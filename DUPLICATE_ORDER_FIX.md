# 重复"请勿重复下单"错误修复

## 问题描述

用户报告在下单时会看到两个相同的"请勿重复下单"错误信息。

## 问题原因

系统中存在两套订单创建服务，它们都有独立的幂等性检查：

1. **新的安全订单创建器** (`secure_order_creator.go`)
   - 幂等性键格式：`order_create:{uid}:{goodsId}:{hour}`
   - 第53行：`return "", fmt.Errorf("请勿重复下单，如有问题请联系客服")`

2. **旧的订单服务** (`apporder.go`)
   - 幂等性键格式：`order_idempotency:{uid}:{goodsId}:{date}`
   - 第210行：`return "", fmt.Errorf("请勿重复下单，如有问题请联系客服")`

虽然控制器只使用新的安全订单创建器，但旧服务的幂等性检查可能在某些情况下被触发。

## 修复方案

移除旧订单服务中的重复幂等性检查，统一使用新的安全订单创建器：

**修改文件**: `services/app_service/apporder.go`

**修改内容**:
```go
// 移除了旧的幂等性检查代码
// 注意：幂等性检查已移至 SecureOrderCreator，此处保留注释作为说明
// 旧的幂等性检查已移除，统一使用 SecureOrderCreator 中的检查
// 避免重复的"请勿重复下单"错误信息
```

## 预期效果

修复后，用户只会看到一个"请勿重复下单"的错误信息，避免了重复显示。

## 验证方法

1. 尝试快速连续下单同一商品
2. 确认只显示一个错误信息
3. 检查日志确认只有一处幂等性检查被触发

## 注意事项

- 新的安全订单创建器提供了更完善的并发控制
- 旧的订单服务方法暂时保留，但移除了重复的幂等性检查
- 如果未来需要完全移除旧服务，需要确认没有其他地方调用 