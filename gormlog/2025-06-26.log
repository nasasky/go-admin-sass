
2025/06/26 09:54:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.723ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:24:14.689'

2025/06/26 09:54:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.905ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 08:54:14.771' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 09:54:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.760ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 09:54:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.966ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 09:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.314ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 08:54:14.935' AND status != 'pending'
	

2025/06/26 09:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[266.865ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:24:14.754'

2025/06/26 09:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.779ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 08:54:15.018' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 09:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.976ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 08:54:15.021' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 09:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.798ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 09:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.810ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 08:54:15.102'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 09:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.246ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 09:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.105ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 08:54:15.197' AND status != 'pending'
	

2025/06/26 09:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.017ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 08:54:15.285' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 09:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.142ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 08:54:15.375'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 09:55:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[94.590ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 09:55:14.69'

2025/06/26 09:55:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.957ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 09:55:14.69'

2025/06/26 09:55:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[89.292ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 09:55:14.69'

2025/06/26 09:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.151ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:25:15.184'

2025/06/26 09:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.156ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 08:55:15.275' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 09:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.528ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 09:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.695ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 09:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.803ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 08:55:15.448' AND status != 'pending'
	

2025/06/26 09:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.357ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:25:15.468'

2025/06/26 09:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.458ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 08:55:15.533' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 09:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.659ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 08:55:15.547' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 09:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.905ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 09:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.798ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 08:55:15.622'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 09:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.757ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 09:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.724ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 08:55:15.711' AND status != 'pending'
	

2025/06/26 09:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.640ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 08:55:15.79' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 09:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.059ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 08:55:15.872'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 09:56:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.667ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 09:56:14.691'

2025/06/26 09:56:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[86.016ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:41:14.691' LIMIT 50

2025/06/26 09:56:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.202ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 09:56:14.691'

2025/06/26 09:56:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[84.748ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 09:56:14.691'

2025/06/26 09:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[273.973ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:41:14.758' LIMIT 50

2025/06/26 09:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[93.668ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:26:15.185'

2025/06/26 09:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.995ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 08:56:15.279' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 09:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.658ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 09:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.749ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 09:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.477ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:26:15.469'

2025/06/26 09:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.762ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 08:56:15.46' AND status != 'pending'
	

2025/06/26 09:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.745ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 08:56:15.549' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 09:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.630ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 08:56:15.552' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 09:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.425ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 09:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.291ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 09:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.763ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 08:56:15.639'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 09:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.176ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 08:56:15.712' AND status != 'pending'
	

2025/06/26 09:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.397ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 08:56:15.794' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 09:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.000ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 08:56:15.877'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 09:57:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.838ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 09:57:14.692'

2025/06/26 09:57:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.619ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 09:57:14.692'

2025/06/26 09:57:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[84.361ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 09:57:14.692'

2025/06/26 09:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.744ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:27:15.186'

2025/06/26 09:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.936ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 08:57:15.27' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 09:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.533ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 09:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.192ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 09:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.040ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 08:57:15.433' AND status != 'pending'
	

2025/06/26 09:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.323ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:27:15.47'

2025/06/26 09:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.002ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 08:57:15.515' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 09:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.587ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 08:57:15.557' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 09:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.732ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 08:57:15.597'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 09:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.563ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 09:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.530ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 09:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.027ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 08:57:15.736' AND status != 'pending'
	

2025/06/26 09:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[91.331ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 08:57:15.824' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 09:57:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.533ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 08:57:15.915'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 09:58:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/login.go:48
[91.435ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/26 09:58:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.136ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:43:14.693' LIMIT 50

2025/06/26 09:58:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[88.214ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 09:58:14.693'

2025/06/26 09:58:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[89.492ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:43:14.759' LIMIT 50

2025/06/26 09:58:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.563ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 09:58:14.693'

2025/06/26 09:58:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[91.187ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 09:58:14.693'

2025/06/26 09:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.827ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:28:15.187'

2025/06/26 09:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.207ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 08:58:15.274' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 09:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.876ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 09:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.569ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 09:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.617ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 08:58:15.454' AND status != 'pending'
	

2025/06/26 09:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.065ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:28:15.471'

2025/06/26 09:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/login.go:48
[79.598ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/26 09:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.851ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 08:58:15.54' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 09:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.401ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 08:58:15.559' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 09:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.787ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 09:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.929ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 08:58:15.626'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 09:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.403ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 09:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.904ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 08:58:15.731' AND status != 'pending'
	

2025/06/26 09:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.636ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 08:58:15.821' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 09:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.325ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 08:58:15.911'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 09:59:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[89.969ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 09:59:14.694'

2025/06/26 09:59:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[88.864ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 09:59:14.694'

2025/06/26 09:59:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.814ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 09:59:14.694'

2025/06/26 09:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.697ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:29:15.189'

2025/06/26 09:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.031ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 08:59:15.28' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 09:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.072ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 09:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.896ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 09:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.521ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 08:59:15.455' AND status != 'pending'
	

2025/06/26 09:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.696ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:29:15.472'

2025/06/26 09:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.154ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 08:59:15.546' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 09:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.684ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 08:59:15.559' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 09:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.929ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 09:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.637ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 08:59:15.633'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 09:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[47.070ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 09:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.031ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 08:59:15.737' AND status != 'pending'
	

2025/06/26 09:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.785ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 08:59:15.824' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 09:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.199ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 08:59:15.911'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:00:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[90.818ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:45:14.695' LIMIT 50

2025/06/26 10:00:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[92.294ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:00:14.695'

2025/06/26 10:00:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.679ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:45:14.762' LIMIT 50

2025/06/26 10:00:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.960ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:00:14.695'

2025/06/26 10:00:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.767ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:00:14.695'

2025/06/26 10:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[91.012ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:30:15.19'

2025/06/26 10:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.853ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:00:15.281' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.880ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.423ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.144ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:00:15.457' AND status != 'pending'
	

2025/06/26 10:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.250ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:30:15.473'

2025/06/26 10:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.725ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:00:15.545' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.434ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:00:15.552' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.443ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.545ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.587ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:00:15.634'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.712ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:00:15.716' AND status != 'pending'
	

2025/06/26 10:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.263ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:00:15.8' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.018ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:00:15.883'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:01:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.162ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:01:14.696'

2025/06/26 10:01:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.635ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:01:14.696'

2025/06/26 10:01:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.487ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:01:14.696'

2025/06/26 10:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.817ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:31:15.191'

2025/06/26 10:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.135ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:01:15.272' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.276ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.391ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.385ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:01:15.437' AND status != 'pending'
	

2025/06/26 10:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.851ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:31:15.474'

2025/06/26 10:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.647ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:01:15.516' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[94.443ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:01:15.561' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.786ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:01:15.597'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.347ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.863ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.576ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:01:15.743' AND status != 'pending'
	

2025/06/26 10:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.717ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:01:15.83' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:01:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.164ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:01:15.92'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:02:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.119ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:47:14.698' LIMIT 50

2025/06/26 10:02:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.935ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:02:14.698'

2025/06/26 10:02:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[90.277ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:47:14.764' LIMIT 50

2025/06/26 10:02:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[88.079ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:02:14.698'

2025/06/26 10:02:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.120ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:02:14.698'

2025/06/26 10:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.517ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:32:15.192'

2025/06/26 10:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.961ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:02:15.279' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.882ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.954ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.565ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:02:15.453' AND status != 'pending'
	

2025/06/26 10:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.755ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:32:15.476'

2025/06/26 10:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.116ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:02:15.542' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.421ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:02:15.563' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.942ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.320ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:02:15.627'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.380ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.985ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:02:15.74' AND status != 'pending'
	

2025/06/26 10:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.853ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:02:15.83' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:02:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.385ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:02:15.916'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:03:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[88.714ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:03:14.699'

2025/06/26 10:03:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[85.932ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:03:14.699'

2025/06/26 10:03:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[89.134ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:03:14.699'

2025/06/26 10:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.062ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:33:15.192'

2025/06/26 10:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.131ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:03:15.279' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.131ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.380ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.833ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:03:15.454' AND status != 'pending'
	

2025/06/26 10:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[102.940ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:33:15.477'

2025/06/26 10:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.215ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:03:15.538' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[107.752ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:03:15.58' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.174ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:03:15.622'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.152ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.332ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.147ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:03:15.775' AND status != 'pending'
	

2025/06/26 10:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.914ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:03:15.863' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:03:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.289ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:03:15.953'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:04:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.323ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:49:14.7' LIMIT 50

2025/06/26 10:04:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[88.253ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:04:14.7'

2025/06/26 10:04:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.596ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:49:14.766' LIMIT 50

2025/06/26 10:04:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.927ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:04:14.7'

2025/06/26 10:04:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.545ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:04:14.7'

2025/06/26 10:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.825ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:34:15.195'

2025/06/26 10:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[92.591ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:04:15.285' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.714ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.796ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.333ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:04:15.463' AND status != 'pending'
	

2025/06/26 10:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.981ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:34:15.478'

2025/06/26 10:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.366ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:04:15.55' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.944ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:04:15.557' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.451ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.886ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.030ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:04:15.638'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.710ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:04:15.719' AND status != 'pending'
	

2025/06/26 10:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.989ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:04:15.803' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.382ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:04:15.884'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:05:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.603ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:05:14.701'

2025/06/26 10:05:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.189ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:05:14.701'

2025/06/26 10:05:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[79.893ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:05:14.701'

2025/06/26 10:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.741ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:35:15.196'

2025/06/26 10:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.186ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:05:15.281' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.031ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.939ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.270ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:05:15.44' AND status != 'pending'
	

2025/06/26 10:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.953ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:35:15.479'

2025/06/26 10:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.970ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:05:15.523' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.540ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:05:15.567' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.643ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:05:15.601'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.410ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.347ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.662ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:05:15.744' AND status != 'pending'
	

2025/06/26 10:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.371ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:05:15.834' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:05:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.335ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:05:15.922'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:05:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:158
[90.952ms] [rows:1] SELECT * FROM `user` WHERE (username = 'admin' OR phone = 'admin') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/26 10:05:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:481
[87.298ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 4

2025/06/26 10:05:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:493 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[47.433ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,3,4,5,6,7,8,23,24)

2025/06/26 10:05:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[91.401ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/26 10:05:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[45.227ms] [rows:20] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/26 10:05:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[47.398ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 10:05:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.172ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 10:05:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.606ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 10:05:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.969ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 10:05:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.330ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 10:05:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.614ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 10:05:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.344ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 10:05:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.119ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 10:05:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[84.851ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 10:05:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.764ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 10:05:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.924ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 10:05:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.023ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 10:05:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.978ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 10:06:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.858ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:51:14.702' LIMIT 50

2025/06/26 10:06:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[89.233ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:06:14.702'

2025/06/26 10:06:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.465ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:51:14.769' LIMIT 50

2025/06/26 10:06:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.087ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:06:14.702'

2025/06/26 10:06:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.061ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:06:14.702'

2025/06/26 10:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.561ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:36:15.197'

2025/06/26 10:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.565ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:06:15.286' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.541ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.013ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.525ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:06:15.459' AND status != 'pending'
	

2025/06/26 10:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.913ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:36:15.48'

2025/06/26 10:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.857ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:06:15.545' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.460ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:06:15.565' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.693ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.438ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:06:15.633'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.478ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.134ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:06:15.739' AND status != 'pending'
	

2025/06/26 10:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.904ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:06:15.825' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:06:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.267ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:06:15.912'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:07:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.454ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:07:14.703'

2025/06/26 10:07:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.101ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:07:14.703'

2025/06/26 10:07:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[99.450ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:07:14.703'

2025/06/26 10:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.295ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:37:15.198'

2025/06/26 10:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.985ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:07:15.286' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.123ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.574ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.301ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:07:15.462' AND status != 'pending'
	

2025/06/26 10:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.962ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:37:15.481'

2025/06/26 10:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.200ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:07:15.546' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.597ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:07:15.567' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.239ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.026ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:07:15.63'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.089ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.501ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:07:15.742' AND status != 'pending'
	

2025/06/26 10:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.793ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:07:15.832' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:07:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.722ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:07:15.922'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:08:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[92.965ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:53:14.705' LIMIT 50

2025/06/26 10:08:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[93.731ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:08:14.704'

2025/06/26 10:08:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.877ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:53:14.771' LIMIT 50

2025/06/26 10:08:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.727ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:08:14.704'

2025/06/26 10:08:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.596ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:08:14.704'

2025/06/26 10:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.780ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:38:15.199'

2025/06/26 10:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.262ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:08:15.29' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.535ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.003ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.415ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:08:15.466' AND status != 'pending'
	

2025/06/26 10:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.861ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:38:15.482'

2025/06/26 10:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.269ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:08:15.553' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.236ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:08:15.561' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.728ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.811ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.673ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:08:15.642'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.166ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:08:15.725' AND status != 'pending'
	

2025/06/26 10:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.657ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:08:15.806' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.015ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:08:15.891'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:09:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.735ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:09:14.705'

2025/06/26 10:09:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.045ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:09:14.705'

2025/06/26 10:09:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.787ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:09:14.705'

2025/06/26 10:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.962ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:39:15.2'

2025/06/26 10:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.172ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:09:15.281' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.340ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.182ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.029ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:09:15.443' AND status != 'pending'
	

2025/06/26 10:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.230ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:39:15.483'

2025/06/26 10:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.516ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:09:15.523' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.755ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:09:15.57' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.210ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:09:15.606'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.057ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.147ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.763ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:09:15.745' AND status != 'pending'
	

2025/06/26 10:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.708ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:09:15.836' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:09:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.015ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:09:15.923'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:10:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.305ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:55:14.707' LIMIT 50

2025/06/26 10:10:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.905ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:10:14.707'

2025/06/26 10:10:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[89.147ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:55:14.774' LIMIT 50

2025/06/26 10:10:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.154ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:10:14.707'

2025/06/26 10:10:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[91.162ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:10:14.707'

2025/06/26 10:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.949ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:40:15.201'

2025/06/26 10:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.446ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:10:15.291' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.775ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.937ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.600ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:10:15.467' AND status != 'pending'
	

2025/06/26 10:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.593ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:40:15.485'

2025/06/26 10:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.591ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:10:15.553' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.856ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:10:15.572' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.834ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.758ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:10:15.642'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.733ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.996ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:10:15.749' AND status != 'pending'
	

2025/06/26 10:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.138ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:10:15.835' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:10:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.939ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:10:15.925'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:11:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.588ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:11:14.708'

2025/06/26 10:11:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.067ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:11:14.708'

2025/06/26 10:11:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.226ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:11:14.708'

2025/06/26 10:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.968ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:41:15.202'

2025/06/26 10:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.763ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:11:15.289' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.194ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.011ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.400ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:11:15.463' AND status != 'pending'
	

2025/06/26 10:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.795ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:41:15.486'

2025/06/26 10:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.301ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:11:15.548' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.329ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:11:15.575' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.196ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.893ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:11:15.631'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.281ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.204ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:11:15.752' AND status != 'pending'
	

2025/06/26 10:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[91.148ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:11:15.838' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:11:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.440ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:11:15.929'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:12:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[93.299ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:57:14.709' LIMIT 50

2025/06/26 10:12:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[93.773ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:12:14.709'

2025/06/26 10:12:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.413ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:57:14.776' LIMIT 50

2025/06/26 10:12:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.005ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:12:14.709'

2025/06/26 10:12:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[91.338ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:12:14.709'

2025/06/26 10:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.948ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:42:15.204'

2025/06/26 10:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.314ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:12:15.294' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.732ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.320ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.071ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:12:15.471' AND status != 'pending'
	

2025/06/26 10:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.965ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:42:15.486'

2025/06/26 10:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.709ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:12:15.56' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.499ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:12:15.567' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.678ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.743ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.329ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:12:15.65'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.576ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:12:15.73' AND status != 'pending'
	

2025/06/26 10:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.081ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:12:15.815' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.836ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:12:15.895'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:12:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[40.393ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 10:12:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.478ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 10:12:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.554ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 10:12:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.727ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 10:12:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.142ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 10:12:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.383ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 10:12:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.206ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 10:12:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.132ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 10:12:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.453ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 10:12:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.188ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 10:12:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.047ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 10:12:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[81.612ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 10:12:58 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.163ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 10:13:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.397ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:13:14.71'

2025/06/26 10:13:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[83.329ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:13:14.71'

2025/06/26 10:13:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.655ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:13:14.71'

2025/06/26 10:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.943ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:43:15.205'

2025/06/26 10:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.649ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:13:15.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.836ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.893ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.308ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:13:15.464' AND status != 'pending'
	

2025/06/26 10:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[92.507ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:43:15.488'

2025/06/26 10:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.830ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:13:15.545' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.080ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:13:15.581' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.521ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:13:15.624'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.799ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.181ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.852ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:13:15.755' AND status != 'pending'
	

2025/06/26 10:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.541ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:13:15.843' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:13:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[93.139ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:13:15.934'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:14:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[93.492ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:14:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[93.037ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[86.964ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:59:14.711' LIMIT 50

2025/06/26 10:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.921ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:14:14.711'

2025/06/26 10:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.716ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:59:14.777' LIMIT 50

2025/06/26 10:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[88.481ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:14:14.711'

2025/06/26 10:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[93.358ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:14:14.711'

2025/06/26 10:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.295ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:44:15.206'

2025/06/26 10:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.402ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:14:15.294' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.744ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[47.130ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.295ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:14:15.475' AND status != 'pending'
	

2025/06/26 10:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.304ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:44:15.489'

2025/06/26 10:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.556ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:14:15.563' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.680ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:14:15.575' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.229ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.946ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:14:15.65'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.644ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.581ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:14:15.749' AND status != 'pending'
	

2025/06/26 10:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.298ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:14:15.835' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:14:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.494ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:14:15.922'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:14:20 /Users/wensiyuan/mycode/go-admin-sass-github/controllers/admin/upload.go:40
[89.027ms] [rows:1] SELECT * FROM `config_setting` WHERE type = 'oss_code'

2025/06/26 10:14:32 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[87.407ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:14:32 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[89.098ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:14:59 /Users/wensiyuan/mycode/go-admin-sass-github/controllers/admin/upload.go:40
[92.442ms] [rows:1] SELECT * FROM `config_setting` WHERE type = 'oss_code'

2025/06/26 10:15:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[86.663ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:15:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[86.096ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:15:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[88.915ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:15:14.712'

2025/06/26 10:15:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.204ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:15:14.712'

2025/06/26 10:15:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.771ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:15:14.712'

2025/06/26 10:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.417ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:45:15.207'

2025/06/26 10:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.790ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:15:15.297' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.911ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.171ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.424ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:15:15.467' AND status != 'pending'
	

2025/06/26 10:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.942ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:45:15.49'

2025/06/26 10:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.385ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:15:15.553' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.878ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:15:15.58' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.929ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.955ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:15:15.637'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.322ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.718ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:15:15.761' AND status != 'pending'
	

2025/06/26 10:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[91.169ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:15:15.852' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:15:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.529ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:15:15.943'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:16:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.477ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:01:14.714' LIMIT 50

2025/06/26 10:16:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.917ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:16:14.713'

2025/06/26 10:16:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.077ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:01:14.78' LIMIT 50

2025/06/26 10:16:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.250ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:16:14.713'

2025/06/26 10:16:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.868ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:16:14.713'

2025/06/26 10:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.387ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:46:15.208'

2025/06/26 10:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.730ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:16:15.296' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.418ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.784ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.178ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:16:15.472' AND status != 'pending'
	

2025/06/26 10:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.718ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:46:15.491'

2025/06/26 10:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.221ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:16:15.562' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.135ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:16:15.571' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.535ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.912ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.799ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:16:15.648'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.954ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:16:15.731' AND status != 'pending'
	

2025/06/26 10:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.246ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:16:15.814' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.627ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:16:15.895'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:17:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.139ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:17:14.715'

2025/06/26 10:17:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.341ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:17:14.715'

2025/06/26 10:17:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[84.268ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:17:14.715'

2025/06/26 10:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.963ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:47:15.209'

2025/06/26 10:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.291ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:17:15.293' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.974ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.189ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.113ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:17:15.456' AND status != 'pending'
	

2025/06/26 10:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.683ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:47:15.492'

2025/06/26 10:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.029ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:17:15.54' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.140ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:17:15.579' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.344ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:17:15.622'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.128ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[47.572ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.133ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:17:15.757' AND status != 'pending'
	

2025/06/26 10:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[91.273ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:17:15.845' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:17:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.290ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:17:15.936'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:18:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[88.482ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:18:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[88.997ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:18:13 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[91.298ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:18:13 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[87.371ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:18:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.704ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:03:14.716' LIMIT 50

2025/06/26 10:18:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.684ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:18:14.716'

2025/06/26 10:18:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[88.720ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:03:14.783' LIMIT 50

2025/06/26 10:18:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.042ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:18:14.716'

2025/06/26 10:18:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.226ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:18:14.716'

2025/06/26 10:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.644ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:48:15.21'

2025/06/26 10:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.201ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:18:15.297' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.081ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.109ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.063ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:18:15.477' AND status != 'pending'
	

2025/06/26 10:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.993ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:48:15.493'

2025/06/26 10:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.692ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:18:15.563' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.409ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:18:15.581' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.774ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.335ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:18:15.649'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.620ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.789ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:18:15.752' AND status != 'pending'
	

2025/06/26 10:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.930ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:18:15.841' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:18:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.617ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:18:15.931'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:18:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[47.178ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 10:18:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.785ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 10:18:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.556ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 10:18:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.551ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 10:18:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.541ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 10:18:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.032ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 10:18:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.338ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 10:18:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[84.712ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 10:18:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.973ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 10:18:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.290ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 10:18:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[84.207ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 10:18:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.065ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 10:18:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.228ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 10:18:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[87.725ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:18:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[84.210ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:19:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.683ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:19:14.717'

2025/06/26 10:19:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[88.912ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:19:14.717'

2025/06/26 10:19:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[92.884ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:19:14.717'

2025/06/26 10:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.978ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:49:15.212'

2025/06/26 10:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.911ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:19:15.297' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.942ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.170ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.008ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:19:15.47' AND status != 'pending'
	

2025/06/26 10:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.995ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:49:15.495'

2025/06/26 10:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.761ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:19:15.555' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.352ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:19:15.584' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.169ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.143ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:19:15.639'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.552ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.355ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:19:15.758' AND status != 'pending'
	

2025/06/26 10:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.644ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:19:15.846' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:19:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.013ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:19:15.937'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:20:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[87.740ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:20:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[87.061ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:20:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.923ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:05:14.718' LIMIT 50

2025/06/26 10:20:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.339ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:20:14.718'

2025/06/26 10:20:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.061ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:05:14.785' LIMIT 50

2025/06/26 10:20:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.297ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:20:14.718'

2025/06/26 10:20:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[88.332ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:20:14.718'

2025/06/26 10:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.419ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:50:15.212'

2025/06/26 10:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.598ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:20:15.299' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.124ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.825ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.508ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:20:15.475' AND status != 'pending'
	

2025/06/26 10:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.638ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:50:15.496'

2025/06/26 10:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.751ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:20:15.561' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.188ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:20:15.58' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.502ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.193ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:20:15.65'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.565ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.337ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:20:15.739' AND status != 'pending'
	

2025/06/26 10:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.439ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:20:15.824' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.634ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:20:15.907'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:20:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[80.163ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:20:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[80.652ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:20:37 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[84.615ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:20:38 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[83.535ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[84.154ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 10:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[39.947ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 10:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[83.054ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 10:21:00 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[80.884ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:21:00 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[82.791ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:21:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:132
[175.815ms] [rows:1] DELETE FROM `pet_banners` WHERE id = 1 AND tenants_id = 1

2025/06/26 10:21:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[83.606ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:21:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[79.085ms] [rows:1] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:21:13 /Users/wensiyuan/mycode/go-admin-sass-github/controllers/admin/upload.go:40
[85.912ms] [rows:1] SELECT * FROM `config_setting` WHERE type = 'oss_code'

2025/06/26 10:21:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.168ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:21:14.719'

2025/06/26 10:21:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.617ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:21:14.719'

2025/06/26 10:21:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.463ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:21:14.719'

2025/06/26 10:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.157ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:51:15.214'

2025/06/26 10:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.404ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:21:15.295' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.639ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.691ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.237ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:21:15.458' AND status != 'pending'
	

2025/06/26 10:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.876ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:51:15.497'

2025/06/26 10:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.054ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:21:15.542' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.281ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:21:15.585' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.057ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:21:15.621'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.118ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.272ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.163ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:21:15.759' AND status != 'pending'
	

2025/06/26 10:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[93.126ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:21:15.847' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:21:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[95.046ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:21:15.941'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:21:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:25
[175.585ms] [rows:1] INSERT INTO `pet_banners` (`title`,`image_url`,`link_url`,`sort`,`status`,`tenants_id`,`create_time`,`update_time`) VALUES ('ceshi ','https://ark-auto-2102366935-cn-beijing-default.tos-cn-beijing.volces.com/uploads/20250626102113000.png','',1,1,1,'2025-06-26 10:21:17.926','2025-06-26 10:21:17.926')

2025/06/26 10:21:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[89.506ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:21:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[85.071ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:21:31 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[86.974ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:21:31 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[90.423ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:22:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.563ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:07:14.72' LIMIT 50

2025/06/26 10:22:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[91.225ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:22:14.72'

2025/06/26 10:22:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[88.536ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:07:14.787' LIMIT 50

2025/06/26 10:22:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.692ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:22:14.72'

2025/06/26 10:22:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.856ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:22:14.72'

2025/06/26 10:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.876ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:52:15.214'

2025/06/26 10:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.905ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:22:15.301' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.524ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[47.829ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.254ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:22:15.479' AND status != 'pending'
	

2025/06/26 10:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.450ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:52:15.498'

2025/06/26 10:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.701ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:22:15.564' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.300ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:22:15.587' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.929ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.881ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:22:15.65'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.394ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.077ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:22:15.758' AND status != 'pending'
	

2025/06/26 10:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.535ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:22:15.847' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:22:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.469ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:22:15.938'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:22:42 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[85.620ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:22:42 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[89.028ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:22:49 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[85.884ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:22:49 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[85.700ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:22:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[85.900ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/26 10:22:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[44.238ms] [rows:20] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/26 10:22:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[43.943ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 10:22:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.724ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 10:22:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.667ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 10:22:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.834ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 10:22:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.041ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 10:22:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[84.504ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 10:22:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.784ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 10:23:00 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.763ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 10:23:00 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.737ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 10:23:00 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.897ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 10:23:00 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[84.530ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 10:23:00 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[84.162ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 10:23:00 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.458ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 10:23:00 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[89.015ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:23:00 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[86.663ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:23:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.145ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:23:14.721'

2025/06/26 10:23:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[88.892ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:23:14.721'

2025/06/26 10:23:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[89.199ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:23:14.721'

2025/06/26 10:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.787ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:53:15.216'

2025/06/26 10:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.248ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:23:15.303' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.924ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.808ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.458ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:23:15.475' AND status != 'pending'
	

2025/06/26 10:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.638ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:53:15.499'

2025/06/26 10:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.447ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:23:15.561' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.529ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:23:15.589' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.397ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.399ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:23:15.646'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.457ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.656ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:23:15.763' AND status != 'pending'
	

2025/06/26 10:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[92.023ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:23:15.854' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:23:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.481ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:23:15.946'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:24:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[90.338ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:24:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[90.662ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:24:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.976ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:09:14.723' LIMIT 50

2025/06/26 10:24:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.188ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:24:14.723'

2025/06/26 10:24:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.241ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:09:14.789' LIMIT 50

2025/06/26 10:24:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.995ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:24:14.723'

2025/06/26 10:24:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[89.944ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:24:14.723'

2025/06/26 10:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.786ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:54:15.217'

2025/06/26 10:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.857ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:24:15.304' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.857ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.383ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.525ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:24:15.483' AND status != 'pending'
	

2025/06/26 10:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.584ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:54:15.5'

2025/06/26 10:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.472ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:24:15.569' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.825ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:24:15.583' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.273ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.315ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:24:15.658'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.922ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.798ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:24:15.746' AND status != 'pending'
	

2025/06/26 10:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.978ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:24:15.829' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.693ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:24:15.912'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:25:01 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[41.023ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 10:25:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.589ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 10:25:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.823ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 10:25:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[81.719ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 10:25:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.588ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 10:25:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.092ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 10:25:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.426ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 10:25:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[81.820ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 10:25:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.721ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 10:25:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.417ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 10:25:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[81.845ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 10:25:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.304ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 10:25:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[77.983ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 10:25:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[78.962ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:25:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[78.569ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:25:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.650ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:25:14.724'

2025/06/26 10:25:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.626ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:25:14.724'

2025/06/26 10:25:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.687ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:25:14.724'

2025/06/26 10:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.165ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:55:15.218'

2025/06/26 10:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.951ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:25:15.302' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.234ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.155ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.168ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:25:15.464' AND status != 'pending'
	

2025/06/26 10:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[92.875ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:55:15.501'

2025/06/26 10:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.248ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:25:15.547' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.612ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:25:15.594' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.975ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:25:15.627'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.017ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.073ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.053ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:25:15.768' AND status != 'pending'
	

2025/06/26 10:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[91.994ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:25:15.857' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:25:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.777ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:25:15.949'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:26:13 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[87.297ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:26:13 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[86.937ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:26:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.213ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:11:14.725' LIMIT 50

2025/06/26 10:26:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.434ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:26:14.725'

2025/06/26 10:26:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[88.961ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:11:14.792' LIMIT 50

2025/06/26 10:26:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.215ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:26:14.725'

2025/06/26 10:26:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[92.071ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:26:14.725'

2025/06/26 10:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.832ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:56:15.22'

2025/06/26 10:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.456ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:26:15.309' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.323ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.086ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.906ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:26:15.478' AND status != 'pending'
	

2025/06/26 10:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.125ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:56:15.503'

2025/06/26 10:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.661ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:26:15.567' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.298ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:26:15.59' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.038ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.741ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:26:15.652'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.233ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.364ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:26:15.766' AND status != 'pending'
	

2025/06/26 10:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.879ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:26:15.852' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:26:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.246ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:26:15.938'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:26:39 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[86.531ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:26:39 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[89.100ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:26:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[46.862ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 10:26:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.360ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 10:26:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.086ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 10:26:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.718ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 10:26:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.976ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 10:26:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[84.611ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 10:26:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.144ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 10:26:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.580ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 10:26:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.665ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 10:26:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.991ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 10:26:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.396ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 10:26:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[84.134ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 10:26:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.551ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 10:26:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[88.508ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:26:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[87.432ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:27:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.626ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:27:14.726'

2025/06/26 10:27:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[85.227ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:27:14.726'

2025/06/26 10:27:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[89.101ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:27:14.726'

2025/06/26 10:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.544ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:57:15.221'

2025/06/26 10:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.724ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:27:15.306' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.020ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.017ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.833ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:27:15.477' AND status != 'pending'
	

2025/06/26 10:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.798ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:57:15.504'

2025/06/26 10:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.185ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:27:15.561' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.678ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:27:15.591' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.514ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.615ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:27:15.646'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[47.361ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.389ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:27:15.774' AND status != 'pending'
	

2025/06/26 10:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.485ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:27:15.86' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:27:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.687ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:27:15.951'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:27:32 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[86.966ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:27:32 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[86.547ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:27:34 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[47.908ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 10:27:34 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.221ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 10:27:34 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.758ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 10:27:34 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[90.126ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 10:27:34 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.304ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 10:27:34 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.212ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 10:27:34 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[90.588ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 10:27:34 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.601ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 10:27:34 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.243ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 10:27:35 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.447ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 10:27:35 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.745ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 10:27:35 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.682ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 10:27:35 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.165ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 10:27:35 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[88.023ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:27:35 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[89.213ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:27:42 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[44.281ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 10:27:42 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.741ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 10:27:42 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.797ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 10:27:42 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.066ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 10:27:42 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.053ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 10:27:42 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.753ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 10:27:42 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[90.648ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 10:27:42 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[91.456ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 10:27:42 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.237ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 10:27:42 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.329ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 10:27:42 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[90.106ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 10:27:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.911ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 10:27:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[91.106ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 10:27:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[88.364ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:27:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[89.606ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:28:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.776ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:13:14.727' LIMIT 50

2025/06/26 10:28:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.396ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:28:14.727'

2025/06/26 10:28:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.440ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:13:14.794' LIMIT 50

2025/06/26 10:28:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.336ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:28:14.727'

2025/06/26 10:28:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.522ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:28:14.727'

2025/06/26 10:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[91.100ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:58:15.222'

2025/06/26 10:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.456ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:28:15.313' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.156ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.728ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.654ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:28:15.49' AND status != 'pending'
	

2025/06/26 10:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.390ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:58:15.505'

2025/06/26 10:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.819ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:28:15.578' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.961ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:28:15.585' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.757ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.067ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.422ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:28:15.667'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.226ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:28:15.748' AND status != 'pending'
	

2025/06/26 10:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.827ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:28:15.831' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.172ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:28:15.916'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:28:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[87.283ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:28:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[80.128ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:28:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[40.532ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 10:28:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.185ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 10:28:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.892ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 10:28:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.599ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 10:28:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[81.776ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 10:28:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.312ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 10:28:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.705ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 10:28:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.284ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 10:28:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.975ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 10:28:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.085ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 10:28:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.498ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 10:28:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.755ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 10:28:37 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.593ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 10:28:37 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[79.119ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:28:37 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[82.210ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:28:53 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[83.947ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:28:53 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[79.925ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:29:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.967ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:29:14.728'

2025/06/26 10:29:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.917ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:29:14.728'

2025/06/26 10:29:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.983ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:29:14.728'

2025/06/26 10:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.152ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:59:15.222'

2025/06/26 10:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.580ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:29:15.302' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.496ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.843ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.183ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:29:15.466' AND status != 'pending'
	

2025/06/26 10:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.755ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 09:59:15.505'

2025/06/26 10:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.385ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:29:15.545' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.382ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:29:15.591' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.975ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:29:15.627'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.755ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.392ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.264ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:29:15.766' AND status != 'pending'
	

2025/06/26 10:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.373ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:29:15.856' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:29:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.584ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:29:15.947'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[91.217ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:29:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[89.609ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:30:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.578ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:15:14.729' LIMIT 50

2025/06/26 10:30:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.047ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:30:14.729'

2025/06/26 10:30:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[88.650ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:15:14.796' LIMIT 50

2025/06/26 10:30:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.281ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:30:14.729'

2025/06/26 10:30:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.437ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:30:14.729'

2025/06/26 10:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.809ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:00:15.224'

2025/06/26 10:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.581ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:30:15.314' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.660ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.530ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.179ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:30:15.49' AND status != 'pending'
	

2025/06/26 10:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.525ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:00:15.507'

2025/06/26 10:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.246ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:30:15.576' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.047ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:30:15.593' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.087ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.253ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:30:15.663'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.821ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.214ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:30:15.768' AND status != 'pending'
	

2025/06/26 10:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.422ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:30:15.857' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:30:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.203ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:30:15.944'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:31:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.584ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:31:14.73'

2025/06/26 10:31:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[85.326ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:31:14.73'

2025/06/26 10:31:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[88.817ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:31:14.73'

2025/06/26 10:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.511ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:01:15.225'

2025/06/26 10:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.770ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:31:15.311' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.908ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.199ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.377ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:31:15.485' AND status != 'pending'
	

2025/06/26 10:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.114ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:01:15.508'

2025/06/26 10:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.709ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:31:15.572' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.009ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:31:15.595' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.076ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.990ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:31:15.656'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.831ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.761ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:31:15.775' AND status != 'pending'
	

2025/06/26 10:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.160ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:31:15.863' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:31:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.934ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:31:15.951'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:31:39 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:58
[86.762ms] [rows:1] SELECT count(*) FROM `pet_banners` WHERE tenants_id = 1

2025/06/26 10:31:39 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:63
[87.373ms] [rows:2] SELECT * FROM `pet_banners` WHERE tenants_id = 1 ORDER BY sort DESC, id DESC LIMIT 10

2025/06/26 10:31:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/banner.go:98
[87.140ms] [rows:1] SELECT * FROM `pet_banners` WHERE id = 3 AND tenants_id = 1 ORDER BY `pet_banners`.`id` LIMIT 1

2025/06/26 10:32:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.773ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:17:14.732' LIMIT 50

2025/06/26 10:32:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[88.418ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:32:14.732'

2025/06/26 10:32:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.943ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:17:14.798' LIMIT 50

2025/06/26 10:32:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.268ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:32:14.732'

2025/06/26 10:32:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.168ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:32:14.732'

2025/06/26 10:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.140ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:02:15.226'

2025/06/26 10:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.357ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:32:15.314' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.709ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.123ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.010ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:32:15.493' AND status != 'pending'
	

2025/06/26 10:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.937ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:02:15.509'

2025/06/26 10:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.472ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:32:15.579' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.305ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:32:15.589' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.121ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.571ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.754ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:32:15.665'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.425ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:32:15.751' AND status != 'pending'
	

2025/06/26 10:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.719ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:32:15.835' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.840ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:32:15.916'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:32:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[84.109ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 1

2025/06/26 10:32:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[85.346ms] [rows:1] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 1 ORDER BY create_time DESC LIMIT 10

2025/06/26 10:32:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:97
[83.740ms] [rows:1] SELECT * FROM `goods_list` WHERE id = 3 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/26 10:33:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.866ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:33:14.733'

2025/06/26 10:33:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[83.208ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:33:14.733'

2025/06/26 10:33:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.911ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:33:14.733'

2025/06/26 10:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.251ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:03:15.227'

2025/06/26 10:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.233ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:33:15.312' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.373ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.105ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.417ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:33:15.475' AND status != 'pending'
	

2025/06/26 10:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.928ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:03:15.511'

2025/06/26 10:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.365ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:33:15.556' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.915ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:33:15.597' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.920ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:33:15.639'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.371ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[47.183ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.906ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:33:15.775' AND status != 'pending'
	

2025/06/26 10:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[91.202ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:33:15.862' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:33:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.258ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:33:15.953'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:34:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.230ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:19:14.734' LIMIT 50

2025/06/26 10:34:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.309ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:34:14.734'

2025/06/26 10:34:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[91.207ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:19:14.8' LIMIT 50

2025/06/26 10:34:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.204ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:34:14.734'

2025/06/26 10:34:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.669ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:34:14.734'

2025/06/26 10:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.037ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:04:15.229'

2025/06/26 10:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.512ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:34:15.316' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.234ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.403ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.858ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:34:15.496' AND status != 'pending'
	

2025/06/26 10:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[92.313ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:04:15.512'

2025/06/26 10:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.165ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:34:15.582' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.255ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:34:15.604' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.591ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[95.793ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:34:15.672'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.598ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.381ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:34:15.779' AND status != 'pending'
	

2025/06/26 10:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[93.591ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:34:15.868' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:34:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.402ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:34:15.961'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:35:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.468ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:35:14.735'

2025/06/26 10:35:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[89.624ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:35:14.735'

2025/06/26 10:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.225ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:35:14.735'

2025/06/26 10:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.643ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:05:15.23'

2025/06/26 10:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.960ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:35:15.316' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.822ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.679ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.695ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:35:15.492' AND status != 'pending'
	

2025/06/26 10:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.659ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:05:15.513'

2025/06/26 10:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.629ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:35:15.577' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.552ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:35:15.602' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.433ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.140ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:35:15.665'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.207ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.970ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:35:15.778' AND status != 'pending'
	

2025/06/26 10:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.852ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:35:15.868' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:35:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.090ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:35:15.956'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:36:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[88.434ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:21:14.736' LIMIT 50

2025/06/26 10:36:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[89.417ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:36:14.736'

2025/06/26 10:36:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.832ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:21:14.803' LIMIT 50

2025/06/26 10:36:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[91.158ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:36:14.736'

2025/06/26 10:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.802ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:36:14.736'

2025/06/26 10:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.997ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:06:15.231'

2025/06/26 10:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[93.567ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:36:15.319' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.590ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.865ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.044ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:36:15.499' AND status != 'pending'
	

2025/06/26 10:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.464ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:06:15.514'

2025/06/26 10:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.348ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:36:15.594' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.710ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:36:15.589' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.417ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.221ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.039ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:36:15.674'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.996ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:36:15.756' AND status != 'pending'
	

2025/06/26 10:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.545ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:36:15.837' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:36:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.478ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:36:15.922'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:37:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.960ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:37:14.737'

2025/06/26 10:37:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[85.140ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:37:14.737'

2025/06/26 10:37:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.184ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:37:14.737'

2025/06/26 10:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.188ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:07:15.232'

2025/06/26 10:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.712ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:37:15.317' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.053ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.493ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.920ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:37:15.48' AND status != 'pending'
	

2025/06/26 10:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.402ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:07:15.515'

2025/06/26 10:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.225ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:37:15.559' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.669ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:37:15.604' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.534ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:37:15.643'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.081ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.533ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.156ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:37:15.777' AND status != 'pending'
	

2025/06/26 10:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.031ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:37:15.868' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:37:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.580ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:37:15.955'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:38:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.650ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:23:14.739' LIMIT 50

2025/06/26 10:38:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.977ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:38:14.738'

2025/06/26 10:38:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[89.323ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:23:14.805' LIMIT 50

2025/06/26 10:38:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[93.942ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:38:14.738'

2025/06/26 10:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.520ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:38:14.738'

2025/06/26 10:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.802ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:08:15.232'

2025/06/26 10:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.180ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:38:15.32' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.820ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.737ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.763ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:38:15.496' AND status != 'pending'
	

2025/06/26 10:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.125ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:08:15.516'

2025/06/26 10:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.064ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:38:15.585' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.973ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:38:15.6' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.962ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.760ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:38:15.673'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.559ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.176ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:38:15.776' AND status != 'pending'
	

2025/06/26 10:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.068ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:38:15.865' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:38:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.727ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:38:15.955'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:39:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[89.231ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:39:14.739'

2025/06/26 10:39:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[89.573ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:39:14.739'

2025/06/26 10:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.559ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:39:14.739'

2025/06/26 10:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.978ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:09:15.233'

2025/06/26 10:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.313ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:39:15.32' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.625ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.263ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.210ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:39:15.493' AND status != 'pending'
	

2025/06/26 10:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.529ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:09:15.517'

2025/06/26 10:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.894ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:39:15.581' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.121ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:39:15.603' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.722ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.356ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:39:15.665'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.504ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.663ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:39:15.777' AND status != 'pending'
	

2025/06/26 10:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.262ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:39:15.867' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:39:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.880ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:39:15.954'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:40:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[91.440ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:25:14.741' LIMIT 50

2025/06/26 10:40:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[92.291ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:40:14.741'

2025/06/26 10:40:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.839ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:25:14.808' LIMIT 50

2025/06/26 10:40:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.362ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:40:14.741'

2025/06/26 10:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[91.835ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:40:14.741'

2025/06/26 10:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[91.470ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:10:15.235'

2025/06/26 10:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.967ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:40:15.327' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.702ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.164ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.152ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:40:15.499' AND status != 'pending'
	

2025/06/26 10:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.576ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:10:15.519'

2025/06/26 10:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.025ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:40:15.589' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.624ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:40:15.598' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.349ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.366ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:40:15.675'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.935ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.090ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:40:15.763' AND status != 'pending'
	

2025/06/26 10:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.489ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:40:15.844' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:40:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.735ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:40:15.929'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:41:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.892ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:41:14.742'

2025/06/26 10:41:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.398ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:41:14.742'

2025/06/26 10:41:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[84.546ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:41:14.742'

2025/06/26 10:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.285ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:11:15.236'

2025/06/26 10:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.321ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:41:15.317' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.610ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.124ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.923ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:41:15.478' AND status != 'pending'
	

2025/06/26 10:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.039ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:11:15.519'

2025/06/26 10:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.977ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:41:15.561' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.559ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:41:15.604' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.036ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:41:15.64'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.326ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.456ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.338ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:41:15.778' AND status != 'pending'
	

2025/06/26 10:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.678ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:41:15.865' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:41:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.282ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:41:15.956'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:42:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.804ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:27:14.743' LIMIT 50

2025/06/26 10:42:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.549ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:42:14.743'

2025/06/26 10:42:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[88.239ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:27:14.81' LIMIT 50

2025/06/26 10:42:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.424ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:42:14.743'

2025/06/26 10:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[89.046ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:42:14.743'

2025/06/26 10:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.692ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:12:15.238'

2025/06/26 10:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[92.013ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:42:15.329' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.726ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.120ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.172ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:42:15.507' AND status != 'pending'
	

2025/06/26 10:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.716ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:12:15.521'

2025/06/26 10:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.708ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:42:15.596' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.244ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:42:15.605' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.762ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.095ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:42:15.686'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.334ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.314ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:42:15.777' AND status != 'pending'
	

2025/06/26 10:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.054ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:42:15.868' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:42:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.840ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:42:15.958'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:43:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.997ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:43:14.744'

2025/06/26 10:43:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.837ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:43:14.744'

2025/06/26 10:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[89.400ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:43:14.744'

2025/06/26 10:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.813ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:13:15.239'

2025/06/26 10:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.873ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:43:15.325' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.988ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.341ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.512ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:43:15.498' AND status != 'pending'
	

2025/06/26 10:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.257ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:13:15.523'

2025/06/26 10:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.596ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:43:15.586' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.986ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:43:15.61' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.461ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.887ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:43:15.67'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.532ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.092ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:43:15.79' AND status != 'pending'
	

2025/06/26 10:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.722ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:43:15.877' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:43:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.594ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:43:15.968'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:44:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[88.133ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:29:14.745' LIMIT 50

2025/06/26 10:44:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[89.117ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:44:14.745'

2025/06/26 10:44:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.301ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:29:14.811' LIMIT 50

2025/06/26 10:44:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.790ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:44:14.745'

2025/06/26 10:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[89.617ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:44:14.745'

2025/06/26 10:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.620ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:14:15.24'

2025/06/26 10:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.478ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:44:15.329' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.964ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.745ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.440ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:44:15.508' AND status != 'pending'
	

2025/06/26 10:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.327ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:14:15.523'

2025/06/26 10:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.233ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:44:15.594' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.083ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:44:15.603' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.673ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.126ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.094ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:44:15.68'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.647ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:44:15.768' AND status != 'pending'
	

2025/06/26 10:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.661ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:44:15.854' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:44:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.782ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:44:15.935'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:45:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.187ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:45:14.746'

2025/06/26 10:45:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.322ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:45:14.746'

2025/06/26 10:45:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.779ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:45:14.746'

2025/06/26 10:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.204ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:15:15.241'

2025/06/26 10:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.958ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:45:15.324' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.454ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.637ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.918ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:45:15.488' AND status != 'pending'
	

2025/06/26 10:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.513ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:15:15.523'

2025/06/26 10:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.726ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:45:15.569' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.328ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:45:15.612' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.463ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:45:15.651'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.444ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.823ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.064ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:45:15.789' AND status != 'pending'
	

2025/06/26 10:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.434ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:45:15.876' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:45:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.429ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:45:15.964'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:46:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.774ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:31:14.748' LIMIT 50

2025/06/26 10:46:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.599ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:46:14.747'

2025/06/26 10:46:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[92.091ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:31:14.814' LIMIT 50

2025/06/26 10:46:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[89.295ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:46:14.747'

2025/06/26 10:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[92.315ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:46:14.747'

2025/06/26 10:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.070ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:16:15.242'

2025/06/26 10:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.513ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:46:15.328' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.324ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.013ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.274ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:46:15.506' AND status != 'pending'
	

2025/06/26 10:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.427ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:16:15.525'

2025/06/26 10:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.057ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:46:15.592' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.168ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:46:15.613' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.999ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.003ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:46:15.677'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.578ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.503ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:46:15.792' AND status != 'pending'
	

2025/06/26 10:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.321ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:46:15.884' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:46:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.109ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:46:15.972'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:47:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.975ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:47:14.749'

2025/06/26 10:47:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.463ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:47:14.749'

2025/06/26 10:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.646ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:47:14.749'

2025/06/26 10:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.544ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:17:15.243'

2025/06/26 10:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.589ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:47:15.332' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.345ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.035ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.350ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:47:15.505' AND status != 'pending'
	

2025/06/26 10:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.768ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:17:15.527'

2025/06/26 10:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.873ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:47:15.59' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.722ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:47:15.612' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.329ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.436ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:47:15.677'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.619ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.251ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:47:15.789' AND status != 'pending'
	

2025/06/26 10:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.714ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:47:15.88' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:47:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.736ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:47:15.967'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:48:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[93.488ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:33:14.75' LIMIT 50

2025/06/26 10:48:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[95.002ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:48:14.75'

2025/06/26 10:48:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.603ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:33:14.817' LIMIT 50

2025/06/26 10:48:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.426ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:48:14.75'

2025/06/26 10:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.693ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:48:14.75'

2025/06/26 10:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.394ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:18:15.244'

2025/06/26 10:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.087ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:48:15.335' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.927ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.004ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.424ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:48:15.511' AND status != 'pending'
	

2025/06/26 10:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.155ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:18:15.528'

2025/06/26 10:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.071ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:48:15.597' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.157ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:48:15.609' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.450ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.707ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:48:15.686'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.771ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.763ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:48:15.773' AND status != 'pending'
	

2025/06/26 10:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.507ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:48:15.853' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:48:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.038ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:48:15.932'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:49:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.431ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:49:14.751'

2025/06/26 10:49:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.505ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:49:14.751'

2025/06/26 10:49:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.983ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:49:14.751'

2025/06/26 10:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.271ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:19:15.246'

2025/06/26 10:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.027ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:49:15.328' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.282ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.659ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.564ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:49:15.494' AND status != 'pending'
	

2025/06/26 10:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.680ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:19:15.529'

2025/06/26 10:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.021ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:49:15.572' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.316ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:49:15.617' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.439ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:49:15.655'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.422ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.097ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.512ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:49:15.791' AND status != 'pending'
	

2025/06/26 10:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.171ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:49:15.882' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:49:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.957ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:49:15.969'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:50:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.373ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:35:14.752' LIMIT 50

2025/06/26 10:50:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.365ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:50:14.752'

2025/06/26 10:50:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[89.046ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:35:14.819' LIMIT 50

2025/06/26 10:50:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.324ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:50:14.752'

2025/06/26 10:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.201ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:50:14.752'

2025/06/26 10:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.867ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:20:15.247'

2025/06/26 10:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.116ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:50:15.334' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.700ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.229ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.670ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:50:15.514' AND status != 'pending'
	

2025/06/26 10:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.216ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:20:15.53'

2025/06/26 10:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.360ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:50:15.6' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.028ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:50:15.619' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.873ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.642ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:50:15.686'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.665ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.093ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:50:15.791' AND status != 'pending'
	

2025/06/26 10:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.335ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:50:15.88' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:50:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.641ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:50:15.97'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:51:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.427ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:51:14.753'

2025/06/26 10:51:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[85.831ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:51:14.753'

2025/06/26 10:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.896ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:51:14.753'

2025/06/26 10:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.909ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:21:15.248'

2025/06/26 10:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.980ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:51:15.334' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.841ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.305ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.343ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:51:15.509' AND status != 'pending'
	

2025/06/26 10:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.979ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:21:15.531'

2025/06/26 10:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.283ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:51:15.594' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.549ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:51:15.619' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.729ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.689ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:51:15.678'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.275ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.941ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:51:15.797' AND status != 'pending'
	

2025/06/26 10:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.964ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:51:15.887' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:51:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.675ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:51:15.974'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:52:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.553ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:37:14.754' LIMIT 50

2025/06/26 10:52:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.323ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:52:14.754'

2025/06/26 10:52:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.947ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:37:14.821' LIMIT 50

2025/06/26 10:52:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[91.195ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:52:14.754'

2025/06/26 10:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[93.254ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:52:14.754'

2025/06/26 10:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[92.347ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:22:15.249'

2025/06/26 10:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[93.422ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:52:15.341' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.523ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.539ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.302ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:22:15.531'

2025/06/26 10:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.624ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:52:15.527' AND status != 'pending'
	

2025/06/26 10:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.877ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:52:15.612' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.873ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:52:15.612' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.233ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.150ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.377ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:52:15.698'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.258ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:52:15.781' AND status != 'pending'
	

2025/06/26 10:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.823ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:52:15.862' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:52:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.164ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:52:15.946'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:53:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.302ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:53:14.755'

2025/06/26 10:53:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.823ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:53:14.755'

2025/06/26 10:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.560ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:53:14.755'

2025/06/26 10:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.449ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:23:15.25'

2025/06/26 10:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.820ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:53:15.333' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.419ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.354ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.691ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:53:15.499' AND status != 'pending'
	

2025/06/26 10:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[91.779ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:23:15.533'

2025/06/26 10:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.169ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:53:15.58' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.739ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:53:15.625' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.207ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:53:15.659'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.412ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.537ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.721ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:53:15.799' AND status != 'pending'
	

2025/06/26 10:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[91.576ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:53:15.886' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:53:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.167ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:53:15.978'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:54:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[89.225ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 10:54:14.757' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/26 10:54:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.130ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:54:14.757'

2025/06/26 10:54:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[42.006ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-19 10:54:14.846'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/26 10:54:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.855ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:54:14.757'

2025/06/26 10:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[245.410ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:39:14.757' LIMIT 50

2025/06/26 10:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.722ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:54:14.757'

2025/06/26 10:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[244.905ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 10:54:14.823' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/26 10:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[252.236ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:39:14.823' LIMIT 50

2025/06/26 10:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[40.183ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-19 10:54:15.068'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/26 10:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.386ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:24:15.251'

2025/06/26 10:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.204ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:54:15.33' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.766ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.457ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.783ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:54:15.492' AND status != 'pending'
	

2025/06/26 10:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.004ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:24:15.534'

2025/06/26 10:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.811ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:54:15.57' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.661ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:54:15.617' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.828ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:54:15.651'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.644ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.639ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.130ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:54:15.782' AND status != 'pending'
	

2025/06/26 10:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.700ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:54:15.867' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:54:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.135ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:54:15.949'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:55:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.671ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:55:14.758'

2025/06/26 10:55:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.742ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:55:14.758'

2025/06/26 10:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.566ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:55:14.758'

2025/06/26 10:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.279ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:25:15.252'

2025/06/26 10:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.252ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:55:15.332' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.219ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.057ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.743ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:55:15.501' AND status != 'pending'
	

2025/06/26 10:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.864ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:25:15.536'

2025/06/26 10:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.981ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:55:15.581' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.328ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:55:15.614' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.170ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.942ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:55:15.66'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.049ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.015ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:55:15.773' AND status != 'pending'
	

2025/06/26 10:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.632ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:55:15.854' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:55:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.524ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:55:15.934'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:56:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.043ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:56:14.759'

2025/06/26 10:56:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.389ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:41:14.759' LIMIT 50

2025/06/26 10:56:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[86.247ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:41:14.826' LIMIT 50

2025/06/26 10:56:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.644ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:56:14.759'

2025/06/26 10:56:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[82.136ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:56:14.759'

2025/06/26 10:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.613ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:26:15.253'

2025/06/26 10:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.144ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:56:15.335' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.145ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.677ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.903ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:56:15.491' AND status != 'pending'
	

2025/06/26 10:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.469ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:26:15.536'

2025/06/26 10:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.922ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:56:15.567' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.748ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:56:15.62' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.011ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:56:15.643'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.483ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.461ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.238ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:56:15.785' AND status != 'pending'
	

2025/06/26 10:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.838ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:56:15.869' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:56:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.692ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:56:15.95'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:57:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.989ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:57:14.76'

2025/06/26 10:57:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.040ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:57:14.76'

2025/06/26 10:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.756ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:57:14.76'

2025/06/26 10:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.451ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:27:15.255'

2025/06/26 10:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.102ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:57:15.336' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.043ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.690ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.172ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:57:15.502' AND status != 'pending'
	

2025/06/26 10:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.739ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:27:15.538'

2025/06/26 10:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.017ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:57:15.583' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.992ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:57:15.62' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.766ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.708ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:57:15.663'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.142ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.924ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:57:15.777' AND status != 'pending'
	

2025/06/26 10:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.985ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:57:15.86' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:57:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.724ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:57:15.938'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:58:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[77.799ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:58:14.761'

2025/06/26 10:58:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.110ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:43:14.761' LIMIT 50

2025/06/26 10:58:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.792ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:43:14.828' LIMIT 50

2025/06/26 10:58:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[83.049ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:58:14.761'

2025/06/26 10:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.396ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:58:14.761'

2025/06/26 10:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.243ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:28:15.256'

2025/06/26 10:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.542ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:58:15.334' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.918ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.989ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.108ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:58:15.495' AND status != 'pending'
	

2025/06/26 10:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.878ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:28:15.539'

2025/06/26 10:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.073ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:58:15.572' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.466ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:58:15.616' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.204ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:58:15.651'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.350ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.919ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.966ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:58:15.771' AND status != 'pending'
	

2025/06/26 10:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.670ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:58:15.852' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:58:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.157ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:58:15.929'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:59:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.621ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 10:59:14.762'

2025/06/26 10:59:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.240ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 10:59:14.762'

2025/06/26 10:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.047ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 10:59:14.762'

2025/06/26 10:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.889ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:29:15.257'

2025/06/26 10:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.582ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:59:15.338' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.511ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.886ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.320ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:59:15.491' AND status != 'pending'
	

2025/06/26 10:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.064ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:29:15.54'

2025/06/26 10:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.550ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:59:15.568' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.606ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 09:59:15.617' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 10:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.787ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:59:15.649'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 10:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.707ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 10:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.115ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 10:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.287ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 09:59:15.777' AND status != 'pending'
	

2025/06/26 10:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.225ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 09:59:15.855' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 10:59:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.406ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 09:59:15.936'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:00:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.230ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:45:14.764' LIMIT 50

2025/06/26 11:00:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.974ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:00:14.763'

2025/06/26 11:00:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.532ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:45:14.83' LIMIT 50

2025/06/26 11:00:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.318ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:00:14.763'

2025/06/26 11:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[115.566ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:00:14.763'

2025/06/26 11:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.249ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:30:15.258'

2025/06/26 11:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.281ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:00:15.341' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.250ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.285ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.542ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:00:15.502' AND status != 'pending'
	

2025/06/26 11:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.395ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:30:15.54'

2025/06/26 11:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.799ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:00:15.582' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.674ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:00:15.623' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.690ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:00:15.659'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.962ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.291ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.946ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:00:15.787' AND status != 'pending'
	

2025/06/26 11:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.868ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:00:15.869' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:00:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.883ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:00:15.951'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:01:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.612ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:01:14.764'

2025/06/26 11:01:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.842ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:01:14.764'

2025/06/26 11:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[84.148ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:01:14.764'

2025/06/26 11:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.683ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:31:15.258'

2025/06/26 11:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.221ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:01:15.344' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.879ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.775ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.440ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:01:15.505' AND status != 'pending'
	

2025/06/26 11:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.424ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:31:15.542'

2025/06/26 11:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.522ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:01:15.588' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.453ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:01:15.62' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.946ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.851ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:01:15.667'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.460ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.299ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:01:15.784' AND status != 'pending'
	

2025/06/26 11:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.065ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:01:15.862' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:01:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.051ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:01:15.94'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:02:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.600ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:02:14.766'

2025/06/26 11:02:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.531ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:47:14.766' LIMIT 50

2025/06/26 11:02:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[77.491ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:47:14.833' LIMIT 50

2025/06/26 11:02:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.073ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:02:14.766'

2025/06/26 11:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.034ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:02:14.766'

2025/06/26 11:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.447ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:32:15.26'

2025/06/26 11:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.951ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:02:15.341' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.087ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.474ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.799ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:02:15.503' AND status != 'pending'
	

2025/06/26 11:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.109ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:32:15.544'

2025/06/26 11:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.903ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:02:15.583' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.543ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:02:15.621' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.129ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:02:15.663'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.729ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.526ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.522ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:02:15.782' AND status != 'pending'
	

2025/06/26 11:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.999ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:02:15.859' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:02:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.405ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:02:15.942'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:03:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.048ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:03:14.767'

2025/06/26 11:03:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.855ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:03:14.767'

2025/06/26 11:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.326ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:03:14.767'

2025/06/26 11:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.053ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:33:15.261'

2025/06/26 11:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.983ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:03:15.341' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.249ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.947ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.898ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:03:15.498' AND status != 'pending'
	

2025/06/26 11:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.762ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:33:15.544'

2025/06/26 11:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.037ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:03:15.574' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.625ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:03:15.621' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.228ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:03:15.653'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.793ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.825ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.395ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:03:15.777' AND status != 'pending'
	

2025/06/26 11:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.467ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:03:15.856' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:03:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.306ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:03:15.935'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:04:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.030ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:04:14.768'

2025/06/26 11:04:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.693ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:49:14.768' LIMIT 50

2025/06/26 11:04:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.994ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:49:14.834' LIMIT 50

2025/06/26 11:04:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.546ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:04:14.768'

2025/06/26 11:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.824ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:04:14.768'

2025/06/26 11:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.917ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:34:15.263'

2025/06/26 11:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.032ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:04:15.342' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.105ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.258ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.033ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:04:15.497' AND status != 'pending'
	

2025/06/26 11:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.302ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:34:15.546'

2025/06/26 11:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.652ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:04:15.577' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.337ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:04:15.626' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.137ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:04:15.655'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.593ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.267ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.454ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:04:15.793' AND status != 'pending'
	

2025/06/26 11:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.372ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:04:15.875' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:04:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.668ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:04:15.96'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:05:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.479ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:05:14.769'

2025/06/26 11:05:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[85.192ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:05:14.769'

2025/06/26 11:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.856ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:05:14.769'

2025/06/26 11:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.778ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:35:15.264'

2025/06/26 11:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.758ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:05:15.349' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.204ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.155ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.917ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:05:15.514' AND status != 'pending'
	

2025/06/26 11:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.363ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:35:15.547'

2025/06/26 11:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.393ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:05:15.594' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.076ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:05:15.628' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.826ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.455ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:05:15.674'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.708ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.020ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:05:15.787' AND status != 'pending'
	

2025/06/26 11:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.752ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:05:15.868' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:05:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.873ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:05:15.949'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:06:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.571ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:06:14.77'

2025/06/26 11:06:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.069ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:51:14.77' LIMIT 50

2025/06/26 11:06:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.877ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:51:14.837' LIMIT 50

2025/06/26 11:06:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.614ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:06:14.77'

2025/06/26 11:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.885ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:06:14.77'

2025/06/26 11:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.626ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:36:15.265'

2025/06/26 11:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.103ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:06:15.347' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.025ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.080ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.320ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:06:15.504' AND status != 'pending'
	

2025/06/26 11:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.632ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:36:15.548'

2025/06/26 11:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.215ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:06:15.582' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.309ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:06:15.631' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.062ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:06:15.658'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.703ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.290ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.248ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:06:15.796' AND status != 'pending'
	

2025/06/26 11:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.083ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:06:15.876' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:06:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.088ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:06:15.959'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:07:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.625ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:07:14.771'

2025/06/26 11:07:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.592ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:07:14.771'

2025/06/26 11:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.312ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:07:14.771'

2025/06/26 11:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.789ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:37:15.266'

2025/06/26 11:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.890ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:07:15.347' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.902ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.662ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.983ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:07:15.501' AND status != 'pending'
	

2025/06/26 11:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.548ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:37:15.549'

2025/06/26 11:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.220ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:07:15.58' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.504ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:07:15.626' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.458ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:07:15.656'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.635ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.985ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.633ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:07:15.781' AND status != 'pending'
	

2025/06/26 11:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.595ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:07:15.864' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:07:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.396ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:07:15.943'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:08:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.202ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:08:14.772'

2025/06/26 11:08:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.246ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:53:14.773' LIMIT 50

2025/06/26 11:08:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[86.249ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:53:14.839' LIMIT 50

2025/06/26 11:08:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.321ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:08:14.772'

2025/06/26 11:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.230ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:08:14.772'

2025/06/26 11:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.083ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:38:15.267'

2025/06/26 11:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.044ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:08:15.348' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.403ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.916ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.220ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:08:15.51' AND status != 'pending'
	

2025/06/26 11:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.461ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:38:15.55'

2025/06/26 11:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.884ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:08:15.59' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.132ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:08:15.633' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.893ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:08:15.669'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.426ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[59.886ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.598ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:08:15.817' AND status != 'pending'
	

2025/06/26 11:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.499ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:08:15.898' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:08:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.185ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:08:15.984'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:09:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[89.074ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:09:14.774'

2025/06/26 11:09:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[85.042ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:09:14.774'

2025/06/26 11:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[82.460ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:09:14.774'

2025/06/26 11:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.466ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:39:15.268'

2025/06/26 11:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.507ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:09:15.353' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.100ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.148ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.657ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:09:15.519' AND status != 'pending'
	

2025/06/26 11:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.743ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:39:15.551'

2025/06/26 11:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.976ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:09:15.6' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.570ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:09:15.632' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.280ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.849ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:09:15.68'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.559ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.808ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:09:15.792' AND status != 'pending'
	

2025/06/26 11:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.409ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:09:15.874' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:09:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.018ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:09:15.953'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:10:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[77.929ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:10:14.775'

2025/06/26 11:10:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.439ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:55:14.775' LIMIT 50

2025/06/26 11:10:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[77.043ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:55:14.842' LIMIT 50

2025/06/26 11:10:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.783ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:10:14.775'

2025/06/26 11:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.672ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:10:14.775'

2025/06/26 11:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.350ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:40:15.269'

2025/06/26 11:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.811ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:10:15.347' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.138ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.532ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.310ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:10:15.502' AND status != 'pending'
	

2025/06/26 11:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.385ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:40:15.552'

2025/06/26 11:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.641ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:10:15.582' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.318ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:10:15.63' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.992ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:10:15.663'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.447ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.196ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.616ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:10:15.788' AND status != 'pending'
	

2025/06/26 11:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.389ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:10:15.866' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:10:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.080ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:10:15.948'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:11:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.259ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:11:14.776'

2025/06/26 11:11:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.710ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:11:14.776'

2025/06/26 11:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.991ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:11:14.776'

2025/06/26 11:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.492ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:41:15.271'

2025/06/26 11:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.166ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:11:15.35' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.831ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.484ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.967ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:11:15.505' AND status != 'pending'
	

2025/06/26 11:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.190ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:41:15.554'

2025/06/26 11:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.630ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:11:15.581' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.684ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:11:15.633' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.884ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:11:15.658'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.487ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.398ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.019ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:11:15.788' AND status != 'pending'
	

2025/06/26 11:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.961ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:11:15.869' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:11:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.298ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:11:15.947'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:12:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.096ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:57:14.777' LIMIT 50

2025/06/26 11:12:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.725ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:12:14.777'

2025/06/26 11:12:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.732ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:57:14.844' LIMIT 50

2025/06/26 11:12:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.271ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:12:14.777'

2025/06/26 11:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.944ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:12:14.777'

2025/06/26 11:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.531ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:42:15.272'

2025/06/26 11:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.205ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:12:15.349' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.442ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.951ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.625ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:12:15.507' AND status != 'pending'
	

2025/06/26 11:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.110ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:42:15.555'

2025/06/26 11:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.007ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:12:15.588' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.603ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:12:15.636' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.669ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:12:15.664'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.494ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.196ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.424ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:12:15.799' AND status != 'pending'
	

2025/06/26 11:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.335ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:12:15.881' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:12:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.127ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:12:15.965'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:13:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.376ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:13:14.778'

2025/06/26 11:13:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.728ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:13:14.778'

2025/06/26 11:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.305ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:13:14.778'

2025/06/26 11:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.946ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:43:15.273'

2025/06/26 11:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.249ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:13:15.354' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.219ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.338ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.213ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:13:15.517' AND status != 'pending'
	

2025/06/26 11:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.882ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:43:15.556'

2025/06/26 11:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.172ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:13:15.597' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.893ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:13:15.637' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.393ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.998ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:13:15.677'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.395ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.132ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:13:15.793' AND status != 'pending'
	

2025/06/26 11:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.115ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:13:15.87' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:13:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.374ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:13:15.949'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.849ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:14:14.779'

2025/06/26 11:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.793ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:59:14.779' LIMIT 50

2025/06/26 11:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.071ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:59:14.845' LIMIT 50

2025/06/26 11:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.811ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:14:14.779'

2025/06/26 11:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.185ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:14:14.779'

2025/06/26 11:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.568ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:44:15.274'

2025/06/26 11:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.646ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:14:15.352' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.435ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.459ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.725ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:14:15.509' AND status != 'pending'
	

2025/06/26 11:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.101ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:44:15.557'

2025/06/26 11:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.434ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:14:15.586' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.360ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:14:15.634' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.759ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:14:15.665'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.607ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.470ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.340ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:14:15.789' AND status != 'pending'
	

2025/06/26 11:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.209ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:14:15.87' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:14:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.693ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:14:15.948'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:15:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.574ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:15:14.78'

2025/06/26 11:15:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.830ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:15:14.78'

2025/06/26 11:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.739ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:15:14.78'

2025/06/26 11:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.648ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:45:15.275'

2025/06/26 11:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.381ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:15:15.358' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.534ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.153ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.325ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:15:15.517' AND status != 'pending'
	

2025/06/26 11:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.191ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:45:15.557'

2025/06/26 11:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.846ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:15:15.598' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.949ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:15:15.637' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.115ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:15:15.675'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.984ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.825ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.481ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:15:15.795' AND status != 'pending'
	

2025/06/26 11:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.753ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:15:15.873' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:15:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.583ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:15:15.954'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:16:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.158ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:01:14.782' LIMIT 50

2025/06/26 11:16:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.065ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:16:14.781'

2025/06/26 11:16:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.945ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:01:14.848' LIMIT 50

2025/06/26 11:16:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[95.438ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:16:14.781'

2025/06/26 11:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.635ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:16:14.781'

2025/06/26 11:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.333ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:46:15.276'

2025/06/26 11:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.967ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:16:15.36' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.898ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.867ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.905ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:16:15.515' AND status != 'pending'
	

2025/06/26 11:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.495ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:46:15.559'

2025/06/26 11:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.400ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:16:15.596' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.281ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:16:15.64' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.225ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:16:15.673'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.036ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.342ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.458ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:16:15.804' AND status != 'pending'
	

2025/06/26 11:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.069ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:16:15.886' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:16:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.124ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:16:15.967'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:17:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.931ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:17:14.782'

2025/06/26 11:17:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.403ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:17:14.782'

2025/06/26 11:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.061ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:17:14.782'

2025/06/26 11:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.346ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:47:15.277'

2025/06/26 11:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.252ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:17:15.362' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.028ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.845ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.281ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:17:15.527' AND status != 'pending'
	

2025/06/26 11:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.980ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:47:15.56'

2025/06/26 11:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.054ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:17:15.613' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.185ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:17:15.638' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.850ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.233ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:17:15.693'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.259ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.699ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:17:15.801' AND status != 'pending'
	

2025/06/26 11:17:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.768ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:17:15.88' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:17:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.004ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:17:15.961'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:18:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.148ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:18:14.784'

2025/06/26 11:18:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.735ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:03:14.784' LIMIT 50

2025/06/26 11:18:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.539ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:03:14.851' LIMIT 50

2025/06/26 11:18:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.487ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:18:14.784'

2025/06/26 11:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.809ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:18:14.784'

2025/06/26 11:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.635ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:48:15.278'

2025/06/26 11:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.860ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:18:15.36' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.925ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.647ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.839ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:18:15.522' AND status != 'pending'
	

2025/06/26 11:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.151ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:48:15.561'

2025/06/26 11:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.303ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:18:15.602' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.041ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:18:15.64' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.597ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:18:15.679'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.038ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.418ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.395ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:18:15.799' AND status != 'pending'
	

2025/06/26 11:18:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.871ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:18:15.88' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:18:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.572ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:18:15.961'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:19:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.164ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:19:14.785'

2025/06/26 11:19:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.525ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:19:14.785'

2025/06/26 11:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.317ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:19:14.785'

2025/06/26 11:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.216ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:49:15.28'

2025/06/26 11:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.723ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:19:15.361' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.962ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.025ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.068ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:19:15.518' AND status != 'pending'
	

2025/06/26 11:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.263ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:49:15.562'

2025/06/26 11:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.468ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:19:15.596' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.824ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:19:15.64' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.090ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:19:15.672'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.749ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.120ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.460ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:19:15.799' AND status != 'pending'
	

2025/06/26 11:19:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.394ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:19:15.878' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:19:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.524ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:19:15.96'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:20:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.705ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:20:14.786'

2025/06/26 11:20:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.169ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:05:14.786' LIMIT 50

2025/06/26 11:20:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.004ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:05:14.853' LIMIT 50

2025/06/26 11:20:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.524ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:20:14.786'

2025/06/26 11:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.626ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:20:14.786'

2025/06/26 11:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.921ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:50:15.281'

2025/06/26 11:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.025ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:20:15.36' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.306ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.242ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.179ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:20:15.521' AND status != 'pending'
	

2025/06/26 11:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.737ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:50:15.563'

2025/06/26 11:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.647ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:20:15.597' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.489ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:20:15.643' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.077ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:20:15.677'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.583ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.297ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.569ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:20:15.806' AND status != 'pending'
	

2025/06/26 11:20:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.188ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:20:15.891' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:20:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.916ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:20:15.972'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:21:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.379ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:21:14.787'

2025/06/26 11:21:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.829ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:21:14.787'

2025/06/26 11:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.710ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:21:14.787'

2025/06/26 11:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.213ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:51:15.281'

2025/06/26 11:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.208ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:21:15.363' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.876ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.678ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.864ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:21:15.525' AND status != 'pending'
	

2025/06/26 11:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.344ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:51:15.565'

2025/06/26 11:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.243ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:21:15.608' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.472ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:21:15.644' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.992ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.879ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:21:15.687'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.950ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.600ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:21:15.805' AND status != 'pending'
	

2025/06/26 11:21:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.148ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:21:15.885' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:21:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.534ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:21:15.967'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:22:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.742ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:22:14.788'

2025/06/26 11:22:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.802ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:07:14.788' LIMIT 50

2025/06/26 11:22:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[77.257ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:07:14.855' LIMIT 50

2025/06/26 11:22:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.942ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:22:14.788'

2025/06/26 11:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.433ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:22:14.788'

2025/06/26 11:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.368ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:52:15.283'

2025/06/26 11:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.891ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:22:15.365' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.943ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.340ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.944ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:22:15.526' AND status != 'pending'
	

2025/06/26 11:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.803ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:52:15.565'

2025/06/26 11:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.296ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:22:15.604' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.823ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:22:15.642' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.472ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:22:15.684'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.199ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.528ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.978ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:22:15.804' AND status != 'pending'
	

2025/06/26 11:22:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.528ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:22:15.882' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:22:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.851ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:22:15.965'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:23:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.232ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:23:14.789'

2025/06/26 11:23:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.192ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:23:14.789'

2025/06/26 11:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.994ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:23:14.789'

2025/06/26 11:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.470ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:53:15.284'

2025/06/26 11:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.397ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:23:15.365' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.845ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.343ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.190ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:23:15.524' AND status != 'pending'
	

2025/06/26 11:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.066ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:53:15.566'

2025/06/26 11:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.580ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:23:15.604' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.241ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:23:15.643' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.315ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:23:15.684'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.319ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.912ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.416ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:23:15.805' AND status != 'pending'
	

2025/06/26 11:23:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.311ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:23:15.884' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:23:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.801ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:23:15.969'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:24:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.983ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:24:14.791'

2025/06/26 11:24:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.834ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:09:14.791' LIMIT 50

2025/06/26 11:24:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.162ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:09:14.856' LIMIT 50

2025/06/26 11:24:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.692ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:24:14.791'

2025/06/26 11:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.013ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:24:14.791'

2025/06/26 11:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.789ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:54:15.285'

2025/06/26 11:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.553ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:24:15.366' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.802ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.927ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.219ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:24:15.524' AND status != 'pending'
	

2025/06/26 11:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.672ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:54:15.568'

2025/06/26 11:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.031ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:24:15.603' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.637ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:24:15.65' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.881ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:24:15.681'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.581ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.886ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.927ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:24:15.813' AND status != 'pending'
	

2025/06/26 11:24:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.612ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:24:15.895' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:24:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.108ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:24:15.979'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:25:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.661ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:25:14.792'

2025/06/26 11:25:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.096ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:25:14.792'

2025/06/26 11:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.996ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:25:14.792'

2025/06/26 11:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.778ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:55:15.286'

2025/06/26 11:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.782ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:25:15.371' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.286ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.012ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.500ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:25:15.537' AND status != 'pending'
	

2025/06/26 11:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.412ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:55:15.57'

2025/06/26 11:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.740ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:25:15.616' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.961ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:25:15.65' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.938ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.565ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:25:15.697'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.773ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.070ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:25:15.811' AND status != 'pending'
	

2025/06/26 11:25:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.311ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:25:15.893' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:25:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.194ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:25:15.976'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:26:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.407ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:26:14.793'

2025/06/26 11:26:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.338ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:11:14.793' LIMIT 50

2025/06/26 11:26:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.010ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:11:14.86' LIMIT 50

2025/06/26 11:26:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.047ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:26:14.793'

2025/06/26 11:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.796ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:26:14.793'

2025/06/26 11:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.146ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:56:15.287'

2025/06/26 11:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.367ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:26:15.366' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.991ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.689ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.636ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:26:15.525' AND status != 'pending'
	

2025/06/26 11:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.797ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:56:15.57'

2025/06/26 11:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.314ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:26:15.602' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.928ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:26:15.647' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.360ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:26:15.682'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.255ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.670ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.114ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:26:15.803' AND status != 'pending'
	

2025/06/26 11:26:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.734ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:26:15.887' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:26:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.334ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:26:15.966'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:27:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.578ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:27:14.794'

2025/06/26 11:27:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.899ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:27:14.794'

2025/06/26 11:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.329ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:27:14.794'

2025/06/26 11:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.276ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:57:15.289'

2025/06/26 11:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.393ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:27:15.366' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.545ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.868ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.952ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:27:15.526' AND status != 'pending'
	

2025/06/26 11:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.063ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:57:15.572'

2025/06/26 11:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.129ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:27:15.602' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.745ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:27:15.649' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.954ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:27:15.679'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.764ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.150ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.603ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:27:15.805' AND status != 'pending'
	

2025/06/26 11:27:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.856ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:27:15.886' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:27:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.598ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:27:15.964'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:28:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.462ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:28:14.795'

2025/06/26 11:28:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.469ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:13:14.795' LIMIT 50

2025/06/26 11:28:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.366ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:13:14.862' LIMIT 50

2025/06/26 11:28:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.391ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:28:14.795'

2025/06/26 11:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[79.016ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:28:14.795'

2025/06/26 11:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.455ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:58:15.29'

2025/06/26 11:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.520ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:28:15.367' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.189ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.780ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.169ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:28:15.526' AND status != 'pending'
	

2025/06/26 11:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.009ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:58:15.573'

2025/06/26 11:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.863ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:28:15.603' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.382ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:28:15.656' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.951ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:28:15.683'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.641ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.402ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.953ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:28:15.82' AND status != 'pending'
	

2025/06/26 11:28:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.590ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:28:15.905' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:28:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.903ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:28:15.987'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:29:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.172ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:29:14.796'

2025/06/26 11:29:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[83.872ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:29:14.796'

2025/06/26 11:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.940ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:29:14.796'

2025/06/26 11:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.204ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:59:15.291'

2025/06/26 11:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.017ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:29:15.375' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.943ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.620ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.679ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:29:15.544' AND status != 'pending'
	

2025/06/26 11:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.924ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 10:59:15.574'

2025/06/26 11:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.299ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:29:15.628' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.156ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:29:15.655' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.972ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.862ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:29:15.708'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.898ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.770ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:29:15.822' AND status != 'pending'
	

2025/06/26 11:29:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.174ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:29:15.899' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:29:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.447ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:29:15.982'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:30:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.703ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:30:14.797'

2025/06/26 11:30:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.981ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:15:14.797' LIMIT 50

2025/06/26 11:30:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.480ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:15:14.864' LIMIT 50

2025/06/26 11:30:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.155ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:30:14.797'

2025/06/26 11:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.441ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:30:14.797'

2025/06/26 11:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.195ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:00:15.292'

2025/06/26 11:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.866ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:30:15.368' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.983ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.696ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.675ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:30:15.527' AND status != 'pending'
	

2025/06/26 11:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.453ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:00:15.575'

2025/06/26 11:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.126ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:30:15.607' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.765ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:30:15.652' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.662ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:30:15.686'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.873ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.928ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.221ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:30:15.811' AND status != 'pending'
	

2025/06/26 11:30:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.988ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:30:15.889' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:30:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.456ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:30:15.97'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:31:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.187ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:31:14.798'

2025/06/26 11:31:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.243ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:31:14.798'

2025/06/26 11:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[79.978ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:31:14.798'

2025/06/26 11:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.330ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:01:15.293'

2025/06/26 11:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.121ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:31:15.372' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.673ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.759ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.914ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:31:15.527' AND status != 'pending'
	

2025/06/26 11:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.733ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:01:15.576'

2025/06/26 11:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.879ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:31:15.611' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.691ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:31:15.655' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.062ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:31:15.688'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.767ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.061ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.506ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:31:15.812' AND status != 'pending'
	

2025/06/26 11:31:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.437ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:31:15.89' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:31:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.602ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:31:15.972'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:32:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.919ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:17:14.8' LIMIT 50

2025/06/26 11:32:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.177ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:32:14.8'

2025/06/26 11:32:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.976ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:17:14.866' LIMIT 50

2025/06/26 11:32:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.833ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:32:14.8'

2025/06/26 11:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.607ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:32:14.8'

2025/06/26 11:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.972ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:02:15.294'

2025/06/26 11:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.564ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:32:15.372' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.544ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.886ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.798ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:32:15.532' AND status != 'pending'
	

2025/06/26 11:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.415ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:02:15.577'

2025/06/26 11:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.028ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:32:15.609' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.286ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:32:15.658' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.973ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:32:15.689'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.389ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.163ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.519ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:32:15.823' AND status != 'pending'
	

2025/06/26 11:32:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.900ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:32:15.908' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:32:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.141ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:32:15.989'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:33:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.739ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:33:14.801'

2025/06/26 11:33:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.985ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:33:14.801'

2025/06/26 11:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.189ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:33:14.801'

2025/06/26 11:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.633ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:03:15.294'

2025/06/26 11:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.251ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:33:15.38' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.204ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.454ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.601ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:33:15.547' AND status != 'pending'
	

2025/06/26 11:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.142ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:03:15.578'

2025/06/26 11:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.779ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:33:15.63' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.020ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:33:15.658' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.076ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.579ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:33:15.71'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[62.815ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.225ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:33:15.841' AND status != 'pending'
	

2025/06/26 11:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.743ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:33:15.919' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:33:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.214ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:33:15.999'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:34:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.105ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:34:14.802'

2025/06/26 11:34:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.027ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:19:14.802' LIMIT 50

2025/06/26 11:34:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[77.415ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:19:14.868' LIMIT 50

2025/06/26 11:34:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.785ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:34:14.802'

2025/06/26 11:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.726ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:34:14.802'

2025/06/26 11:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.862ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:04:15.297'

2025/06/26 11:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.980ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:34:15.381' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.306ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.147ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.960ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:34:15.536' AND status != 'pending'
	

2025/06/26 11:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.909ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:04:15.579'

2025/06/26 11:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.118ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:34:15.616' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.878ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:34:15.656' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.933ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:34:15.692'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.754ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.246ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.634ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:34:15.814' AND status != 'pending'
	

2025/06/26 11:34:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.546ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:34:15.891' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:34:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.432ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:34:15.969'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:35:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.669ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:35:14.803'

2025/06/26 11:35:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.809ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:35:14.803'

2025/06/26 11:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.743ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:35:14.803'

2025/06/26 11:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.697ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:05:15.298'

2025/06/26 11:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.783ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:35:15.376' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.135ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.104ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.456ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:35:15.537' AND status != 'pending'
	

2025/06/26 11:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.463ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:05:15.58'

2025/06/26 11:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.262ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:35:15.614' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.074ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:35:15.658' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.118ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:35:15.694'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.261ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.787ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.770ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:35:15.814' AND status != 'pending'
	

2025/06/26 11:35:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.595ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:35:15.895' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:35:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.483ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:35:15.972'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:36:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.627ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:21:14.804' LIMIT 50

2025/06/26 11:36:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.854ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:36:14.804'

2025/06/26 11:36:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.946ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:21:14.87' LIMIT 50

2025/06/26 11:36:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.639ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:36:14.804'

2025/06/26 11:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.589ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:36:14.804'

2025/06/26 11:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.409ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:06:15.299'

2025/06/26 11:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[76.421ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:36:15.375' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.288ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.371ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.763ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:36:15.529' AND status != 'pending'
	

2025/06/26 11:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.575ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:06:15.582'

2025/06/26 11:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.609ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:36:15.609' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.320ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:36:15.663' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.991ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:36:15.69'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.889ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.233ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.180ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:36:15.829' AND status != 'pending'
	

2025/06/26 11:36:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.379ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:36:15.91' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:36:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.461ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:36:15.992'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:37:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.764ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:37:14.805'

2025/06/26 11:37:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[85.895ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:37:14.805'

2025/06/26 11:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[82.334ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:37:14.805'

2025/06/26 11:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.522ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:07:15.3'

2025/06/26 11:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.316ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:37:15.385' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.819ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.094ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.284ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:37:15.547' AND status != 'pending'
	

2025/06/26 11:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.333ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:07:15.583'

2025/06/26 11:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.367ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:37:15.631' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.605ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:37:15.661' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.974ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.483ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:37:15.711'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.905ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.715ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:37:15.832' AND status != 'pending'
	

2025/06/26 11:37:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.091ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:37:15.91' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:37:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.154ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:37:15.992'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:38:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.224ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:38:14.806'

2025/06/26 11:38:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.034ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:23:14.807' LIMIT 50

2025/06/26 11:38:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.509ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:23:14.873' LIMIT 50

2025/06/26 11:38:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.260ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:38:14.806'

2025/06/26 11:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.260ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:38:14.806'

2025/06/26 11:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.222ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:08:15.3'

2025/06/26 11:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.897ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:38:15.383' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.070ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.498ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.536ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:38:15.545' AND status != 'pending'
	

2025/06/26 11:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.845ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:08:15.584'

2025/06/26 11:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.397ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:38:15.626' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.244ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:38:15.662' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.511ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:38:15.707'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.538ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.479ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.830ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:38:15.829' AND status != 'pending'
	

2025/06/26 11:38:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.836ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:38:15.908' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:38:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.666ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:38:15.988'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:39:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.181ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:39:14.807'

2025/06/26 11:39:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.442ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:39:14.807'

2025/06/26 11:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.960ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:39:14.807'

2025/06/26 11:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.242ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:09:15.302'

2025/06/26 11:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.592ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:39:15.382' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.084ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.490ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.685ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:39:15.538' AND status != 'pending'
	

2025/06/26 11:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.371ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:09:15.585'

2025/06/26 11:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.285ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:39:15.615' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.632ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:39:15.667' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.134ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:39:15.692'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.979ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.669ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.202ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:39:15.826' AND status != 'pending'
	

2025/06/26 11:39:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.717ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:39:15.904' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:39:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.978ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:39:15.983'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:40:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.584ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:25:14.809' LIMIT 50

2025/06/26 11:40:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.798ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:40:14.809'

2025/06/26 11:40:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.927ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:25:14.875' LIMIT 50

2025/06/26 11:40:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.170ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:40:14.809'

2025/06/26 11:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.801ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:40:14.809'

2025/06/26 11:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.943ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:10:15.303'

2025/06/26 11:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.738ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:40:15.384' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.160ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.195ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.119ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:40:15.541' AND status != 'pending'
	

2025/06/26 11:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.933ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:10:15.586'

2025/06/26 11:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.185ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:40:15.618' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.738ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:40:15.67' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.524ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:40:15.698'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.519ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.126ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:40:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.730ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:40:15.835' AND status != 'pending'
	

2025/06/26 11:40:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.761ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:40:15.92' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:40:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.901ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:40:16.002'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:41:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.982ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:41:14.81'

2025/06/26 11:41:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.270ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:41:14.81'

2025/06/26 11:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.741ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:41:14.81'

2025/06/26 11:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.163ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:11:15.304'

2025/06/26 11:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.753ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:41:15.386' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.659ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.715ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.305ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:41:15.546' AND status != 'pending'
	

2025/06/26 11:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.581ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:11:15.587'

2025/06/26 11:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.299ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:41:15.627' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.189ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:41:15.668' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.554ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.500ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:41:15.707'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.616ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.831ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:41:15.824' AND status != 'pending'
	

2025/06/26 11:41:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.187ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:41:15.901' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:41:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.891ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:41:15.979'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:42:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.700ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:42:14.811'

2025/06/26 11:42:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.454ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:27:14.811' LIMIT 50

2025/06/26 11:42:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[77.200ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:27:14.878' LIMIT 50

2025/06/26 11:42:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.602ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:42:14.811'

2025/06/26 11:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.360ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:42:14.811'

2025/06/26 11:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.578ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:12:15.306'

2025/06/26 11:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.478ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:42:15.388' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.490ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.930ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.650ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:42:15.543' AND status != 'pending'
	

2025/06/26 11:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.181ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:12:15.589'

2025/06/26 11:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.162ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:42:15.623' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.831ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:42:15.666' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.953ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:42:15.699'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.846ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.998ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.692ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:42:15.822' AND status != 'pending'
	

2025/06/26 11:42:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.664ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:42:15.9' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:42:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.852ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:42:15.988'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:43:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.798ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:43:14.812'

2025/06/26 11:43:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.249ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:43:14.812'

2025/06/26 11:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.644ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:43:14.812'

2025/06/26 11:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.912ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:13:15.306'

2025/06/26 11:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.383ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:43:15.384' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.796ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.269ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.921ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:43:15.539' AND status != 'pending'
	

2025/06/26 11:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.847ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:13:15.589'

2025/06/26 11:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.414ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:43:15.619' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.195ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:43:15.667' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.101ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:43:15.7'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.224ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.322ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.418ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:43:15.827' AND status != 'pending'
	

2025/06/26 11:43:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.188ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:43:15.905' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:43:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.578ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:43:15.986'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:44:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.545ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:29:14.813' LIMIT 50

2025/06/26 11:44:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.435ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:44:14.813'

2025/06/26 11:44:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.762ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:29:14.879' LIMIT 50

2025/06/26 11:44:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.139ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:44:14.813'

2025/06/26 11:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.702ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:44:14.813'

2025/06/26 11:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.337ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:14:15.307'

2025/06/26 11:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.011ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:44:15.385' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.709ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.754ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.786ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:44:15.542' AND status != 'pending'
	

2025/06/26 11:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.682ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:14:15.591'

2025/06/26 11:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.892ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:44:15.619' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.724ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:44:15.671' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.801ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:44:15.699'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.359ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.376ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:44:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.345ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:44:15.834' AND status != 'pending'
	

2025/06/26 11:44:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.339ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:44:15.92' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:44:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.352ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:44:16.001'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:45:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.129ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:45:14.814'

2025/06/26 11:45:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.338ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:45:14.814'

2025/06/26 11:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.388ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:45:14.814'

2025/06/26 11:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.424ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:15:15.309'

2025/06/26 11:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.510ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:45:15.392' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.757ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.540ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.710ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:45:15.553' AND status != 'pending'
	

2025/06/26 11:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.616ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:15:15.592'

2025/06/26 11:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.987ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:45:15.635' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.221ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:45:15.675' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.584ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.520ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:45:15.714'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.490ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.140ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:45:15.835' AND status != 'pending'
	

2025/06/26 11:45:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.302ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:45:15.912' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:45:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.678ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:45:15.993'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:46:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[77.346ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:46:14.815'

2025/06/26 11:46:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.773ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:31:14.816' LIMIT 50

2025/06/26 11:46:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.728ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:31:14.881' LIMIT 50

2025/06/26 11:46:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.618ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:46:14.815'

2025/06/26 11:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.377ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:46:14.815'

2025/06/26 11:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.762ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:16:15.31'

2025/06/26 11:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.585ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:46:15.387' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.829ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.250ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.071ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:46:15.541' AND status != 'pending'
	

2025/06/26 11:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.754ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:16:15.594'

2025/06/26 11:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.776ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:46:15.619' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.274ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:46:15.67' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.557ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:46:15.696'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.357ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.046ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.156ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:46:15.831' AND status != 'pending'
	

2025/06/26 11:46:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.956ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:46:15.908' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:46:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.534ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:46:15.988'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:47:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.148ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:47:14.717'

2025/06/26 11:47:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.137ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:47:14.717'

2025/06/26 11:47:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.690ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:47:14.717'

2025/06/26 11:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.533ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:17:15.211'

2025/06/26 11:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[76.317ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:47:15.294' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.462ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.193ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.883ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:47:15.454' AND status != 'pending'
	

2025/06/26 11:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.473ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:17:15.495'

2025/06/26 11:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.485ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:47:15.536' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.786ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:47:15.575' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.966ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:47:15.617'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.599ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.235ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.043ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:47:15.742' AND status != 'pending'
	

2025/06/26 11:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.672ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:47:15.822' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:47:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.647ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:47:15.909'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:48:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.559ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:48:14.717'

2025/06/26 11:48:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.304ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:33:14.717' LIMIT 50

2025/06/26 11:48:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.132ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:33:14.784' LIMIT 50

2025/06/26 11:48:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.828ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:48:14.717'

2025/06/26 11:48:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.351ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:48:14.717'

2025/06/26 11:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.430ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:18:15.211'

2025/06/26 11:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.243ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:48:15.29' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.242ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.305ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.523ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:48:15.445' AND status != 'pending'
	

2025/06/26 11:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.311ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:18:15.495'

2025/06/26 11:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.441ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:48:15.522' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.511ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:48:15.577' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.957ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:48:15.602'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.227ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.625ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.434ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:48:15.738' AND status != 'pending'
	

2025/06/26 11:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.689ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:48:15.823' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:48:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.762ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:48:15.906'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:48:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:38
[42.336ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/26 11:48:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:44
[80.492ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/26 11:48:33 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[82.877ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 11:48:33 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[40.191ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 11:48:33 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[84.736ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 11:48:34 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[42.078ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 11:48:34 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[83.064ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/26 11:48:41 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:139
[83.292ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 11:48:41 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[41.810ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 11:48:41 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[84.346ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/26 11:48:51 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[81.660ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/26 11:48:51 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[45.095ms] [rows:20] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/26 11:48:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:98
[41.045ms] [rows:1] SELECT count(*) FROM `order`

2025/06/26 11:48:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:116
[85.334ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` ORDER BY create_time DESC LIMIT 10

2025/06/26 11:49:00 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:165
[79.583ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (6,108,109,116)

2025/06/26 11:49:00 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods_optimized.go:127
[79.990ms] [rows:1] SELECT id, goods_name, content, price, stock, cover, status, category_id, create_time, update_time FROM `goods_list` WHERE id IN (1) AND isdelete != 1

2025/06/26 11:49:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[82.032ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 11:49:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[43.527ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 11:49:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[79.427ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 11:49:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.187ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:49:14.717'

2025/06/26 11:49:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[93.556ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:49:14.717'

2025/06/26 11:49:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[84.448ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:49:14.717'

2025/06/26 11:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.745ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:19:15.212'

2025/06/26 11:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.944ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:49:15.297' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.354ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.530ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.993ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:49:15.46' AND status != 'pending'
	

2025/06/26 11:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.997ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:19:15.495'

2025/06/26 11:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.339ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:49:15.545' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.268ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:49:15.572' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.822ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.056ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:49:15.627'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.008ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.705ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:49:15.734' AND status != 'pending'
	

2025/06/26 11:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.254ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:49:15.81' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:49:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.418ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:49:15.888'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:49:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[38.832ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 11:49:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[76.046ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 11:49:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[77.746ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 11:49:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.270ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 11:49:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.697ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 11:49:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[76.386ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 11:49:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.151ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 11:49:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[77.847ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 11:49:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[76.523ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 11:49:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.278ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 11:49:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.256ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 11:49:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.525ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 11:49:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.357ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 11:49:20 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[38.529ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 11:49:20 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[80.700ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/26 11:49:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[76.777ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 11:49:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[39.256ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 11:49:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[79.229ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 11:50:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.145ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:50:14.717'

2025/06/26 11:50:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.483ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:35:14.718' LIMIT 50

2025/06/26 11:50:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.659ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:35:14.785' LIMIT 50

2025/06/26 11:50:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.210ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:50:14.717'

2025/06/26 11:50:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.785ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:50:14.717'

2025/06/26 11:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.160ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:20:15.212'

2025/06/26 11:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.549ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:50:15.291' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.902ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.754ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.407ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:50:15.446' AND status != 'pending'
	

2025/06/26 11:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.033ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:20:15.496'

2025/06/26 11:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.099ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:50:15.525' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.507ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:50:15.574' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.203ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:50:15.605'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.936ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.926ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.869ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:50:15.735' AND status != 'pending'
	

2025/06/26 11:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.972ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:50:15.816' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:50:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.495ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:50:15.894'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:50:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[77.873ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 11:50:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[38.530ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 11:50:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[78.244ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 11:50:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[39.440ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 11:50:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.554ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 11:50:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.844ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 11:50:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.223ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 11:50:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.361ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 11:50:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.623ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 11:50:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[77.732ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 11:50:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.044ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 11:50:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.776ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 11:50:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[77.243ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 11:50:44 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.063ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 11:50:44 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.538ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 11:50:44 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[76.026ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 11:50:44 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[76.802ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 11:50:44 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[41.127ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 11:50:44 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[76.118ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 11:50:51 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[38.761ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 11:50:51 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[80.698ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/26 11:50:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[78.179ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 11:50:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[39.011ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 11:50:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[77.427ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 11:50:58 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[82.832ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 11:50:58 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[38.336ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 11:50:58 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[80.744ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 11:51:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.841ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:51:14.718'

2025/06/26 11:51:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.701ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:51:14.718'

2025/06/26 11:51:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.273ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:51:14.718'

2025/06/26 11:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.888ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:21:15.213'

2025/06/26 11:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.077ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:51:15.293' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.432ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.386ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.106ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:51:15.449' AND status != 'pending'
	

2025/06/26 11:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.162ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:21:15.496'

2025/06/26 11:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.472ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:51:15.527' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.577ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:51:15.576' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.472ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:51:15.605'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.548ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.468ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.999ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:51:15.737' AND status != 'pending'
	

2025/06/26 11:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.451ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:51:15.814' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:51:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.410ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:51:15.893'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:51:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[43.118ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 11:51:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[77.292ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 11:51:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[81.299ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 11:51:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.494ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 11:51:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[77.471ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 11:51:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.725ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 11:51:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.231ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 11:51:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[76.450ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 11:51:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.248ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 11:51:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.675ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 11:51:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[77.640ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 11:51:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.703ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 11:51:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.023ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 11:51:30 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[78.240ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 11:51:30 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[41.309ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 11:51:30 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[76.746ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 11:52:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.737ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:37:14.718' LIMIT 50

2025/06/26 11:52:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.534ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:52:14.718'

2025/06/26 11:52:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.456ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:37:14.785' LIMIT 50

2025/06/26 11:52:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.954ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:52:14.718'

2025/06/26 11:52:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.539ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:52:14.718'

2025/06/26 11:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.139ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:22:15.213'

2025/06/26 11:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.935ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:52:15.294' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.143ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.781ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.365ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:52:15.453' AND status != 'pending'
	

2025/06/26 11:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.997ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:22:15.495'

2025/06/26 11:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.109ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:52:15.533' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.726ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:52:15.576' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.530ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:52:15.613'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.296ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.776ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.621ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:52:15.742' AND status != 'pending'
	

2025/06/26 11:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.683ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:52:15.824' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:52:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.108ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:52:15.909'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:53:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.215ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:53:14.718'

2025/06/26 11:53:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.043ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:53:14.718'

2025/06/26 11:53:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[84.708ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:53:14.718'

2025/06/26 11:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.580ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:23:15.213'

2025/06/26 11:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.275ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:53:15.296' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.054ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.805ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.738ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:53:15.46' AND status != 'pending'
	

2025/06/26 11:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.534ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:23:15.496'

2025/06/26 11:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.814ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:53:15.54' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.836ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:53:15.577' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.352ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.734ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:53:15.62'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.415ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.916ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:53:15.738' AND status != 'pending'
	

2025/06/26 11:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.008ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:53:15.82' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:53:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.127ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:53:15.898'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:53:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[39.482ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 11:53:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[77.330ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 11:53:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[77.721ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 11:53:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.404ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 11:53:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.951ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 11:53:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[76.389ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 11:53:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.367ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 11:53:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.817ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 11:53:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.754ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 11:53:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.474ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 11:53:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.349ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 11:53:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[76.993ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 11:53:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.975ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 11:53:19 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[77.397ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 11:53:19 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[41.596ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 11:53:19 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[76.327ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 11:54:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.776ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:39:14.719' LIMIT 50

2025/06/26 11:54:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[83.334ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 11:54:14.719' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/26 11:54:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.547ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:54:14.719'

2025/06/26 11:54:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[38.947ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-19 11:54:14.802'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/26 11:54:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.787ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:54:14.719'

2025/06/26 11:54:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.579ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:54:14.719'

2025/06/26 11:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[228.375ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 11:54:14.785' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/26 11:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[258.388ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:39:14.785' LIMIT 50

2025/06/26 11:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[37.385ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-19 11:54:15.013'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/26 11:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.597ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:24:15.213'

2025/06/26 11:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.606ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:54:15.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.734ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.260ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.108ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:54:15.441' AND status != 'pending'
	

2025/06/26 11:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[71.506ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:54:15.516' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[91.729ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:24:15.497'

2025/06/26 11:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.753ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:54:15.588'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.798ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:54:15.588' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.430ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.307ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.385ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:54:15.758' AND status != 'pending'
	

2025/06/26 11:54:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.927ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:54:15.844' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:54:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.712ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:54:15.931'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:55:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.853ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:55:14.719'

2025/06/26 11:55:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.303ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:55:14.719'

2025/06/26 11:55:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[88.314ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:55:14.719'

2025/06/26 11:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.281ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:25:15.213'

2025/06/26 11:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.553ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:55:15.299' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.275ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.405ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.721ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:55:15.47' AND status != 'pending'
	

2025/06/26 11:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[73.415ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:25:15.497'

2025/06/26 11:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.195ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:55:15.557' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[72.892ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:55:15.571' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.273ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.602ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.800ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:55:15.643'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.033ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:55:15.72' AND status != 'pending'
	

2025/06/26 11:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.734ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:55:15.797' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.046ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:55:15.874'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:55:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[73.463ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 11:55:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[35.954ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 11:55:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[71.988ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 11:56:01 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[36.958ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 11:56:01 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[72.325ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 11:56:01 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[73.490ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 11:56:01 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.000ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 11:56:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[74.424ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 11:56:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[70.909ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 11:56:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[77.075ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 11:56:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[73.842ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 11:56:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[72.765ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 11:56:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.476ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 11:56:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[74.860ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 11:56:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[71.434ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 11:56:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.589ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 11:56:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[71.489ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 11:56:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[35.394ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 11:56:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[74.571ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 11:56:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[76.373ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:56:14.719'

2025/06/26 11:56:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.476ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:41:14.719' LIMIT 50

2025/06/26 11:56:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[73.268ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:56:14.719'

2025/06/26 11:56:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[73.336ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:56:14.719'

2025/06/26 11:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[274.505ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:41:14.785' LIMIT 50

2025/06/26 11:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[94.970ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:26:15.214'

2025/06/26 11:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.511ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:56:15.31' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.704ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.650ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.347ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:26:15.497'

2025/06/26 11:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.573ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:56:15.489' AND status != 'pending'
	

2025/06/26 11:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[72.564ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:56:15.571' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.258ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:56:15.581' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[35.377ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.941ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.436ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:56:15.669'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[71.516ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:56:15.717' AND status != 'pending'
	

2025/06/26 11:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.782ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:56:15.788' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:56:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.252ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:56:15.864'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[38.611ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 11:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[77.998ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 11:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[74.360ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 11:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[76.819ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 11:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[74.659ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 11:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[72.055ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 11:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[70.168ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 11:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.356ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 11:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[72.779ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 11:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[74.254ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 11:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[74.897ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 11:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[71.005ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 11:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.637ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 11:56:47 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[71.740ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 11:56:47 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[38.545ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 11:56:47 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[71.553ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 11:57:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[76.163ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:57:14.719'

2025/06/26 11:57:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.289ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:57:14.719'

2025/06/26 11:57:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[72.538ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:57:14.719'

2025/06/26 11:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[72.723ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:27:15.214'

2025/06/26 11:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[73.408ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:57:15.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.081ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.317ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.928ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:57:15.434' AND status != 'pending'
	

2025/06/26 11:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.007ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:57:15.509' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.406ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:27:15.497'

2025/06/26 11:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[70.873ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:57:15.584'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.940ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:57:15.586' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.938ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.058ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.155ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:57:15.765' AND status != 'pending'
	

2025/06/26 11:57:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.141ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:57:15.856' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:57:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.482ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:57:15.944'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:58:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[90.792ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 11:58:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[44.284ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 11:58:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[91.083ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 11:58:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[77.778ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:43:14.72' LIMIT 50

2025/06/26 11:58:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[88.101ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:58:14.72'

2025/06/26 11:58:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.671ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:43:14.787' LIMIT 50

2025/06/26 11:58:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[88.442ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:58:14.72'

2025/06/26 11:58:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.282ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:58:14.72'

2025/06/26 11:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.858ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:28:15.214'

2025/06/26 11:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.899ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:58:15.302' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.256ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.509ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.359ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:58:15.481' AND status != 'pending'
	

2025/06/26 11:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.282ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:28:15.498'

2025/06/26 11:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.176ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:58:15.567' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.040ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:58:15.585' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.901ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.110ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:58:15.657'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.800ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.033ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:58:15.753' AND status != 'pending'
	

2025/06/26 11:58:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.041ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:58:15.841' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:58:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.623ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:58:15.927'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:58:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[51.214ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 11:58:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[91.405ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 11:58:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[93.648ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 11:58:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.998ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 11:58:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.727ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 11:58:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.501ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 11:58:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.330ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 11:58:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.323ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 11:58:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.447ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 11:58:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[91.908ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 11:58:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.741ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 11:58:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.213ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 11:58:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[95.868ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 11:58:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[86.977ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 11:58:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[45.281ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 11:58:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[88.642ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 11:58:38 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[42.894ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 11:58:38 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[87.301ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/26 11:58:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[42.537ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 11:58:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[87.176ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/26 11:58:49 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[83.939ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 11:58:49 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[45.639ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 11:58:49 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[84.778ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 11:58:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:139
[84.718ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 11:58:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[41.697ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 11:58:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[87.216ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/26 11:59:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.874ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 11:59:14.72'

2025/06/26 11:59:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.866ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 11:59:14.72'

2025/06/26 11:59:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.711ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 11:59:14.72'

2025/06/26 11:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.734ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:29:15.215'

2025/06/26 11:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.372ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:59:15.3' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.594ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.733ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.914ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:59:15.468' AND status != 'pending'
	

2025/06/26 11:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.161ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:29:15.497'

2025/06/26 11:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.615ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:59:15.554' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.587ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 10:59:15.584' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 11:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.677ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:59:15.637'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 11:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.724ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 11:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.529ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 11:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.404ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 10:59:15.764' AND status != 'pending'
	

2025/06/26 11:59:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.815ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 10:59:15.851' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 11:59:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.497ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 10:59:15.939'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:00:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.687ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:45:14.72' LIMIT 50

2025/06/26 12:00:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[89.265ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 12:00:14.72'

2025/06/26 12:00:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[74.884ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:45:14.787' LIMIT 50

2025/06/26 12:00:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[89.419ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 12:00:14.72'

2025/06/26 12:00:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[89.415ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 12:00:14.72'

2025/06/26 12:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.424ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:30:15.215'

2025/06/26 12:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.654ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:00:15.306' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.403ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.852ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[71.170ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:30:15.498'

2025/06/26 12:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.866ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:00:15.485' AND status != 'pending'
	

2025/06/26 12:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.408ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:00:15.57' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.027ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:00:15.571' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.487ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.773ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.234ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:00:15.657'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.612ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:00:15.722' AND status != 'pending'
	

2025/06/26 12:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[72.260ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:00:15.795' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:00:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.638ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:00:15.868'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:01:06 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[37.203ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 12:01:06 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[71.283ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 12:01:06 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.982ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 12:01:06 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[72.383ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 12:01:06 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[74.459ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 12:01:06 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[74.608ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 12:01:06 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[71.624ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 12:01:06 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[74.820ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 12:01:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[74.145ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 12:01:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[71.360ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 12:01:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[74.047ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 12:01:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[74.033ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 12:01:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[70.413ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 12:01:09 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[35.862ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 12:01:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[74.140ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/26 12:01:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[71.316ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 12:01:14.721'

2025/06/26 12:01:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[71.490ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 12:01:14.721'

2025/06/26 12:01:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[71.655ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 12:01:14.721'

2025/06/26 12:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[71.331ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:31:15.215'

2025/06/26 12:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[70.582ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:01:15.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[35.340ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[35.280ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[71.236ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:01:15.428' AND status != 'pending'
	

2025/06/26 12:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[70.595ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:01:15.5' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.033ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:31:15.499'

2025/06/26 12:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[70.905ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:01:15.571'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.099ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:01:15.588' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.987ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.181ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.624ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:01:15.765' AND status != 'pending'
	

2025/06/26 12:01:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.359ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:01:15.853' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:01:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.413ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:01:15.941'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:01:31 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:336
[44.489ms] [rows:1] SELECT count(*) FROM `sys_dict_type`

2025/06/26 12:01:31 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:336
[87.863ms] [rows:10] SELECT * FROM `sys_dict_type` ORDER BY create_time DESC LIMIT 10

2025/06/26 12:01:40 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:98
[44.289ms] [rows:1] SELECT count(*) FROM `order`

2025/06/26 12:01:40 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:116
[91.466ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` ORDER BY create_time DESC LIMIT 10

2025/06/26 12:01:40 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods_optimized.go:127
[72.442ms] [rows:1] SELECT id, goods_name, content, price, stock, cover, status, category_id, create_time, update_time FROM `goods_list` WHERE id IN (1) AND isdelete != 1

2025/06/26 12:01:40 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:165
[87.423ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (6,108,109,116)

2025/06/26 12:02:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[76.088ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:47:14.721' LIMIT 50

2025/06/26 12:02:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.489ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 12:02:14.721'

2025/06/26 12:02:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.297ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:47:14.788' LIMIT 50

2025/06/26 12:02:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.300ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 12:02:14.721'

2025/06/26 12:02:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.750ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 12:02:14.721'

2025/06/26 12:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.963ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:32:15.216'

2025/06/26 12:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.881ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:02:15.307' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.420ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.233ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.315ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:02:15.485' AND status != 'pending'
	

2025/06/26 12:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.602ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:32:15.498'

2025/06/26 12:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.984ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:02:15.572' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.367ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:02:15.581' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.767ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.763ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.962ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:02:15.663'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.189ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:02:15.749' AND status != 'pending'
	

2025/06/26 12:02:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.841ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:02:15.836' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:02:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.333ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:02:15.924'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:03:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.597ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 12:03:14.721'

2025/06/26 12:03:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[88.214ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 12:03:14.721'

2025/06/26 12:03:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.995ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 12:03:14.721'

2025/06/26 12:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.338ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:33:15.216'

2025/06/26 12:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.710ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:03:15.299' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.687ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.330ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.447ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:03:15.469' AND status != 'pending'
	

2025/06/26 12:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[93.535ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:33:15.499'

2025/06/26 12:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.787ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:03:15.552' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.520ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:03:15.593' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.730ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:03:15.638'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.567ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[47.539ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.011ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:03:15.774' AND status != 'pending'
	

2025/06/26 12:03:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.809ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:03:15.862' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:03:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.923ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:03:15.952'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:03:51 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[87.677ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/26 12:03:51 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[46.450ms] [rows:20] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/26 12:03:51 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[44.598ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 12:03:51 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[91.354ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 12:03:51 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.691ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 12:03:51 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.558ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 12:03:51 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.632ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 12:03:51 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.559ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 12:03:51 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.961ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 12:03:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.311ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 12:03:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.812ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 12:03:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.597ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 12:03:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.628ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 12:03:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.891ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 12:03:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.412ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 12:03:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[87.675ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 12:03:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[48.631ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 12:03:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[86.801ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 12:04:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.912ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:49:14.722' LIMIT 50

2025/06/26 12:04:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[92.492ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 12:04:14.721'

2025/06/26 12:04:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[71.765ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:49:14.787' LIMIT 50

2025/06/26 12:04:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.883ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 12:04:14.721'

2025/06/26 12:04:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[91.397ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 12:04:14.721'

2025/06/26 12:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.235ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:34:15.216'

2025/06/26 12:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.837ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:04:15.303' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.249ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.172ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.639ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:04:15.478' AND status != 'pending'
	

2025/06/26 12:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.741ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:34:15.499'

2025/06/26 12:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[72.631ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:04:15.574' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.789ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:04:15.568' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.527ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.317ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.144ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:04:15.654'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.750ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:04:15.723' AND status != 'pending'
	

2025/06/26 12:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[73.235ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:04:15.799' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:04:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.480ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:04:15.872'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:04:49 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[40.857ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 12:04:49 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[72.943ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 12:04:49 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[77.674ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 12:04:49 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[72.364ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 12:04:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[71.160ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 12:04:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.061ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 12:04:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[74.942ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 12:04:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[71.112ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 12:04:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[74.439ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 12:04:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[74.627ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 12:04:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[70.946ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 12:04:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[73.932ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 12:04:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[74.355ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 12:04:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[37.447ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 12:04:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[72.492ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 12:04:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.962ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 12:04:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[72.245ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 12:04:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[76.072ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 12:04:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.994ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 12:04:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[72.694ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 12:04:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[76.870ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 12:04:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.880ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 12:04:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[72.655ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 12:04:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.569ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 12:04:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.122ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 12:04:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[74.129ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 12:04:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[73.059ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 12:04:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[39.370ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 12:04:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[73.928ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 12:05:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[73.046ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 12:05:14.722'

2025/06/26 12:05:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.064ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 12:05:14.722'

2025/06/26 12:05:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.398ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 12:05:14.722'

2025/06/26 12:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.120ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:35:15.216'

2025/06/26 12:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[71.167ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:05:15.292' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.756ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.646ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.920ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:05:15.439' AND status != 'pending'
	

2025/06/26 12:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[70.933ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:05:15.514' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.881ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:35:15.5'

2025/06/26 12:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.835ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:05:15.585'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.439ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:05:15.588' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.911ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.733ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.838ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:05:15.763' AND status != 'pending'
	

2025/06/26 12:05:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.070ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:05:15.855' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:05:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.119ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:05:15.943'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:06:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[75.256ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:51:14.722' LIMIT 50

2025/06/26 12:06:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[91.750ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 12:06:14.722'

2025/06/26 12:06:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[86.990ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:51:14.789' LIMIT 50

2025/06/26 12:06:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[94.526ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 12:06:14.722'

2025/06/26 12:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[99.585ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 12:06:14.722'

2025/06/26 12:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[92.276ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:36:15.216'

2025/06/26 12:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[92.172ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:06:15.308' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.214ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.787ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[92.469ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:06:15.489' AND status != 'pending'
	

2025/06/26 12:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.272ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:36:15.5'

2025/06/26 12:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.939ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:06:15.583' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[92.121ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:06:15.581' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.053ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.043ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.991ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:06:15.674'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[92.947ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:06:15.759' AND status != 'pending'
	

2025/06/26 12:06:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.445ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:06:15.852' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:06:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[92.071ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:06:15.94'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:07:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[92.093ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 12:07:14.722'

2025/06/26 12:07:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[88.389ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 12:07:14.722'

2025/06/26 12:07:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[91.007ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 12:07:14.722'

2025/06/26 12:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.839ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:37:15.217'

2025/06/26 12:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.433ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:07:15.305' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.644ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.102ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.290ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:07:15.481' AND status != 'pending'
	

2025/06/26 12:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.970ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:37:15.5'

2025/06/26 12:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.713ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:07:15.571' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.478ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:07:15.587' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.595ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.055ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:07:15.658'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.021ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.599ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:07:15.757' AND status != 'pending'
	

2025/06/26 12:07:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.558ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:07:15.84' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:07:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.761ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:07:15.924'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:08:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[91.254ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 12:08:14.722'

2025/06/26 12:08:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[91.377ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:53:14.723' LIMIT 50

2025/06/26 12:08:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[72.060ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:53:14.789' LIMIT 50

2025/06/26 12:08:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[83.022ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 12:08:14.722'

2025/06/26 12:08:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.154ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 12:08:14.722'

2025/06/26 12:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.322ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:38:15.217'

2025/06/26 12:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.624ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:08:15.305' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.036ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.275ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.682ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:08:15.475' AND status != 'pending'
	

2025/06/26 12:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[72.793ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:38:15.5'

2025/06/26 12:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.668ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:08:15.561' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.148ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:08:15.573' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.354ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.710ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.361ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:08:15.647'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.912ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:08:15.729' AND status != 'pending'
	

2025/06/26 12:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.065ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:08:15.805' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:08:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.207ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:08:15.882'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:09:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[76.233ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 12:09:14.723'

2025/06/26 12:09:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.126ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 12:09:14.723'

2025/06/26 12:09:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[72.470ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 12:09:14.723'

2025/06/26 12:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.059ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:39:15.217'

2025/06/26 12:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[72.985ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:09:15.294' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.727ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[35.674ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.254ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:09:15.441' AND status != 'pending'
	

2025/06/26 12:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.038ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:39:15.501'

2025/06/26 12:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[69.422ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:09:15.517' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.723ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:09:15.586'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.141ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:09:15.586' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.649ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.468ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.775ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:09:15.757' AND status != 'pending'
	

2025/06/26 12:09:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.442ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:09:15.842' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:09:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.596ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:09:15.931'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:10:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.716ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:55:14.723' LIMIT 50

2025/06/26 12:10:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.659ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 12:10:14.723'

2025/06/26 12:10:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[94.958ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:55:14.79' LIMIT 50

2025/06/26 12:10:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.379ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 12:10:14.723'

2025/06/26 12:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[118.919ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 12:10:14.723'

2025/06/26 12:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.517ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:40:15.217'

2025/06/26 12:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.572ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:10:15.304' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.128ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.794ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.347ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:10:15.481' AND status != 'pending'
	

2025/06/26 12:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[91.594ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:40:15.501'

2025/06/26 12:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.611ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:10:15.563' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.742ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:10:15.593' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.850ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.957ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:10:15.646'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.417ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[92.798ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:10:15.773' AND status != 'pending'
	

2025/06/26 12:10:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[91.423ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:10:15.866' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:10:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.577ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:10:15.957'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:11:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[88.784ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 12:11:14.723'

2025/06/26 12:11:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[88.112ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 12:11:14.723'

2025/06/26 12:11:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[88.942ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 12:11:14.723'

2025/06/26 12:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.186ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:41:15.218'

2025/06/26 12:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.001ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:11:15.305' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[48.197ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[47.563ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.743ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:11:15.492' AND status != 'pending'
	

2025/06/26 12:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.048ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:41:15.501'

2025/06/26 12:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.997ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:11:15.578' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.851ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:11:15.584' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.273ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.798ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.130ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:11:15.668'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.011ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:11:15.754' AND status != 'pending'
	

2025/06/26 12:11:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.825ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:11:15.838' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:11:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.491ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:11:15.923'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:12:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.156ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 12:12:14.724'

2025/06/26 12:12:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.432ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:57:14.724' LIMIT 50

2025/06/26 12:12:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[72.548ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:57:14.791' LIMIT 50

2025/06/26 12:12:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.842ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 12:12:14.724'

2025/06/26 12:12:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[91.974ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 12:12:14.724'

2025/06/26 12:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.784ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:42:15.219'

2025/06/26 12:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[93.586ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:12:15.307' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.947ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.635ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.151ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:12:15.485' AND status != 'pending'
	

2025/06/26 12:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[71.860ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:42:15.503'

2025/06/26 12:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.429ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:12:15.568' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.072ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:12:15.575' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[35.768ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.482ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.695ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:12:15.651'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.616ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:12:15.736' AND status != 'pending'
	

2025/06/26 12:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.162ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:12:15.81' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:12:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.347ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:12:15.888'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:13:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[77.120ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 12:13:14.724'

2025/06/26 12:13:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[72.948ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 12:13:14.724'

2025/06/26 12:13:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[73.817ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 12:13:14.724'

2025/06/26 12:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.855ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:43:15.219'

2025/06/26 12:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.960ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:13:15.3' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.042ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[35.926ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.368ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:13:15.451' AND status != 'pending'
	

2025/06/26 12:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.826ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:43:15.501'

2025/06/26 12:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.589ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:13:15.527' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.055ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:13:15.585' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[71.726ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:13:15.604'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[49.098ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.309ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.872ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:13:15.763' AND status != 'pending'
	

2025/06/26 12:13:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.619ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:13:15.852' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:13:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.543ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:13:15.936'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[73.317ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:59:14.724' LIMIT 50

2025/06/26 12:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.740ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 12:14:14.724'

2025/06/26 12:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.501ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:59:14.79' LIMIT 50

2025/06/26 12:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[96.186ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 12:14:14.724'

2025/06/26 12:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.122ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 12:14:14.724'

2025/06/26 12:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[96.324ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:44:15.22'

2025/06/26 12:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.100ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:14:15.316' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.058ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.452ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.535ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:14:15.484' AND status != 'pending'
	

2025/06/26 12:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[94.053ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:44:15.502'

2025/06/26 12:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.880ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:14:15.571' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.722ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:14:15.596' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.335ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.431ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:14:15.658'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[47.468ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.679ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:14:15.776' AND status != 'pending'
	

2025/06/26 12:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.635ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:14:15.864' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:14:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.857ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:14:15.952'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:15:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[88.703ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 12:15:14.725'

2025/06/26 12:15:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[88.864ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 12:15:14.725'

2025/06/26 12:15:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[93.770ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 12:15:14.725'

2025/06/26 12:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.313ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:45:15.22'

2025/06/26 12:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[93.016ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:15:15.309' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[49.303ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[47.178ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.864ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:15:15.498' AND status != 'pending'
	

2025/06/26 12:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.704ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:45:15.502'

2025/06/26 12:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.264ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:15:15.587' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[92.619ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:15:15.586' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.157ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.658ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.327ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:15:15.679'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[93.199ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:15:15.761' AND status != 'pending'
	

2025/06/26 12:15:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.821ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:15:15.855' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:15:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.201ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:15:15.943'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:16:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.536ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 12:16:14.725'

2025/06/26 12:16:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[89.854ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:01:14.725' LIMIT 50

2025/06/26 12:16:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[73.536ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:01:14.793' LIMIT 50

2025/06/26 12:16:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[91.917ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 12:16:14.725'

2025/06/26 12:16:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.730ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 12:16:14.725'

2025/06/26 12:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.894ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:46:15.22'

2025/06/26 12:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.611ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:16:15.311' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.115ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.502ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.614ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:16:15.478' AND status != 'pending'
	

2025/06/26 12:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[71.322ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 11:46:15.504'

2025/06/26 12:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[76.034ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:16:15.575' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.536ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:16:15.566' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.106ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[35.717ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.021ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:16:15.651'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[71.884ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:16:15.723' AND status != 'pending'
	

2025/06/26 12:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[72.680ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:16:15.795' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:16:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.270ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:16:15.868'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:33:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129 invalid connection
[34624.983ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:02:40.086'

2025/06/26 12:33:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[267.131ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:33:14.706' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[47.354ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.382ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.462ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:33:15.063' AND status != 'pending'
	

2025/06/26 12:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[92.584ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:33:15.15' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:33:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[110.606ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:33:15.243'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:33:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67 invalid connection
[36507.458ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 12:32:39.59'

2025/06/26 12:33:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[83.229ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 12:32:39.59'

2025/06/26 12:33:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[82.630ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 12:32:39.59'

2025/06/26 12:33:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129 invalid connection
[45014.827ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:02:40.369'

2025/06/26 12:33:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[93.787ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:33:25.379' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:33:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.087ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:33:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.058ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:33:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[102.219ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:33:25.558' AND status != 'pending'
	

2025/06/26 12:33:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[116.611ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:33:25.66' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:33:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.555ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:33:25.777'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:49:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[274.973ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:34:04.645' LIMIT 50

2025/06/26 12:49:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[246.661ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:34:04.712' LIMIT 50

2025/06/26 12:49:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.016ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:19:05.138'

2025/06/26 12:49:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.283ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:49:05.218' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:49:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.514ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:49:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.340ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:49:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.721ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:49:05.382' AND status != 'pending'
	

2025/06/26 12:49:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.077ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:19:05.421'

2025/06/26 12:49:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.968ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:49:05.46' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:49:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.941ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 11:49:05.511' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 12:49:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.816ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:49:05.543'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 12:49:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[47.500ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 12:49:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[66.094ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 12:49:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[93.326ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 11:49:05.714' AND status != 'pending'
	

2025/06/26 12:49:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.620ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 11:49:05.807' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 12:49:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.867ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 11:49:05.897'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:05:08 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67 invalid connection
[47217.208ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 12:49:04.645'

2025/06/26 13:05:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[283.470ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:35:21.818'

2025/06/26 13:05:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[96.277ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:05:22.102' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:05:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.204ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:05:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.095ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:05:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[128.890ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:05:22.291' AND status != 'pending'
	

2025/06/26 13:05:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[94.750ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:05:22.42' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:05:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.002ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:05:22.514'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:05:44 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121 invalid connection
[36740.003ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 12:49:04.645'

2025/06/26 13:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[95.909ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 12:49:04.645'

2025/06/26 13:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[94.253ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:05:45.084'

2025/06/26 13:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.757ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:05:45.084'

2025/06/26 13:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[93.272ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:05:45.084'

2025/06/26 13:05:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129 invalid connection
[34018.539ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:35:21.535'

2025/06/26 13:05:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.319ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:05:55.543' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:05:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[50.390ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:05:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.335ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:05:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[95.223ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:05:55.73' AND status != 'pending'
	

2025/06/26 13:05:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[92.461ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:05:55.825' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:05:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.490ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:05:55.918'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:06:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[95.733ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:06:21.027'

2025/06/26 13:06:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[99.706ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:06:21.027'

2025/06/26 13:06:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[102.662ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:06:21.027'

2025/06/26 13:06:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[298.357ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:51:21.027' LIMIT 50

2025/06/26 13:06:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[300.383ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:51:21.095' LIMIT 50

2025/06/26 13:06:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.502ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:36:21.523'

2025/06/26 13:06:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[92.213ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:06:21.613' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:06:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[48.049ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:06:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.401ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:06:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.855ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:06:21.798' AND status != 'pending'
	

2025/06/26 13:06:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.601ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:36:21.804'

2025/06/26 13:06:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[98.563ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:06:21.885' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:06:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.490ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:06:21.894' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:06:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.765ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:06:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[49.834ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:06:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[97.214ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:06:21.984'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:06:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[217.526ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:06:22.081' AND status != 'pending'
	

2025/06/26 13:06:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[241.613ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:06:22.299' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:06:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[132.918ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:06:22.541'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:07:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[95.003ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:07:21.026'

2025/06/26 13:07:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[91.366ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:07:21.026'

2025/06/26 13:07:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.877ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:07:21.026'

2025/06/26 13:07:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[91.170ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:37:21.522'

2025/06/26 13:07:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.562ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:07:21.613' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:07:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.047ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:07:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.544ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:07:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.419ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:07:21.794' AND status != 'pending'
	

2025/06/26 13:07:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[92.117ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:37:21.805'

2025/06/26 13:07:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.966ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:07:21.883' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:07:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.920ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:07:21.897' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:07:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.584ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:07:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.733ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:07:21.973'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:07:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.208ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:07:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.088ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:07:22.074' AND status != 'pending'
	

2025/06/26 13:07:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.831ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:07:22.165' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:07:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.464ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:07:22.253'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:08:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[91.022ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:08:21.026'

2025/06/26 13:08:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[92.244ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:53:21.026' LIMIT 50

2025/06/26 13:08:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[97.180ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:53:21.092' LIMIT 50

2025/06/26 13:08:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.240ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:08:21.026'

2025/06/26 13:08:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.955ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:08:21.026'

2025/06/26 13:08:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[91.609ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:38:21.52'

2025/06/26 13:08:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.178ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:08:21.612' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:08:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.944ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:08:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.300ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:08:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.252ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:08:21.787' AND status != 'pending'
	

2025/06/26 13:08:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[93.624ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:38:21.804'

2025/06/26 13:08:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.500ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:08:21.876' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:08:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.512ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:08:21.898' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:08:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.774ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:08:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.536ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:08:21.963'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:08:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.995ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:08:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.349ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:08:22.073' AND status != 'pending'
	

2025/06/26 13:08:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.807ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:08:22.163' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:08:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.914ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:08:22.252'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:09:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[89.834ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:09:21.025'

2025/06/26 13:09:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.786ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:09:21.025'

2025/06/26 13:09:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[96.746ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:09:21.025'

2025/06/26 13:09:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.228ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:39:21.52'

2025/06/26 13:09:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.883ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:09:21.608' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:09:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.143ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:09:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.286ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:09:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.853ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:09:21.776' AND status != 'pending'
	

2025/06/26 13:09:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.127ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:39:21.804'

2025/06/26 13:09:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.712ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:09:21.861' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:09:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.546ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:09:21.891' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:09:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.736ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:09:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.671ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:09:21.944'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:09:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[52.836ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:09:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.592ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:09:22.079' AND status != 'pending'
	

2025/06/26 13:09:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[93.796ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:09:22.168' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:09:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[96.548ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:09:22.262'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:10:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.200ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:55:21.025' LIMIT 50

2025/06/26 13:10:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.088ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:10:21.024'

2025/06/26 13:10:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[90.428ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:55:21.091' LIMIT 50

2025/06/26 13:10:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[97.236ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:10:21.024'

2025/06/26 13:10:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.769ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:10:21.024'

2025/06/26 13:10:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.366ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:40:21.52'

2025/06/26 13:10:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.997ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:10:21.607' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:10:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.800ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:10:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.892ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:10:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.773ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:10:21.784' AND status != 'pending'
	

2025/06/26 13:10:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[94.549ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:40:21.801'

2025/06/26 13:10:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.605ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:10:21.87' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:10:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.469ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:10:21.896' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:10:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.880ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:10:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.229ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:10:21.958'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:10:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[48.428ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:10:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[92.550ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:10:22.081' AND status != 'pending'
	

2025/06/26 13:10:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[91.179ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:10:22.174' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:10:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[106.269ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:10:22.265'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:11:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.697ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:11:21.024'

2025/06/26 13:11:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.141ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:11:21.024'

2025/06/26 13:11:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[91.229ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:11:21.024'

2025/06/26 13:11:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[95.108ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:41:21.519'

2025/06/26 13:11:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.030ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:11:21.615' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:11:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[47.835ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:11:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.522ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:11:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.013ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:11:21.797' AND status != 'pending'
	

2025/06/26 13:11:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.502ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:41:21.801'

2025/06/26 13:11:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.518ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:11:21.887' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:11:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[91.198ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:11:21.886' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:11:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.028ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:11:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.576ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:11:21.978'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:11:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.396ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:11:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[92.754ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:11:22.066' AND status != 'pending'
	

2025/06/26 13:11:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[92.204ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:11:22.159' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:11:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.571ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:11:22.252'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:12:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[90.304ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:57:21.023' LIMIT 50

2025/06/26 13:12:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[91.956ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:12:21.023'

2025/06/26 13:12:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.808ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:57:21.091' LIMIT 50

2025/06/26 13:12:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.967ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:12:21.023'

2025/06/26 13:12:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[93.161ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:12:21.023'

2025/06/26 13:12:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[94.081ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:42:21.519'

2025/06/26 13:12:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.546ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:12:21.613' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:12:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[47.679ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:12:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.645ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:12:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.315ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:42:21.801'

2025/06/26 13:12:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[92.164ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:12:21.796' AND status != 'pending'
	

2025/06/26 13:12:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.353ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:12:21.888' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:12:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.868ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:12:21.888' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:12:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.604ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:12:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.396ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:12:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.642ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:12:21.977'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:12:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.237ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:12:22.066' AND status != 'pending'
	

2025/06/26 13:12:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.612ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:12:22.154' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:12:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.943ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:12:22.241'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:13:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.692ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:13:21.022'

2025/06/26 13:13:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[88.060ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:13:21.022'

2025/06/26 13:13:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[84.746ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:13:21.022'

2025/06/26 13:13:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.688ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:43:21.518'

2025/06/26 13:13:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.331ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:13:21.603' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:13:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.554ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:13:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[53.447ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:13:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.761ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:13:21.784' AND status != 'pending'
	

2025/06/26 13:13:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.310ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:43:21.801'

2025/06/26 13:13:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.983ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:13:21.868' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:13:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[98.313ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:13:21.892' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:13:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[172.876ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:13:21.954'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:13:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[136.557ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:13:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[125.761ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:13:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[222.826ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:13:22.253' AND status != 'pending'
	

2025/06/26 13:13:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[102.374ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:13:22.476' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:13:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[94.104ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:13:22.578'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:14:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.420ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:59:21.022' LIMIT 50

2025/06/26 13:14:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[92.560ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:14:21.022'

2025/06/26 13:14:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[86.759ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:59:21.09' LIMIT 50

2025/06/26 13:14:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[94.879ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:14:21.022'

2025/06/26 13:14:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[94.541ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:14:21.022'

2025/06/26 13:14:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[94.729ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:44:21.517'

2025/06/26 13:14:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[95.945ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:14:21.612' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:14:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.454ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:14:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.528ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:14:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.396ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:44:21.799'

2025/06/26 13:14:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[92.011ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:14:21.798' AND status != 'pending'
	

2025/06/26 13:14:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.031ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:14:21.889' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:14:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.476ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:14:21.89' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:14:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.078ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:14:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.950ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:14:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.029ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:14:21.98'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:14:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.046ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:14:22.066' AND status != 'pending'
	

2025/06/26 13:14:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.978ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:14:22.157' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:14:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.893ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:14:22.248'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:15:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.418ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:15:21.021'

2025/06/26 13:15:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.644ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:15:21.021'

2025/06/26 13:15:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.193ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:15:21.021'

2025/06/26 13:15:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.856ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:45:21.517'

2025/06/26 13:15:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.469ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:15:21.604' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:15:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.655ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:15:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.096ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:15:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.925ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:15:21.784' AND status != 'pending'
	

2025/06/26 13:15:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[92.712ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:45:21.799'

2025/06/26 13:15:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.007ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:15:21.869' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:15:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.426ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:15:21.891' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:15:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.745ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:15:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.788ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:15:21.956'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:15:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.126ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:15:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[95.084ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:15:22.073' AND status != 'pending'
	

2025/06/26 13:15:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[93.241ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:15:22.168' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:15:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.560ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:15:22.262'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:16:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.482ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:01:21.021' LIMIT 50

2025/06/26 13:16:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.661ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:16:21.021'

2025/06/26 13:16:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.826ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:01:21.087' LIMIT 50

2025/06/26 13:16:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[94.128ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:16:21.021'

2025/06/26 13:16:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[94.044ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:16:21.021'

2025/06/26 13:16:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[93.105ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:46:21.516'

2025/06/26 13:16:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[96.266ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:16:21.609' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:16:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.397ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:16:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.627ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:16:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.792ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:46:21.798'

2025/06/26 13:16:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.583ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:16:21.795' AND status != 'pending'
	

2025/06/26 13:16:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.250ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:16:21.886' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:16:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.762ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:16:21.886' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:16:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.729ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:16:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.994ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:16:21.97'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:16:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.500ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:16:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.031ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:16:22.063' AND status != 'pending'
	

2025/06/26 13:16:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.447ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:16:22.152' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:16:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.437ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:16:22.241'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:17:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[95.738ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:17:21.02'

2025/06/26 13:17:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.629ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:17:21.02'

2025/06/26 13:17:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.605ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:17:21.02'

2025/06/26 13:17:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.945ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:47:21.516'

2025/06/26 13:17:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.461ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:17:21.607' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:17:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[48.887ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:17:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.288ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:17:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.562ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:17:21.791' AND status != 'pending'
	

2025/06/26 13:17:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.265ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:47:21.798'

2025/06/26 13:17:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.829ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:17:21.881' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:17:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.928ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:17:21.88' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:17:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.366ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:17:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.694ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:17:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.891ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:17:21.97'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:17:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.258ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:17:22.054' AND status != 'pending'
	

2025/06/26 13:17:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.987ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:17:22.14' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:17:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.342ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:17:22.225'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:18:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[89.422ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:18:21.019'

2025/06/26 13:18:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[92.717ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:03:21.019' LIMIT 50

2025/06/26 13:18:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[86.304ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:03:21.087' LIMIT 50

2025/06/26 13:18:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.831ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:18:21.019'

2025/06/26 13:18:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[88.775ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:18:21.019'

2025/06/26 13:18:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.884ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:48:21.515'

2025/06/26 13:18:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.757ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:18:21.604' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:18:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.630ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:18:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.640ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:18:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.320ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:18:21.777' AND status != 'pending'
	

2025/06/26 13:18:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.324ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:48:21.796'

2025/06/26 13:18:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.243ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:18:21.861' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:18:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[93.389ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:18:21.883' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:18:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.879ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:18:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.505ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:18:21.943'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:18:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.467ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:18:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.800ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:18:22.064' AND status != 'pending'
	

2025/06/26 13:18:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.623ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:18:22.155' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:18:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.315ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:18:22.242'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:19:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[91.063ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:19:21.019'

2025/06/26 13:19:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[93.633ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:19:21.019'

2025/06/26 13:19:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.483ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:19:21.019'

2025/06/26 13:19:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.441ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:49:21.514'

2025/06/26 13:19:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.019ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:19:21.603' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:19:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.038ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:19:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.728ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:19:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.210ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:19:21.779' AND status != 'pending'
	

2025/06/26 13:19:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.152ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:49:21.798'

2025/06/26 13:19:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.725ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:19:21.865' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:19:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.939ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:19:21.885' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:19:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.343ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:19:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.261ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:19:21.951'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:19:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.520ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:19:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.035ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:19:22.055' AND status != 'pending'
	

2025/06/26 13:19:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.648ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:19:22.143' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:19:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.073ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:19:22.232'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:20:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[89.616ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:20:21.018'

2025/06/26 13:20:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[89.833ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:05:21.018' LIMIT 50

2025/06/26 13:20:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[89.470ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:05:21.084' LIMIT 50

2025/06/26 13:20:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.747ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:20:21.018'

2025/06/26 13:20:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.377ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:20:21.018'

2025/06/26 13:20:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.489ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:50:21.514'

2025/06/26 13:20:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[92.676ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:20:21.603' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:20:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.014ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:20:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.155ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:20:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[94.469ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:20:21.78' AND status != 'pending'
	

2025/06/26 13:20:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[173.793ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:50:21.795'

2025/06/26 13:20:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[303.283ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:20:21.874' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:20:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[208.782ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:20:21.969' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:20:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[135.380ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:20:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[228.561ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:20:22.178'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:20:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[93.031ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:20:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[93.931ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:20:22.406' AND status != 'pending'
	

2025/06/26 13:20:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[95.180ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:20:22.501' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:20:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[92.634ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:20:22.596'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:21:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[91.613ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:21:21.018'

2025/06/26 13:21:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[96.891ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:21:21.018'

2025/06/26 13:21:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[95.294ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:21:21.018'

2025/06/26 13:21:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[96.094ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:51:21.513'

2025/06/26 13:21:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[97.825ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:21:21.609' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:21:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.631ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:21:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.395ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:21:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.553ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:51:21.794'

2025/06/26 13:21:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.224ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:21:21.797' AND status != 'pending'
	

2025/06/26 13:21:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.220ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:21:21.882' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:21:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.871ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:21:21.886' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:21:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.582ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:21:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.434ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:21:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.058ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:21:21.976'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:21:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.664ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:21:22.059' AND status != 'pending'
	

2025/06/26 13:21:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.594ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:21:22.146' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:21:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.587ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:21:22.231'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:22:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.598ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:22:21.017'

2025/06/26 13:22:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[90.901ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:07:21.017' LIMIT 50

2025/06/26 13:22:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[86.955ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:07:21.085' LIMIT 50

2025/06/26 13:22:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.369ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:22:21.017'

2025/06/26 13:22:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.003ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:22:21.017'

2025/06/26 13:22:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.625ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:52:21.512'

2025/06/26 13:22:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.003ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:22:21.599' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:22:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.659ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:22:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.435ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:22:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.516ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:22:21.772' AND status != 'pending'
	

2025/06/26 13:22:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.541ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:52:21.794'

2025/06/26 13:22:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.210ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:22:21.855' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:22:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.486ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:22:21.882' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:22:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.312ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:22:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.366ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:22:21.94'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:22:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.060ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:22:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.174ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:22:22.057' AND status != 'pending'
	

2025/06/26 13:22:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.520ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:22:22.147' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:22:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.715ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:22:22.235'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:23:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[88.103ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:23:21.016'

2025/06/26 13:23:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.430ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:23:21.016'

2025/06/26 13:23:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.182ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:23:21.016'

2025/06/26 13:23:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.480ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:53:21.512'

2025/06/26 13:23:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.133ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:23:21.599' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:23:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.887ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:23:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.813ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:23:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.281ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:23:21.778' AND status != 'pending'
	

2025/06/26 13:23:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.007ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:53:21.795'

2025/06/26 13:23:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.977ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:23:21.867' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:23:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.532ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:23:21.883' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:23:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.461ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:23:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.891ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:23:21.953'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:23:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.510ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:23:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.598ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:23:22.055' AND status != 'pending'
	

2025/06/26 13:23:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.026ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:23:22.141' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:23:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.120ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:23:22.227'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:24:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.554ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:24:21.016'

2025/06/26 13:24:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.152ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:09:21.016' LIMIT 50

2025/06/26 13:24:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[95.835ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:09:21.083' LIMIT 50

2025/06/26 13:24:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[93.997ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:24:21.016'

2025/06/26 13:24:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.083ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:24:21.016'

2025/06/26 13:24:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.844ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:54:21.511'

2025/06/26 13:24:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.481ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:24:21.6' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:24:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.030ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:24:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.780ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:24:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[94.376ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:24:21.782' AND status != 'pending'
	

2025/06/26 13:24:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.116ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:54:21.793'

2025/06/26 13:24:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.826ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:24:21.876' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:24:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.780ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:24:21.883' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:24:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.982ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:24:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.794ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:24:21.964'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:24:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[47.721ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:24:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[96.150ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:24:22.068' AND status != 'pending'
	

2025/06/26 13:24:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[97.305ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:24:22.164' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:24:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[96.993ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:24:22.261'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:25:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[96.868ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:25:21.015'

2025/06/26 13:25:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[93.510ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:25:21.015'

2025/06/26 13:25:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[95.742ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:25:21.015'

2025/06/26 13:25:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[92.803ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:55:21.511'

2025/06/26 13:25:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[94.220ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:25:21.604' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:25:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.319ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:25:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.925ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:25:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.870ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:55:21.793'

2025/06/26 13:25:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.669ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:25:21.788' AND status != 'pending'
	

2025/06/26 13:25:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.077ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:25:21.878' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:25:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.280ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:25:21.879' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:25:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.488ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:25:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.370ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:25:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.098ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:25:21.967'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:25:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.067ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:25:22.055' AND status != 'pending'
	

2025/06/26 13:25:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.899ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:25:22.14' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:25:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.330ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:25:22.23'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:26:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.940ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:26:21.015'

2025/06/26 13:26:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[91.160ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:11:21.015' LIMIT 50

2025/06/26 13:26:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.029ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:11:21.082' LIMIT 50

2025/06/26 13:26:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[88.711ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:26:21.015'

2025/06/26 13:26:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[84.974ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:26:21.015'

2025/06/26 13:26:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.559ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:56:21.51'

2025/06/26 13:26:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.770ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:26:21.596' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:26:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.776ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:26:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.534ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:26:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.229ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:26:21.772' AND status != 'pending'
	

2025/06/26 13:26:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.461ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:56:21.793'

2025/06/26 13:26:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.042ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:26:21.857' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:26:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.049ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:26:21.884' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:26:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.463ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:26:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[93.913ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:26:21.945'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:26:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.990ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:26:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[95.520ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:26:22.066' AND status != 'pending'
	

2025/06/26 13:26:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.239ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:26:22.161' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:26:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[170.155ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:26:22.248'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:27:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[91.398ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:27:21.014'

2025/06/26 13:27:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[233.650ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:27:21.014'

2025/06/26 13:27:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[277.644ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:27:21.014'

2025/06/26 13:27:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[194.347ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:57:21.509'

2025/06/26 13:27:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.958ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:27:21.703' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:27:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.269ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:27:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.567ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:27:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[91.680ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:57:21.791'

2025/06/26 13:27:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.308ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:27:21.873' AND status != 'pending'
	

2025/06/26 13:27:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.135ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:27:21.883' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:27:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.500ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:27:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.264ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:27:21.959' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:27:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.733ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:27:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.950ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:27:22.043'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:27:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.688ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:27:22.061' AND status != 'pending'
	

2025/06/26 13:27:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.321ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:27:22.147' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:27:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.001ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:27:22.237'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:28:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[86.273ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:13:21.013' LIMIT 50

2025/06/26 13:28:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.507ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:28:21.013'

2025/06/26 13:28:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[93.299ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:13:21.081' LIMIT 50

2025/06/26 13:28:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.909ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:28:21.013'

2025/06/26 13:28:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[88.525ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:28:21.013'

2025/06/26 13:28:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.226ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:58:21.509'

2025/06/26 13:28:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.894ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:28:21.596' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:28:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.886ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:28:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.098ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:28:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.579ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:28:21.77' AND status != 'pending'
	

2025/06/26 13:28:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.281ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:58:21.79'

2025/06/26 13:28:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.609ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:28:21.86' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:28:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[93.892ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:28:21.881' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:28:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[47.545ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:28:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.631ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:28:21.946'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:28:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[50.163ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:28:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[92.867ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:28:22.072' AND status != 'pending'
	

2025/06/26 13:28:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[94.513ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:28:22.165' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:28:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.215ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:28:22.26'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:29:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[94.507ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:29:21.013'

2025/06/26 13:29:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.755ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:29:21.013'

2025/06/26 13:29:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[94.276ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:29:21.013'

2025/06/26 13:29:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[93.788ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:59:21.507'

2025/06/26 13:29:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.181ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:29:21.601' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:29:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.500ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:29:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[47.658ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:29:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.019ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:29:21.784' AND status != 'pending'
	

2025/06/26 13:29:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.527ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 12:59:21.791'

2025/06/26 13:29:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.721ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:29:21.876' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:29:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[93.698ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:29:21.875' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:29:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.574ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:29:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[47.074ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:29:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.643ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:29:21.968'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:29:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.760ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:29:22.059' AND status != 'pending'
	

2025/06/26 13:29:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[91.111ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:29:22.146' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:29:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.322ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:29:22.237'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:30:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[99.186ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:30:21.012'

2025/06/26 13:30:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[99.689ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:15:21.012' LIMIT 50

2025/06/26 13:30:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.906ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:15:21.078' LIMIT 50

2025/06/26 13:30:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[102.056ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:30:21.012'

2025/06/26 13:30:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.084ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:30:21.012'

2025/06/26 13:30:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.895ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:00:21.507'

2025/06/26 13:30:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.762ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:30:21.594' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:30:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.118ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:30:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.299ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:30:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.231ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:30:21.773' AND status != 'pending'
	

2025/06/26 13:30:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.421ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:00:21.791'

2025/06/26 13:30:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.456ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:30:21.858' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:30:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.998ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:30:21.875' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:30:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.175ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:30:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.502ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:30:21.948'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:30:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.225ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:30:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.152ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:30:22.045' AND status != 'pending'
	

2025/06/26 13:30:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.796ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:30:22.129' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:30:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.208ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:30:22.218'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:31:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.729ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:31:21.012'

2025/06/26 13:31:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[88.364ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:31:21.012'

2025/06/26 13:31:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.782ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:31:21.012'

2025/06/26 13:31:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.226ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:01:21.507'

2025/06/26 13:31:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.705ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:31:21.592' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:31:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.907ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:31:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.512ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:31:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.743ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:31:21.771' AND status != 'pending'
	

2025/06/26 13:31:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.182ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:01:21.79'

2025/06/26 13:31:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.992ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:31:21.855' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:31:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.583ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:31:21.878' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:31:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.593ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:31:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[93.762ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:31:21.94'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:31:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.620ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:31:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.806ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:31:22.057' AND status != 'pending'
	

2025/06/26 13:31:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[92.909ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:31:22.147' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:31:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.741ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:31:22.24'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:32:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.951ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:17:21.011' LIMIT 50

2025/06/26 13:32:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.946ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:32:21.011'

2025/06/26 13:32:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[90.489ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:17:21.079' LIMIT 50

2025/06/26 13:32:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.286ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:32:21.011'

2025/06/26 13:32:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.226ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:32:21.011'

2025/06/26 13:32:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[91.431ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:02:21.506'

2025/06/26 13:32:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.609ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:32:21.598' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:32:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.135ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:32:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.752ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:32:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.543ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:32:21.775' AND status != 'pending'
	

2025/06/26 13:32:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[93.155ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:02:21.789'

2025/06/26 13:32:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.699ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:32:21.861' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:32:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.463ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:32:21.883' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:32:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.253ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:32:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.457ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:32:21.948'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:32:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.164ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:32:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[94.527ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:32:22.064' AND status != 'pending'
	

2025/06/26 13:32:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[93.731ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:32:22.159' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:32:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[93.005ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:32:22.252'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:33:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[91.414ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:33:21.01'

2025/06/26 13:33:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[94.714ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:33:21.01'

2025/06/26 13:33:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.415ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:33:21.01'

2025/06/26 13:33:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[204.819ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:03:21.504'

2025/06/26 13:33:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[257.527ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:33:21.709' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:33:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[265.519ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:03:21.789'

2025/06/26 13:33:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[87.555ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:33:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.593ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:33:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.903ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:33:22.054' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:33:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[47.609ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:33:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.066ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:33:22.098' AND status != 'pending'
	

2025/06/26 13:33:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.155ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:33:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.300ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:33:22.189' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:33:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.087ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:33:22.234' AND status != 'pending'
	

2025/06/26 13:33:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.890ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:33:22.278'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:33:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[91.139ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:33:22.324' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:33:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.144ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:33:22.415'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:34:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[92.765ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:34:21.01'

2025/06/26 13:34:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[94.386ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:19:21.01' LIMIT 50

2025/06/26 13:34:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[86.923ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:19:21.077' LIMIT 50

2025/06/26 13:34:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.148ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:34:21.01'

2025/06/26 13:34:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[92.088ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:34:21.01'

2025/06/26 13:34:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.817ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:04:21.505'

2025/06/26 13:34:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[94.573ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:34:21.593' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:34:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.688ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:34:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.738ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:34:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.143ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:34:21.773' AND status != 'pending'
	

2025/06/26 13:34:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.473ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:04:21.788'

2025/06/26 13:34:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.519ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:34:21.863' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:34:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.048ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:34:21.872' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:34:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.560ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:34:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.442ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:34:21.949'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:34:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.696ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:34:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.244ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:34:22.043' AND status != 'pending'
	

2025/06/26 13:34:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.998ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:34:22.128' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:34:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.563ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:34:22.213'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:35:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.089ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:35:21.009'

2025/06/26 13:35:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[96.017ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:35:21.009'

2025/06/26 13:35:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[88.126ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:35:21.009'

2025/06/26 13:35:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.626ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:05:21.505'

2025/06/26 13:35:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.570ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:35:21.589' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:35:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.284ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:35:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.856ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:35:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.405ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:35:21.762' AND status != 'pending'
	

2025/06/26 13:35:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.287ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:05:21.788'

2025/06/26 13:35:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.655ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:35:21.846' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:35:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.699ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:35:21.874' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:35:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.474ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:35:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.185ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:35:21.936'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:35:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[47.393ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:35:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[98.852ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:35:22.053' AND status != 'pending'
	

2025/06/26 13:35:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.636ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:35:22.152' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:35:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.457ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:35:22.24'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:36:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.679ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:21:21.009' LIMIT 50

2025/06/26 13:36:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.897ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:36:21.009'

2025/06/26 13:36:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[89.677ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:21:21.075' LIMIT 50

2025/06/26 13:36:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[91.638ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:36:21.009'

2025/06/26 13:36:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.871ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:36:21.009'

2025/06/26 13:36:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.323ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:06:21.503'

2025/06/26 13:36:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.284ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:36:21.591' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:36:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.339ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:36:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.077ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:36:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.612ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:36:21.769' AND status != 'pending'
	

2025/06/26 13:36:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[93.080ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:06:21.785'

2025/06/26 13:36:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.034ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:36:21.857' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:36:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.034ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:36:21.878' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:36:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.407ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:36:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.638ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:36:21.947'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:36:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[50.680ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:36:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.715ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:36:22.065' AND status != 'pending'
	

2025/06/26 13:36:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[95.141ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:36:22.156' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:36:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[94.075ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:36:22.251'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:37:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[93.377ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:37:21.008'

2025/06/26 13:37:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[91.409ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:37:21.008'

2025/06/26 13:37:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[95.696ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:37:21.008'

2025/06/26 13:37:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.472ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:07:21.503'

2025/06/26 13:37:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[94.446ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:37:21.594' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:37:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.521ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:37:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.116ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:37:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.058ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:37:21.777' AND status != 'pending'
	

2025/06/26 13:37:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.878ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:07:21.786'

2025/06/26 13:37:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[92.777ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:37:21.869' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:37:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.783ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:37:21.872' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:37:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.914ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:37:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.354ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:37:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.424ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:37:21.961'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:37:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.008ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:37:22.05' AND status != 'pending'
	

2025/06/26 13:37:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.219ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:37:22.141' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:37:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[98.395ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:37:22.231'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:38:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[89.039ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:38:21.007'

2025/06/26 13:38:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[90.660ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:23:21.007' LIMIT 50

2025/06/26 13:38:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.794ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:23:21.073' LIMIT 50

2025/06/26 13:38:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.656ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:38:21.007'

2025/06/26 13:38:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[101.397ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:38:21.007'

2025/06/26 13:38:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[93.963ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:08:21.501'

2025/06/26 13:38:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.801ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:38:21.595' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:38:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.926ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:38:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.286ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:38:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.183ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:38:21.77' AND status != 'pending'
	

2025/06/26 13:38:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.224ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:08:21.785'

2025/06/26 13:38:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.671ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:38:21.856' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:38:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.906ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:38:21.87' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:38:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.485ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:38:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[102.133ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:38:21.947'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:38:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[48.409ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:38:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.796ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:38:22.049' AND status != 'pending'
	

2025/06/26 13:38:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[94.617ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:38:22.14' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:38:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.913ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:38:22.235'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:39:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[88.256ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:39:21.007'

2025/06/26 13:39:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[88.176ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:39:21.007'

2025/06/26 13:39:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.416ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:39:21.007'

2025/06/26 13:39:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.853ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:09:21.502'

2025/06/26 13:39:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.152ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:39:21.588' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:39:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.631ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:39:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.387ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:39:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.673ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:39:21.761' AND status != 'pending'
	

2025/06/26 13:39:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[94.437ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:09:21.783'

2025/06/26 13:39:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.791ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:39:21.845' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:39:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.058ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:39:21.878' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:39:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[52.411ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:39:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.548ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:39:21.934'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:39:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.830ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:39:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[94.724ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:39:22.066' AND status != 'pending'
	

2025/06/26 13:39:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[169.882ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:39:22.161' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:39:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[200.840ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:39:22.331'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:40:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[120.433ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:25:21.006' LIMIT 50

2025/06/26 13:40:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[120.810ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 13:40:21.006' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/26 13:40:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[120.906ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:40:21.006'

2025/06/26 13:40:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[48.595ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-19 13:40:21.127'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/26 13:40:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[93.351ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:40:21.006'

2025/06/26 13:40:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[92.153ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:40:21.006'

2025/06/26 13:40:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[254.739ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:25:21.072' LIMIT 50

2025/06/26 13:40:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[264.669ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 13:40:21.072' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/26 13:40:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[49.066ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-19 13:40:21.337'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/26 13:40:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.157ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:10:21.501'

2025/06/26 13:40:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.313ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:40:21.585' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:40:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.365ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:40:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.797ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:40:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.575ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:40:21.748' AND status != 'pending'
	

2025/06/26 13:40:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.213ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:10:21.784'

2025/06/26 13:40:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.498ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:40:21.833' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:40:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.358ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:40:21.86' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:40:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.934ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:40:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.146ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:40:21.915'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:40:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.230ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:40:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.676ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:40:22.022' AND status != 'pending'
	

2025/06/26 13:40:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.320ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:40:22.097' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:40:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.135ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:40:22.178'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:41:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.001ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:41:21.005'

2025/06/26 13:41:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.516ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:41:21.005'

2025/06/26 13:41:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[74.757ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:41:21.005'

2025/06/26 13:41:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.351ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:11:21.501'

2025/06/26 13:41:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.817ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:41:21.579' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:41:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.632ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:41:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.687ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:41:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.594ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:41:21.732' AND status != 'pending'
	

2025/06/26 13:41:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.643ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:11:21.782'

2025/06/26 13:41:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.792ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:41:21.809' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:41:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.572ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:41:21.86' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:41:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.915ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:41:21.883'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:41:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.597ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:41:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.468ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:41:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[113.056ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:41:22.02' AND status != 'pending'
	

2025/06/26 13:41:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.007ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:41:22.133' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:41:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.939ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:41:22.221'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:42:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[74.803ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:27:21.005' LIMIT 50

2025/06/26 13:42:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.312ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:42:21.005'

2025/06/26 13:42:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[89.596ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:42:21.005'

2025/06/26 13:42:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[104.805ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:27:21.071' LIMIT 50

2025/06/26 13:42:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.351ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:42:21.005'

2025/06/26 13:42:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.658ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:12:21.499'

2025/06/26 13:42:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.426ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:42:21.579' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:42:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.317ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:42:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.343ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:42:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.404ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:42:21.738' AND status != 'pending'
	

2025/06/26 13:42:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.244ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:12:21.782'

2025/06/26 13:42:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.148ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:42:21.819' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:42:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.379ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:42:21.868' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:42:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.252ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:42:21.898'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:42:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.039ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:42:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.726ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:42:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.994ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:42:22.048' AND status != 'pending'
	

2025/06/26 13:42:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.304ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:42:22.135' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:42:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.301ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:42:22.223'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:43:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[96.948ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:43:21.004'

2025/06/26 13:43:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.713ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:43:21.004'

2025/06/26 13:43:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[88.105ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:43:21.004'

2025/06/26 13:43:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[91.344ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:13:21.499'

2025/06/26 13:43:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.169ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:43:21.59' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:43:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.899ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:43:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.854ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:43:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.592ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:43:21.766' AND status != 'pending'
	

2025/06/26 13:43:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.253ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:13:21.782'

2025/06/26 13:43:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.166ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:43:21.86' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:43:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.982ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:43:21.856' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:43:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.871ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:43:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.219ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:43:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.406ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:43:21.943'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:43:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.227ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:43:22.027' AND status != 'pending'
	

2025/06/26 13:43:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.467ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:43:22.11' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:43:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.379ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:43:22.194'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:44:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.026ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:44:21.003'

2025/06/26 13:44:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[90.424ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:29:21.003' LIMIT 50

2025/06/26 13:44:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[74.245ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:29:21.07' LIMIT 50

2025/06/26 13:44:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.614ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:44:21.003'

2025/06/26 13:44:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[79.366ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:44:21.003'

2025/06/26 13:44:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.202ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:14:21.498'

2025/06/26 13:44:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.882ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:44:21.581' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:44:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[51.609ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:44:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.586ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:44:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.605ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:44:21.753' AND status != 'pending'
	

2025/06/26 13:44:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.328ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:14:21.781'

2025/06/26 13:44:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.598ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:44:21.831' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:44:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.773ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:44:21.86' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:44:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.747ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:44:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.048ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:44:21.908'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:44:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.574ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:44:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.212ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:44:22.014' AND status != 'pending'
	

2025/06/26 13:44:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.819ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:44:22.093' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:44:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.601ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:44:22.171'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:45:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.957ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:45:21.003'

2025/06/26 13:45:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.029ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:45:21.003'

2025/06/26 13:45:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.744ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:45:21.003'

2025/06/26 13:45:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.483ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:15:21.497'

2025/06/26 13:45:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.623ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:45:21.576' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:45:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.886ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:45:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.685ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:45:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.762ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:45:21.729' AND status != 'pending'
	

2025/06/26 13:45:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.267ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:15:21.781'

2025/06/26 13:45:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.733ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:45:21.807' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:45:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.115ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:45:21.859' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:45:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.018ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:45:21.884'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:45:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.616ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:45:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.361ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:45:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.096ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:45:22.024' AND status != 'pending'
	

2025/06/26 13:45:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.963ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:45:22.104' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:45:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.935ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:45:22.186'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:46:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.879ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:31:21.002' LIMIT 50

2025/06/26 13:46:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.967ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:46:21.002'

2025/06/26 13:46:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[90.756ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:31:21.069' LIMIT 50

2025/06/26 13:46:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.090ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:46:21.002'

2025/06/26 13:46:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[79.633ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:46:21.002'

2025/06/26 13:46:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.242ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:16:21.497'

2025/06/26 13:46:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.101ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:46:21.576' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:46:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.930ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:46:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.048ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:46:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.423ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:46:21.738' AND status != 'pending'
	

2025/06/26 13:46:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.957ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:16:21.78'

2025/06/26 13:46:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.747ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:46:21.819' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:46:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.273ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:46:21.867' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:46:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.505ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:46:21.9'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:46:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.677ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:46:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[54.896ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:46:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.139ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:46:22.052' AND status != 'pending'
	

2025/06/26 13:46:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[105.368ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:46:22.144' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:46:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[93.661ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:46:22.249'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:47:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[315.587ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:47:21.001'

2025/06/26 13:47:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[88.036ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:47:21.001'

2025/06/26 13:47:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.714ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:47:21.001'

2025/06/26 13:47:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.196ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:17:21.496'

2025/06/26 13:47:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.015ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:47:21.58' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:47:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.962ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:47:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.898ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:47:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.753ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:47:21.743' AND status != 'pending'
	

2025/06/26 13:47:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.362ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:17:21.779'

2025/06/26 13:47:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.604ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:47:21.826' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:47:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.294ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:47:21.868' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:47:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.737ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:47:21.906'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:47:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.106ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:47:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.439ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:47:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.349ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:47:22.043' AND status != 'pending'
	

2025/06/26 13:47:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.486ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:47:22.13' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:47:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.955ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:47:22.215'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:48:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.929ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:33:21.001' LIMIT 50

2025/06/26 13:48:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.689ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:48:21.001'

2025/06/26 13:48:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[74.365ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:33:21.068' LIMIT 50

2025/06/26 13:48:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.520ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:48:21.001'

2025/06/26 13:48:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.226ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:48:21.001'

2025/06/26 13:48:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[91.460ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:18:21.496'

2025/06/26 13:48:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.418ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:48:21.587' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:48:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.641ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:48:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.167ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:48:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[73.602ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:18:21.778'

2025/06/26 13:48:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.804ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:48:21.765' AND status != 'pending'
	

2025/06/26 13:48:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.850ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:48:21.852' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:48:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.246ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:48:21.855' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:48:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.774ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:48:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.186ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:48:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.248ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:48:21.94'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:48:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.140ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:48:22.005' AND status != 'pending'
	

2025/06/26 13:48:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.208ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:48:22.086' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:48:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.108ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:48:22.165'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:49:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[152.137ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:49:21'

2025/06/26 13:49:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[105.832ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:49:21'

2025/06/26 13:49:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[170.866ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:49:21'

2025/06/26 13:49:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[123.671ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:19:21.495'

2025/06/26 13:49:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[191.438ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:49:21.619' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:49:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[47.385ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:49:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[101.776ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:19:21.778'

2025/06/26 13:49:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[51.835ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:49:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[142.896ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:49:21.88' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:49:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[157.425ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:49:21.91' AND status != 'pending'
	

2025/06/26 13:49:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[50.450ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:49:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[70.969ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:49:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[128.700ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:49:22.067' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:49:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[204.168ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:49:22.145' AND status != 'pending'
	

2025/06/26 13:49:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[192.782ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:49:22.196'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:49:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[101.277ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:49:22.349' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:49:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[131.476ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:49:22.451'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:50:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.926ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:35:21' LIMIT 50

2025/06/26 13:50:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.490ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:50:21'

2025/06/26 13:50:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.893ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:35:21.066' LIMIT 50

2025/06/26 13:50:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.387ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:50:21'

2025/06/26 13:50:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.507ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:50:21'

2025/06/26 13:50:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.810ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:20:21.494'

2025/06/26 13:50:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[92.390ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:50:21.585' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:50:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.281ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:50:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.561ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:50:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[239.446ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:20:21.778'

2025/06/26 13:50:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[252.315ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:50:21.765' AND status != 'pending'
	

2025/06/26 13:50:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[161.805ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:50:22.017' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:50:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[161.827ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:50:22.017' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:50:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[89.493ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:50:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[166.817ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:50:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[256.568ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:50:22.179'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:50:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[191.247ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:50:22.436' AND status != 'pending'
	

2025/06/26 13:50:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[106.630ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:50:22.627' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:50:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[132.981ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:50:22.734'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:51:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.737ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:51:20.999'

2025/06/26 13:51:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[111.626ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:51:20.999'

2025/06/26 13:51:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[84.244ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:51:20.999'

2025/06/26 13:51:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.155ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:21:21.494'

2025/06/26 13:51:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.946ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:51:21.577' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:51:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.453ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:51:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.119ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:51:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.829ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:51:21.739' AND status != 'pending'
	

2025/06/26 13:51:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.503ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:21:21.777'

2025/06/26 13:51:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.916ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:51:21.82' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:51:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.861ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:51:21.864' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:51:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.556ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:51:21.898'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:51:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.665ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:51:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.631ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:51:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.603ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:51:22.044' AND status != 'pending'
	

2025/06/26 13:51:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[91.511ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:51:22.132' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:51:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.484ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:51:22.224'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:52:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[86.974ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:37:20.999' LIMIT 50

2025/06/26 13:52:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[91.267ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:52:20.999'

2025/06/26 13:52:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[74.273ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:37:21.066' LIMIT 50

2025/06/26 13:52:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[88.626ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:52:20.999'

2025/06/26 13:52:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[88.029ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:52:20.999'

2025/06/26 13:52:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.378ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:22:21.493'

2025/06/26 13:52:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.435ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:52:21.583' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:52:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.737ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:52:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.890ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:52:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.747ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:52:21.76' AND status != 'pending'
	

2025/06/26 13:52:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[73.380ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:22:21.777'

2025/06/26 13:52:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.434ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:52:21.851' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:52:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.631ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:52:21.849' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:52:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.485ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:52:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.061ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:52:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.878ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:52:21.935'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:52:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.109ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:52:22.004' AND status != 'pending'
	

2025/06/26 13:52:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.169ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:52:22.083' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:52:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.121ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:52:22.162'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:57:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.315ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:57:10.74'

2025/06/26 13:57:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.097ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:57:10.74'

2025/06/26 13:57:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.006ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:57:10.74'

2025/06/26 13:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.758ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:27:11.234'

2025/06/26 13:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.845ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:57:11.316' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.191ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.580ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.505ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:57:11.473' AND status != 'pending'
	

2025/06/26 13:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[190.453ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:57:11.554' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[245.656ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:57:11.744'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:57:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129 invalid connection
[36665.574ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:27:11.517'

2025/06/26 13:57:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[236.545ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:57:48.173' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:57:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[90.586ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:57:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.234ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:57:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.897ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:57:48.537' AND status != 'pending'
	

2025/06/26 13:57:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.060ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:57:48.611' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:57:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.056ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:57:48.69'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:58:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.145ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:58:10.728'

2025/06/26 13:58:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.519ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:43:10.728' LIMIT 50

2025/06/26 13:58:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.424ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:58:10.728'

2025/06/26 13:58:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.285ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:58:10.728'

2025/06/26 13:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[183.366ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:28:11.223'

2025/06/26 13:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[171.149ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:58:11.406' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[35.899ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[102.732ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[210.621ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:28:11.506'

2025/06/26 13:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[128.719ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:58:11.717' AND status != 'pending'
	

2025/06/26 13:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[129.053ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:58:11.717' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.546ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.254ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:58:11.845' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.378ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.583ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:58:11.92'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:58:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.753ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:58:11.926' AND status != 'pending'
	

2025/06/26 13:58:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.224ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:58:12.007' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:58:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.535ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:58:12.09'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:58:42 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163 invalid connection
[31717.835ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:43:10.795' LIMIT 50

2025/06/26 13:59:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.036ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 13:59:10.727'

2025/06/26 13:59:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.990ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 13:59:10.727'

2025/06/26 13:59:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.576ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 13:59:10.727'

2025/06/26 13:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.133ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:29:11.222'

2025/06/26 13:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.510ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:59:11.301' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.030ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.753ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.207ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:59:11.462' AND status != 'pending'
	

2025/06/26 13:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.814ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:29:11.504'

2025/06/26 13:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.106ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:59:11.544' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.245ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 12:59:11.58' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 13:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.340ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 13:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.247ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:59:11.622'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 13:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.641ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 13:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.601ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 12:59:11.737' AND status != 'pending'
	

2025/06/26 13:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.558ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 12:59:11.812' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 13:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.204ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 12:59:11.89'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:00:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[74.529ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:00:10.726'

2025/06/26 14:00:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.667ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:45:10.726' LIMIT 50

2025/06/26 14:00:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[75.308ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:00:10.726'

2025/06/26 14:00:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[74.010ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:00:10.726'

2025/06/26 14:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[235.329ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:45:10.793' LIMIT 50

2025/06/26 14:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.551ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:30:11.22'

2025/06/26 14:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.307ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:00:11.297' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.668ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.117ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.900ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:00:11.453' AND status != 'pending'
	

2025/06/26 14:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.832ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:30:11.504'

2025/06/26 14:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.914ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:00:11.534' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.706ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:00:11.579' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.591ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:00:11.609'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.266ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.933ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.738ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:00:11.727' AND status != 'pending'
	

2025/06/26 14:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.474ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:00:11.804' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.192ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:00:11.88'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:01:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[75.587ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:01:10.725'

2025/06/26 14:01:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.062ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:01:10.725'

2025/06/26 14:01:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.060ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:01:10.725'

2025/06/26 14:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.522ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:31:11.219'

2025/06/26 14:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.240ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:01:11.298' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.093ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.373ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.956ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:01:11.447' AND status != 'pending'
	

2025/06/26 14:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.639ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:31:11.502'

2025/06/26 14:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.196ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:01:11.53' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.957ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:01:11.577' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.754ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:01:11.608'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.015ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.993ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.122ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:01:11.732' AND status != 'pending'
	

2025/06/26 14:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.525ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:01:11.807' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.302ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:01:11.886'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:02:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.075ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:47:10.724' LIMIT 50

2025/06/26 14:02:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.365ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:02:10.724'

2025/06/26 14:02:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.775ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:47:10.791' LIMIT 50

2025/06/26 14:02:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[74.680ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:02:10.724'

2025/06/26 14:02:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.517ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:02:10.724'

2025/06/26 14:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.630ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:32:11.218'

2025/06/26 14:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[76.434ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:02:11.298' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.985ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.963ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.633ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:02:11.452' AND status != 'pending'
	

2025/06/26 14:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.135ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:32:11.502'

2025/06/26 14:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.115ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:02:11.531' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.868ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:02:11.58' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.030ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:02:11.605'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.679ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.572ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.836ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:02:11.739' AND status != 'pending'
	

2025/06/26 14:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.226ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:02:11.818' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.861ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:02:11.901'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:03:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[98.536ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:03:10.723'

2025/06/26 14:03:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[83.546ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:03:10.723'

2025/06/26 14:03:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.678ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:03:10.723'

2025/06/26 14:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.144ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:33:11.216'

2025/06/26 14:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.130ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:03:11.3' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.574ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.675ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.110ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:03:11.456' AND status != 'pending'
	

2025/06/26 14:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.599ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:33:11.5'

2025/06/26 14:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.427ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:03:11.535' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[96.769ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:03:11.575' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.461ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[93.230ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:03:11.617'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.539ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.090ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:03:11.753' AND status != 'pending'
	

2025/06/26 14:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.203ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:03:11.832' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:03:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.163ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:03:11.912'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:04:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.742ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:04:10.722'

2025/06/26 14:04:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.589ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:49:10.722' LIMIT 50

2025/06/26 14:04:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.146ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:49:10.788' LIMIT 50

2025/06/26 14:04:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[73.751ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:04:10.722'

2025/06/26 14:04:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.738ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:04:10.722'

2025/06/26 14:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.501ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:34:11.216'

2025/06/26 14:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.103ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:04:11.295' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.578ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.685ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.565ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:04:11.449' AND status != 'pending'
	

2025/06/26 14:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.756ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:34:11.5'

2025/06/26 14:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[92.291ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:04:11.525' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[76.835ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:04:11.577' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.330ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:04:11.618'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.354ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.922ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.117ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:04:11.733' AND status != 'pending'
	

2025/06/26 14:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.929ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:04:11.809' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.272ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:04:11.888'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:05:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[107.963ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:05:10.72'

2025/06/26 14:05:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.147ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:05:10.72'

2025/06/26 14:05:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[74.807ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:05:10.72'

2025/06/26 14:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.530ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:35:11.215'

2025/06/26 14:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.944ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:05:11.293' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.422ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.328ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.503ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:05:11.445' AND status != 'pending'
	

2025/06/26 14:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.417ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:35:11.498'

2025/06/26 14:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.115ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:05:11.523' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.804ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:05:11.573' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.398ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:05:11.597'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.043ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.032ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.633ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:05:11.726' AND status != 'pending'
	

2025/06/26 14:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.366ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:05:11.801' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.959ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:05:11.877'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:06:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.304ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:51:10.72' LIMIT 50

2025/06/26 14:06:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.507ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:06:10.719'

2025/06/26 14:06:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.740ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:51:10.786' LIMIT 50

2025/06/26 14:06:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[75.984ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:06:10.719'

2025/06/26 14:06:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[74.366ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:06:10.719'

2025/06/26 14:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.961ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:36:11.214'

2025/06/26 14:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.355ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:06:11.29' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.524ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.421ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.562ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:06:11.439' AND status != 'pending'
	

2025/06/26 14:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.825ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:36:11.497'

2025/06/26 14:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.780ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:06:11.513' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.775ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:06:11.576' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.940ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:06:11.59'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.755ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.303ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.090ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:06:11.738' AND status != 'pending'
	

2025/06/26 14:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.719ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:06:11.817' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.053ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:06:11.897'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:07:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.217ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:07:10.718'

2025/06/26 14:07:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.735ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:07:10.718'

2025/06/26 14:07:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[79.338ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:07:10.718'

2025/06/26 14:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.023ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:37:11.213'

2025/06/26 14:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.925ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:07:11.296' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.821ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.027ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.723ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:07:11.454' AND status != 'pending'
	

2025/06/26 14:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.440ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:37:11.496'

2025/06/26 14:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.615ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:07:11.531' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.809ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:07:11.57' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.167ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.547ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:07:11.611'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.681ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.889ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:07:11.728' AND status != 'pending'
	

2025/06/26 14:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.581ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:07:11.803' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.628ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:07:11.882'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:08:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[75.100ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:08:10.717'

2025/06/26 14:08:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.572ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:53:10.717' LIMIT 50

2025/06/26 14:08:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.325ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:53:10.784' LIMIT 50

2025/06/26 14:08:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.137ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:08:10.717'

2025/06/26 14:08:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.170ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:08:10.717'

2025/06/26 14:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.393ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:38:11.212'

2025/06/26 14:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.626ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:08:11.289' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.068ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.124ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.719ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:08:11.439' AND status != 'pending'
	

2025/06/26 14:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.031ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:38:11.495'

2025/06/26 14:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.865ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:08:11.514' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[76.012ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:08:11.57' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.992ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:08:11.593'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.291ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.078ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.416ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:08:11.721' AND status != 'pending'
	

2025/06/26 14:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.734ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:08:11.799' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.941ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:08:11.873'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:09:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.573ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:09:10.716'

2025/06/26 14:09:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.329ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:09:10.716'

2025/06/26 14:09:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[73.966ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:09:10.716'

2025/06/26 14:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.469ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:39:11.211'

2025/06/26 14:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.773ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:09:11.289' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.404ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.852ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.478ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:09:11.44' AND status != 'pending'
	

2025/06/26 14:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.108ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:39:11.494'

2025/06/26 14:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.862ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:09:11.517' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[76.183ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:09:11.57' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.808ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:09:11.597'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.707ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.413ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.055ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:09:11.722' AND status != 'pending'
	

2025/06/26 14:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.994ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:09:11.798' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.293ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:09:11.877'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:10:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.704ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:10:10.715'

2025/06/26 14:10:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.326ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:55:10.715' LIMIT 50

2025/06/26 14:10:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.612ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:55:10.782' LIMIT 50

2025/06/26 14:10:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[74.714ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:10:10.715'

2025/06/26 14:10:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[74.892ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:10:10.715'

2025/06/26 14:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.875ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:40:11.21'

2025/06/26 14:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.170ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:10:11.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.089ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.825ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.074ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:10:11.438' AND status != 'pending'
	

2025/06/26 14:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.430ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:40:11.493'

2025/06/26 14:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[73.098ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:10:11.514' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.379ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:10:11.573' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.573ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:10:11.588'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.535ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.904ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.403ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:10:11.736' AND status != 'pending'
	

2025/06/26 14:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.965ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:10:11.818' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.769ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:10:11.903'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:11:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[97.034ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:11:10.714'

2025/06/26 14:11:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.665ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:11:10.714'

2025/06/26 14:11:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.338ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:11:10.714'

2025/06/26 14:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[221.238ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:41:11.209'

2025/06/26 14:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[221.966ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:11:11.43' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[200.953ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:41:11.492'

2025/06/26 14:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.206ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.448ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.500ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:11:11.693' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.667ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.674ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:11:11.731' AND status != 'pending'
	

2025/06/26 14:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.297ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.008ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:11:11.808' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.054ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:11:11.847' AND status != 'pending'
	

2025/06/26 14:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.048ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:11:11.884'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:11:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.213ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:11:11.923' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:11:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.163ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:11:12.001'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:12:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.072ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:57:10.713' LIMIT 50

2025/06/26 14:12:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.659ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:12:10.713'

2025/06/26 14:12:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[74.876ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:57:10.78' LIMIT 50

2025/06/26 14:12:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.689ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:12:10.713'

2025/06/26 14:12:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[82.020ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:12:10.713'

2025/06/26 14:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.989ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:42:11.207'

2025/06/26 14:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.609ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:12:11.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.004ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.420ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.097ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:12:11.445' AND status != 'pending'
	

2025/06/26 14:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.257ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:42:11.491'

2025/06/26 14:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.241ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:12:11.526' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.134ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:12:11.566' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.237ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.285ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:12:11.605'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.763ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.137ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:12:11.72' AND status != 'pending'
	

2025/06/26 14:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.705ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:12:11.798' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.313ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:12:11.874'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:13:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.232ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:13:10.769'

2025/06/26 14:13:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.302ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:13:10.769'

2025/06/26 14:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[74.131ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:13:10.769'

2025/06/26 14:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.369ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:43:11.263'

2025/06/26 14:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.166ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:13:11.341' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.393ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.788ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.162ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:13:11.497' AND status != 'pending'
	

2025/06/26 14:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.910ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:43:11.546'

2025/06/26 14:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.265ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:13:11.575' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.318ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:13:11.626' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.094ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:13:11.653'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.373ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.816ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.061ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:13:11.788' AND status != 'pending'
	

2025/06/26 14:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.522ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:13:11.869' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:13:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.107ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:13:11.951'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:14:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.826ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:59:10.769' LIMIT 50

2025/06/26 14:14:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.470ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:14:10.768'

2025/06/26 14:14:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.553ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:59:10.834' LIMIT 50

2025/06/26 14:14:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.891ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:14:10.768'

2025/06/26 14:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.843ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:14:10.768'

2025/06/26 14:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.732ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:44:11.263'

2025/06/26 14:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.293ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:14:11.347' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.800ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.604ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.545ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:14:11.509' AND status != 'pending'
	

2025/06/26 14:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.249ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:44:11.545'

2025/06/26 14:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.487ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:14:11.591' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.121ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:14:11.62' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.475ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.440ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:14:11.669'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.782ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.868ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:14:11.78' AND status != 'pending'
	

2025/06/26 14:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.478ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:14:11.857' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:14:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.200ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:14:11.936'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:15:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.009ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:15:10.768'

2025/06/26 14:15:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[75.842ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:15:10.768'

2025/06/26 14:15:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[74.714ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:15:10.768'

2025/06/26 14:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.894ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:45:11.262'

2025/06/26 14:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.591ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:15:11.341' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.245ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.700ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.724ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:15:11.493' AND status != 'pending'
	

2025/06/26 14:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.560ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:45:11.545'

2025/06/26 14:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.135ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:15:11.568' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.428ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:15:11.624' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.639ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:15:11.642'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.818ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.308ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.188ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:15:11.788' AND status != 'pending'
	

2025/06/26 14:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.929ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:15:11.871' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:15:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.293ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:15:11.951'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:16:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[74.888ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:01:10.768' LIMIT 50

2025/06/26 14:16:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.567ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:16:10.768'

2025/06/26 14:16:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[77.244ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:01:10.835' LIMIT 50

2025/06/26 14:16:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.920ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:16:10.768'

2025/06/26 14:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[79.766ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:16:10.768'

2025/06/26 14:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.492ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:46:11.262'

2025/06/26 14:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.997ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:16:11.345' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.640ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.051ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.605ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:16:11.506' AND status != 'pending'
	

2025/06/26 14:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.789ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:46:11.546'

2025/06/26 14:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.946ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:16:11.587' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.157ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:16:11.622' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.415ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.508ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:16:11.664'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.782ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.870ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:16:11.779' AND status != 'pending'
	

2025/06/26 14:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.256ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:16:11.854' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:16:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.035ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:16:11.932'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:17:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[74.633ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:17:10.767'

2025/06/26 14:17:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[75.913ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:17:10.767'

2025/06/26 14:17:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.082ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:17:10.767'

2025/06/26 14:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.156ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:47:11.262'

2025/06/26 14:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.719ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:17:11.337' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.517ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.773ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.313ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:17:11.492' AND status != 'pending'
	

2025/06/26 14:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.078ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:47:11.545'

2025/06/26 14:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.045ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:17:11.568' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.867ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:17:11.625' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[71.614ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:17:11.642'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.005ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.569ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.220ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:17:11.791' AND status != 'pending'
	

2025/06/26 14:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.596ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:17:11.871' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:17:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.147ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:17:11.954'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:18:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[167.437ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:03:10.767' LIMIT 50

2025/06/26 14:18:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[169.177ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:18:10.767'

2025/06/26 14:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[194.972ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:03:10.834' LIMIT 50

2025/06/26 14:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[136.319ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:18:10.767'

2025/06/26 14:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[79.674ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:18:10.767'

2025/06/26 14:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.973ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:48:11.262'

2025/06/26 14:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.270ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:18:11.344' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.034ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.476ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.236ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:18:11.509' AND status != 'pending'
	

2025/06/26 14:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.657ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:48:11.545'

2025/06/26 14:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.285ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:18:11.591' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.048ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:18:11.621' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.804ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.971ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:18:11.67'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.728ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.987ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:18:11.778' AND status != 'pending'
	

2025/06/26 14:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.770ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:18:11.853' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:18:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.422ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:18:11.932'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:19:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[75.370ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:19:10.767'

2025/06/26 14:19:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.242ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:19:10.767'

2025/06/26 14:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.281ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:19:10.767'

2025/06/26 14:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.508ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:49:11.261'

2025/06/26 14:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.445ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:19:11.336' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.073ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.814ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.408ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:19:11.487' AND status != 'pending'
	

2025/06/26 14:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.556ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:49:11.545'

2025/06/26 14:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[73.996ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:19:11.56' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.066ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:19:11.623' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[71.877ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:19:11.634'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[76.817ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.140ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.766ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:19:11.827' AND status != 'pending'
	

2025/06/26 14:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.884ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:19:11.907' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:19:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.772ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:19:11.992'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:20:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.742ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:05:10.767' LIMIT 50

2025/06/26 14:20:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.194ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:20:10.766'

2025/06/26 14:20:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[74.553ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:05:10.833' LIMIT 50

2025/06/26 14:20:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.859ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:20:10.766'

2025/06/26 14:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.559ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:20:10.766'

2025/06/26 14:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.095ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:50:11.261'

2025/06/26 14:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.591ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:20:11.341' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.941ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.697ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.887ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:20:11.501' AND status != 'pending'
	

2025/06/26 14:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.784ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:50:11.544'

2025/06/26 14:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.921ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:20:11.581' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.891ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:20:11.622' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.218ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.954ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:20:11.66'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.928ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.419ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:20:11.775' AND status != 'pending'
	

2025/06/26 14:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.515ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:20:11.853' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:20:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.039ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:20:11.928'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:21:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.216ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:21:10.766'

2025/06/26 14:21:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[74.789ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:21:10.766'

2025/06/26 14:21:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.596ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:21:10.766'

2025/06/26 14:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.544ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:51:11.261'

2025/06/26 14:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[76.571ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:21:11.339' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.468ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.305ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.000ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:21:11.489' AND status != 'pending'
	

2025/06/26 14:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.460ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:51:11.544'

2025/06/26 14:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.050ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:21:11.564' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.235ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:21:11.626' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.718ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:21:11.641'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.888ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.135ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.891ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:21:11.788' AND status != 'pending'
	

2025/06/26 14:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.526ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:21:11.871' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:21:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.789ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:21:11.95'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:22:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[74.159ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:07:10.766' LIMIT 50

2025/06/26 14:22:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.482ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:22:10.766'

2025/06/26 14:22:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.342ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:07:10.833' LIMIT 50

2025/06/26 14:22:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.492ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:22:10.766'

2025/06/26 14:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[79.047ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:22:10.766'

2025/06/26 14:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.800ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:52:11.261'

2025/06/26 14:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.832ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:22:11.34' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.561ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.051ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.416ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:22:11.501' AND status != 'pending'
	

2025/06/26 14:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.802ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:52:11.543'

2025/06/26 14:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.224ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:22:11.58' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.458ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:22:11.621' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.607ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.569ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:22:11.659'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.234ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.096ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:22:11.776' AND status != 'pending'
	

2025/06/26 14:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.333ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:22:11.857' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:22:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.676ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:22:11.935'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:23:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.337ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:23:10.765'

2025/06/26 14:23:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.873ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:23:10.765'

2025/06/26 14:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[82.626ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:23:10.765'

2025/06/26 14:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.314ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:53:11.26'

2025/06/26 14:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.723ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:23:11.34' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.757ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.042ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.396ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:23:11.503' AND status != 'pending'
	

2025/06/26 14:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.070ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:53:11.543'

2025/06/26 14:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.789ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:23:11.58' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.926ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:23:11.621' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.247ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.045ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:23:11.66'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.139ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.954ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:23:11.775' AND status != 'pending'
	

2025/06/26 14:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[73.522ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:23:11.854' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:23:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.410ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:23:11.927'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:24:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.171ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:24:10.765'

2025/06/26 14:24:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.250ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:09:10.765' LIMIT 50

2025/06/26 14:24:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.991ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:09:10.831' LIMIT 50

2025/06/26 14:24:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.167ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:24:10.765'

2025/06/26 14:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[296.267ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:24:10.765'

2025/06/26 14:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[219.371ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:54:11.259'

2025/06/26 14:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.193ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:24:11.479' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.607ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.877ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:54:11.543'

2025/06/26 14:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.133ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.435ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:24:11.621' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.612ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:24:11.627' AND status != 'pending'
	

2025/06/26 14:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.962ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.787ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:24:11.701' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.272ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.143ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:24:11.776' AND status != 'pending'
	

2025/06/26 14:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.604ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:24:11.776'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.512ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:24:11.854' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:24:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.083ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:24:11.932'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:25:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[168.638ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:25:10.765'

2025/06/26 14:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[95.174ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:25:10.765'

2025/06/26 14:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[132.812ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:25:10.765'

2025/06/26 14:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[133.141ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:55:11.26'

2025/06/26 14:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[137.099ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:25:11.393' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[121.534ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[191.221ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:55:11.543'

2025/06/26 14:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[82.218ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[151.894ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:25:11.734' AND status != 'pending'
	

2025/06/26 14:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[152.278ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:25:11.734' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[110.679ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:25:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[197.915ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:25:11.886' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:25:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[87.258ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:25:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[284.950ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:25:12.085'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:25:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[284.990ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:25:12.085' AND status != 'pending'
	

2025/06/26 14:25:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[91.904ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:25:12.37' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:25:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[92.934ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:25:12.462'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:26:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.034ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:26:10.765'

2025/06/26 14:26:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.529ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:11:10.765' LIMIT 50

2025/06/26 14:26:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.241ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:11:10.831' LIMIT 50

2025/06/26 14:26:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.439ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:26:10.765'

2025/06/26 14:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.508ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:26:10.765'

2025/06/26 14:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.028ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:56:11.259'

2025/06/26 14:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.272ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:26:11.336' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.593ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.685ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.016ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:26:11.492' AND status != 'pending'
	

2025/06/26 14:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.081ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:56:11.543'

2025/06/26 14:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.547ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:26:11.569' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.466ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:26:11.621' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.136ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:26:11.645'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.289ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.501ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.773ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:26:11.781' AND status != 'pending'
	

2025/06/26 14:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.467ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:26:11.861' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:26:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.125ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:26:11.942'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:27:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.034ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:27:10.764'

2025/06/26 14:27:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.240ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:27:10.764'

2025/06/26 14:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.052ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:27:10.764'

2025/06/26 14:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.244ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:57:11.259'

2025/06/26 14:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.075ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:27:11.338' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.267ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.288ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.917ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:27:11.502' AND status != 'pending'
	

2025/06/26 14:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.213ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:57:11.542'

2025/06/26 14:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.458ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:27:11.58' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.702ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:27:11.617' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.971ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.528ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:27:11.657'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.322ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.801ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:27:11.769' AND status != 'pending'
	

2025/06/26 14:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.594ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:27:11.844' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:27:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.392ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:27:11.919'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:28:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.562ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:28:10.764'

2025/06/26 14:28:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.020ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:13:10.764' LIMIT 50

2025/06/26 14:28:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[74.251ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:13:10.831' LIMIT 50

2025/06/26 14:28:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.939ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:28:10.764'

2025/06/26 14:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.760ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:28:10.764'

2025/06/26 14:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.718ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:58:11.259'

2025/06/26 14:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.321ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:28:11.338' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.251ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.303ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.882ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:28:11.49' AND status != 'pending'
	

2025/06/26 14:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.631ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:58:11.542'

2025/06/26 14:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.782ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:28:11.567' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.125ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:28:11.617' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.213ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:28:11.646'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.101ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.310ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.972ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:28:11.769' AND status != 'pending'
	

2025/06/26 14:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.541ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:28:11.844' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:28:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.092ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:28:11.921'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:29:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.782ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:29:10.764'

2025/06/26 14:29:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.069ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:29:10.764'

2025/06/26 14:29:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.925ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:29:10.764'

2025/06/26 14:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.326ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:59:11.258'

2025/06/26 14:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.081ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:29:11.338' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.623ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.672ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.008ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:29:11.491' AND status != 'pending'
	

2025/06/26 14:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[73.751ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 13:59:11.542'

2025/06/26 14:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.589ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:29:11.567' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.599ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:29:11.616' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.943ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:29:11.644'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.539ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.219ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.294ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:29:11.77' AND status != 'pending'
	

2025/06/26 14:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.595ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:29:11.846' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:29:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.713ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:29:11.924'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:30:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.926ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:15:10.763' LIMIT 50

2025/06/26 14:30:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.737ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:30:10.763'

2025/06/26 14:30:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.225ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:15:10.83' LIMIT 50

2025/06/26 14:30:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[73.951ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:30:10.763'

2025/06/26 14:30:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.092ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:30:10.763'

2025/06/26 14:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.095ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:00:11.258'

2025/06/26 14:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.405ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:30:11.337' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.870ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.338ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[165.319ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:30:11.497' AND status != 'pending'
	

2025/06/26 14:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[160.923ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:00:11.541'

2025/06/26 14:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.298ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:30:11.663' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[173.147ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:30:11.747'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[219.452ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:30:11.702' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:30:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[102.704ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:30:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[82.994ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:30:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.038ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:30:12.107' AND status != 'pending'
	

2025/06/26 14:30:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.589ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:30:12.19' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:30:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.192ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:30:12.274'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:31:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.100ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:31:10.763'

2025/06/26 14:31:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.002ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:31:10.763'

2025/06/26 14:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[82.867ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:31:10.763'

2025/06/26 14:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.286ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:01:11.257'

2025/06/26 14:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.519ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:31:11.336' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.052ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.670ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.443ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:31:11.494' AND status != 'pending'
	

2025/06/26 14:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.126ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:01:11.54'

2025/06/26 14:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.974ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:31:11.575' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.305ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:31:11.615' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.580ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.275ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:31:11.655'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.956ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.083ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:31:11.778' AND status != 'pending'
	

2025/06/26 14:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.974ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:31:11.853' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:31:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.051ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:31:11.928'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:32:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.335ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:32:10.828'

2025/06/26 14:32:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.609ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:17:10.828' LIMIT 50

2025/06/26 14:32:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.335ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:17:10.895' LIMIT 50

2025/06/26 14:32:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[75.760ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:32:10.828'

2025/06/26 14:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[74.913ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:32:10.828'

2025/06/26 14:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.295ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:02:11.323'

2025/06/26 14:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.142ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:32:11.401' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.411ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.583ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.728ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:32:11.554' AND status != 'pending'
	

2025/06/26 14:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[73.168ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:02:11.606'

2025/06/26 14:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[73.383ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:32:11.628' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[76.808ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:32:11.679' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.079ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:32:11.701'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.703ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.195ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.310ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:32:11.836' AND status != 'pending'
	

2025/06/26 14:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.124ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:32:11.915' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:32:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.155ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:32:11.99'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:33:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[75.607ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:33:10.828'

2025/06/26 14:33:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.354ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:33:10.828'

2025/06/26 14:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.783ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:33:10.828'

2025/06/26 14:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.954ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:03:11.323'

2025/06/26 14:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.505ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:33:11.401' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.015ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.773ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.674ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:33:11.556' AND status != 'pending'
	

2025/06/26 14:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.986ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:03:11.609'

2025/06/26 14:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[73.310ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:33:11.633' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.873ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:33:11.684' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.795ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:33:11.706'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.284ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.475ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.832ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:33:11.836' AND status != 'pending'
	

2025/06/26 14:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.381ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:33:11.912' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:33:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.860ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:33:11.99'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:34:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.497ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:19:10.829' LIMIT 50

2025/06/26 14:34:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.774ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:34:10.829'

2025/06/26 14:34:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.893ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:19:10.895' LIMIT 50

2025/06/26 14:34:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.678ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:34:10.829'

2025/06/26 14:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.618ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:34:10.829'

2025/06/26 14:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.312ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:04:11.324'

2025/06/26 14:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.379ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:34:11.399' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.551ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.023ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.618ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:34:11.552' AND status != 'pending'
	

2025/06/26 14:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.855ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:04:11.607'

2025/06/26 14:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.282ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:34:11.625' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.833ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:34:11.685' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.376ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:34:11.704'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.386ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.642ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.858ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:34:11.844' AND status != 'pending'
	

2025/06/26 14:34:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.313ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:34:11.927' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:34:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.127ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:34:12.011'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:35:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.681ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:35:10.83'

2025/06/26 14:35:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.724ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:35:10.83'

2025/06/26 14:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.513ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:35:10.83'

2025/06/26 14:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.109ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:05:11.324'

2025/06/26 14:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.225ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:35:11.406' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.956ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.709ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.554ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:35:11.567' AND status != 'pending'
	

2025/06/26 14:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.097ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:05:11.607'

2025/06/26 14:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.322ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:35:11.648' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.986ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:35:11.682' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.628ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.363ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:35:11.725'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.398ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.424ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:35:11.833' AND status != 'pending'
	

2025/06/26 14:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.210ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:35:11.908' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:35:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.706ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:35:11.989'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:36:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[74.920ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:36:10.83'

2025/06/26 14:36:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[77.808ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:21:10.831' LIMIT 50

2025/06/26 14:36:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[75.740ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:21:10.896' LIMIT 50

2025/06/26 14:36:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[74.321ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:36:10.83'

2025/06/26 14:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.684ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:36:10.83'

2025/06/26 14:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.418ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:06:11.328'

2025/06/26 14:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.638ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:36:11.409' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.195ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[54.873ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.188ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:36:11.578' AND status != 'pending'
	

2025/06/26 14:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.166ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:06:11.608'

2025/06/26 14:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.059ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:36:11.655' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.554ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:36:11.683' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.440ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:36:11.729'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.479ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.859ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.620ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:36:11.85' AND status != 'pending'
	

2025/06/26 14:36:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[185.623ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:36:11.93' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:36:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[157.288ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:36:12.115'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:37:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[77.833ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:37:10.831'

2025/06/26 14:37:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[74.927ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:37:10.831'

2025/06/26 14:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.123ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:37:10.831'

2025/06/26 14:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.215ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:07:11.325'

2025/06/26 14:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[76.025ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:37:11.401' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.670ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.065ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.960ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:37:11.552' AND status != 'pending'
	

2025/06/26 14:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[73.939ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:07:11.609'

2025/06/26 14:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[72.697ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:37:11.628' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.586ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:37:11.683' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.079ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:37:11.701'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.457ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.724ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.743ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:37:11.838' AND status != 'pending'
	

2025/06/26 14:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.930ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:37:11.913' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:37:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.740ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:37:11.992'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:38:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.509ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:23:10.831' LIMIT 50

2025/06/26 14:38:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.636ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:38:10.831'

2025/06/26 14:38:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.688ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:23:10.898' LIMIT 50

2025/06/26 14:38:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[74.111ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:38:10.831'

2025/06/26 14:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[74.987ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:38:10.831'

2025/06/26 14:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.672ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:08:11.326'

2025/06/26 14:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.566ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:38:11.401' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.331ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.418ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.700ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:38:11.556' AND status != 'pending'
	

2025/06/26 14:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.993ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:08:11.609'

2025/06/26 14:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.166ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:38:11.632' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.559ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:38:11.687' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.120ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:38:11.711'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.950ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.086ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.764ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:38:11.847' AND status != 'pending'
	

2025/06/26 14:38:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.763ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:38:11.926' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:38:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.134ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:38:12.006'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:39:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.235ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:39:10.832'

2025/06/26 14:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[83.074ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:39:10.832'

2025/06/26 14:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[79.064ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:39:10.832'

2025/06/26 14:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.270ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:09:11.327'

2025/06/26 14:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.221ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:39:11.406' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.523ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.560ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.128ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:39:11.566' AND status != 'pending'
	

2025/06/26 14:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.871ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:09:11.609'

2025/06/26 14:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.472ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:39:11.644' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.784ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:39:11.686' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.174ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.721ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:39:11.726'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.206ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.615ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:39:11.839' AND status != 'pending'
	

2025/06/26 14:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.944ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:39:11.918' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:39:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.035ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:39:11.993'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:40:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.082ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:40:10.832'

2025/06/26 14:40:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.308ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:25:10.833' LIMIT 50

2025/06/26 14:40:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[77.952ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:25:10.899' LIMIT 50

2025/06/26 14:40:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[74.223ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:40:10.832'

2025/06/26 14:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[74.556ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:40:10.832'

2025/06/26 14:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.144ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:10:11.327'

2025/06/26 14:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.144ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:40:11.403' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.676ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.852ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.470ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:40:11.557' AND status != 'pending'
	

2025/06/26 14:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.354ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:10:11.61'

2025/06/26 14:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.758ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:40:11.632' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.454ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:40:11.685' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.375ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:40:11.709'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.434ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.192ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.138ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:40:11.834' AND status != 'pending'
	

2025/06/26 14:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.259ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:40:11.912' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:40:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.547ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:40:11.989'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:41:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[75.189ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:41:10.833'

2025/06/26 14:41:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.529ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:41:10.833'

2025/06/26 14:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.184ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:41:10.833'

2025/06/26 14:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.533ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:11:11.328'

2025/06/26 14:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.626ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:41:11.402' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.173ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.946ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.522ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:41:11.558' AND status != 'pending'
	

2025/06/26 14:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.995ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:11:11.611'

2025/06/26 14:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.108ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:41:11.635' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.348ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:41:11.686' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.408ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:41:11.71'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.377ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.589ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.299ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:41:11.837' AND status != 'pending'
	

2025/06/26 14:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.836ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:41:11.913' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:41:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.591ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:41:11.991'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:42:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.969ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:42:10.834'

2025/06/26 14:42:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.385ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:27:10.834' LIMIT 50

2025/06/26 14:42:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.947ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:27:10.901' LIMIT 50

2025/06/26 14:42:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.030ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:42:10.834'

2025/06/26 14:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.156ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:42:10.834'

2025/06/26 14:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.888ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:12:11.328'

2025/06/26 14:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.970ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:42:11.403' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.421ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.988ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.467ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:42:11.552' AND status != 'pending'
	

2025/06/26 14:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.900ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:12:11.612'

2025/06/26 14:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[72.414ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:42:11.628' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.169ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:42:11.7'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.064ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:42:11.696' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.917ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.994ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.949ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:42:11.858' AND status != 'pending'
	

2025/06/26 14:42:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.941ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:42:11.942' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:42:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.314ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:42:12.021'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:43:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.719ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:43:10.834'

2025/06/26 14:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.718ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:43:10.834'

2025/06/26 14:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[104.323ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:43:10.834'

2025/06/26 14:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[289.879ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:13:11.328'

2025/06/26 14:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[136.691ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:13:11.612'

2025/06/26 14:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[132.203ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:43:11.618' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.276ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.354ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:43:11.749' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.058ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.345ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.284ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:43:11.831' AND status != 'pending'
	

2025/06/26 14:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[49.199ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.637ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:43:11.91' AND status != 'pending'
	

2025/06/26 14:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.412ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:43:11.91' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:43:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.616ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:43:11.988' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:43:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.478ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:43:11.99'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:43:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.408ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:43:12.067'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:44:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[79.659ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 14:44:10.835' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/26 14:44:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.832ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:44:10.835'

2025/06/26 14:44:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.327ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:29:10.835' LIMIT 50

2025/06/26 14:44:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[36.592ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-19 14:44:10.916'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/26 14:44:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[74.571ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:44:10.835'

2025/06/26 14:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.111ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:44:10.835'

2025/06/26 14:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[263.059ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:29:10.901' LIMIT 50

2025/06/26 14:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[287.171ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 14:44:10.901' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/26 14:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[47.164ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-19 14:44:11.188'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/26 14:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[93.571ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:14:11.329'

2025/06/26 14:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[94.169ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:44:11.423' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[49.968ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.673ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.228ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:14:11.613'

2025/06/26 14:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[92.507ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:44:11.614' AND status != 'pending'
	

2025/06/26 14:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.852ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:44:11.702' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[91.912ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:44:11.707' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.616ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.261ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[94.751ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:44:11.799'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.865ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:44:11.875' AND status != 'pending'
	

2025/06/26 14:44:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.148ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:44:11.96' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:44:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.005ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:44:12.051'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:45:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.794ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:45:10.835'

2025/06/26 14:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[85.483ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:45:10.835'

2025/06/26 14:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[92.579ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:45:10.835'

2025/06/26 14:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.822ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:15:11.33'

2025/06/26 14:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.338ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:45:11.414' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.504ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.420ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.542ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:45:11.584' AND status != 'pending'
	

2025/06/26 14:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[94.100ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:15:11.613'

2025/06/26 14:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.989ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:45:11.669' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.085ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:45:11.707' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.961ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:45:11.752'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.780ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.370ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.514ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:45:11.89' AND status != 'pending'
	

2025/06/26 14:45:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[93.019ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:45:11.981' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:45:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[94.461ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:45:12.075'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:46:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.038ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:31:10.836' LIMIT 50

2025/06/26 14:46:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[94.363ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:46:10.836'

2025/06/26 14:46:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[76.933ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:31:10.903' LIMIT 50

2025/06/26 14:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[91.916ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:46:10.836'

2025/06/26 14:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[93.354ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:46:10.836'

2025/06/26 14:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[94.146ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:16:11.33'

2025/06/26 14:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[94.387ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:46:11.425' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.715ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.639ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.435ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:16:11.613'

2025/06/26 14:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.645ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:46:11.609' AND status != 'pending'
	

2025/06/26 14:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.343ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:46:11.689' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[92.708ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:46:11.699' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.368ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.373ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.594ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:46:11.791'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.733ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:46:11.837' AND status != 'pending'
	

2025/06/26 14:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.608ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:46:11.914' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:46:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.883ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:46:11.992'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:47:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[119.733ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:47:10.836'

2025/06/26 14:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[83.473ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:47:10.836'

2025/06/26 14:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[82.809ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:47:10.836'

2025/06/26 14:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.824ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:17:11.331'

2025/06/26 14:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.936ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:47:11.407' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[59.317ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.046ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[101.818ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:47:11.597' AND status != 'pending'
	

2025/06/26 14:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[102.805ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:17:11.614'

2025/06/26 14:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[101.933ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:47:11.699' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[103.190ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:47:11.717' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[48.222ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.289ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:47:11.801'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[48.705ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:47:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[104.449ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:47:11.918' AND status != 'pending'
	

2025/06/26 14:47:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[128.207ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:47:12.022' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:47:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[138.976ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:47:12.151'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:48:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[76.399ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:33:10.837' LIMIT 50

2025/06/26 14:48:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[91.071ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:48:10.837'

2025/06/26 14:48:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.520ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:33:10.904' LIMIT 50

2025/06/26 14:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.682ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:48:10.837'

2025/06/26 14:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[94.668ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:48:10.837'

2025/06/26 14:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.868ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:18:11.331'

2025/06/26 14:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.654ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:48:11.422' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[48.065ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.793ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.531ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:48:11.606' AND status != 'pending'
	

2025/06/26 14:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.626ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:18:11.615'

2025/06/26 14:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.829ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:48:11.698' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.582ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:48:11.696' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.210ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.552ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.078ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:48:11.786'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.897ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:48:11.869' AND status != 'pending'
	

2025/06/26 14:48:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.692ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:48:11.955' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:48:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.941ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:48:12.042'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:49:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[88.147ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:49:10.837'

2025/06/26 14:49:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[83.559ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:49:10.837'

2025/06/26 14:49:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.448ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:49:10.837'

2025/06/26 14:49:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[101.694ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:19:11.332'

2025/06/26 14:49:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.042ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:49:11.434' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:49:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.355ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:49:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.101ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:49:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[203.438ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:49:11.603' AND status != 'pending'
	

2025/06/26 14:49:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[237.294ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:19:11.615'

2025/06/26 14:49:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[182.102ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:49:11.807' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:49:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[322.327ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:49:11.853' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:49:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[228.122ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:49:11.989'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:49:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.193ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:49:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[48.578ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:49:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.992ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:49:12.269' AND status != 'pending'
	

2025/06/26 14:49:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[94.655ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:49:12.361' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:49:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.079ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:49:12.455'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:50:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[102.782ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:50:10.838'

2025/06/26 14:50:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[106.034ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:35:10.838' LIMIT 50

2025/06/26 14:50:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[76.828ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:35:10.905' LIMIT 50

2025/06/26 14:50:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.853ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:50:10.838'

2025/06/26 14:50:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.269ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:50:10.838'

2025/06/26 14:50:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.246ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:20:11.333'

2025/06/26 14:50:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.938ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:50:11.417' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:50:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.085ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:50:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.613ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:50:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.410ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:50:11.587' AND status != 'pending'
	

2025/06/26 14:50:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.349ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:20:11.616'

2025/06/26 14:50:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.927ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:50:11.67' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:50:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.727ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:50:11.694' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:50:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.876ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:50:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.742ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:50:11.753'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:50:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.289ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:50:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.445ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:50:11.844' AND status != 'pending'
	

2025/06/26 14:50:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.361ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:50:11.922' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:50:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.785ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:50:11.998'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:51:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[75.405ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:51:10.839'

2025/06/26 14:51:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[75.183ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:51:10.839'

2025/06/26 14:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.350ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:51:10.839'

2025/06/26 14:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.273ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:21:11.333'

2025/06/26 14:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.918ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:51:11.408' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.681ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.418ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.975ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:51:11.557' AND status != 'pending'
	

2025/06/26 14:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.754ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:21:11.617'

2025/06/26 14:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[73.325ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:51:11.631' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.612ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:51:11.705'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.486ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:51:11.705' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.342ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.858ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.340ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:51:11.879' AND status != 'pending'
	

2025/06/26 14:51:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[97.009ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:51:11.963' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:51:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.045ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:51:12.06'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:52:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[75.170ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:37:10.839' LIMIT 50

2025/06/26 14:52:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.097ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:52:10.839'

2025/06/26 14:52:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[90.628ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:37:10.906' LIMIT 50

2025/06/26 14:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.329ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:52:10.839'

2025/06/26 14:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[82.871ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:52:10.839'

2025/06/26 14:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.329ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:22:11.334'

2025/06/26 14:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.767ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:52:11.421' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.069ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.119ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.767ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:52:11.588' AND status != 'pending'
	

2025/06/26 14:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.985ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:22:11.617'

2025/06/26 14:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.513ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:52:11.671' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[94.177ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:52:11.708' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.598ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:52:11.758'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.166ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[49.319ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.815ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:52:11.897' AND status != 'pending'
	

2025/06/26 14:52:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[96.543ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:52:11.988' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:52:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[92.865ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:52:12.085'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:53:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[92.778ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:53:10.84'

2025/06/26 14:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[94.899ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:53:10.84'

2025/06/26 14:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[105.327ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:53:10.84'

2025/06/26 14:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[94.906ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:23:11.334'

2025/06/26 14:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[94.950ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:53:11.429' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.900ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.748ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[91.117ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:23:11.617'

2025/06/26 14:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[95.346ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:53:11.615' AND status != 'pending'
	

2025/06/26 14:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.555ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:53:11.708' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.816ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:53:11.71' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.677ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.628ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.396ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:53:11.801'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.809ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:53:11.885' AND status != 'pending'
	

2025/06/26 14:53:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.407ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:53:11.973' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:53:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.225ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:53:12.06'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:54:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[88.130ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:54:10.84'

2025/06/26 14:54:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[91.111ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:39:10.84' LIMIT 50

2025/06/26 14:54:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[74.115ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:39:10.906' LIMIT 50

2025/06/26 14:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.286ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:54:10.84'

2025/06/26 14:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.903ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:54:10.84'

2025/06/26 14:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.392ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:24:11.335'

2025/06/26 14:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.149ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:54:11.42' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.305ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.128ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.324ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:54:11.59' AND status != 'pending'
	

2025/06/26 14:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.187ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:24:11.618'

2025/06/26 14:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.744ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:54:11.672' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.653ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:54:11.699' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.633ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.999ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:54:11.755'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.043ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.856ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:54:11.854' AND status != 'pending'
	

2025/06/26 14:54:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.750ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:54:11.934' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:54:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.831ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:54:12.012'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:55:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.336ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:55:10.841'

2025/06/26 14:55:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.733ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:55:10.841'

2025/06/26 14:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[79.351ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:55:10.841'

2025/06/26 14:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.471ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:25:11.336'

2025/06/26 14:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.630ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:55:11.414' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.672ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.099ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.130ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:55:11.57' AND status != 'pending'
	

2025/06/26 14:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.236ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:25:11.619'

2025/06/26 14:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.173ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:55:11.647' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.373ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:55:11.702' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.155ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:55:11.726'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.475ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.322ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.902ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:55:11.876' AND status != 'pending'
	

2025/06/26 14:55:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.001ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:55:11.963' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:55:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.406ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:55:12.047'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:56:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[122.096ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:41:10.842' LIMIT 50

2025/06/26 14:56:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[123.173ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:56:10.841'

2025/06/26 14:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[196.799ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:41:10.908' LIMIT 50

2025/06/26 14:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[276.158ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:56:10.841'

2025/06/26 14:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[137.173ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:56:10.841'

2025/06/26 14:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[92.786ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:26:11.336'

2025/06/26 14:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[92.563ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:56:11.429' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[48.877ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.078ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.340ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:26:11.619'

2025/06/26 14:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.360ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:56:11.617' AND status != 'pending'
	

2025/06/26 14:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.432ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:56:11.7' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[91.329ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:56:11.707' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.506ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.154ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[96.005ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:56:11.798'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.699ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:56:11.869' AND status != 'pending'
	

2025/06/26 14:56:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.810ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:56:11.951' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:56:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.493ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:56:12.035'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:57:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[88.161ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:57:10.842'

2025/06/26 14:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[83.971ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:57:10.842'

2025/06/26 14:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.230ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:57:10.842'

2025/06/26 14:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.960ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:27:11.337'

2025/06/26 14:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.698ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:57:11.423' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.102ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.065ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.140ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:57:11.595' AND status != 'pending'
	

2025/06/26 14:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[94.070ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:27:11.62'

2025/06/26 14:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.937ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:57:11.677' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[98.110ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:57:11.714' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.004ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:57:11.766'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.602ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[47.761ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.559ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:57:11.906' AND status != 'pending'
	

2025/06/26 14:57:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[101.145ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:57:11.998' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:57:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[96.992ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:57:12.099'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:58:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.560ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:43:10.843' LIMIT 50

2025/06/26 14:58:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[91.890ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:58:10.843'

2025/06/26 14:58:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[74.484ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:43:10.91' LIMIT 50

2025/06/26 14:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.812ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:58:10.843'

2025/06/26 14:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[103.222ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:58:10.843'

2025/06/26 14:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[95.638ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:28:11.337'

2025/06/26 14:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[95.022ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:58:11.433' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.214ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.668ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.596ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:28:11.62'

2025/06/26 14:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.375ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:58:11.617' AND status != 'pending'
	

2025/06/26 14:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.461ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:58:11.697' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.746ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:58:11.707' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.477ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.484ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[92.756ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:58:11.797'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.084ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:58:11.851' AND status != 'pending'
	

2025/06/26 14:58:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.584ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:58:11.928' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:58:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.036ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:58:12.007'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:59:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.604ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 14:59:10.843'

2025/06/26 14:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[75.596ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 14:59:10.843'

2025/06/26 14:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[82.188ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 14:59:10.843'

2025/06/26 14:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[224.864ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:29:11.338'

2025/06/26 14:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.136ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:59:11.563' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.489ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[109.650ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:29:11.621'

2025/06/26 14:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.960ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.417ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:59:11.731' AND status != 'pending'
	

2025/06/26 14:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[92.144ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 13:59:11.731' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 14:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.057ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 14:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.654ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:59:11.809' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[48.109ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 14:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.403ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:59:11.886'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 14:59:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[95.343ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 13:59:11.917' AND status != 'pending'
	

2025/06/26 14:59:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[91.358ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 13:59:12.012' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 14:59:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[95.542ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 13:59:12.104'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:00:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.855ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:45:10.844' LIMIT 50

2025/06/26 15:00:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[91.444ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:00:10.844'

2025/06/26 15:00:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.192ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:45:10.911' LIMIT 50

2025/06/26 15:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[91.419ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:00:10.844'

2025/06/26 15:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[95.408ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:00:10.844'

2025/06/26 15:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[95.055ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:30:11.338'

2025/06/26 15:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[93.043ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:00:11.434' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.157ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.556ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.815ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:30:11.621'

2025/06/26 15:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.695ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:00:11.618' AND status != 'pending'
	

2025/06/26 15:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.071ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:00:11.705' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.626ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:00:11.708' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.981ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.725ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.732ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:00:11.796'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.328ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:00:11.878' AND status != 'pending'
	

2025/06/26 15:00:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.105ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:00:11.966' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:00:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.569ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:00:12.05'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:00:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[90.904ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/26 15:00:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[43.590ms] [rows:20] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/26 15:00:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[42.521ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 15:00:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.989ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 15:00:28 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.875ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 15:00:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.880ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 15:00:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.900ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 15:00:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.142ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 15:00:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.903ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 15:00:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.745ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 15:00:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.085ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 15:00:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.869ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 15:00:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.032ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 15:00:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[84.708ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 15:00:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.965ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 15:00:30 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[86.773ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 15:00:30 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[44.329ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 15:00:30 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[82.263ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 15:00:39 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[84.301ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 15:00:39 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[44.640ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 15:00:39 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[83.533ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 15:00:47 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[86.776ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 15:00:47 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[41.993ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 15:00:47 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[88.974ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 15:01:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.081ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:01:10.844'

2025/06/26 15:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.833ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:01:10.844'

2025/06/26 15:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[84.036ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:01:10.844'

2025/06/26 15:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.576ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:31:11.338'

2025/06/26 15:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.576ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:01:11.423' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.212ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.294ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.839ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:01:11.591' AND status != 'pending'
	

2025/06/26 15:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[93.437ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:31:11.622'

2025/06/26 15:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.284ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:01:11.674' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[94.424ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:01:11.716' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.520ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:01:11.757'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.105ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.950ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:01:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[92.080ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:01:11.903' AND status != 'pending'
	

2025/06/26 15:01:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[97.737ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:01:11.995' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:01:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.406ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:01:12.093'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:02:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.872ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:47:10.845' LIMIT 50

2025/06/26 15:02:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.648ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:02:10.845'

2025/06/26 15:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[92.636ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:02:10.845'

2025/06/26 15:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[94.038ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:02:10.845'

2025/06/26 15:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[274.741ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:47:10.912' LIMIT 50

2025/06/26 15:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.918ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:32:11.34'

2025/06/26 15:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.670ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:02:11.424' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.317ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.829ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.075ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:02:11.592' AND status != 'pending'
	

2025/06/26 15:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[112.979ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:32:11.623'

2025/06/26 15:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[98.303ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:02:11.678' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[99.271ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:02:11.736' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.516ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:02:11.777'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.367ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:02:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[49.184ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:02:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[93.874ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:02:11.929' AND status != 'pending'
	

2025/06/26 15:02:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[102.288ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:02:12.023' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:02:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[264.190ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:02:12.126'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:02:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[96.338ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 15:02:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[45.037ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 15:02:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[95.215ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 15:03:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[94.689ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:03:10.845'

2025/06/26 15:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[94.997ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:03:10.845'

2025/06/26 15:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[91.903ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:03:10.845'

2025/06/26 15:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.657ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:33:11.34'

2025/06/26 15:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.463ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:03:11.431' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.392ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.660ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.870ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:33:11.623'

2025/06/26 15:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[94.093ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:03:11.612' AND status != 'pending'
	

2025/06/26 15:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.482ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:03:11.705' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.327ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:03:11.706' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.776ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.752ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.464ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:03:11.796'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:03:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.230ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:03:11.872' AND status != 'pending'
	

2025/06/26 15:03:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.203ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:03:11.954' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:03:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.510ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:03:12.037'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:04:01 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[41.307ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 15:04:01 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.456ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 15:04:01 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.397ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 15:04:01 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.481ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 15:04:01 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[81.490ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 15:04:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.114ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 15:04:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.836ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 15:04:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.191ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 15:04:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.494ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 15:04:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.623ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 15:04:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.596ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 15:04:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[84.038ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 15:04:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.240ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 15:04:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[80.329ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 15:04:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[39.516ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 15:04:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[80.384ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 15:04:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.631ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:04:10.846'

2025/06/26 15:04:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[91.491ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:49:10.846' LIMIT 50

2025/06/26 15:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[88.287ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:49:10.912' LIMIT 50

2025/06/26 15:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.907ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:04:10.846'

2025/06/26 15:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[82.885ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:04:10.846'

2025/06/26 15:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.428ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:34:11.341'

2025/06/26 15:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.475ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:04:11.429' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.510ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.299ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.374ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:04:11.595' AND status != 'pending'
	

2025/06/26 15:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.082ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:34:11.624'

2025/06/26 15:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.234ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:04:11.675' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.266ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:04:11.708' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.108ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:04:11.756'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.603ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.165ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:04:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.803ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:04:11.882' AND status != 'pending'
	

2025/06/26 15:04:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.119ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:04:11.967' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:04:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.061ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:04:12.055'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:05:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.078ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:05:10.846'

2025/06/26 15:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.288ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:05:10.846'

2025/06/26 15:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[88.758ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:05:10.846'

2025/06/26 15:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.897ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:35:11.341'

2025/06/26 15:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.593ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:05:11.425' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.084ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.130ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.482ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:05:11.592' AND status != 'pending'
	

2025/06/26 15:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.425ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:35:11.625'

2025/06/26 15:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.479ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:05:11.679' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.841ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:05:11.709' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.814ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.250ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:05:11.762'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.824ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:05:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.387ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:05:11.878' AND status != 'pending'
	

2025/06/26 15:05:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.136ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:05:11.963' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:05:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.246ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:05:12.05'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:06:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[88.051ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 15:06:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[51.056ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 15:06:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[81.931ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 15:06:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[89.130ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:51:10.847' LIMIT 50

2025/06/26 15:06:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[89.297ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:06:10.847'

2025/06/26 15:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[91.906ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:51:10.914' LIMIT 50

2025/06/26 15:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.817ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:06:10.847'

2025/06/26 15:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[84.479ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:06:10.847'

2025/06/26 15:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.051ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:36:11.342'

2025/06/26 15:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.699ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:06:11.427' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.960ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.331ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.623ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:06:11.592' AND status != 'pending'
	

2025/06/26 15:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[93.409ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:36:11.625'

2025/06/26 15:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.803ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:06:11.675' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.810ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:06:11.718' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.431ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:06:11.758'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.152ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[49.665ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:06:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.104ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:06:11.905' AND status != 'pending'
	

2025/06/26 15:06:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[92.238ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:06:11.997' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:06:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[94.663ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:06:12.089'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:07:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[91.769ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:07:10.848'

2025/06/26 15:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[91.250ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:07:10.848'

2025/06/26 15:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[91.317ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:07:10.848'

2025/06/26 15:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[91.531ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:37:11.342'

2025/06/26 15:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.313ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:07:11.434' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.277ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.922ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.577ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:07:11.616' AND status != 'pending'
	

2025/06/26 15:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.449ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:37:11.626'

2025/06/26 15:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.071ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:07:11.708' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.446ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:07:11.706' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.442ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.729ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.026ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:07:11.796'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:07:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.091ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:07:11.881' AND status != 'pending'
	

2025/06/26 15:07:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[92.726ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:07:11.967' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:07:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.193ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:07:12.06'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:08:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[88.313ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:08:10.848'

2025/06/26 15:08:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[96.226ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:53:10.848' LIMIT 50

2025/06/26 15:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.517ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:53:10.915' LIMIT 50

2025/06/26 15:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.279ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:08:10.848'

2025/06/26 15:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.214ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:08:10.848'

2025/06/26 15:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.992ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:38:11.343'

2025/06/26 15:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.208ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:08:11.427' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.352ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.779ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.505ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:08:11.598' AND status != 'pending'
	

2025/06/26 15:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.654ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:38:11.625'

2025/06/26 15:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.931ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:08:11.683' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.488ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:08:11.706' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.523ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.295ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:08:11.766'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.497ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:08:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.890ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:08:11.873' AND status != 'pending'
	

2025/06/26 15:08:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.551ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:08:11.954' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:08:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.582ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:08:12.036'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[191.052ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:09:10.849'

2025/06/26 15:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[254.348ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:09:10.849'

2025/06/26 15:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[131.779ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:09:10.849'

2025/06/26 15:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[121.516ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:39:11.343'

2025/06/26 15:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.204ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:09:11.465' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.528ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.777ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.300ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:39:11.627'

2025/06/26 15:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.394ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:09:11.633' AND status != 'pending'
	

2025/06/26 15:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.425ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:09:11.706' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.685ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:09:11.718' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.816ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.816ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.307ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:09:11.805'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:09:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.835ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:09:11.87' AND status != 'pending'
	

2025/06/26 15:09:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.247ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:09:11.95' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:09:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.772ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:09:12.03'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:10:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[126.314ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:10:10.853'

2025/06/26 15:10:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[128.405ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:55:10.851' LIMIT 50

2025/06/26 15:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[191.567ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:55:10.935' LIMIT 50

2025/06/26 15:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[202.023ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:10:10.853'

2025/06/26 15:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[233.518ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:10:10.853'

2025/06/26 15:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[159.315ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:40:11.36'

2025/06/26 15:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[64.778ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 15:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[117.368ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:10:11.519' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[101.574ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[157.141ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 15:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[186.527ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:40:11.637'

2025/06/26 15:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[86.781ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[131.116ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 15:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[126.646ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:10:11.828' AND status != 'pending'
	

2025/06/26 15:10:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[131.447ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:10:11.823' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:10:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[130.773ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 15:10:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[78.469ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:10:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[131.856ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:10:11.955' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:10:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[53.334ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:10:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[151.941ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 15:10:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[131.904ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:10:12.087'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:10:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[131.907ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:10:12.087' AND status != 'pending'
	

2025/06/26 15:10:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[113.257ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 15:10:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[165.914ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:10:12.219' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:10:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[116.001ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 15:10:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[100.522ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 15:10:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[151.918ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:10:12.385'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:10:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[172.151ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 15:10:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[106.092ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 15:10:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[115.702ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 15:10:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[103.354ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 15:10:13 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.357ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 15:10:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[82.914ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 15:10:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[66.863ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 15:10:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[110.652ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 15:10:20 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[74.863ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 15:10:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[174.932ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/26 15:10:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:139
[84.703ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 15:10:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[40.715ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 15:10:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[81.206ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/26 15:10:31 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:139
[84.747ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/26 15:10:31 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[41.260ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 15:10:31 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[84.112ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/26 15:10:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:139
[81.994ms] [rows:1] SELECT * FROM `user` WHERE id = 12 ORDER BY `user`.`id` LIMIT 1

2025/06/26 15:10:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[40.695ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 15:10:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[87.135ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/26 15:10:38 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:74
[82.489ms] [rows:1] SELECT * FROM `user` WHERE id = 12 ORDER BY `user`.`id` LIMIT 1

2025/06/26 15:10:38 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:91
[171.232ms] [rows:1] UPDATE `user` SET `avatar`='https://ark-auto-2102366935-cn-beijing-default.tos-cn-beijing.volces.com/uploads/20250619230133000.jpg',`enable`='disable',`phone`='16620436581',`role_id`=5,`sex`=0,`update_time`='2025-06-26 15:10:38.435',`user_type`=3,`username`='松鼠上架员' WHERE `id` = 12

2025/06/26 15:10:38 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[81.303ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 15:10:38 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[43.486ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 15:10:39 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[81.274ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 15:10:40 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:139
[81.807ms] [rows:1] SELECT * FROM `user` WHERE id = 12 ORDER BY `user`.`id` LIMIT 1

2025/06/26 15:10:40 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[40.875ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 15:10:40 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[84.509ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/26 15:10:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[41.292ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 15:10:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[87.045ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/26 15:11:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:38
[41.133ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/26 15:11:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:44
[84.352ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/26 15:11:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.016ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:11:10.85'

2025/06/26 15:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[83.097ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:11:10.85'

2025/06/26 15:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.362ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:11:10.85'

2025/06/26 15:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.653ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:41:11.345'

2025/06/26 15:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.901ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:11:11.428' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.869ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.968ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.537ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:11:11.593' AND status != 'pending'
	

2025/06/26 15:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.696ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:41:11.628'

2025/06/26 15:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.457ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:11:11.673' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.834ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:11:11.715' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.627ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:11:11.753'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.111ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.871ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:11:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.602ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:11:11.886' AND status != 'pending'
	

2025/06/26 15:11:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.581ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:11:11.972' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:11:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.056ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:11:12.059'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:11:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:38
[42.357ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/26 15:11:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:44
[88.310ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/26 15:12:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.710ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:57:10.851' LIMIT 50

2025/06/26 15:12:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.795ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:12:10.85'

2025/06/26 15:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[90.879ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:57:10.917' LIMIT 50

2025/06/26 15:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.226ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:12:10.85'

2025/06/26 15:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[88.424ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:12:10.85'

2025/06/26 15:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.189ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:42:11.345'

2025/06/26 15:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.782ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:12:11.434' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.666ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.097ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.509ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:12:11.602' AND status != 'pending'
	

2025/06/26 15:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[94.066ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:42:11.628'

2025/06/26 15:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.020ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:12:11.685' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[94.549ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:12:11.722' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.249ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:12:11.771'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.326ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:12:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.177ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:12:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[93.046ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:12:11.907' AND status != 'pending'
	

2025/06/26 15:12:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[95.044ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:12:12' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:12:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[96.236ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:12:12.095'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:12:42 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:38
[46.355ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/26 15:12:42 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:44
[93.830ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/26 15:13:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[92.424ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:13:10.851'

2025/06/26 15:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[91.030ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:13:10.851'

2025/06/26 15:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[96.179ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:13:10.851'

2025/06/26 15:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[95.879ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:43:11.346'

2025/06/26 15:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[99.261ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:13:11.442' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.175ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.075ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.293ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:43:11.629'

2025/06/26 15:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.546ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:13:11.633' AND status != 'pending'
	

2025/06/26 15:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.512ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:13:11.717' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.704ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:13:11.722' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.561ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.365ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.522ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:13:11.812'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:13:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.180ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:13:11.889' AND status != 'pending'
	

2025/06/26 15:13:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.561ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:13:11.974' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:13:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.846ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:13:12.061'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:14:06 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:38
[41.753ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/26 15:14:06 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:44
[85.214ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/26 15:14:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.954ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:14:10.852'

2025/06/26 15:14:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[94.744ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:59:10.852' LIMIT 50

2025/06/26 15:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.500ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:59:10.918' LIMIT 50

2025/06/26 15:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[92.745ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:14:10.852'

2025/06/26 15:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.203ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:14:10.852'

2025/06/26 15:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.836ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:44:11.346'

2025/06/26 15:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.595ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:14:11.434' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.218ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.189ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.973ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:14:11.606' AND status != 'pending'
	

2025/06/26 15:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.489ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:44:11.629'

2025/06/26 15:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.106ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:14:11.692' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.305ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:14:11.71' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.471ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.902ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:14:11.778'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.548ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:14:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.441ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:14:11.872' AND status != 'pending'
	

2025/06/26 15:14:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.253ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:14:11.957' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:14:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.420ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:14:12.038'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[45.213ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 15:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.534ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 15:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.542ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 15:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.178ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 15:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.842ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 15:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.375ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 15:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.138ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 15:14:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.734ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 15:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.023ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 15:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.022ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 15:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.098ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 15:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.467ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 15:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[81.424ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 15:14:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:38
[40.416ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/26 15:14:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:44
[83.279ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/26 15:14:19 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:38
[40.011ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/26 15:14:19 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:44
[80.792ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/26 15:15:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[81.212ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 1

2025/06/26 15:15:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[85.205ms] [rows:1] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 1 ORDER BY create_time DESC LIMIT 10

2025/06/26 15:15:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:97
[82.149ms] [rows:1] SELECT * FROM `goods_list` WHERE id = 3 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/26 15:15:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.523ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:15:10.852'

2025/06/26 15:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.686ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:15:10.852'

2025/06/26 15:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.717ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:15:10.852'

2025/06/26 15:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[109.205ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:45:11.347'

2025/06/26 15:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.609ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:15:11.456' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.772ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[166.708ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:15:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[237.093ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:45:11.63'

2025/06/26 15:15:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[259.330ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:15:11.745' AND status != 'pending'
	

2025/06/26 15:15:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[218.605ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:15:11.867' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:15:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[122.659ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:15:12.004' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:15:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.061ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:15:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.754ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:15:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.555ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:15:12.127'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:15:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.981ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:15:12.17' AND status != 'pending'
	

2025/06/26 15:15:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.176ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:15:12.257' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:15:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.654ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:15:12.346'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:15:19 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:38
[42.663ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/26 15:15:19 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:44
[82.813ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/26 15:15:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:38
[41.867ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/26 15:15:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:44
[84.225ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/26 15:16:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[92.401ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:01:10.853' LIMIT 50

2025/06/26 15:16:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[93.798ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:16:10.853'

2025/06/26 15:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[90.526ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:01:10.92' LIMIT 50

2025/06/26 15:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[85.268ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:16:10.853'

2025/06/26 15:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[84.172ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:16:10.853'

2025/06/26 15:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.097ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:46:11.346'

2025/06/26 15:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.014ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:16:11.431' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.000ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.029ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.532ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:16:11.597' AND status != 'pending'
	

2025/06/26 15:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[92.662ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:46:11.631'

2025/06/26 15:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.167ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:16:11.68' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.074ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:16:11.723' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.717ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:16:11.763'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.021ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.873ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:16:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.251ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:16:11.906' AND status != 'pending'
	

2025/06/26 15:16:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[95.451ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:16:11.997' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:16:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[92.509ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:16:12.093'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:16:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:38
[46.088ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/26 15:16:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:44
[90.709ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/26 15:16:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[92.483ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/26 15:16:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[46.654ms] [rows:20] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/26 15:16:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[45.884ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 15:16:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[95.091ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 15:16:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[90.402ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 15:16:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[93.290ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 15:16:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.905ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 15:16:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[90.727ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 15:16:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[90.080ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 15:16:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.782ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 15:16:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.939ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 15:16:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.530ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 15:16:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.549ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 15:16:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[93.577ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 15:16:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.891ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 15:16:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:38
[46.090ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/26 15:16:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:44
[89.763ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/26 15:17:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[94.343ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:17:10.853'

2025/06/26 15:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[91.260ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:17:10.853'

2025/06/26 15:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[91.108ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:17:10.853'

2025/06/26 15:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[94.008ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:47:11.348'

2025/06/26 15:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.401ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:17:11.442' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.364ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.974ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[93.012ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:17:11.623' AND status != 'pending'
	

2025/06/26 15:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.771ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:47:11.631'

2025/06/26 15:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.333ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:17:11.717' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.337ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:17:11.716' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.092ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.978ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.672ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:17:11.806'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:17:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.815ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:17:11.884' AND status != 'pending'
	

2025/06/26 15:17:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.062ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:17:11.974' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:17:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.073ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:17:12.058'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:17:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[43.309ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 15:17:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.482ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 15:17:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.508ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 15:17:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.444ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 15:17:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.968ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 15:17:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.178ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 15:17:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.236ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 15:17:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.262ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 15:17:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.629ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 15:17:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[84.866ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 15:17:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.908ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 15:17:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.482ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 15:17:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.228ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 15:17:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:38
[41.477ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/26 15:17:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:44
[83.071ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/26 15:18:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[89.261ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:18:10.854'

2025/06/26 15:18:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[91.891ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:03:10.854' LIMIT 50

2025/06/26 15:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.905ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:03:10.92' LIMIT 50

2025/06/26 15:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[83.957ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:18:10.854'

2025/06/26 15:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[88.394ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:18:10.854'

2025/06/26 15:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.771ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:48:11.348'

2025/06/26 15:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.716ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:18:11.436' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.797ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.638ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.107ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:18:11.608' AND status != 'pending'
	

2025/06/26 15:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.348ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:48:11.632'

2025/06/26 15:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.452ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:18:11.694' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.572ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:18:11.715' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.433ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.947ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:18:11.78'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.453ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:18:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.029ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:18:11.885' AND status != 'pending'
	

2025/06/26 15:18:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.879ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:18:11.973' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:18:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.554ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:18:12.055'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:18:20 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:38
[40.728ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/26 15:18:20 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:44
[84.898ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/26 15:18:32 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:38
[44.118ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/26 15:18:32 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:44
[81.370ms] [rows:10] SELECT * FROM `app_user` LIMIT 10 OFFSET 10

2025/06/26 15:18:34 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:38
[40.626ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/26 15:18:34 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:44
[83.950ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/26 15:19:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[82.344ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 1

2025/06/26 15:19:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[186.739ms] [rows:1] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 1 ORDER BY create_time DESC LIMIT 10

2025/06/26 15:19:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.059ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:19:10.854'

2025/06/26 15:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.861ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:19:10.854'

2025/06/26 15:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.240ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:19:10.854'

2025/06/26 15:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.765ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:49:11.349'

2025/06/26 15:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.051ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:19:11.432' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.005ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.315ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.516ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:19:11.601' AND status != 'pending'
	

2025/06/26 15:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.309ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:49:11.632'

2025/06/26 15:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.137ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:19:11.681' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.200ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:19:11.72' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.598ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:19:11.76'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.815ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.423ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:19:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.509ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:19:11.894' AND status != 'pending'
	

2025/06/26 15:19:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.163ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:19:11.981' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:19:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.203ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:19:12.069'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:20:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[87.272ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 1

2025/06/26 15:20:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[87.411ms] [rows:1] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 1 ORDER BY create_time DESC LIMIT 10

2025/06/26 15:20:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[86.201ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:05:10.855' LIMIT 50

2025/06/26 15:20:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.795ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:20:10.855'

2025/06/26 15:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[92.092ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:05:10.922' LIMIT 50

2025/06/26 15:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.988ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:20:10.855'

2025/06/26 15:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[89.192ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:20:10.855'

2025/06/26 15:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.264ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:50:11.35'

2025/06/26 15:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.995ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:20:11.434' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.465ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.725ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.089ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:20:11.606' AND status != 'pending'
	

2025/06/26 15:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.527ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:50:11.633'

2025/06/26 15:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.087ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:20:11.692' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.338ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:20:11.723' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.423ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:20:11.776'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.237ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:20:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[48.834ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:20:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.059ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:20:11.909' AND status != 'pending'
	

2025/06/26 15:20:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[92.016ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:20:12' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:20:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[98.464ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:20:12.093'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:20:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[46.561ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 15:20:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[90.980ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 15:20:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[93.901ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 15:20:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.287ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 15:20:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[94.478ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 15:20:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.609ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 15:20:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[93.653ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 15:20:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[93.912ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 15:20:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.814ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 15:20:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.518ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 15:20:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[94.262ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 15:20:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.733ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 15:20:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.508ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 15:20:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[96.086ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 1

2025/06/26 15:20:19 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[90.462ms] [rows:1] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 1 ORDER BY create_time DESC LIMIT 10

2025/06/26 15:21:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[91.815ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:21:10.855'

2025/06/26 15:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[93.947ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:21:10.855'

2025/06/26 15:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[93.757ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:21:10.855'

2025/06/26 15:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[94.614ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:51:11.35'

2025/06/26 15:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[97.038ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:21:11.445' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.885ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.785ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[100.367ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:51:11.632'

2025/06/26 15:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[100.994ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:21:11.632' AND status != 'pending'
	

2025/06/26 15:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.785ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:21:11.733' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[99.408ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:21:11.733' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.905ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[63.657ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:21:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[93.038ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:21:11.833'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:21:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.909ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:21:11.926' AND status != 'pending'
	

2025/06/26 15:21:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.523ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:21:12.016' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:21:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[220.551ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:21:12.101'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:21:19 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[87.586ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 1

2025/06/26 15:21:19 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[84.073ms] [rows:1] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 1 ORDER BY create_time DESC LIMIT 10

2025/06/26 15:21:39 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[84.331ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 1

2025/06/26 15:21:39 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[87.709ms] [rows:1] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 1 ORDER BY create_time DESC LIMIT 10

2025/06/26 15:21:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[84.449ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 15:21:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[41.590ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 15:21:44 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[86.832ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 15:21:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[88.719ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 1

2025/06/26 15:21:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[84.980ms] [rows:1] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 1 ORDER BY create_time DESC LIMIT 10

2025/06/26 15:21:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[87.221ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 15:21:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[40.811ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 15:21:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[87.288ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 15:22:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[88.305ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:22:10.856'

2025/06/26 15:22:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[92.306ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:07:10.856' LIMIT 50

2025/06/26 15:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.243ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:07:10.923' LIMIT 50

2025/06/26 15:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.630ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:22:10.856'

2025/06/26 15:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[84.047ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:22:10.856'

2025/06/26 15:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.708ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:52:11.351'

2025/06/26 15:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.221ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:22:11.434' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.522ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.251ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.851ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:22:11.602' AND status != 'pending'
	

2025/06/26 15:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.850ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:52:11.633'

2025/06/26 15:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.398ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:22:11.685' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.056ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:22:11.717' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.594ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.152ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:22:11.768'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.679ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:22:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.948ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:22:11.884' AND status != 'pending'
	

2025/06/26 15:22:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.433ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:22:11.97' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:22:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.757ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:22:12.055'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:22:40 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[40.785ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 15:22:40 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[81.097ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/26 15:22:44 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:38
[40.888ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/26 15:22:44 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:44
[81.144ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/26 15:22:47 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[82.507ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 1

2025/06/26 15:22:47 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[81.753ms] [rows:1] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 1 ORDER BY create_time DESC LIMIT 10

2025/06/26 15:22:54 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[82.740ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 1

2025/06/26 15:22:54 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[83.060ms] [rows:1] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 1 ORDER BY create_time DESC LIMIT 10

2025/06/26 15:23:08 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:38
[132.936ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/26 15:23:08 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:44
[133.337ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/26 15:23:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.636ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:23:10.857'

2025/06/26 15:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.592ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:23:10.857'

2025/06/26 15:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.707ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:23:10.857'

2025/06/26 15:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.793ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:53:11.351'

2025/06/26 15:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.215ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:23:11.432' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.952ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.642ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.976ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:23:11.6' AND status != 'pending'
	

2025/06/26 15:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.099ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:53:11.635'

2025/06/26 15:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.966ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:23:11.68' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.168ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:23:11.722' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.485ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:23:11.762'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.090ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.947ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:23:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.602ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:23:11.889' AND status != 'pending'
	

2025/06/26 15:23:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.506ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:23:11.976' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:23:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.373ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:23:12.064'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:23:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:38
[114.189ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/26 15:23:55 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:44
[227.980ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/26 15:24:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.836ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:09:10.857' LIMIT 50

2025/06/26 15:24:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.143ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:24:10.857'

2025/06/26 15:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[90.701ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:09:10.923' LIMIT 50

2025/06/26 15:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.307ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:24:10.857'

2025/06/26 15:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.890ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:24:10.857'

2025/06/26 15:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.935ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:54:11.352'

2025/06/26 15:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.529ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:24:11.435' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.670ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.840ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.104ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:24:11.603' AND status != 'pending'
	

2025/06/26 15:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[94.104ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:54:11.635'

2025/06/26 15:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.565ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:24:11.687' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.449ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:24:11.729' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.995ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:24:11.769'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.693ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:24:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.760ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:24:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.006ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:24:11.913' AND status != 'pending'
	

2025/06/26 15:24:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[95.826ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:24:12.003' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:24:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[96.886ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:24:12.099'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:24:34 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:38
[46.037ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/26 15:24:34 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/member.go:44
[102.907ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/26 15:24:41 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[254.896ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 1

2025/06/26 15:24:41 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[134.383ms] [rows:1] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 1 ORDER BY create_time DESC LIMIT 10

2025/06/26 15:25:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[97.159ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:25:10.858'

2025/06/26 15:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.351ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:25:10.858'

2025/06/26 15:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[94.713ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:25:10.858'

2025/06/26 15:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[95.504ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:55:11.352'

2025/06/26 15:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.660ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:25:11.448' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.307ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.204ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.785ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:55:11.635'

2025/06/26 15:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[95.645ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:25:11.63' AND status != 'pending'
	

2025/06/26 15:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.597ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:25:11.725' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.620ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:25:11.725' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.184ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.835ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.582ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:25:11.815'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:25:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.605ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:25:11.898' AND status != 'pending'
	

2025/06/26 15:25:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.085ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:25:11.982' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:25:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.819ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:25:12.066'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:26:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.041ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:26:10.858'

2025/06/26 15:26:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[91.567ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:11:10.858' LIMIT 50

2025/06/26 15:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.059ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:11:10.925' LIMIT 50

2025/06/26 15:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.118ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:26:10.858'

2025/06/26 15:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.150ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:26:10.858'

2025/06/26 15:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.425ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:56:11.353'

2025/06/26 15:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.880ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:26:11.439' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.454ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.278ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.710ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:26:11.609' AND status != 'pending'
	

2025/06/26 15:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.298ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:56:11.636'

2025/06/26 15:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.748ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:26:11.692' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.378ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:26:11.717' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.343ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.809ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:26:11.778'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.388ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:26:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.774ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:26:11.883' AND status != 'pending'
	

2025/06/26 15:26:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.889ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:26:11.965' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:26:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.891ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:26:12.05'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:26:51 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[41.651ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 15:26:51 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[81.515ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 15:26:51 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.977ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 15:26:51 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[84.445ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 15:26:51 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.934ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 15:26:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.526ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 15:26:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.142ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 15:26:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.716ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 15:26:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.430ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 15:26:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.684ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 15:26:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.740ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 15:26:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.223ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 15:26:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[84.610ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 15:26:53 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[80.139ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 1

2025/06/26 15:26:53 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[83.488ms] [rows:1] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 1 ORDER BY create_time DESC LIMIT 10

2025/06/26 15:27:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:97
[81.555ms] [rows:1] SELECT * FROM `goods_list` WHERE id = 3 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/26 15:27:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.670ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:27:10.859'

2025/06/26 15:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.863ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:27:10.859'

2025/06/26 15:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.139ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:27:10.859'

2025/06/26 15:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.724ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:57:11.354'

2025/06/26 15:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.764ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:27:11.434' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.710ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.069ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.200ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:27:11.597' AND status != 'pending'
	

2025/06/26 15:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.899ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:57:11.636'

2025/06/26 15:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.418ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:27:11.677' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.044ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:27:11.722' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.536ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:27:11.759'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.638ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.723ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:27:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.749ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:27:11.89' AND status != 'pending'
	

2025/06/26 15:27:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.062ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:27:11.977' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:27:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.668ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:27:12.061'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:27:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:87
[173.126ms] [rows:1] UPDATE `goods_list` SET `goods_name`='测是',`price`=100,`content`='<p>刘强东与外卖小哥的合影 社交媒体图片</p><p>6月18日，京东面向全体酒店经营者发布公开信，正式宣布进军酒旅市场。而刘强东点外卖所在的四季酒店则是全球奢华酒店品牌之一。</p><p>送外卖的小哥身穿达达快送制服。今年，京东官宣外卖业务，该业务正是位于京东APP首页的京东秒送下的门类之一，其运力也主要来自达达秒送。</p><p>据最新披露的数据，京东外卖日订单量已突破2500万单，超过150万家餐厅入驻，京东外卖全职骑手已突破12万人。</p>',`cover`='https://ark-auto-2102366935-cn-beijing-default.tos-cn-beijing.volces.com/uploads/20250619234050000.jpg',`status`='normal',`stock`=100,`update_time`='2025-06-26 15:27:16.129' WHERE `id` = 3

2025/06/26 15:27:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[82.824ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 1

2025/06/26 15:27:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[82.608ms] [rows:1] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 1 ORDER BY create_time DESC LIMIT 10

2025/06/26 15:27:19 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:97
[83.831ms] [rows:1] SELECT * FROM `goods_list` WHERE id = 3 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/26 15:28:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[93.711ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:13:10.86' LIMIT 50

2025/06/26 15:28:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[94.095ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:28:10.859'

2025/06/26 15:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[183.791ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:28:10.859'

2025/06/26 15:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[305.559ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:13:10.926' LIMIT 50

2025/06/26 15:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[232.363ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:28:10.859'

2025/06/26 15:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[91.299ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:58:11.354'

2025/06/26 15:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.378ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:28:11.446' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[48.206ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.130ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.215ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:58:11.637'

2025/06/26 15:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.072ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:28:11.63' AND status != 'pending'
	

2025/06/26 15:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.263ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:28:11.719' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.214ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:28:11.721' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.861ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.437ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.935ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:28:11.81'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:28:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.190ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:28:11.887' AND status != 'pending'
	

2025/06/26 15:28:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.056ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:28:11.974' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:28:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.508ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:28:12.06'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:29:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.241ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:29:10.86'

2025/06/26 15:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.882ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:29:10.86'

2025/06/26 15:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.398ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:29:10.86'

2025/06/26 15:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.331ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:59:11.355'

2025/06/26 15:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.538ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:29:11.445' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.638ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.511ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.949ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:29:11.616' AND status != 'pending'
	

2025/06/26 15:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[93.634ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 14:59:11.638'

2025/06/26 15:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.670ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:29:11.699' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[96.728ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:29:11.732' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.393ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:29:11.783'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.568ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:29:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.573ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:29:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.997ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:29:11.92' AND status != 'pending'
	

2025/06/26 15:29:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[94.709ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:29:12.012' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:29:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.938ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:29:12.107'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:30:06 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[46.431ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 15:30:06 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[110.952ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 15:30:06 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[102.999ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 15:30:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[96.708ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 15:30:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[98.591ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 15:30:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[93.283ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 15:30:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[263.601ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 15:30:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[222.637ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 15:30:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[90.665ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 15:30:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[93.333ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 15:30:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.768ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 15:30:08 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[93.027ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 15:30:08 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.848ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 15:30:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[89.011ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:15:10.861' LIMIT 50

2025/06/26 15:30:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.599ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:30:10.86'

2025/06/26 15:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.353ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:15:10.927' LIMIT 50

2025/06/26 15:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[89.583ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:30:10.86'

2025/06/26 15:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[93.193ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:30:10.86'

2025/06/26 15:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[92.565ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:00:11.355'

2025/06/26 15:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.568ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:30:11.448' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[49.532ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.837ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.835ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:00:11.638'

2025/06/26 15:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.973ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:30:11.633' AND status != 'pending'
	

2025/06/26 15:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.841ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:30:11.722' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.531ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:30:11.723' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.227ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.288ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.712ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:30:11.814'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:30:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.064ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:30:11.889' AND status != 'pending'
	

2025/06/26 15:30:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.471ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:30:11.973' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:30:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.465ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:30:12.056'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:31:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.719ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:31:10.861'

2025/06/26 15:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.802ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:31:10.861'

2025/06/26 15:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.740ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:31:10.861'

2025/06/26 15:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.525ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:01:11.356'

2025/06/26 15:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.989ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:31:11.44' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.521ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.950ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.779ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:31:11.602' AND status != 'pending'
	

2025/06/26 15:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[96.150ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:01:11.639'

2025/06/26 15:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[92.107ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:31:11.688' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[93.172ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:31:11.735' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.972ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:31:11.78'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.848ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:31:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.709ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:31:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[94.782ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:31:11.921' AND status != 'pending'
	

2025/06/26 15:31:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[93.231ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:31:12.015' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:31:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[95.378ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:31:12.109'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:32:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.816ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:17:10.836' LIMIT 50

2025/06/26 15:32:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[93.031ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:32:10.835'

2025/06/26 15:32:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[88.360ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:17:10.902' LIMIT 50

2025/06/26 15:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[103.403ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:32:10.835'

2025/06/26 15:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[92.933ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:32:10.835'

2025/06/26 15:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[97.611ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:02:11.33'

2025/06/26 15:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.673ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:32:11.428' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.907ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[48.738ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[91.458ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:02:11.613'

2025/06/26 15:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.758ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:32:11.613' AND status != 'pending'
	

2025/06/26 15:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.267ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:32:11.704' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.907ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:32:11.705' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.192ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.856ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.503ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:32:11.796'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:32:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.926ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:32:11.88' AND status != 'pending'
	

2025/06/26 15:32:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.524ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:32:11.964' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:32:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.226ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:32:12.052'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:33:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.512ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:33:10.823'

2025/06/26 15:33:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.622ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:33:10.823'

2025/06/26 15:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.507ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:33:10.823'

2025/06/26 15:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.352ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:03:11.318'

2025/06/26 15:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.086ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:33:11.407' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.075ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.707ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.264ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:33:11.581' AND status != 'pending'
	

2025/06/26 15:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[93.986ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:03:11.601'

2025/06/26 15:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.325ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:33:11.669' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[102.434ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:33:11.695' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.769ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:33:11.752'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.409ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[48.907ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:33:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.268ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:33:11.892' AND status != 'pending'
	

2025/06/26 15:33:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[94.564ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:33:11.984' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:33:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.153ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:33:12.078'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:34:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.609ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:19:10.823' LIMIT 50

2025/06/26 15:34:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[94.318ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:34:10.823'

2025/06/26 15:34:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.243ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:19:10.889' LIMIT 50

2025/06/26 15:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[95.322ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:34:10.823'

2025/06/26 15:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[181.302ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:34:10.823'

2025/06/26 15:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[291.634ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:04:11.317'

2025/06/26 15:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.790ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:04:11.601'

2025/06/26 15:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.404ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:34:11.609' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[48.940ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.518ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:34:11.686' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.477ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.205ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.455ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[95.432ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:34:11.795' AND status != 'pending'
	

2025/06/26 15:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.815ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:34:11.848' AND status != 'pending'
	

2025/06/26 15:34:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.055ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:34:11.891' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:34:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.629ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:34:11.933' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:34:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.463ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:34:11.98'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:34:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.239ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:34:12.018'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:34:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[87.804ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/26 15:34:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[42.301ms] [rows:20] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/26 15:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:98
[40.856ms] [rows:1] SELECT count(*) FROM `order`

2025/06/26 15:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:116
[201.595ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` ORDER BY create_time DESC LIMIT 10

2025/06/26 15:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:165
[264.412ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (109,116,6,108)

2025/06/26 15:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods_optimized.go:127
[265.361ms] [rows:1] SELECT id, goods_name, content, price, stock, cover, status, category_id, create_time, update_time FROM `goods_list` WHERE id IN (1) AND isdelete != 1

2025/06/26 15:35:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[91.190ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:35:10.823'

2025/06/26 15:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[94.043ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:35:10.823'

2025/06/26 15:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[97.297ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:35:10.823'

2025/06/26 15:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[96.423ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:05:11.317'

2025/06/26 15:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[95.867ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:35:11.414' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.316ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.715ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.206ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:05:11.601'

2025/06/26 15:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.753ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:35:11.601' AND status != 'pending'
	

2025/06/26 15:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.705ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:35:11.681' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.786ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:35:11.692' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.586ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.640ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[92.213ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:35:11.782'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:35:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.001ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:35:11.848' AND status != 'pending'
	

2025/06/26 15:35:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.675ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:35:11.931' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:35:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.643ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:35:12.018'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:36:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.938ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:36:10.823'

2025/06/26 15:36:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[96.221ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:21:10.823' LIMIT 50

2025/06/26 15:36:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.705ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:21:10.89' LIMIT 50

2025/06/26 15:36:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.062ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:36:10.823'

2025/06/26 15:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.910ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:36:10.823'

2025/06/26 15:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.488ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:06:11.317'

2025/06/26 15:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[96.261ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:36:11.404' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.551ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.614ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.861ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:36:11.587' AND status != 'pending'
	

2025/06/26 15:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.290ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:06:11.601'

2025/06/26 15:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.490ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:36:11.676' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.979ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:36:11.686' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.124ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.209ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:36:11.76'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.445ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:36:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.109ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:36:11.854' AND status != 'pending'
	

2025/06/26 15:36:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.293ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:36:11.942' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:36:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.340ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:36:12.03'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:36:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:98
[42.232ms] [rows:1] SELECT count(*) FROM `order`

2025/06/26 15:36:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:116
[92.406ms] [rows:8] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` ORDER BY create_time DESC LIMIT 10 OFFSET 10

2025/06/26 15:36:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:165
[86.978ms] [rows:8] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (137,6,120,126,129,130,131,132)

2025/06/26 15:36:44 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:98
[42.045ms] [rows:1] SELECT count(*) FROM `order`

2025/06/26 15:36:44 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:116
[90.789ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` ORDER BY create_time DESC LIMIT 10

2025/06/26 15:36:44 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:165
[89.446ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (116,6,108,109)

2025/06/26 15:36:53 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[93.936ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 1

2025/06/26 15:36:53 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[88.531ms] [rows:1] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 1 ORDER BY create_time DESC LIMIT 10

2025/06/26 15:37:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[43.065ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 15:37:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.470ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 15:37:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.921ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 15:37:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[118.305ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 15:37:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[84.639ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 15:37:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.460ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 15:37:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[81.998ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 15:37:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[83.202ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 15:37:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.058ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 15:37:07 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.200ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 15:37:08 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[82.608ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 15:37:08 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[85.991ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 15:37:08 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[84.812ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 15:37:08 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[82.963ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 1

2025/06/26 15:37:08 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods.go:64
[82.092ms] [rows:1] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 1 ORDER BY create_time DESC LIMIT 10

2025/06/26 15:37:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.503ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:37:10.823'

2025/06/26 15:37:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.282ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:37:10.823'

2025/06/26 15:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.469ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:37:10.823'

2025/06/26 15:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.285ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:07:11.318'

2025/06/26 15:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.820ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:37:11.4' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.134ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.966ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.379ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:37:11.567' AND status != 'pending'
	

2025/06/26 15:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.758ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:07:11.601'

2025/06/26 15:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.290ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:37:11.655' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.510ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:37:11.682' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.819ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.455ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:37:11.739'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.967ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:37:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.661ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:37:11.85' AND status != 'pending'
	

2025/06/26 15:37:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.733ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:37:11.935' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:37:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.136ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:37:12.017'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:37:27 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:336
[41.005ms] [rows:1] SELECT count(*) FROM `sys_dict_type`

2025/06/26 15:37:27 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:336
[86.592ms] [rows:10] SELECT * FROM `sys_dict_type` ORDER BY create_time DESC LIMIT 10

2025/06/26 15:37:32 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[82.315ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 15:37:32 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[43.514ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 15:37:32 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[83.798ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 15:38:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.600ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:38:10.823'

2025/06/26 15:38:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.519ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:23:10.823' LIMIT 50

2025/06/26 15:38:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[94.086ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:23:10.89' LIMIT 50

2025/06/26 15:38:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.297ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:38:10.823'

2025/06/26 15:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.834ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:38:10.823'

2025/06/26 15:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.277ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:08:11.317'

2025/06/26 15:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.742ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:38:11.401' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.732ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.437ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.882ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:38:11.563' AND status != 'pending'
	

2025/06/26 15:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[93.040ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:08:11.601'

2025/06/26 15:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.564ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:38:11.648' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.508ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:38:11.694' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.558ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:38:11.728'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[47.117ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[48.475ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:38:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[92.213ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:38:11.881' AND status != 'pending'
	

2025/06/26 15:38:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[92.391ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:38:11.973' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:38:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[95.095ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:38:12.065'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:39:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[103.206ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:39:10.823'

2025/06/26 15:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[96.225ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:39:10.823'

2025/06/26 15:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[92.415ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:39:10.823'

2025/06/26 15:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[97.668ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:09:11.317'

2025/06/26 15:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.263ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:39:11.415' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.959ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.805ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.388ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:09:11.6'

2025/06/26 15:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[92.264ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:39:11.597' AND status != 'pending'
	

2025/06/26 15:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.797ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:39:11.685' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.793ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:39:11.689' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.769ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.451ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.260ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:39:11.779'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:39:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.760ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:39:11.851' AND status != 'pending'
	

2025/06/26 15:39:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.529ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:39:11.936' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:39:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.793ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:39:12.021'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:39:32 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:388
[88.388ms] [rows:1] SELECT * FROM `permission_user` WHERE id = 24 ORDER BY `permission_user`.`id` LIMIT 1

2025/06/26 15:39:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:388
[82.477ms] [rows:1] SELECT * FROM `permission_user` WHERE id = 24 ORDER BY `permission_user`.`id` LIMIT 1

2025/06/26 15:40:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.876ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:40:10.823'

2025/06/26 15:40:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[92.785ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:25:10.823' LIMIT 50

2025/06/26 15:40:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[86.799ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:25:10.89' LIMIT 50

2025/06/26 15:40:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.154ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:40:10.823'

2025/06/26 15:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.271ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:40:10.823'

2025/06/26 15:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.963ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:10:11.318'

2025/06/26 15:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.938ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:40:11.4' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.066ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.735ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[97.595ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:40:11.569' AND status != 'pending'
	

2025/06/26 15:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.389ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:10:11.6'

2025/06/26 15:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.831ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:40:11.667' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.826ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:40:11.686' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.847ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.542ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:40:11.747'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:40:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[48.980ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:40:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[180.740ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:40:11.866' AND status != 'pending'
	

2025/06/26 15:40:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[180.759ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:40:12.047' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:40:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[233.921ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:40:12.228'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:40:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:316
[84.523ms] [rows:0] SELECT * FROM `permission_user` WHERE ((rule = '/NewsData' AND rule != '')) ORDER BY `permission_user`.`id` LIMIT 1

2025/06/26 15:40:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:326
[174.983ms] [rows:1] INSERT INTO `permission_user` (`label`,`icon`,`rule`,`key`,`path`,`layout`,`show`,`enable`,`order`,`title`,`type`,`is_link`,`keepAlive`,`parent_id`,`create_time`,`update_time`,`sort`) VALUES ('内容管理','Aim','/NewsData','','/NewsData','',1,1,0,'内容管理','TITLE',0,0,NULL,'2025-06-26 15:40:48.393','2025-06-26 15:40:48.393',600)

2025/06/26 15:40:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:344
[87.571ms] [rows:1] INSERT INTO `staff_permissions` (`permission_id`,`tenant_id`,`role_id`) VALUES (26,1,4)

2025/06/26 15:40:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:372
[83.393ms] [rows:1] INSERT INTO `role_permissions_permission` (`roleId`,`permissionId`) VALUES (4,26)

2025/06/26 15:41:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.413ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:41:10.823'

2025/06/26 15:41:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.070ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:41:10.823'

2025/06/26 15:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.069ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:41:10.823'

2025/06/26 15:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.550ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:11:11.318'

2025/06/26 15:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.594ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:41:11.406' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.576ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.301ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.623ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:41:11.572' AND status != 'pending'
	

2025/06/26 15:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.873ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:11:11.601'

2025/06/26 15:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.499ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:41:11.655' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.540ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:41:11.685' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.445ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.484ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:41:11.738'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.506ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:41:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.337ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:41:11.851' AND status != 'pending'
	

2025/06/26 15:41:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.678ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:41:11.932' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:41:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.994ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:41:12.017'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:42:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.171ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:42:10.823'

2025/06/26 15:42:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.569ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:27:10.823' LIMIT 50

2025/06/26 15:42:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[90.945ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:27:10.89' LIMIT 50

2025/06/26 15:42:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.061ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:42:10.823'

2025/06/26 15:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.800ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:42:10.823'

2025/06/26 15:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.600ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:12:11.317'

2025/06/26 15:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.365ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:42:11.399' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.833ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.271ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.223ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:42:11.566' AND status != 'pending'
	

2025/06/26 15:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[91.165ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:12:11.607'

2025/06/26 15:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.736ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:42:11.649' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.596ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:42:11.699' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.578ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:42:11.731'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.849ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.604ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:42:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[94.492ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:42:11.881' AND status != 'pending'
	

2025/06/26 15:42:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[94.057ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:42:11.976' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:42:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.606ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:42:12.07'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:43:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[92.147ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:43:10.823'

2025/06/26 15:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[91.861ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:43:10.823'

2025/06/26 15:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[92.767ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:43:10.823'

2025/06/26 15:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[95.361ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:13:11.318'

2025/06/26 15:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.962ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:43:11.413' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[52.228ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.848ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.842ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:13:11.601'

2025/06/26 15:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.471ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:43:11.603' AND status != 'pending'
	

2025/06/26 15:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.166ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:43:11.682' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.568ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:43:11.693' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.714ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.346ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[94.418ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:43:11.783'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:43:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.046ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:43:11.849' AND status != 'pending'
	

2025/06/26 15:43:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.527ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:43:11.93' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:43:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.708ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:43:12.014'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:44:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.769ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:44:10.823'

2025/06/26 15:44:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.417ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:29:10.823' LIMIT 50

2025/06/26 15:44:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[90.845ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 15:44:10.823' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/26 15:44:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[48.544ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-19 15:44:10.914'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/26 15:44:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.320ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:44:10.823'

2025/06/26 15:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.235ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:44:10.823'

2025/06/26 15:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[236.511ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 15:44:10.889' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/26 15:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[270.898ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:29:10.889' LIMIT 50

2025/06/26 15:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[37.740ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-19 15:44:11.126'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/26 15:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.657ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:14:11.318'

2025/06/26 15:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[73.917ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:44:11.398' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.965ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.216ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.928ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:44:11.55' AND status != 'pending'
	

2025/06/26 15:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.605ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:14:11.601'

2025/06/26 15:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[72.953ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:44:11.624' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.711ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:44:11.697'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.804ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:44:11.691' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.717ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[57.337ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:44:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[92.561ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:44:11.882' AND status != 'pending'
	

2025/06/26 15:44:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.158ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:44:11.975' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:44:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.752ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:44:12.062'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:45:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[92.687ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:45:10.823'

2025/06/26 15:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.020ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:45:10.823'

2025/06/26 15:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[91.114ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:45:10.823'

2025/06/26 15:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.217ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:15:11.318'

2025/06/26 15:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.829ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:45:11.404' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.641ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.998ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.532ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:45:11.58' AND status != 'pending'
	

2025/06/26 15:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[72.947ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:15:11.601'

2025/06/26 15:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[76.658ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:45:11.674' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.677ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:45:11.666' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.938ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.338ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.909ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:45:11.757'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.131ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:45:11.828' AND status != 'pending'
	

2025/06/26 15:45:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.547ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:45:11.904' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:45:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.019ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:45:11.981'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:46:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[76.736ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:46:10.823'

2025/06/26 15:46:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.309ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:31:10.823' LIMIT 50

2025/06/26 15:46:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.690ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:31:10.89' LIMIT 50

2025/06/26 15:46:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.602ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:46:10.823'

2025/06/26 15:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.128ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:46:10.823'

2025/06/26 15:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.350ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:16:11.318'

2025/06/26 15:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[72.217ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:46:11.396' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.333ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[35.971ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.960ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:46:11.542' AND status != 'pending'
	

2025/06/26 15:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.403ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:16:11.601'

2025/06/26 15:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[71.645ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:46:11.617' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[71.944ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:46:11.691'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.042ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:46:11.686' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.658ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.446ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:46:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.344ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:46:11.851' AND status != 'pending'
	

2025/06/26 15:46:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.957ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:46:11.934' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:46:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[97.131ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:46:12.015'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[322.565ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:47:10.823'

2025/06/26 15:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.563ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:47:10.823'

2025/06/26 15:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.782ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:47:10.823'

2025/06/26 15:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.627ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:17:11.318'

2025/06/26 15:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.654ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:47:11.398' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.875ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.853ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.261ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:47:11.564' AND status != 'pending'
	

2025/06/26 15:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.689ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:17:11.601'

2025/06/26 15:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.328ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:47:11.646' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.189ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:47:11.68' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.708ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.622ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:47:11.726'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.781ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.460ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:47:11.833' AND status != 'pending'
	

2025/06/26 15:47:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.484ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:47:11.909' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:47:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.888ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:47:11.988'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:48:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[76.156ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:48:10.823'

2025/06/26 15:48:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.491ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:33:10.823' LIMIT 50

2025/06/26 15:48:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.506ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:48:10.823'

2025/06/26 15:48:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[88.846ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:33:10.89' LIMIT 50

2025/06/26 15:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[74.227ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:48:10.823'

2025/06/26 15:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.137ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:18:11.317'

2025/06/26 15:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[73.855ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:48:11.394' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.064ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[35.602ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.410ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:48:11.54' AND status != 'pending'
	

2025/06/26 15:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[91.759ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:18:11.601'

2025/06/26 15:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.489ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:48:11.617' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.959ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:48:11.693'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.908ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:48:11.693' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[47.244ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.686ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:48:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.436ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:48:11.871' AND status != 'pending'
	

2025/06/26 15:48:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.987ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:48:11.961' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:48:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.184ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:48:12.052'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:48:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.410ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:18:25.207'

2025/06/26 15:48:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.736ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:48:25.292' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:48:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.701ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:48:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.251ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:48:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[274.460ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:18:25.214'

2025/06/26 15:48:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.154ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:48:25.471' AND status != 'pending'
	

2025/06/26 15:48:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.264ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:48:25.488' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:48:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.075ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:48:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.951ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:48:25.559' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:48:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[48.739ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:48:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.134ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:48:25.641'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:48:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[90.125ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:48:25.673' AND status != 'pending'
	

2025/06/26 15:48:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.437ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:48:25.763' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:48:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[92.063ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:48:25.852'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:48:49 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[44.562ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 15:48:49 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.118ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 15:48:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[94.277ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 15:48:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.056ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 15:48:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.881ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 15:48:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.570ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 15:48:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.338ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 15:48:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[90.423ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 15:48:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.168ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 15:48:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.203ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 15:48:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.640ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 15:48:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[86.137ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 15:48:50 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[90.429ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 15:49:00 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:336
[44.293ms] [rows:1] SELECT count(*) FROM `sys_dict_type`

2025/06/26 15:49:00 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:336
[91.480ms] [rows:10] SELECT * FROM `sys_dict_type` ORDER BY create_time DESC LIMIT 10

2025/06/26 15:49:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[89.072ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 15:49:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[47.159ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 15:49:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[87.680ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 15:49:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[93.489ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:49:25.208'

2025/06/26 15:49:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[89.425ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:49:25.208'

2025/06/26 15:49:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[92.396ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:49:25.208'

2025/06/26 15:49:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[91.196ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:19:25.722'

2025/06/26 15:49:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.189ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:49:25.814' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:49:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.214ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:49:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.906ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:49:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.801ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:19:25.945'

2025/06/26 15:49:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.572ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:49:25.993' AND status != 'pending'
	

2025/06/26 15:49:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.183ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:49:26.029' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:49:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.809ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:49:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.958ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:49:26.079' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:49:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.646ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:49:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.085ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:49:26.166'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:49:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.609ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:49:26.2' AND status != 'pending'
	

2025/06/26 15:49:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.027ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:49:26.282' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:49:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.519ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:49:26.367'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:50:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.908ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:35:25.207' LIMIT 50

2025/06/26 15:50:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.554ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:50:25.208'

2025/06/26 15:50:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[89.724ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:50:25.208'

2025/06/26 15:50:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[229.510ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:35:25.214' LIMIT 50

2025/06/26 15:50:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.343ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:50:25.208'

2025/06/26 15:50:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.196ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:20:25.723'

2025/06/26 15:50:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.761ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:50:25.813' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:50:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.114ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:50:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.273ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:50:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.140ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:20:25.944'

2025/06/26 15:50:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.758ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:50:25.99' AND status != 'pending'
	

2025/06/26 15:50:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.855ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:50:26.023' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:50:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.413ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:50:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.866ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:50:26.077' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:50:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[35.923ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:50:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.962ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:50:26.171' AND status != 'pending'
	

2025/06/26 15:50:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.709ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:50:26.165'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:50:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.517ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:50:26.247' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:50:26 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[71.795ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:50:26.322'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:50:33 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.686ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:20:32.987'

2025/06/26 15:50:33 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.160ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:50:33.073' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:50:33 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.244ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:50:33 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.552ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:50:33 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[260.499ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:20:32.997'

2025/06/26 15:50:33 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.340ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:50:33.242' AND status != 'pending'
	

2025/06/26 15:50:33 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.275ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:50:33.258' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:50:33 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.066ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:50:33 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.229ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:50:33.324' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:50:33 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.256ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:50:33 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.803ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:50:33.433' AND status != 'pending'
	

2025/06/26 15:50:33 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.490ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:50:33.52' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:50:33 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[100.953ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:50:33.605'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[96.013ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:20:46.494'

2025/06/26 15:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.086ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:50:46.59' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.291ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[267.442ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:20:46.5'

2025/06/26 15:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.315ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.998ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:50:46.768' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[98.488ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:50:46.774' AND status != 'pending'
	

2025/06/26 15:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.440ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.772ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.769ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:50:46.873' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:50:47 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.942ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:50:46.944' AND status != 'pending'
	

2025/06/26 15:50:47 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[92.783ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:50:46.963'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:50:47 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.254ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:50:47.033' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:50:47 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.295ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:50:47.123'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:51:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.450ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:21:03.714'

2025/06/26 15:51:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.055ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:51:03.799' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:51:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.657ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:51:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.384ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:51:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[256.642ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:21:03.722'

2025/06/26 15:51:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.301ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:51:03.96' AND status != 'pending'
	

2025/06/26 15:51:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.545ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:51:03.978' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:51:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.765ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:51:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.188ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:51:04.038' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:51:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.845ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:51:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.606ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:51:04.121'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:51:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.370ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:51:04.147' AND status != 'pending'
	

2025/06/26 15:51:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.541ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:51:04.235' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:51:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.639ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:51:04.318'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.035ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:21:11.11'

2025/06/26 15:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.525ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:51:11.193' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.680ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.165ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[282.847ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:21:11.119'

2025/06/26 15:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.595ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:51:11.352' AND status != 'pending'
	

2025/06/26 15:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.827ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:51:11.403' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.073ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:51:11.432' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.541ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.925ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:51:11.51'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[50.250ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[93.443ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:51:11.591' AND status != 'pending'
	

2025/06/26 15:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.669ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:51:11.685' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:51:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.627ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:51:11.775'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:51:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[87.377ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/26 15:51:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[51.440ms] [rows:21] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/26 15:51:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[45.215ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 15:51:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.328ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 15:51:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[97.339ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 15:51:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.195ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 15:51:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[91.594ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 15:51:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.440ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 15:51:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[93.307ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 15:51:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.534ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 15:51:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.431ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 15:51:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[91.969ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 15:51:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.398ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 15:51:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.127ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 15:51:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[93.392ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 15:51:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[45.612ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 15:51:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.177ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 15:51:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[94.756ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 15:51:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[93.001ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 15:51:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.405ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 15:51:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[91.714ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 15:51:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[91.932ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 15:51:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.454ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 15:51:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[93.245ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 15:51:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[91.487ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 15:51:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.918ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 15:51:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[91.329ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 15:51:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.871ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 15:51:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:316
[89.598ms] [rows:0] SELECT * FROM `permission_user` WHERE ((rule = '/test' AND rule != '')) ORDER BY `permission_user`.`id` LIMIT 1

2025/06/26 15:51:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:326
[183.863ms] [rows:1] INSERT INTO `permission_user` (`label`,`icon`,`rule`,`key`,`path`,`layout`,`show`,`enable`,`order`,`title`,`type`,`is_link`,`keepAlive`,`parent_id`,`create_time`,`update_time`,`sort`) VALUES ('测试','AlarmClock','/test','','/test','',1,1,0,'测试','TITLE',0,0,NULL,'2025-06-26 15:51:57.678','2025-06-26 15:51:57.678',700)

2025/06/26 15:51:58 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:344
[89.580ms] [rows:1] INSERT INTO `staff_permissions` (`permission_id`,`tenant_id`,`role_id`) VALUES (27,1,4)

2025/06/26 15:51:58 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:378
[92.288ms] [rows:1] INSERT INTO `role_permissions_permission` (`roleId`,`permissionId`) VALUES (4,27)

2025/06/26 15:51:58 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[88.883ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/26 15:51:58 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[45.599ms] [rows:22] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/26 15:52:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[45.412ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 15:52:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.260ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 15:52:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.651ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 15:52:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.882ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 15:52:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.926ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 15:52:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.903ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 15:52:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.749ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 15:52:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.351ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 15:52:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.316ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 15:52:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[91.773ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 15:52:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[89.395ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 15:52:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.613ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 15:52:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[94.581ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 15:52:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:479
[92.448ms] [rows:0] SELECT `id` FROM `permission_user` WHERE parent_id IN (27)

2025/06/26 15:52:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:437
[90.770ms] [rows:1] DELETE FROM `permission_user` WHERE id IN (27)

2025/06/26 15:52:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:442
[89.121ms] [rows:1] DELETE FROM `staff_permissions` WHERE permission_id IN (27)

2025/06/26 15:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:447
[91.932ms] [rows:1] DELETE FROM `role_permissions_permission` WHERE permissionId IN (27)

2025/06/26 15:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.943ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:52:11.144'

2025/06/26 15:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[87.915ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/26 15:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[45.456ms] [rows:21] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/26 15:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.235ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:52:11.144'

2025/06/26 15:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.420ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:52:11.144'

2025/06/26 15:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.268ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:22:11.622'

2025/06/26 15:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.320ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:52:11.699' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.014ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.286ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.592ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:52:11.856' AND status != 'pending'
	

2025/06/26 15:52:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.180ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:22:11.899'

2025/06/26 15:52:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.094ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:52:11.933' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:52:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.042ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:52:11.986' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:52:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.542ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:52:12.013'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:52:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.813ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:52:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.984ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:52:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.917ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:52:12.162' AND status != 'pending'
	

2025/06/26 15:52:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.576ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:52:12.254' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:52:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.223ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:52:12.343'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:52:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:479
[92.138ms] [rows:0] SELECT `id` FROM `permission_user` WHERE parent_id IN (26)

2025/06/26 15:52:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:437
[88.217ms] [rows:1] DELETE FROM `permission_user` WHERE id IN (26)

2025/06/26 15:52:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:442
[91.597ms] [rows:1] DELETE FROM `staff_permissions` WHERE permission_id IN (26)

2025/06/26 15:52:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:447
[87.796ms] [rows:1] DELETE FROM `role_permissions_permission` WHERE permissionId IN (26)

2025/06/26 15:52:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[87.070ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/26 15:52:14 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[49.398ms] [rows:20] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/26 15:52:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[47.809ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 15:52:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.336ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 15:52:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[90.979ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 15:52:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.597ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 15:52:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[90.727ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 15:52:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.874ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 15:52:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.849ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 15:52:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.096ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 15:52:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[91.997ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 15:52:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.298ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 15:52:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.439ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 15:52:17 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[91.262ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 15:52:18 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[91.266ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 15:52:25 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/user.go:394
[91.393ms] [rows:1] SELECT * FROM `permission_user` WHERE id = 2 ORDER BY `permission_user`.`id` LIMIT 1

2025/06/26 15:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[111.632ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:53:11.145'

2025/06/26 15:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[208.057ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:38:11.145' LIMIT 50

2025/06/26 15:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[253.475ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:53:11.145'

2025/06/26 15:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[549.597ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:38:11.156' LIMIT 50

2025/06/26 15:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[194.563ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:53:11.145'

2025/06/26 15:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[130.774ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:23:11.622'

2025/06/26 15:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.971ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:53:11.753' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[47.387ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.122ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:53:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.988ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:23:11.901'

2025/06/26 15:53:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.869ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:53:11.935' AND status != 'pending'
	

2025/06/26 15:53:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.765ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:53:11.981' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:53:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.057ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:53:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.943ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:53:12.024' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:53:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.905ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:53:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.862ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:53:12.111'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:53:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.493ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:53:12.146' AND status != 'pending'
	

2025/06/26 15:53:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.432ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:53:12.224' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:53:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.654ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:53:12.304'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.050ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:54:11.146'

2025/06/26 15:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.206ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:54:11.146'

2025/06/26 15:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[82.612ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:54:11.146'

2025/06/26 15:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.377ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:24:11.623'

2025/06/26 15:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.305ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:54:11.701' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.410ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.228ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.894ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:54:11.863' AND status != 'pending'
	

2025/06/26 15:54:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.698ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:24:11.9'

2025/06/26 15:54:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.788ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:54:11.939' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:54:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[93.769ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:54:11.99' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:54:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.666ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:54:12.016'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:54:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.678ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:54:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.658ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:54:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[92.984ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:54:12.174' AND status != 'pending'
	

2025/06/26 15:54:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.244ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:54:12.267' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:54:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.367ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:54:12.357'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.180ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:55:11.146'

2025/06/26 15:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[75.919ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:40:11.157' LIMIT 50

2025/06/26 15:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[88.234ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:40:11.146' LIMIT 50

2025/06/26 15:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.649ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:55:11.146'

2025/06/26 15:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.537ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:55:11.146'

2025/06/26 15:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.693ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:25:11.624'

2025/06/26 15:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.056ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:55:11.702' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.938ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.313ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.906ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:55:11.863' AND status != 'pending'
	

2025/06/26 15:55:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.879ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:25:11.901'

2025/06/26 15:55:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.718ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:55:11.939' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:55:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[92.711ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:55:11.991' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:55:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.881ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:55:12.014'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:55:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.491ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:55:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.408ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:55:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.364ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:55:12.173' AND status != 'pending'
	

2025/06/26 15:55:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[92.114ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:55:12.264' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:55:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[93.795ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:55:12.357'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[45.290ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 15:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[93.400ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 15:55:15 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.038ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 15:55:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.907ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 15:55:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[91.295ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 15:55:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.410ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 15:55:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.196ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 15:55:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[90.174ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 15:55:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.691ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 15:55:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[87.715ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 15:55:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[92.468ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 15:55:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[90.900ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 15:55:16 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[88.418ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 15:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[92.667ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:56:11.147'

2025/06/26 15:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.801ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:56:11.147'

2025/06/26 15:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.134ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:56:11.147'

2025/06/26 15:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[94.163ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:26:11.624'

2025/06/26 15:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.060ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:56:11.719' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.285ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.066ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.273ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:26:11.902'

2025/06/26 15:56:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.527ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:56:11.899' AND status != 'pending'
	

2025/06/26 15:56:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.562ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:56:11.982' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:56:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.812ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:56:11.986' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:56:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.459ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:56:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.423ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:56:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.232ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:56:12.074'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:56:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.237ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:56:12.139' AND status != 'pending'
	

2025/06/26 15:56:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.349ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:56:12.219' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:56:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.175ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:56:12.297'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:56:47 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[39.575ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 15:56:47 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[76.589ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 15:56:47 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.278ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 15:56:47 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[77.752ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 15:56:47 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.617ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 15:56:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[81.910ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 15:56:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.644ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 15:56:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.099ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 15:56:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.699ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 15:56:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.967ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 15:56:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.421ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 15:56:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.765ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 15:56:48 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.958ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 15:57:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[39.222ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 15:57:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[77.106ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 15:57:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.086ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 15:57:04 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[80.627ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 15:57:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[76.882ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 15:57:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.697ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 15:57:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.337ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 15:57:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.817ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 15:57:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.502ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 15:57:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.366ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 15:57:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.959ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 15:57:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[76.593ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 15:57:05 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.893ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 15:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[76.857ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:42:11.147' LIMIT 50

2025/06/26 15:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.140ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:42:11.158' LIMIT 50

2025/06/26 15:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[91.184ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:57:11.147'

2025/06/26 15:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[89.471ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:57:11.147'

2025/06/26 15:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.004ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:57:11.147'

2025/06/26 15:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:434
[44.094ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/26 15:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[93.826ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:27:11.624'

2025/06/26 15:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[76.664ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/26 15:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.775ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:57:11.719' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[81.218ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/26 15:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.865ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[46.736ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.376ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/26 15:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.833ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:27:11.902'

2025/06/26 15:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.361ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/26 15:57:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.813ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:57:11.898' AND status != 'pending'
	

2025/06/26 15:57:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.120ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:57:11.979' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:57:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.191ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/26 15:57:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.447ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:57:11.986' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:57:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.307ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:57:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.619ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/26 15:57:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.052ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:57:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.875ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:57:12.073'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:57:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[77.487ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/26 15:57:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.276ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:57:12.135' AND status != 'pending'
	

2025/06/26 15:57:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.908ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/26 15:57:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.614ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:57:12.213' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:57:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.011ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/26 15:57:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.605ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:57:12.293'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:57:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[75.932ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/26 15:57:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[79.342ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/26 15:57:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:447
[78.141ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/26 15:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.841ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:58:11.148'

2025/06/26 15:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.756ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:58:11.148'

2025/06/26 15:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.683ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:58:11.148'

2025/06/26 15:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.785ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:28:11.626'

2025/06/26 15:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.800ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:58:11.707' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.827ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.157ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.454ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:58:11.865' AND status != 'pending'
	

2025/06/26 15:58:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.019ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:28:11.903'

2025/06/26 15:58:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.176ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:58:11.943' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:58:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.626ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:58:11.982' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:58:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.923ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:58:12.022'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:58:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.534ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:58:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.351ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:58:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.661ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:58:12.142' AND status != 'pending'
	

2025/06/26 15:58:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.933ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:58:12.221' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:58:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.622ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:58:12.302'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[76.435ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:44:11.148' LIMIT 50

2025/06/26 15:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.134ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 15:59:11.148'

2025/06/26 15:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[92.099ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:44:11.159' LIMIT 50

2025/06/26 15:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.434ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 15:59:11.148'

2025/06/26 15:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.741ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 15:59:11.148'

2025/06/26 15:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.497ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:29:11.625'

2025/06/26 15:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.433ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:59:11.705' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.774ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.723ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:59:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.695ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:59:11.866' AND status != 'pending'
	

2025/06/26 15:59:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[120.147ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:29:11.904'

2025/06/26 15:59:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.546ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:59:11.949' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:59:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.943ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:59:12.03'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 15:59:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[142.276ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 14:59:12.024' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 15:59:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[94.534ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 15:59:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[178.576ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 15:59:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[273.316ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 14:59:12.44' AND status != 'pending'
	

2025/06/26 15:59:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[131.376ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 14:59:12.714' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 15:59:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.663ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 14:59:12.845'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[93.131ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:00:11.149'

2025/06/26 16:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[93.301ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:00:11.149'

2025/06/26 16:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[89.865ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:00:11.149'

2025/06/26 16:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[93.648ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:30:11.627'

2025/06/26 16:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.382ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:00:11.721' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.784ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.275ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.544ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:30:11.904'

2025/06/26 16:00:11 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.345ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:00:11.901' AND status != 'pending'
	

2025/06/26 16:00:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.159ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:00:11.982' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:00:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.906ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:00:11.988' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:00:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.034ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:00:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.575ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:00:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.587ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:00:12.076'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:00:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.692ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:00:12.144' AND status != 'pending'
	

2025/06/26 16:00:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.411ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:00:12.222' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:00:12 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.663ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:00:12.3'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:00:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[97.390ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:30:59.362'

2025/06/26 16:00:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[99.584ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:00:59.46' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:00:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[233.663ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:30:59.372'

2025/06/26 16:00:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[47.936ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:00:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[48.361ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:00:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[76.663ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:00:59.606' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:00:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.280ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:00:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[95.646ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:00:59.656' AND status != 'pending'
	

2025/06/26 16:00:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.129ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:00:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.316ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:00:59.76' AND status != 'pending'
	

2025/06/26 16:00:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[96.766ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:00:59.752' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:00:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[95.513ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:00:59.84' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:00:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[93.729ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:00:59.849'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:01:00 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.117ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:00:59.935'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:01:35 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.108ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:31:35.607'

2025/06/26 16:01:35 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.466ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:01:35.69' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:01:35 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.765ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:01:35 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.403ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:01:35 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[240.765ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:31:35.617'

2025/06/26 16:01:35 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.326ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:01:35.858' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:01:35 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.056ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:01:35.858' AND status != 'pending'
	

2025/06/26 16:01:35 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.519ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:01:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.295ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:01:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.238ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:01:35.938' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:01:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.982ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:01:36.019' AND status != 'pending'
	

2025/06/26 16:01:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.965ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:01:36.019'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:01:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.635ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:01:36.097' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:01:36 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.423ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:01:36.175'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.851ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:31:45.196'

2025/06/26 16:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.440ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:01:45.282' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.517ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[242.886ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:31:45.203'

2025/06/26 16:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.225ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.063ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:01:45.446' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.029ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:01:45.453' AND status != 'pending'
	

2025/06/26 16:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.876ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.918ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.476ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:01:45.537' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.148ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:01:45.607' AND status != 'pending'
	

2025/06/26 16:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.466ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:01:45.62'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.582ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:01:45.688' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.278ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:01:45.771'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.767ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:02:45.197'

2025/06/26 16:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.927ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:02:45.197'

2025/06/26 16:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.157ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:02:45.197'

2025/06/26 16:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.802ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:32:45.703'

2025/06/26 16:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.144ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:02:45.783' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.526ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.833ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:32:45.851'

2025/06/26 16:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.666ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.685ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:02:45.937' AND status != 'pending'
	

2025/06/26 16:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.694ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:02:45.937' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.015ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.217ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:02:46.018' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.154ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.437ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:02:46.102'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.706ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:02:46.11' AND status != 'pending'
	

2025/06/26 16:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.032ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:02:46.192' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.586ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:02:46.276'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:03:13 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:454
[85.311ms] [rows:12] SELECT * FROM `sys_dict_type` WHERE del_flag != 'T'

2025/06/26 16:03:13 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:468
[83.325ms] [rows:38] SELECT * FROM `sys_dict` WHERE sys_dict_type_id IN (1000,1001,1002,1003,1004,1005,1006,1007,1008,1009,1010,1011) AND del_flag != 'T'

2025/06/26 16:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[77.626ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:48:45.197' LIMIT 50

2025/06/26 16:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.478ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:03:45.197'

2025/06/26 16:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.764ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:03:45.197'

2025/06/26 16:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.876ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:03:45.197'

2025/06/26 16:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[259.217ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:48:45.204' LIMIT 50

2025/06/26 16:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.729ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:33:45.703'

2025/06/26 16:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.483ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:03:45.789' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.694ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.740ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:33:45.852'

2025/06/26 16:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.579ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.658ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:03:45.938' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.133ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:03:45.953' AND status != 'pending'
	

2025/06/26 16:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.496ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.001ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.386ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:03:46.035' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.767ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:03:46.103' AND status != 'pending'
	

2025/06/26 16:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.009ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:03:46.115'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.842ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:03:46.185' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.865ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:03:46.27'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.394ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:04:45.198'

2025/06/26 16:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.988ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:04:45.198'

2025/06/26 16:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.302ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:04:45.198'

2025/06/26 16:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.208ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:34:45.704'

2025/06/26 16:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.109ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:04:45.79' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.969ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.145ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:34:45.852'

2025/06/26 16:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.717ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.691ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:04:45.932' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.923ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:04:45.963' AND status != 'pending'
	

2025/06/26 16:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.203ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.251ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.015ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:04:46.048' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.763ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:04:46.099' AND status != 'pending'
	

2025/06/26 16:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.165ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:04:46.133'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[90.072ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:04:46.182' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.312ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:04:46.272'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.222ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:50:45.205' LIMIT 50

2025/06/26 16:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.319ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:50:45.199' LIMIT 50

2025/06/26 16:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.355ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:05:45.199'

2025/06/26 16:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.193ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:05:45.199'

2025/06/26 16:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.843ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:05:45.199'

2025/06/26 16:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.741ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:35:45.704'

2025/06/26 16:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.755ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:05:45.79' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.675ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.664ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:35:45.853'

2025/06/26 16:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.659ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.333ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:05:45.938' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.600ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:05:45.954' AND status != 'pending'
	

2025/06/26 16:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.419ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.496ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.561ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:05:46.033' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.626ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:05:46.11' AND status != 'pending'
	

2025/06/26 16:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.138ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:05:46.116'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.804ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:05:46.193' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[90.438ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:05:46.279'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.196ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:06:45.199'

2025/06/26 16:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[85.815ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:06:45.199'

2025/06/26 16:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.314ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:06:45.199'

2025/06/26 16:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.984ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:36:45.704'

2025/06/26 16:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.093ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:06:45.789' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.988ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.230ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:36:45.853'

2025/06/26 16:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[47.390ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.100ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:06:45.934' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.019ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:06:45.964' AND status != 'pending'
	

2025/06/26 16:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.089ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[47.888ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.191ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:06:46.052' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[95.640ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:06:46.105' AND status != 'pending'
	

2025/06/26 16:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.813ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:06:46.138'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.286ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:06:46.201' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[196.455ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:06:46.287'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[77.327ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:52:45.206' LIMIT 50

2025/06/26 16:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.025ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:07:45.199'

2025/06/26 16:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[86.552ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:52:45.199' LIMIT 50

2025/06/26 16:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.362ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:07:45.199'

2025/06/26 16:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[82.375ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:07:45.199'

2025/06/26 16:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.204ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:37:45.705'

2025/06/26 16:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.394ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:07:45.79' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.707ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.495ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:37:45.854'

2025/06/26 16:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.665ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.681ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:07:45.937' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.816ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:07:45.955' AND status != 'pending'
	

2025/06/26 16:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.222ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.601ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.434ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:07:46.035' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.147ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:07:46.109' AND status != 'pending'
	

2025/06/26 16:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.880ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:07:46.115'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.105ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:07:46.192' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.025ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:07:46.278'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.610ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:08:45.2'

2025/06/26 16:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.635ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:08:45.2'

2025/06/26 16:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.433ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:08:45.2'

2025/06/26 16:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.264ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:38:45.706'

2025/06/26 16:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.002ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:08:45.794' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.520ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.246ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:38:45.854'

2025/06/26 16:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.542ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.725ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:08:45.935' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.701ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:08:45.963' AND status != 'pending'
	

2025/06/26 16:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.459ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.887ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.857ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:08:46.047' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.073ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:08:46.098' AND status != 'pending'
	

2025/06/26 16:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.344ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:08:46.129'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.090ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:08:46.179' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.246ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:08:46.267'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:08:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[44.149ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 16:08:56 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[85.644ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/26 16:08:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:309
[83.981ms] [rows:1] SELECT * FROM `role` WHERE id = 3 ORDER BY `role`.`id` LIMIT 1

2025/06/26 16:08:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:320
[83.470ms] [rows:0] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 3

2025/06/26 16:08:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[81.837ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/26 16:08:59 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[41.736ms] [rows:20] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/26 16:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.445ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:54:45.207' LIMIT 50

2025/06/26 16:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[97.369ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:54:45.201' LIMIT 50

2025/06/26 16:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[97.500ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:09:45.201'

2025/06/26 16:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.021ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:09:45.201'

2025/06/26 16:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[84.920ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:09:45.201'

2025/06/26 16:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.308ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:39:45.706'

2025/06/26 16:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.880ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:09:45.791' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.650ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.636ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:39:45.855'

2025/06/26 16:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.683ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.562ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:09:45.936' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.332ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:09:45.962' AND status != 'pending'
	

2025/06/26 16:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.614ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.679ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.620ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:09:46.047' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.317ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:09:46.099' AND status != 'pending'
	

2025/06/26 16:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.910ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:09:46.132'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.291ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:09:46.179' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.928ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:09:46.264'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:10:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.676ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:10:45.202'

2025/06/26 16:10:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.600ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:10:45.202'

2025/06/26 16:10:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.892ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:10:45.202'

2025/06/26 16:10:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.743ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:40:45.707'

2025/06/26 16:10:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.417ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:10:45.793' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:10:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.405ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:10:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.829ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:40:45.856'

2025/06/26 16:10:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.805ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:10:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.656ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:10:45.938' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:10:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.975ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:10:45.96' AND status != 'pending'
	

2025/06/26 16:10:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.435ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:10:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.758ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:10:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.846ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:10:46.04' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:10:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.984ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:10:46.112' AND status != 'pending'
	

2025/06/26 16:10:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.790ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:10:46.12'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:10:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.085ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:10:46.195' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:10:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.764ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:10:46.281'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[76.975ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:56:45.208' LIMIT 50

2025/06/26 16:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.020ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:56:45.202' LIMIT 50

2025/06/26 16:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.105ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:11:45.202'

2025/06/26 16:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.181ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:11:45.202'

2025/06/26 16:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[89.002ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:11:45.202'

2025/06/26 16:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.199ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:41:45.707'

2025/06/26 16:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.955ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:11:45.793' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.695ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.387ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:41:45.856'

2025/06/26 16:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.214ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:11:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.769ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:11:45.943' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:11:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.970ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:11:45.964' AND status != 'pending'
	

2025/06/26 16:11:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.214ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:11:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.889ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:11:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.857ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:11:46.045' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:11:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.811ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:11:46.115' AND status != 'pending'
	

2025/06/26 16:11:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.380ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:11:46.125'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:11:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.661ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:11:46.202' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:11:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.156ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:11:46.287'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:12:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.254ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:12:45.203'

2025/06/26 16:12:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.145ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:12:45.203'

2025/06/26 16:12:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.227ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:12:45.203'

2025/06/26 16:12:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.183ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:42:45.707'

2025/06/26 16:12:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[92.361ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:12:45.795' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:12:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.058ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:12:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.954ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:42:45.857'

2025/06/26 16:12:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.335ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:12:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.269ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:12:45.938' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:12:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.246ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:12:45.97' AND status != 'pending'
	

2025/06/26 16:12:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.530ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:12:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.008ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:12:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.596ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:12:46.055' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:12:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.958ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:12:46.101' AND status != 'pending'
	

2025/06/26 16:12:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.229ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:12:46.14'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:12:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.388ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:12:46.181' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:12:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.350ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:12:46.266'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.471ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:58:45.199' LIMIT 50

2025/06/26 16:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[88.057ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:13:45.193'

2025/06/26 16:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[88.336ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:58:45.193' LIMIT 50

2025/06/26 16:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.127ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:13:45.193'

2025/06/26 16:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.334ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:13:45.193'

2025/06/26 16:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.356ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:43:45.698'

2025/06/26 16:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.728ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:13:45.779' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.084ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.969ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:43:45.847'

2025/06/26 16:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.505ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:13:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.456ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:13:45.932' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:13:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.694ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:13:45.942' AND status != 'pending'
	

2025/06/26 16:13:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.158ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:13:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.315ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:13:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.605ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:13:46.029' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:13:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.291ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:13:46.101' AND status != 'pending'
	

2025/06/26 16:13:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.685ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:13:46.109'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:13:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.888ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:13:46.186' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:13:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.470ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:13:46.269'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:14:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.043ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:14:45.192'

2025/06/26 16:14:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[85.826ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:14:45.192'

2025/06/26 16:14:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.065ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:14:45.192'

2025/06/26 16:14:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.684ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:44:45.698'

2025/06/26 16:14:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.079ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:14:45.785' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:14:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.270ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:14:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.482ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:44:45.847'

2025/06/26 16:14:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.814ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:14:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.635ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:14:45.935' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:14:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.762ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:14:45.949' AND status != 'pending'
	

2025/06/26 16:14:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.622ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:14:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.501ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:14:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.160ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:14:46.033' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:14:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.516ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:14:46.102' AND status != 'pending'
	

2025/06/26 16:14:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.498ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:14:46.115'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:14:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.906ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:14:46.185' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:14:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.442ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:14:46.269'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.981ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:00:45.199' LIMIT 50

2025/06/26 16:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[89.764ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:00:45.193' LIMIT 50

2025/06/26 16:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.527ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:15:45.193'

2025/06/26 16:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.394ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:15:45.193'

2025/06/26 16:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.040ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:15:45.193'

2025/06/26 16:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.466ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:45:45.699'

2025/06/26 16:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.421ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:15:45.788' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.635ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.664ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:45:45.846'

2025/06/26 16:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.605ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:15:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.780ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:15:45.928' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:15:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.011ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:15:45.955' AND status != 'pending'
	

2025/06/26 16:15:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.826ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:15:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.136ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:15:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.912ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:15:46.041' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:15:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.648ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:15:46.091' AND status != 'pending'
	

2025/06/26 16:15:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.189ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:15:46.126'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:15:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.418ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:15:46.171' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:15:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.029ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:15:46.256'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:16:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.460ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:16:45.193'

2025/06/26 16:16:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.342ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:16:45.193'

2025/06/26 16:16:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.891ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:16:45.193'

2025/06/26 16:16:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.299ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:46:45.699'

2025/06/26 16:16:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.949ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:16:45.782' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:16:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.691ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:16:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.357ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:16:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.537ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:46:45.861'

2025/06/26 16:16:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.715ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:16:45.947' AND status != 'pending'
	

2025/06/26 16:16:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.227ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:16:45.947' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:16:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.219ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:16:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.104ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:16:46.026' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:16:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.134ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:16:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.126ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:16:46.109'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:16:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.989ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:16:46.112' AND status != 'pending'
	

2025/06/26 16:16:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.159ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:16:46.194' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:16:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.272ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:16:46.28'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.514ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:02:45.194' LIMIT 50

2025/06/26 16:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.817ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:17:45.194'

2025/06/26 16:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[77.802ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:02:45.2' LIMIT 50

2025/06/26 16:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.773ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:17:45.194'

2025/06/26 16:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[89.341ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:17:45.194'

2025/06/26 16:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.617ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:47:45.699'

2025/06/26 16:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.884ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:17:45.782' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.397ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.058ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:47:45.848'

2025/06/26 16:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.944ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:17:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.776ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:17:45.924' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:17:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.936ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:17:45.953' AND status != 'pending'
	

2025/06/26 16:17:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.868ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:17:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.670ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:17:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.763ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:17:46.035' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:17:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.400ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:17:46.08' AND status != 'pending'
	

2025/06/26 16:17:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.628ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:17:46.116'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:17:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.748ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:17:46.158' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:17:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.259ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:17:46.24'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:18:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.985ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:18:45.194'

2025/06/26 16:18:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.674ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:18:45.194'

2025/06/26 16:18:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.403ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:18:45.194'

2025/06/26 16:18:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.589ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:48:45.7'

2025/06/26 16:18:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.968ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:18:45.783' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:18:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.446ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:18:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.958ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:48:45.848'

2025/06/26 16:18:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.580ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:18:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.189ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:18:45.935' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:18:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.339ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:18:45.944' AND status != 'pending'
	

2025/06/26 16:18:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.500ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:18:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.960ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:18:46.019' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:18:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.271ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:18:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.775ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:18:46.098'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:18:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.999ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:18:46.101' AND status != 'pending'
	

2025/06/26 16:18:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.647ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:18:46.183' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:18:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.151ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:18:46.266'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[86.079ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:04:45.194' LIMIT 50

2025/06/26 16:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[90.099ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:04:45.201' LIMIT 50

2025/06/26 16:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[96.836ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:19:45.194'

2025/06/26 16:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.582ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:19:45.194'

2025/06/26 16:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[100.381ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:19:45.194'

2025/06/26 16:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.830ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:49:45.7'

2025/06/26 16:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.332ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:19:45.786' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.445ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.242ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:49:45.848'

2025/06/26 16:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[53.638ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:19:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.344ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:19:45.936' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:19:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.182ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:19:45.964' AND status != 'pending'
	

2025/06/26 16:19:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.703ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:19:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.392ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:19:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.941ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:19:46.049' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:19:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.373ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:19:46.11' AND status != 'pending'
	

2025/06/26 16:19:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.966ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:19:46.135'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:19:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[100.812ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:19:46.195' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:19:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[104.823ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:19:46.296'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[91.243ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:20:45.194'

2025/06/26 16:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.133ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:20:45.194'

2025/06/26 16:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[87.576ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:20:45.194'

2025/06/26 16:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.805ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:50:45.7'

2025/06/26 16:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.821ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:20:45.785' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.528ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.245ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:50:45.849'

2025/06/26 16:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.994ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:20:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.378ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:20:45.93' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:20:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.223ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:20:45.954' AND status != 'pending'
	

2025/06/26 16:20:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.274ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:20:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.348ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:20:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.094ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:20:46.037' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:20:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.338ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:20:46.1' AND status != 'pending'
	

2025/06/26 16:20:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.683ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:20:46.121'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:20:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.086ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:20:46.185' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:20:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.332ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:20:46.271'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.005ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:06:45.202' LIMIT 50

2025/06/26 16:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.801ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:06:45.195' LIMIT 50

2025/06/26 16:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.930ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:21:45.195'

2025/06/26 16:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.969ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:21:45.195'

2025/06/26 16:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.278ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:21:45.195'

2025/06/26 16:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.862ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:51:45.701'

2025/06/26 16:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.029ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:21:45.787' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.118ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.153ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:51:45.849'

2025/06/26 16:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.686ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:21:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.099ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:21:45.936' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:21:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.544ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:21:45.959' AND status != 'pending'
	

2025/06/26 16:21:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.453ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:21:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.205ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:21:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.471ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:21:46.041' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:21:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[133.172ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:21:46.104' AND status != 'pending'
	

2025/06/26 16:21:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[109.909ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:21:46.127'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:21:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.968ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:21:46.237' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:21:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.943ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:21:46.318'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:22:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.646ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:22:45.195'

2025/06/26 16:22:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.246ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:22:45.195'

2025/06/26 16:22:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.533ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:22:45.195'

2025/06/26 16:22:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.584ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:52:45.7'

2025/06/26 16:22:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.504ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:22:45.783' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:22:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.327ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:22:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.577ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:52:45.849'

2025/06/26 16:22:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.593ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:22:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.479ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:22:45.931' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:22:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.235ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:22:45.947' AND status != 'pending'
	

2025/06/26 16:22:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.539ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:22:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[55.329ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:22:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.612ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:22:46.028' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:22:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.621ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:22:46.115'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:22:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.212ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:22:46.115' AND status != 'pending'
	

2025/06/26 16:22:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.528ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:22:46.197' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:22:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.800ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:22:46.279'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:23:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.243ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:08:45.202' LIMIT 50

2025/06/26 16:23:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[86.199ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:08:45.196' LIMIT 50

2025/06/26 16:23:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.146ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:23:45.196'

2025/06/26 16:23:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[83.668ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:23:45.196'

2025/06/26 16:23:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[84.266ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:23:45.196'

2025/06/26 16:23:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.962ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:53:45.702'

2025/06/26 16:23:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.968ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:23:45.79' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:23:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.477ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:23:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.802ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:53:45.849'

2025/06/26 16:23:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.828ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.367ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:23:45.93' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.219ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:23:45.961' AND status != 'pending'
	

2025/06/26 16:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.450ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.906ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.971ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:23:46.047' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.615ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:23:46.096' AND status != 'pending'
	

2025/06/26 16:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.067ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:23:46.137'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.901ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:23:46.177' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.195ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:23:46.262'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:24:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.549ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:24:45.196'

2025/06/26 16:24:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.075ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:24:45.196'

2025/06/26 16:24:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[91.932ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:24:45.196'

2025/06/26 16:24:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.290ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:54:45.702'

2025/06/26 16:24:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.273ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:24:45.789' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:24:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.676ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:24:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.735ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:54:45.85'

2025/06/26 16:24:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.861ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:24:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.505ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:24:45.935' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:24:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.301ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:24:45.955' AND status != 'pending'
	

2025/06/26 16:24:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.629ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:24:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.686ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:24:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.400ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:24:46.035' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:24:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.115ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:24:46.108' AND status != 'pending'
	

2025/06/26 16:24:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.984ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:24:46.116'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:24:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.668ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:24:46.191' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:24:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[91.746ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:24:46.278'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.418ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:25:45.197'

2025/06/26 16:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.638ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:10:45.197' LIMIT 50

2025/06/26 16:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.587ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:10:45.203' LIMIT 50

2025/06/26 16:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.166ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:25:45.197'

2025/06/26 16:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[88.342ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:25:45.197'

2025/06/26 16:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.282ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:55:45.701'

2025/06/26 16:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.833ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:25:45.788' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.848ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.003ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:55:45.851'

2025/06/26 16:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.040ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:25:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.736ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:25:45.93' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:25:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.341ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:25:45.953' AND status != 'pending'
	

2025/06/26 16:25:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.437ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:25:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.214ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:25:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.135ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:25:46.037' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:25:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.074ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:25:46.085' AND status != 'pending'
	

2025/06/26 16:25:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.318ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:25:46.118'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:25:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.344ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:25:46.167' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:25:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.154ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:25:46.248'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:26:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[95.576ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:26:45.241'

2025/06/26 16:26:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.384ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:26:45.241'

2025/06/26 16:26:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[93.633ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:26:45.241'

2025/06/26 16:26:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[93.031ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:56:45.743'

2025/06/26 16:26:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[107.650ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:26:45.836' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:26:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[55.261ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[135.230ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:56:45.865'

2025/06/26 16:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.617ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[107.588ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:26:46' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[95.046ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:26:46.043' AND status != 'pending'
	

2025/06/26 16:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[47.380ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.918ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[115.737ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:26:46.138' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[99.909ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:26:46.195' AND status != 'pending'
	

2025/06/26 16:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[121.253ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:26:46.254'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[92.492ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:26:46.295' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[163.196ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:26:46.387'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.270ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:27:45.198'

2025/06/26 16:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.117ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:12:45.198' LIMIT 50

2025/06/26 16:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.447ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:12:45.204' LIMIT 50

2025/06/26 16:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[85.786ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:27:45.198'

2025/06/26 16:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[84.702ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:27:45.198'

2025/06/26 16:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.397ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:57:45.703'

2025/06/26 16:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.304ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:27:45.785' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.160ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.998ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:57:45.851'

2025/06/26 16:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.287ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:27:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.349ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:27:45.938' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:27:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.938ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:27:45.95' AND status != 'pending'
	

2025/06/26 16:27:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.006ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:27:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.469ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:27:46.026' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:27:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.406ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:27:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.813ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:27:46.102'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:27:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.115ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:27:46.108' AND status != 'pending'
	

2025/06/26 16:27:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.163ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:27:46.189' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:27:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.509ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:27:46.278'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:28:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.225ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:28:45.197'

2025/06/26 16:28:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[91.513ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:28:45.197'

2025/06/26 16:28:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.295ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:28:45.197'

2025/06/26 16:28:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.227ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:58:45.703'

2025/06/26 16:28:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.667ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:28:45.791' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:28:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.467ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:28:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.466ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:58:45.852'

2025/06/26 16:28:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.026ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:28:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.889ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:28:45.93' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:28:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.077ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:28:45.96' AND status != 'pending'
	

2025/06/26 16:28:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.614ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:28:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.969ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:28:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.911ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:28:46.046' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:28:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.215ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:28:46.085' AND status != 'pending'
	

2025/06/26 16:28:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.693ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:28:46.129'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:28:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.480ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:28:46.167' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:28:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.719ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:28:46.248'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[76.985ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:29:45.198'

2025/06/26 16:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.168ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:14:45.198' LIMIT 50

2025/06/26 16:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.323ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:14:45.205' LIMIT 50

2025/06/26 16:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.775ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:29:45.198'

2025/06/26 16:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.541ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:29:45.198'

2025/06/26 16:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.194ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:59:45.714'

2025/06/26 16:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.247ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:29:45.79' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.891ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.611ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 15:59:45.852'

2025/06/26 16:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.950ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:29:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.710ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:29:45.944' AND status != 'pending'
	

2025/06/26 16:29:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.376ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:29:45.935' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:29:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.293ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:29:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.889ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:29:46.023' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:29:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.314ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:29:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.662ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:29:46.101'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:29:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.989ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:29:46.109' AND status != 'pending'
	

2025/06/26 16:29:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.696ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:29:46.193' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:29:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.112ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:29:46.275'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:30:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.984ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:30:45.199'

2025/06/26 16:30:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[91.843ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:30:45.199'

2025/06/26 16:30:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.595ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:30:45.199'

2025/06/26 16:30:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.574ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:00:45.704'

2025/06/26 16:30:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.840ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:30:45.794' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:30:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.246ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:30:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.437ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:00:45.853'

2025/06/26 16:30:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.707ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:30:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.610ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:30:45.934' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:30:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.988ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:30:45.956' AND status != 'pending'
	

2025/06/26 16:30:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.971ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:30:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.673ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:30:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.177ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:30:46.038' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:30:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.088ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:30:46.093' AND status != 'pending'
	

2025/06/26 16:30:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.850ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:30:46.12'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:30:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.279ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:30:46.17' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:30:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.234ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:30:46.251'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.229ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:31:45.199'

2025/06/26 16:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.478ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:16:45.199' LIMIT 50

2025/06/26 16:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.759ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:16:45.205' LIMIT 50

2025/06/26 16:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.199ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:31:45.199'

2025/06/26 16:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.366ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:31:45.199'

2025/06/26 16:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.513ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:01:45.704'

2025/06/26 16:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.745ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:31:45.786' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.612ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.057ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:01:45.853'

2025/06/26 16:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.887ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:31:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.078ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:31:45.944' AND status != 'pending'
	

2025/06/26 16:31:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.004ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:31:45.938' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:31:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.305ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:31:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.794ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:31:46.022' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:31:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.350ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:31:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.132ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:31:46.105'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:31:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.534ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:31:46.106' AND status != 'pending'
	

2025/06/26 16:31:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[94.081ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:31:46.191' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:31:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.515ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:31:46.285'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:32:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.938ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:32:45.199'

2025/06/26 16:32:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[85.638ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:32:45.199'

2025/06/26 16:32:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.741ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:32:45.199'

2025/06/26 16:32:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.836ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:02:45.705'

2025/06/26 16:32:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.328ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:32:45.788' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:32:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.892ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:32:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.375ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:02:45.853'

2025/06/26 16:32:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.748ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:32:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.077ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:32:45.932' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:32:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.452ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:32:45.958' AND status != 'pending'
	

2025/06/26 16:32:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.245ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:32:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.987ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:32:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.592ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:32:46.04' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:32:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.384ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:32:46.089' AND status != 'pending'
	

2025/06/26 16:32:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.509ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:32:46.122'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:32:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.138ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:32:46.172' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:32:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.890ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:32:46.252'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.181ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:33:45.2'

2025/06/26 16:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.005ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:18:45.2' LIMIT 50

2025/06/26 16:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.101ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:18:45.206' LIMIT 50

2025/06/26 16:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.760ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:33:45.2'

2025/06/26 16:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.821ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:33:45.2'

2025/06/26 16:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.844ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:03:45.705'

2025/06/26 16:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.188ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:33:45.786' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.175ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.062ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:03:45.854'

2025/06/26 16:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.673ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:33:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.218ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:33:45.936' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:33:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.966ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:33:45.945' AND status != 'pending'
	

2025/06/26 16:33:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.461ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:33:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.160ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:33:46.021' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:33:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.739ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:33:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.184ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:33:46.1'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:33:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.365ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:33:46.101' AND status != 'pending'
	

2025/06/26 16:33:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.387ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:33:46.181' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:33:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.575ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:33:46.266'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:34:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.387ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:34:45.2'

2025/06/26 16:34:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.063ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:34:45.2'

2025/06/26 16:34:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.202ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:34:45.2'

2025/06/26 16:34:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.298ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:04:45.706'

2025/06/26 16:34:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.073ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:34:45.792' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:34:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.219ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:34:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.462ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:04:45.854'

2025/06/26 16:34:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.660ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.890ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:34:45.935' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.085ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:34:45.956' AND status != 'pending'
	

2025/06/26 16:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.551ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.853ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.372ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:34:46.036' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.532ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:34:46.094' AND status != 'pending'
	

2025/06/26 16:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.514ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:34:46.121'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.607ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:34:46.17' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.784ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:34:46.252'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.798ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:35:45.201'

2025/06/26 16:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.061ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:20:45.201' LIMIT 50

2025/06/26 16:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.029ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:20:45.207' LIMIT 50

2025/06/26 16:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.876ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:35:45.201'

2025/06/26 16:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.386ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:35:45.201'

2025/06/26 16:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.046ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:05:45.706'

2025/06/26 16:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.460ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:35:45.789' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.378ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.153ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:05:45.855'

2025/06/26 16:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.869ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:35:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.341ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:35:45.942' AND status != 'pending'
	

2025/06/26 16:35:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.043ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:35:45.939' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:35:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.335ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:35:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.745ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:35:46.023' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:35:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.291ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:35:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.272ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:35:46.101'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:35:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.223ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:35:46.108' AND status != 'pending'
	

2025/06/26 16:35:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.026ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:35:46.19' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:35:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.244ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:35:46.274'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:36:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[88.634ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:36:45.201'

2025/06/26 16:36:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.883ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:36:45.201'

2025/06/26 16:36:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.848ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:36:45.201'

2025/06/26 16:36:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.976ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:06:45.706'

2025/06/26 16:36:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[96.607ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:36:45.793' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:36:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.488ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:36:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.356ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:06:45.855'

2025/06/26 16:36:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.107ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:36:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.036ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:36:45.933' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:36:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.634ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:36:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.983ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:36:45.973' AND status != 'pending'
	

2025/06/26 16:36:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.495ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:36:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.890ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:36:46.055' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:36:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.320ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:36:46.092' AND status != 'pending'
	

2025/06/26 16:36:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.310ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:36:46.136'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:36:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.357ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:36:46.174' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:36:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.628ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:36:46.257'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.229ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:37:45.201'

2025/06/26 16:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.215ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:22:45.208' LIMIT 50

2025/06/26 16:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.650ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:22:45.201' LIMIT 50

2025/06/26 16:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.116ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:37:45.201'

2025/06/26 16:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[82.687ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:37:45.201'

2025/06/26 16:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.757ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:07:45.706'

2025/06/26 16:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.956ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:37:45.788' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.082ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.433ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:07:45.855'

2025/06/26 16:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.001ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:37:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.154ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:37:45.945' AND status != 'pending'
	

2025/06/26 16:37:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.266ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:37:45.939' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:37:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.549ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:37:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.256ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:37:46.024' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:37:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.148ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:37:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.399ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:37:46.107'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:37:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.744ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:37:46.108' AND status != 'pending'
	

2025/06/26 16:37:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.761ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:37:46.192' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:37:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.286ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:37:46.276'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:38:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.086ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:38:45.202'

2025/06/26 16:38:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.877ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:38:45.202'

2025/06/26 16:38:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[82.863ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:38:45.202'

2025/06/26 16:38:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.234ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:08:45.707'

2025/06/26 16:38:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.084ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:38:45.795' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:38:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.217ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:38:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.193ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:08:45.856'

2025/06/26 16:38:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.753ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:38:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.744ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:38:45.933' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:38:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[88.481ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:38:45.962' AND status != 'pending'
	

2025/06/26 16:38:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.929ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:38:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.905ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:38:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.091ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:38:46.051' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:38:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.850ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:38:46.09' AND status != 'pending'
	

2025/06/26 16:38:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.857ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:38:46.133'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:38:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.289ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:38:46.171' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:38:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.960ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:38:46.256'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[77.825ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:24:45.201' LIMIT 50

2025/06/26 16:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.343ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:39:45.202'

2025/06/26 16:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.686ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:24:45.208' LIMIT 50

2025/06/26 16:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.197ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:39:45.202'

2025/06/26 16:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.300ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:39:45.202'

2025/06/26 16:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[90.390ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:09:45.708'

2025/06/26 16:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.374ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:39:45.798' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.161ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.317ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:09:45.856'

2025/06/26 16:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.137ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:39:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.482ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:39:45.937' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:39:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.212ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:39:45.968' AND status != 'pending'
	

2025/06/26 16:39:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.320ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:39:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.877ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:39:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.160ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:39:46.049' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:39:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.953ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:39:46.105' AND status != 'pending'
	

2025/06/26 16:39:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.458ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:39:46.131'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:39:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.600ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:39:46.192' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:39:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.058ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:39:46.274'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:40:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.608ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:40:45.202'

2025/06/26 16:40:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.815ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:40:45.202'

2025/06/26 16:40:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.180ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:40:45.202'

2025/06/26 16:40:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.666ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:10:45.708'

2025/06/26 16:40:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.020ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:40:45.794' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:40:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.817ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:40:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.596ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:10:45.856'

2025/06/26 16:40:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.741ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:40:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.996ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:40:45.939' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:40:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.874ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:40:45.96' AND status != 'pending'
	

2025/06/26 16:40:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.588ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:40:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.228ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:40:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.897ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:40:46.04' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:40:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.999ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:40:46.112' AND status != 'pending'
	

2025/06/26 16:40:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.393ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:40:46.12'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:40:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.433ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:40:46.198' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:40:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.290ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:40:46.284'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.984ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:26:45.209' LIMIT 50

2025/06/26 16:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[86.924ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:26:45.202' LIMIT 50

2025/06/26 16:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.291ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:41:45.202'

2025/06/26 16:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[83.307ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:41:45.202'

2025/06/26 16:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.416ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:41:45.202'

2025/06/26 16:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.133ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:11:45.708'

2025/06/26 16:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.214ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:41:45.798' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.210ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.401ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:11:45.857'

2025/06/26 16:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.127ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:41:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.789ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:41:45.938' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:41:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.649ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:41:45.968' AND status != 'pending'
	

2025/06/26 16:41:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.702ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:41:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.003ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:41:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.686ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:41:46.053' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:41:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.489ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:41:46.103' AND status != 'pending'
	

2025/06/26 16:41:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.730ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:41:46.138'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:41:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[101.144ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:41:46.184' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:41:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.207ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:41:46.285'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:42:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.137ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:42:45.203'

2025/06/26 16:42:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.374ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:42:45.203'

2025/06/26 16:42:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.010ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:42:45.203'

2025/06/26 16:42:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.897ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:12:45.708'

2025/06/26 16:42:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.945ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:42:45.798' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:42:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.035ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:42:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.340ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:12:45.857'

2025/06/26 16:42:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.521ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:42:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.182ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:42:45.943' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:42:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.689ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:42:45.96' AND status != 'pending'
	

2025/06/26 16:42:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.904ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:42:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.295ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:42:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.436ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:42:46.04' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:42:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.936ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:42:46.11' AND status != 'pending'
	

2025/06/26 16:42:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.144ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:42:46.128'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:42:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[88.604ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:42:46.193' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:42:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.692ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:42:46.281'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.140ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:43:45.204'

2025/06/26 16:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.100ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:28:45.21' LIMIT 50

2025/06/26 16:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.553ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:28:45.203' LIMIT 50

2025/06/26 16:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[83.102ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:43:45.204'

2025/06/26 16:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.226ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:43:45.204'

2025/06/26 16:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.347ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:13:45.708'

2025/06/26 16:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.383ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:43:45.793' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.579ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.713ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:13:45.858'

2025/06/26 16:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.803ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:43:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.401ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:43:45.939' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:43:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.476ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:43:45.959' AND status != 'pending'
	

2025/06/26 16:43:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.526ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:43:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.439ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:43:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.619ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:43:46.039' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:43:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.622ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:43:46.119'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:43:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.080ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:43:46.114' AND status != 'pending'
	

2025/06/26 16:43:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.656ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:43:46.199' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:43:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.991ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:43:46.282'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:44:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.885ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:44:45.203'

2025/06/26 16:44:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[91.145ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:44:45.203'

2025/06/26 16:44:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.198ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:44:45.203'

2025/06/26 16:44:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.502ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:14:45.709'

2025/06/26 16:44:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.236ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:44:45.796' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:44:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.080ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:44:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.467ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:14:45.858'

2025/06/26 16:44:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.733ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:44:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.941ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:44:45.939' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:44:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.043ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:44:45.97' AND status != 'pending'
	

2025/06/26 16:44:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.348ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:44:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.161ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:44:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.607ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:44:46.055' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:44:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.059ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:44:46.101' AND status != 'pending'
	

2025/06/26 16:44:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.968ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:44:46.14'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:44:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.467ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:44:46.182' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:44:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.959ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:44:46.266'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.668ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:45:45.204'

2025/06/26 16:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.685ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:30:45.204' LIMIT 50

2025/06/26 16:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[76.502ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:30:45.211' LIMIT 50

2025/06/26 16:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[87.136ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:45:45.204'

2025/06/26 16:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.025ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:45:45.204'

2025/06/26 16:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.330ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:15:45.71'

2025/06/26 16:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.233ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:45:45.791' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.500ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.020ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:15:45.858'

2025/06/26 16:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.690ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:45:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.301ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:45:45.935' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:45:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.867ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:45:45.952' AND status != 'pending'
	

2025/06/26 16:45:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.008ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:45:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.233ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:45:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.340ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:45:46.035' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:45:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.002ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:45:46.1' AND status != 'pending'
	

2025/06/26 16:45:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.291ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:45:46.115'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:45:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.928ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:45:46.178' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:45:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.121ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:45:46.257'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:46:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.545ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:46:45.205'

2025/06/26 16:46:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.491ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:46:45.205'

2025/06/26 16:46:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.862ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:46:45.205'

2025/06/26 16:46:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.190ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:16:45.71'

2025/06/26 16:46:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.706ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:46:45.787' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:46:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.831ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:46:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.984ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:16:45.859'

2025/06/26 16:46:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.575ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:46:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.723ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:46:45.942' AND status != 'pending'
	

2025/06/26 16:46:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.229ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:46:45.94' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:46:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.449ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:46:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.144ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:46:46.021' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:46:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.001ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:46:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.956ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:46:46.098'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:46:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.332ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:46:46.102' AND status != 'pending'
	

2025/06/26 16:46:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.350ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:46:46.182' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:46:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.046ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:46:46.264'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.548ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:47:45.205'

2025/06/26 16:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.825ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:32:45.205' LIMIT 50

2025/06/26 16:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.270ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:32:45.211' LIMIT 50

2025/06/26 16:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.640ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:47:45.205'

2025/06/26 16:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.116ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:47:45.205'

2025/06/26 16:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.468ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:17:45.711'

2025/06/26 16:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.546ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:47:45.792' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.850ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.023ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:17:45.859'

2025/06/26 16:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.307ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:47:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.901ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:47:45.946' AND status != 'pending'
	

2025/06/26 16:47:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.029ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:47:45.944' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:47:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.960ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:47:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.078ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:47:46.025' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:47:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.305ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:47:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.773ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:47:46.105'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:47:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.191ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:47:46.116' AND status != 'pending'
	

2025/06/26 16:47:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[89.640ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:47:46.198' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:47:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.336ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:47:46.288'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:47:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:309
[83.783ms] [rows:1] SELECT * FROM `role` WHERE id = 3 ORDER BY `role`.`id` LIMIT 1

2025/06/26 16:47:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:320
[88.995ms] [rows:0] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 3

2025/06/26 16:47:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[82.207ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/26 16:47:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[45.774ms] [rows:20] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/26 16:48:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[85.248ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 16:48:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[43.821ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 16:48:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[39.022ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 16:48:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[81.572ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 16:48:02 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[84.084ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/26 16:48:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[39.099ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 16:48:03 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[82.018ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/26 16:48:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.410ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:48:45.205'

2025/06/26 16:48:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.789ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:48:45.205'

2025/06/26 16:48:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.454ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:48:45.205'

2025/06/26 16:48:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.953ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:18:45.71'

2025/06/26 16:48:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.506ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:48:45.791' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:48:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.725ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:48:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.728ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:18:45.859'

2025/06/26 16:48:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.848ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:48:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.634ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:48:45.946' AND status != 'pending'
	

2025/06/26 16:48:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.217ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:48:45.945' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:48:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.297ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:48:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.955ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:48:46.024' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:48:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.804ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:48:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.855ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:48:46.101'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:48:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.659ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:48:46.111' AND status != 'pending'
	

2025/06/26 16:48:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.954ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:48:46.194' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:48:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.766ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:48:46.276'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[77.758ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:49:45.206'

2025/06/26 16:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.918ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:34:45.206' LIMIT 50

2025/06/26 16:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[88.780ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:34:45.212' LIMIT 50

2025/06/26 16:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.302ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:49:45.206'

2025/06/26 16:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[91.062ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:49:45.206'

2025/06/26 16:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.157ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:19:45.711'

2025/06/26 16:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.813ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:49:45.792' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.942ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.348ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:19:45.859'

2025/06/26 16:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.350ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:49:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[83.174ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:49:45.941' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:49:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.966ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:49:45.95' AND status != 'pending'
	

2025/06/26 16:49:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[46.791ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:49:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.864ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:49:46.025' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:49:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.573ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:49:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.216ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:49:46.109'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:49:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.856ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:49:46.112' AND status != 'pending'
	

2025/06/26 16:49:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.263ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:49:46.193' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:49:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.320ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:49:46.275'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:50:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.670ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:50:45.206'

2025/06/26 16:50:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.729ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:50:45.206'

2025/06/26 16:50:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[100.105ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:50:45.206'

2025/06/26 16:50:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.606ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:20:45.712'

2025/06/26 16:50:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.356ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:50:45.796' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:50:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.028ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:50:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.265ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:20:45.86'

2025/06/26 16:50:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.027ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.615ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:50:45.937' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.254ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:50:45.961' AND status != 'pending'
	

2025/06/26 16:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.522ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.554ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.306ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:50:46.046' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.477ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:50:46.092' AND status != 'pending'
	

2025/06/26 16:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.991ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:50:46.126'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.499ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:50:46.17' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.457ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:50:46.249'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[77.680ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:51:45.206'

2025/06/26 16:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.758ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:36:45.206' LIMIT 50

2025/06/26 16:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.681ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:36:45.213' LIMIT 50

2025/06/26 16:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.193ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:51:45.206'

2025/06/26 16:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.334ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:51:45.206'

2025/06/26 16:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.657ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:21:45.712'

2025/06/26 16:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.735ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:51:45.789' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.038ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.454ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:21:45.86'

2025/06/26 16:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.473ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:51:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.496ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:51:45.948' AND status != 'pending'
	

2025/06/26 16:51:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.129ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:51:45.948' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:51:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.294ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:51:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.043ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:51:46.029' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:51:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.857ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:51:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.159ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:51:46.108'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:51:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.199ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:51:46.117' AND status != 'pending'
	

2025/06/26 16:51:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.586ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:51:46.2' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:51:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.877ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:51:46.284'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:52:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.223ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:52:45.163'

2025/06/26 16:52:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.603ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:52:45.163'

2025/06/26 16:52:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.201ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:52:45.163'

2025/06/26 16:52:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.778ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:22:45.669'

2025/06/26 16:52:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.946ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:52:45.756' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:52:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.661ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:52:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.478ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:22:45.817'

2025/06/26 16:52:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.587ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:52:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.689ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:52:45.898' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:52:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.132ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:52:45.921' AND status != 'pending'
	

2025/06/26 16:52:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.937ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:52:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.382ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:52:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.813ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:52:46.003' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:52:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.643ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:52:46.058' AND status != 'pending'
	

2025/06/26 16:52:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.467ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:52:46.088'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:52:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.860ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:52:46.137' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:52:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.372ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:52:46.216'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.103ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:53:45.16'

2025/06/26 16:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.192ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:38:45.16' LIMIT 50

2025/06/26 16:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.992ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:38:45.166' LIMIT 50

2025/06/26 16:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.064ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:53:45.16'

2025/06/26 16:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.121ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:53:45.16'

2025/06/26 16:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.500ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:23:45.665'

2025/06/26 16:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.733ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:53:45.743' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.069ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.409ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:23:45.814'

2025/06/26 16:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.633ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.452ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:53:45.902' AND status != 'pending'
	

2025/06/26 16:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.598ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:53:45.901' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:53:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.674ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:53:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.133ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:53:45.978' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:53:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.730ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:53:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.767ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:53:46.061'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:53:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.083ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:53:46.063' AND status != 'pending'
	

2025/06/26 16:53:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.521ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:53:46.143' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:53:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.266ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:53:46.224'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.924ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:54:45.16'

2025/06/26 16:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.775ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:54:45.16'

2025/06/26 16:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.091ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:54:45.16'

2025/06/26 16:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.577ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:24:45.665'

2025/06/26 16:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.320ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:54:45.747' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.158ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.709ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:24:45.814'

2025/06/26 16:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.031ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.971ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:54:45.89' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.599ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:54:45.917' AND status != 'pending'
	

2025/06/26 16:54:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.712ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:54:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.170ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:54:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.140ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:54:45.996' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:54:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.314ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:54:46.048' AND status != 'pending'
	

2025/06/26 16:54:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.877ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:54:46.08'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:54:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.123ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:54:46.125' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:54:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.546ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:54:46.204'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.308ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:55:45.159'

2025/06/26 16:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.354ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:40:45.159' LIMIT 50

2025/06/26 16:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.937ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:40:45.166' LIMIT 50

2025/06/26 16:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.657ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:55:45.159'

2025/06/26 16:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.580ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:55:45.159'

2025/06/26 16:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.028ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:25:45.665'

2025/06/26 16:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.560ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:55:45.75' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.967ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.471ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:25:45.813'

2025/06/26 16:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.092ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.169ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:55:45.896' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.460ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:55:45.907' AND status != 'pending'
	

2025/06/26 16:55:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.826ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:55:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.683ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:55:45.984' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:55:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.805ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:55:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.517ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:55:46.064'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:55:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.167ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:55:46.067' AND status != 'pending'
	

2025/06/26 16:55:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.079ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:55:46.15' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:55:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[82.047ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:55:46.233'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:56:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[84.683ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 16:56:21 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[40.271ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 16:56:22 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[84.161ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 16:56:23 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[41.623ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 16:56:24 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[89.461ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/26 16:56:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[45.348ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 16:56:29 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[85.690ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/26 16:56:32 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:338
[43.092ms] [rows:1] SELECT count(*) FROM `sys_dict_type`

2025/06/26 16:56:32 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/system.go:338
[82.498ms] [rows:10] SELECT * FROM `sys_dict_type` ORDER BY create_time DESC LIMIT 10

2025/06/26 16:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.223ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:56:45.159'

2025/06/26 16:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.777ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:56:45.159'

2025/06/26 16:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.320ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:56:45.159'

2025/06/26 16:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.002ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:26:45.665'

2025/06/26 16:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.183ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:56:45.754' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[44.401ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.203ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:26:45.812'

2025/06/26 16:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.977ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.032ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:56:45.89' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.666ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:56:45.922' AND status != 'pending'
	

2025/06/26 16:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.634ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.314ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.325ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:56:46.007' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.981ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:56:46.047' AND status != 'pending'
	

2025/06/26 16:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.652ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:56:46.087'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.020ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:56:46.127' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.108ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:56:46.205'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:56:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:98
[40.488ms] [rows:1] SELECT count(*) FROM `order`

2025/06/26 16:56:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:116
[80.608ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` ORDER BY create_time DESC LIMIT 10

2025/06/26 16:56:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:165
[78.700ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (6,108,109,116)

2025/06/26 16:56:52 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/goods_optimized.go:127
[83.385ms] [rows:1] SELECT id, goods_name, content, price, stock, cover, status, category_id, create_time, update_time FROM `goods_list` WHERE id IN (1) AND isdelete != 1

2025/06/26 16:56:53 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:98
[41.351ms] [rows:1] SELECT count(*) FROM `order`

2025/06/26 16:56:53 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:116
[87.573ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` ORDER BY create_time DESC LIMIT 10

2025/06/26 16:56:53 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:165
[83.249ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (109,116,6,108)

2025/06/26 16:56:54 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:98
[41.749ms] [rows:1] SELECT count(*) FROM `order`

2025/06/26 16:56:54 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:116
[87.893ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` ORDER BY create_time DESC LIMIT 10

2025/06/26 16:56:54 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:165
[86.629ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (6,108,109,116)

2025/06/26 16:56:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/revenue.go:79
[83.144ms] [rows:1] SELECT count(*) FROM merchant_revenue_stats FORCE INDEX (idx_stat_date) WHERE tenants_id = 1

2025/06/26 16:56:57 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/revenue.go:82
[87.798ms] [rows:10] SELECT id, tenants_id, stat_date, total_orders, total_revenue, actual_revenue, paid_orders FROM merchant_revenue_stats FORCE INDEX (idx_stat_date) WHERE tenants_id = 1 ORDER BY stat_date DESC LIMIT 10

2025/06/26 16:57:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:98
[45.241ms] [rows:1] SELECT count(*) FROM `order`

2025/06/26 16:57:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:116
[83.520ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` ORDER BY create_time DESC LIMIT 10

2025/06/26 16:57:10 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/order.go:165
[85.818ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (116,6,108,109)

2025/06/26 16:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[89.288ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:57:45.159'

2025/06/26 16:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.683ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:42:45.165' LIMIT 50

2025/06/26 16:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[95.438ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:42:45.159' LIMIT 50

2025/06/26 16:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.872ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:57:45.159'

2025/06/26 16:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.047ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:57:45.159'

2025/06/26 16:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.701ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:27:45.664'

2025/06/26 16:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.612ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:57:45.745' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.462ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.390ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:27:45.812'

2025/06/26 16:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.938ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.614ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:57:45.9' AND status != 'pending'
	

2025/06/26 16:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.308ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:57:45.894' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:57:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.093ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:57:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.447ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:57:45.978' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:57:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.084ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:57:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.083ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:57:46.058'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:57:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.476ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:57:46.063' AND status != 'pending'
	

2025/06/26 16:57:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.272ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:57:46.146' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:57:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.439ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:57:46.232'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.806ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:58:45.158'

2025/06/26 16:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.827ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:58:45.158'

2025/06/26 16:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.111ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:58:45.158'

2025/06/26 16:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.231ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:28:45.664'

2025/06/26 16:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.109ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:58:45.748' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.556ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.667ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:28:45.813'

2025/06/26 16:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.962ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.700ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:58:45.893' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.858ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:58:45.91' AND status != 'pending'
	

2025/06/26 16:58:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.363ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:58:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.661ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:58:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.368ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:58:45.992' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:58:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.033ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:58:46.052' AND status != 'pending'
	

2025/06/26 16:58:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.777ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:58:46.073'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:58:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.712ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:58:46.133' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:58:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.589ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:58:46.213'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[77.924ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 16:59:45.158'

2025/06/26 16:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.300ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:44:45.158' LIMIT 50

2025/06/26 16:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.439ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:44:45.165' LIMIT 50

2025/06/26 16:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.080ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 16:59:45.158'

2025/06/26 16:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.304ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 16:59:45.158'

2025/06/26 16:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.585ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:29:45.664'

2025/06/26 16:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.293ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:59:45.745' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.762ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.589ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:29:45.811'

2025/06/26 16:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.358ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.332ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 15:59:45.892' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 16:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.395ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:59:45.899' AND status != 'pending'
	

2025/06/26 16:59:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.373ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 16:59:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.507ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:59:45.979' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:59:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.235ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 16:59:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.090ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:59:46.054'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 16:59:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.561ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 15:59:46.059' AND status != 'pending'
	

2025/06/26 16:59:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.115ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 15:59:46.14' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 16:59:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.280ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 15:59:46.222'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:00:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.416ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:00:45.158'

2025/06/26 17:00:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.029ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:00:45.158'

2025/06/26 17:00:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.436ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:00:45.158'

2025/06/26 17:00:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.662ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:30:45.663'

2025/06/26 17:00:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.576ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:00:45.747' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:00:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.560ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:00:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.064ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:30:45.812'

2025/06/26 17:00:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.565ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:00:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.131ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:00:45.892' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:00:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.782ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:00:45.907' AND status != 'pending'
	

2025/06/26 17:00:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.495ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:00:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.508ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:00:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.515ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:00:45.987' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:00:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.702ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:00:46.051' AND status != 'pending'
	

2025/06/26 17:00:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.906ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:00:46.067'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:00:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.190ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:00:46.132' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:00:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.873ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:00:46.213'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[77.823ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:01:45.158'

2025/06/26 17:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.105ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:46:45.158' LIMIT 50

2025/06/26 17:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.813ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:01:45.158'

2025/06/26 17:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[238.739ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 17:01:45.158' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/26 17:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.144ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:01:45.158'

2025/06/26 17:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[240.212ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:46:45.164' LIMIT 50

2025/06/26 17:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[240.914ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 17:01:45.164' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/26 17:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[41.998ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-19 17:01:45.397'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/26 17:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[38.334ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-19 17:01:45.405'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/26 17:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.839ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:31:45.663'

2025/06/26 17:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.042ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:01:45.741' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.614ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.432ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:31:45.812'

2025/06/26 17:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.553ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.579ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:01:45.9' AND status != 'pending'
	

2025/06/26 17:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[92.420ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:01:45.889' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:01:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.443ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:01:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.870ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:01:45.977' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:01:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.779ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:01:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.077ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:01:46.052'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:01:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.567ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:01:46.06' AND status != 'pending'
	

2025/06/26 17:01:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.951ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:01:46.141' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:01:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.941ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:01:46.217'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[76.235ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:02:45.157'

2025/06/26 17:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.756ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:02:45.157'

2025/06/26 17:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.392ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:02:45.157'

2025/06/26 17:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.327ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:32:45.663'

2025/06/26 17:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[76.114ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:02:45.739' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.050ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.581ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:32:45.811'

2025/06/26 17:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.466ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.672ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:02:45.892' AND status != 'pending'
	

2025/06/26 17:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.169ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:02:45.892' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.662ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.091ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:02:45.967' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.391ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.092ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:02:46.048'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.122ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:02:46.048' AND status != 'pending'
	

2025/06/26 17:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.604ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:02:46.126' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.713ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:02:46.202'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[76.137ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:03:45.157'

2025/06/26 17:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[77.266ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:48:45.157' LIMIT 50

2025/06/26 17:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.846ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:48:45.164' LIMIT 50

2025/06/26 17:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.856ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:03:45.157'

2025/06/26 17:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.439ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:03:45.157'

2025/06/26 17:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.415ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:33:45.663'

2025/06/26 17:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.384ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:03:45.738' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.377ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.490ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.737ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:33:45.811'

2025/06/26 17:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.398ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:03:45.886' AND status != 'pending'
	

2025/06/26 17:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.319ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:03:45.886' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.342ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.339ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:03:45.964' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.175ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.029ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:03:46.04'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.699ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:03:46.041' AND status != 'pending'
	

2025/06/26 17:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.566ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:03:46.114' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.983ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:03:46.193'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[75.765ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:04:45.157'

2025/06/26 17:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.628ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:04:45.157'

2025/06/26 17:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.367ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:04:45.157'

2025/06/26 17:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.336ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:34:45.662'

2025/06/26 17:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.994ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:04:45.741' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.775ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.388ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:34:45.811'

2025/06/26 17:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.522ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.556ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:04:45.888' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[72.584ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:04:45.895' AND status != 'pending'
	

2025/06/26 17:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.003ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.398ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:04:45.968' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.204ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.385ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:04:46.044'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.672ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:04:46.045' AND status != 'pending'
	

2025/06/26 17:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.465ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:04:46.118' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.461ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:04:46.197'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.088ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:50:45.157' LIMIT 50

2025/06/26 17:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.730ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:05:45.157'

2025/06/26 17:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[76.656ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:50:45.163' LIMIT 50

2025/06/26 17:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.826ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:05:45.157'

2025/06/26 17:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.448ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:05:45.157'

2025/06/26 17:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.672ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:35:45.662'

2025/06/26 17:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.413ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:05:45.741' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.624ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.344ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:35:45.81'

2025/06/26 17:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.638ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.060ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:05:45.893' AND status != 'pending'
	

2025/06/26 17:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.341ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:05:45.887' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.120ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.779ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:05:45.966' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.853ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.907ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:05:46.044'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.030ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:05:46.045' AND status != 'pending'
	

2025/06/26 17:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.856ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:05:46.12' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.690ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:05:46.199'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[77.768ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:06:45.156'

2025/06/26 17:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.601ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:06:45.156'

2025/06/26 17:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.186ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:06:45.156'

2025/06/26 17:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.486ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:36:45.662'

2025/06/26 17:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.968ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:06:45.742' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.169ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.553ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:36:45.81'

2025/06/26 17:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.885ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.559ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:06:45.885' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.869ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:06:45.895' AND status != 'pending'
	

2025/06/26 17:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.069ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.707ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[73.911ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:06:45.973' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.285ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:06:46.041' AND status != 'pending'
	

2025/06/26 17:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.050ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:06:46.047'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.984ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:06:46.118' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.745ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:06:46.199'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:07:42 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:190
[75.159ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/26 17:07:42 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[40.693ms] [rows:1] SELECT count(*) FROM `user`

2025/06/26 17:07:43 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/employee.go:236
[75.196ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/26 17:07:44 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[41.092ms] [rows:1] SELECT count(*) FROM `role`

2025/06/26 17:07:44 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/role.go:150
[76.030ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/26 17:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[75.637ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/26 17:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[40.137ms] [rows:20] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/26 17:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[76.924ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:07:45.156'

2025/06/26 17:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[77.263ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:52:45.156' LIMIT 50

2025/06/26 17:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[74.634ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:52:45.162' LIMIT 50

2025/06/26 17:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.403ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:07:45.156'

2025/06/26 17:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.323ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:07:45.156'

2025/06/26 17:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.232ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:37:45.662'

2025/06/26 17:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.635ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:07:45.741' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.628ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.592ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:37:45.81'

2025/06/26 17:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[35.940ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.789ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:07:45.885' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.099ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:07:45.893' AND status != 'pending'
	

2025/06/26 17:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.400ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.676ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.451ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:07:45.968' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.210ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:07:46.042'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.454ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:07:46.042' AND status != 'pending'
	

2025/06/26 17:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.973ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:07:46.117' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.362ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:07:46.195'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.576ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:08:45.155'

2025/06/26 17:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.566ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:08:45.155'

2025/06/26 17:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.045ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:08:45.155'

2025/06/26 17:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.710ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:38:45.661'

2025/06/26 17:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.567ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:08:45.741' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.634ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.945ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:38:45.81'

2025/06/26 17:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.529ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.597ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:08:45.885' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.944ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:08:45.897' AND status != 'pending'
	

2025/06/26 17:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.089ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.653ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.163ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:08:45.974' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.399ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:08:46.037' AND status != 'pending'
	

2025/06/26 17:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.965ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:08:46.05'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.865ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:08:46.112' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.893ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:08:46.191'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[77.657ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:54:45.156' LIMIT 50

2025/06/26 17:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.917ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:09:45.155'

2025/06/26 17:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.538ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:54:45.162' LIMIT 50

2025/06/26 17:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[84.852ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:09:45.155'

2025/06/26 17:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[80.028ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:09:45.155'

2025/06/26 17:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.280ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:39:45.661'

2025/06/26 17:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.549ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:09:45.741' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.962ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.780ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:39:45.81'

2025/06/26 17:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.420ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.485ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:09:45.885' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.348ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:09:45.894' AND status != 'pending'
	

2025/06/26 17:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.473ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.083ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:09:45.967' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.026ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.075ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:09:46.049'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.572ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:09:46.049' AND status != 'pending'
	

2025/06/26 17:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[82.071ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:09:46.123' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.051ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:09:46.206'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:10:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[75.443ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:10:45.155'

2025/06/26 17:10:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.062ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:10:45.155'

2025/06/26 17:10:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[82.636ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:10:45.155'

2025/06/26 17:10:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.210ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:40:45.66'

2025/06/26 17:10:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.623ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:10:45.74' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:10:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.125ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:10:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.223ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:40:45.809'

2025/06/26 17:10:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.035ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:10:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.955ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:10:45.885' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:10:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.560ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:10:45.895' AND status != 'pending'
	

2025/06/26 17:10:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.633ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:10:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.081ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:10:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.772ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:10:45.969' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:10:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.075ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:10:46.045' AND status != 'pending'
	

2025/06/26 17:10:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.944ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:10:46.045'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:10:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.313ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:10:46.121' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:10:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.946ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:10:46.2'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.817ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:56:45.155' LIMIT 50

2025/06/26 17:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.926ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:11:45.155'

2025/06/26 17:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[73.722ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:56:45.161' LIMIT 50

2025/06/26 17:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.897ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:11:45.155'

2025/06/26 17:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.295ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:11:45.155'

2025/06/26 17:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.228ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:41:45.66'

2025/06/26 17:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.370ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:11:45.74' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.577ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.504ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:41:45.809'

2025/06/26 17:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.669ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.877ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:11:45.884' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:11:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.679ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:11:45.893' AND status != 'pending'
	

2025/06/26 17:11:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.276ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:11:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.555ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:11:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.274ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:11:45.967' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:11:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.051ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:11:46.043'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:11:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.493ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:11:46.043' AND status != 'pending'
	

2025/06/26 17:11:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.175ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:11:46.117' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:11:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.441ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:11:46.199'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:12:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[77.055ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:12:45.155'

2025/06/26 17:12:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.987ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:12:45.155'

2025/06/26 17:12:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.095ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:12:45.155'

2025/06/26 17:12:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.524ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:42:45.659'

2025/06/26 17:12:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[73.733ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:12:45.736' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:12:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.609ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:12:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.962ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:12:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.390ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:42:45.809'

2025/06/26 17:12:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.028ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:12:45.884' AND status != 'pending'
	

2025/06/26 17:12:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.004ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:12:45.89' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:12:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.560ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:12:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.391ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:12:45.959' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:12:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.849ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:12:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.203ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:12:46.035'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:12:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.222ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:12:46.04' AND status != 'pending'
	

2025/06/26 17:12:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.625ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:12:46.114' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:12:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.177ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:12:46.189'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.207ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:58:45.154' LIMIT 50

2025/06/26 17:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.197ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:58:45.161' LIMIT 50

2025/06/26 17:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.073ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:13:45.154'

2025/06/26 17:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[75.454ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:13:45.154'

2025/06/26 17:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.646ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:13:45.154'

2025/06/26 17:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.432ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:43:45.66'

2025/06/26 17:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.696ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:13:45.743' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.732ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.379ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:43:45.808'

2025/06/26 17:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.538ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.695ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:13:45.884' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:13:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.466ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:13:45.895' AND status != 'pending'
	

2025/06/26 17:13:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.102ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:13:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.317ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:13:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.552ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:13:45.968' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:13:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.029ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:13:46.043'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:13:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.431ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:13:46.043' AND status != 'pending'
	

2025/06/26 17:13:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.099ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:13:46.119' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:13:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.752ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:13:46.199'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:14:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.454ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:14:45.154'

2025/06/26 17:14:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.014ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:14:45.154'

2025/06/26 17:14:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.480ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:14:45.154'

2025/06/26 17:14:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.951ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:44:45.66'

2025/06/26 17:14:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[76.321ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:14:45.736' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:14:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.011ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:14:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.193ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:44:45.808'

2025/06/26 17:14:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.255ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:14:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.517ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:14:45.883' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:14:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.391ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:14:45.887' AND status != 'pending'
	

2025/06/26 17:14:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.524ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:14:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.358ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:14:45.964' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:14:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.582ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:14:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.417ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:14:46.042'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:14:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.011ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:14:46.042' AND status != 'pending'
	

2025/06/26 17:14:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.404ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:14:46.119' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:14:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.710ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:14:46.197'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[75.080ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:15:45.154'

2025/06/26 17:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[76.167ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:00:45.154' LIMIT 50

2025/06/26 17:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[73.385ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:00:45.16' LIMIT 50

2025/06/26 17:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.600ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:15:45.154'

2025/06/26 17:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.050ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:15:45.154'

2025/06/26 17:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.160ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:45:45.658'

2025/06/26 17:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.431ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:15:45.735' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.864ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[73.803ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:45:45.807'

2025/06/26 17:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.297ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.347ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:15:45.882' AND status != 'pending'
	

2025/06/26 17:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.033ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:15:45.881' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:15:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.729ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:15:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.609ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:15:45.956' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:15:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.535ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:15:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.570ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:15:46.037'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:15:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.481ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:15:46.037' AND status != 'pending'
	

2025/06/26 17:15:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.237ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:15:46.114' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:15:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.120ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:15:46.194'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:16:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[75.558ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:16:45.154'

2025/06/26 17:16:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.686ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:16:45.154'

2025/06/26 17:16:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[79.428ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:16:45.154'

2025/06/26 17:16:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.624ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:46:45.658'

2025/06/26 17:16:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.963ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:16:45.734' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:16:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.400ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:16:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.487ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:46:45.808'

2025/06/26 17:16:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.552ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:16:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[72.845ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:16:45.886' AND status != 'pending'
	

2025/06/26 17:16:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.253ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:16:45.886' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:16:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.181ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:16:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.084ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:16:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.719ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:16:45.959' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:16:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.986ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:16:46.041'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:16:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.168ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:16:46.041' AND status != 'pending'
	

2025/06/26 17:16:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.076ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:16:46.119' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:16:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.969ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:16:46.199'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[75.133ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:17:45.153'

2025/06/26 17:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[75.426ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:02:45.153' LIMIT 50

2025/06/26 17:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[74.409ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:02:45.16' LIMIT 50

2025/06/26 17:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[75.208ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:17:45.153'

2025/06/26 17:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.059ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:17:45.153'

2025/06/26 17:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.498ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:47:45.659'

2025/06/26 17:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.100ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:17:45.74' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.091ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.601ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:47:45.807'

2025/06/26 17:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.493ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.275ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:17:45.884' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:17:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[72.467ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:17:45.891' AND status != 'pending'
	

2025/06/26 17:17:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.872ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:17:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.531ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:17:45.964' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:17:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.515ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:17:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.146ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:17:46.042'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:17:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.594ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:17:46.044' AND status != 'pending'
	

2025/06/26 17:17:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.464ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:17:46.118' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:17:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.404ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:17:46.197'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:18:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[103.466ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:18:45.154'

2025/06/26 17:18:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.577ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:18:45.154'

2025/06/26 17:18:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[90.552ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:18:45.154'

2025/06/26 17:18:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.000ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:48:45.658'

2025/06/26 17:18:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.275ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:18:45.735' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:18:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.264ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:18:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.339ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:48:45.806'

2025/06/26 17:18:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.575ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:18:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.711ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:18:45.885' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:18:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.789ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:18:45.891' AND status != 'pending'
	

2025/06/26 17:18:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.812ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:18:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.685ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:18:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.658ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:18:45.966' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:18:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.483ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:18:46.042' AND status != 'pending'
	

2025/06/26 17:18:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.929ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:18:46.043'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:18:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.947ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:18:46.118' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:18:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.906ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:18:46.196'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.033ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:19:45.165'

2025/06/26 17:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.744ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:04:45.166' LIMIT 50

2025/06/26 17:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.518ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:04:45.171' LIMIT 50

2025/06/26 17:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.062ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:19:45.165'

2025/06/26 17:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[79.054ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:19:45.165'

2025/06/26 17:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.190ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:49:45.67'

2025/06/26 17:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.725ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:19:45.746' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.566ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.836ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.508ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:49:45.819'

2025/06/26 17:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.480ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:19:45.901' AND status != 'pending'
	

2025/06/26 17:19:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.414ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:19:45.901' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:19:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.376ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:19:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.933ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:19:45.979' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:19:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.624ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:19:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.735ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:19:46.054'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:19:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.542ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:19:46.054' AND status != 'pending'
	

2025/06/26 17:19:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.318ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:19:46.129' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:19:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.279ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:19:46.204'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[76.306ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:20:45.168'

2025/06/26 17:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[73.951ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:20:45.168'

2025/06/26 17:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[79.212ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:20:45.168'

2025/06/26 17:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.462ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:50:45.673'

2025/06/26 17:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.824ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:20:45.753' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.622ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.697ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:50:45.822'

2025/06/26 17:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.416ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.265ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:20:45.901' AND status != 'pending'
	

2025/06/26 17:20:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.553ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:20:45.9' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:20:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.262ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:20:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[73.700ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:20:45.978' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:20:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.719ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:20:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.835ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:20:46.052'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:20:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.422ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:20:46.054' AND status != 'pending'
	

2025/06/26 17:20:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.596ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:20:46.131' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:20:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.278ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:20:46.212'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.993ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:06:45.168' LIMIT 50

2025/06/26 17:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.932ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:21:45.167'

2025/06/26 17:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.519ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:06:45.174' LIMIT 50

2025/06/26 17:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.401ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:21:45.167'

2025/06/26 17:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.279ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:21:45.167'

2025/06/26 17:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.913ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:51:45.673'

2025/06/26 17:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.691ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:21:45.751' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.929ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.823ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:51:45.822'

2025/06/26 17:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.631ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.016ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:21:45.897' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:21:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.711ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:21:45.91' AND status != 'pending'
	

2025/06/26 17:21:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.358ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:21:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.007ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:21:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.368ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:21:45.988' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:21:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.820ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:21:46.05' AND status != 'pending'
	

2025/06/26 17:21:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.025ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:21:46.067'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:21:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.790ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:21:46.124' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:21:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.422ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:21:46.203'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:22:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[75.372ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:22:45.168'

2025/06/26 17:22:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[75.035ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:22:45.168'

2025/06/26 17:22:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.547ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:22:45.168'

2025/06/26 17:22:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.192ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:52:45.673'

2025/06/26 17:22:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.483ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:22:45.756' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:22:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.797ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:22:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.744ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:52:45.821'

2025/06/26 17:22:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.376ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:22:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.409ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:22:45.901' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:22:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.223ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:22:45.907' AND status != 'pending'
	

2025/06/26 17:22:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.299ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:22:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.682ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:22:45.983' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:22:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.484ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:22:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.649ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:22:46.057'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:22:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.239ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:22:46.058' AND status != 'pending'
	

2025/06/26 17:22:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.470ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:22:46.136' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:22:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[77.544ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:22:46.213'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:23:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[264.182ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:08:45.168' LIMIT 50

2025/06/26 17:23:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[271.666ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:08:45.174' LIMIT 50

2025/06/26 17:23:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[459.424ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:23:45.168'

2025/06/26 17:23:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.818ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:23:45.168'

2025/06/26 17:23:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.127ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:53:45.673'

2025/06/26 17:23:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[85.555ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:23:45.168'

2025/06/26 17:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[276.905ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:23:45.749' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.197ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.320ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[266.268ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:23:46.1' AND status != 'pending'
	

2025/06/26 17:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.551ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:23:46.366' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.152ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:23:46.447'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[703.843ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:53:45.822'

2025/06/26 17:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.129ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:23:46.526' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.832ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.118ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.214ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:23:46.685' AND status != 'pending'
	

2025/06/26 17:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.922ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:23:46.761' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:23:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.184ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:23:46.84'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:24:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.297ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:24:45.167'

2025/06/26 17:24:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[83.707ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:24:45.167'

2025/06/26 17:24:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[81.220ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:24:45.167'

2025/06/26 17:24:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.923ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:54:45.673'

2025/06/26 17:24:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[87.160ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:24:45.748' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:24:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.839ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:24:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.501ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:54:45.822'

2025/06/26 17:24:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.376ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:24:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.448ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:24:45.906' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:24:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.228ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:24:45.919' AND status != 'pending'
	

2025/06/26 17:24:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.994ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:24:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.932ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:24:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.083ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:24:45.995' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:24:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.221ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:24:46.064' AND status != 'pending'
	

2025/06/26 17:24:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.713ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:24:46.074'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:24:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.906ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:24:46.146' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:24:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.635ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:24:46.225'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[76.876ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:10:45.167' LIMIT 50

2025/06/26 17:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.108ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:25:45.168'

2025/06/26 17:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[74.900ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:10:45.174' LIMIT 50

2025/06/26 17:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.499ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:25:45.168'

2025/06/26 17:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.485ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:25:45.168'

2025/06/26 17:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.023ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:55:45.673'

2025/06/26 17:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.508ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:25:45.752' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.235ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.952ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:55:45.821'

2025/06/26 17:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.355ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.926ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:25:45.901' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:25:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.807ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:25:45.908' AND status != 'pending'
	

2025/06/26 17:25:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.094ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:25:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.446ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:25:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.624ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:25:45.984' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:25:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.320ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:25:46.061' AND status != 'pending'
	

2025/06/26 17:25:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.821ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:25:46.061'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:25:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.738ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:25:46.136' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:25:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.648ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:25:46.22'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:26:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.615ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:26:45.168'

2025/06/26 17:26:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.670ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:26:45.168'

2025/06/26 17:26:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[74.027ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:26:45.168'

2025/06/26 17:26:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.929ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:56:45.821'

2025/06/26 17:26:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[280.143ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:56:45.673'

2025/06/26 17:26:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.274ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:26:45.903' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.128ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.491ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[109.868ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:26:45.953' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.287ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.495ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[82.637ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:26:46.056' AND status != 'pending'
	

2025/06/26 17:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.691ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:26:46.138' AND status != 'pending'
	

2025/06/26 17:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.097ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:26:46.139' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[263.367ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:26:46.223' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[262.236ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:26:46.225'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:26:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.912ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:26:46.487'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.731ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:12:45.167' LIMIT 50

2025/06/26 17:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.434ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:27:45.168'

2025/06/26 17:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[75.396ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:12:45.174' LIMIT 50

2025/06/26 17:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.960ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:27:45.168'

2025/06/26 17:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.909ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:27:45.168'

2025/06/26 17:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.086ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:57:45.673'

2025/06/26 17:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.338ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:27:45.754' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.143ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.642ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:57:45.821'

2025/06/26 17:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.550ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.705ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:27:45.896' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:27:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.829ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:27:45.909' AND status != 'pending'
	

2025/06/26 17:27:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.269ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:27:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[44.826ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:27:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.253ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:27:45.984' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:27:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.213ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:27:46.058' AND status != 'pending'
	

2025/06/26 17:27:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.089ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:27:46.059'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:27:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.178ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:27:46.133' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:27:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.363ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:27:46.211'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:28:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.124ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:28:45.167'

2025/06/26 17:28:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.537ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:28:45.167'

2025/06/26 17:28:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.072ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:28:45.167'

2025/06/26 17:28:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[84.893ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:58:45.673'

2025/06/26 17:28:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.768ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:28:45.758' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:28:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.617ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:28:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.497ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:58:45.821'

2025/06/26 17:28:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.813ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:28:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[76.583ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:28:45.897' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:28:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.688ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:28:45.911' AND status != 'pending'
	

2025/06/26 17:28:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.619ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:28:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.220ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:28:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.225ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:28:45.984' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:28:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.950ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:28:46.053' AND status != 'pending'
	

2025/06/26 17:28:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.930ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:28:46.06'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:28:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.496ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:28:46.131' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:28:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.219ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:28:46.212'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.519ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:14:45.167' LIMIT 50

2025/06/26 17:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[77.898ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:14:45.174' LIMIT 50

2025/06/26 17:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.999ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:29:45.167'

2025/06/26 17:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.760ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:29:45.167'

2025/06/26 17:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.214ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:29:45.167'

2025/06/26 17:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.722ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:59:45.673'

2025/06/26 17:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.359ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:29:45.753' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.501ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.585ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 16:59:45.821'

2025/06/26 17:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.221ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.012ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:29:45.896' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:29:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.343ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:29:45.905' AND status != 'pending'
	

2025/06/26 17:29:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.031ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:29:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.570ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:29:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.763ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:29:45.981' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:29:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.308ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:29:46.054' AND status != 'pending'
	

2025/06/26 17:29:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.139ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:29:46.056'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:29:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.685ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:29:46.131' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:29:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.454ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:29:46.212'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:30:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.487ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:30:45.167'

2025/06/26 17:30:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.053ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:30:45.167'

2025/06/26 17:30:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.223ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:30:45.167'

2025/06/26 17:30:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.396ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:00:45.673'

2025/06/26 17:30:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.185ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:30:45.754' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:30:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.689ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:30:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.663ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:00:45.821'

2025/06/26 17:30:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.852ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:30:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.436ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:30:45.897' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:30:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[72.819ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:30:45.907' AND status != 'pending'
	

2025/06/26 17:30:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.867ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:30:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.593ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:30:45.979' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:30:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.825ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:30:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.313ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:30:46.059'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:30:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.673ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:30:46.06' AND status != 'pending'
	

2025/06/26 17:30:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.362ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:30:46.135' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:30:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.798ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:30:46.217'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.850ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:16:45.167' LIMIT 50

2025/06/26 17:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.863ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:31:45.167'

2025/06/26 17:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[74.672ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:16:45.174' LIMIT 50

2025/06/26 17:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.031ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:31:45.167'

2025/06/26 17:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.158ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:31:45.167'

2025/06/26 17:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.079ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:01:45.673'

2025/06/26 17:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.301ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:31:45.751' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.066ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.722ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:01:45.821'

2025/06/26 17:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.145ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.227ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:31:45.896' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:31:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.902ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:31:45.904' AND status != 'pending'
	

2025/06/26 17:31:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.491ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:31:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.281ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:31:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.723ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:31:45.979' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:31:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.756ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:31:46.058'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:31:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.740ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:31:46.058' AND status != 'pending'
	

2025/06/26 17:31:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.448ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:31:46.136' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:31:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.314ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:31:46.219'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:32:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.683ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:32:45.167'

2025/06/26 17:32:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[74.685ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:32:45.167'

2025/06/26 17:32:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[79.499ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:32:45.167'

2025/06/26 17:32:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.006ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:02:45.673'

2025/06/26 17:32:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.070ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:32:45.748' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:32:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.230ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:32:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.779ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:02:45.821'

2025/06/26 17:32:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.725ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:32:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.078ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:32:45.897' AND status != 'pending'
	

2025/06/26 17:32:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.493ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:32:45.896' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:32:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.347ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:32:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.408ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:32:45.974' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:32:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.980ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:32:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.273ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:32:46.051'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:32:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.248ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:32:46.052' AND status != 'pending'
	

2025/06/26 17:32:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.103ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:32:46.129' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:32:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.592ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:32:46.21'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.077ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:33:45.167'

2025/06/26 17:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.760ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:18:45.167' LIMIT 50

2025/06/26 17:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[75.838ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:18:45.174' LIMIT 50

2025/06/26 17:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.702ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:33:45.167'

2025/06/26 17:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.775ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:33:45.167'

2025/06/26 17:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.586ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:03:45.673'

2025/06/26 17:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.917ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:33:45.751' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.886ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.090ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:03:45.821'

2025/06/26 17:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.669ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.207ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:33:45.897' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:33:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.094ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:33:45.9' AND status != 'pending'
	

2025/06/26 17:33:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.673ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:33:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.869ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:33:45.974' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:33:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.917ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:33:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.196ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:33:46.053'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:33:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.224ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:33:46.053' AND status != 'pending'
	

2025/06/26 17:33:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.053ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:33:46.127' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:33:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.217ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:33:46.202'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:34:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.726ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:34:45.167'

2025/06/26 17:34:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[74.931ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:34:45.167'

2025/06/26 17:34:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.089ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:34:45.167'

2025/06/26 17:34:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.827ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:04:45.673'

2025/06/26 17:34:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.177ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:34:45.748' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:34:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.898ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:34:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.132ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:04:45.821'

2025/06/26 17:34:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.961ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:34:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.173ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:34:45.903' AND status != 'pending'
	

2025/06/26 17:34:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.510ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:34:45.903' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.851ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.303ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:34:45.978' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.416ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[145.574ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:34:46.057' AND status != 'pending'
	

2025/06/26 17:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[146.054ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:34:46.057'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.453ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:34:46.203' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:34:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.576ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:34:46.277'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.494ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:20:45.168' LIMIT 50

2025/06/26 17:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.561ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:35:45.168'

2025/06/26 17:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.587ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:20:45.174' LIMIT 50

2025/06/26 17:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[75.184ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:35:45.168'

2025/06/26 17:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.501ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:35:45.168'

2025/06/26 17:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.386ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:05:45.673'

2025/06/26 17:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.815ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:35:45.751' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.707ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.259ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:05:45.821'

2025/06/26 17:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.521ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.848ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:35:45.897' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:35:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[72.926ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:35:45.904' AND status != 'pending'
	

2025/06/26 17:35:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.308ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:35:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[73.130ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:35:45.977' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:35:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.267ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:35:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.704ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:35:46.05'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:35:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.853ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:35:46.052' AND status != 'pending'
	

2025/06/26 17:35:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.482ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:35:46.128' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:35:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.658ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:35:46.205'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:36:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.283ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:36:45.167'

2025/06/26 17:36:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[82.351ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:36:45.167'

2025/06/26 17:36:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.384ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:36:45.167'

2025/06/26 17:36:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.856ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:06:45.673'

2025/06/26 17:36:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.954ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:36:45.753' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:36:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.964ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:36:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.752ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:06:45.82'

2025/06/26 17:36:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.137ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:36:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.406ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:36:45.896' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:36:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.890ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:36:45.91' AND status != 'pending'
	

2025/06/26 17:36:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.456ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:36:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.286ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:36:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.813ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:36:45.986' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:36:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.480ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:36:46.062' AND status != 'pending'
	

2025/06/26 17:36:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.852ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:36:46.063'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:36:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.954ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:36:46.137' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:36:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.581ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:36:46.212'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[79.192ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:22:45.167' LIMIT 50

2025/06/26 17:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[73.612ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:22:45.174' LIMIT 50

2025/06/26 17:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.412ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:37:45.167'

2025/06/26 17:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.607ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:37:45.167'

2025/06/26 17:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.706ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:37:45.167'

2025/06/26 17:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.782ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:07:45.672'

2025/06/26 17:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.587ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:37:45.752' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.551ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.788ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:07:45.821'

2025/06/26 17:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.186ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.218ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:37:45.896' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:37:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.097ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:37:45.907' AND status != 'pending'
	

2025/06/26 17:37:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.164ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:37:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.749ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:37:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.238ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:37:45.982' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:37:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.236ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:37:46.054' AND status != 'pending'
	

2025/06/26 17:37:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.360ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:37:46.056'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:37:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.945ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:37:46.129' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:37:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.586ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:37:46.208'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:38:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.338ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:38:45.167'

2025/06/26 17:38:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[89.050ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:38:45.167'

2025/06/26 17:38:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.004ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:38:45.167'

2025/06/26 17:38:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.396ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:08:45.673'

2025/06/26 17:38:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.666ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:38:45.751' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:38:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.436ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:38:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.769ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:08:45.821'

2025/06/26 17:38:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.562ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:38:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.782ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:38:45.898' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:38:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.166ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:38:45.906' AND status != 'pending'
	

2025/06/26 17:38:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.012ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:38:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.566ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:38:45.98' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:38:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.795ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:38:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.279ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:38:46.057'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:38:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.086ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:38:46.058' AND status != 'pending'
	

2025/06/26 17:38:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.370ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:38:46.133' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:38:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.951ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:38:46.213'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.453ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:39:45.167'

2025/06/26 17:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.305ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:24:45.167' LIMIT 50

2025/06/26 17:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[73.862ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:24:45.174' LIMIT 50

2025/06/26 17:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.034ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:39:45.167'

2025/06/26 17:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.594ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:39:45.167'

2025/06/26 17:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.420ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:09:45.673'

2025/06/26 17:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.796ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:39:45.752' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.611ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.055ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:09:45.821'

2025/06/26 17:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.138ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.481ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:39:45.896' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:39:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.367ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:39:45.905' AND status != 'pending'
	

2025/06/26 17:39:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.482ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:39:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.868ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:39:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.762ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:39:45.979' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:39:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.430ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:39:46.054' AND status != 'pending'
	

2025/06/26 17:39:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.475ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:39:46.054'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:39:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.876ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:39:46.127' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:39:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.270ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:39:46.204'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:40:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[75.932ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:40:45.167'

2025/06/26 17:40:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.403ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:40:45.167'

2025/06/26 17:40:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.748ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:40:45.167'

2025/06/26 17:40:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.373ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:10:45.673'

2025/06/26 17:40:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.488ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:40:45.748' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:40:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.436ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:40:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.098ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:10:45.82'

2025/06/26 17:40:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.149ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:40:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[72.665ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:40:45.899' AND status != 'pending'
	

2025/06/26 17:40:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.569ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:40:45.899' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:40:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.947ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:40:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[73.080ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:40:45.972' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:40:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.175ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:40:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.887ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:40:46.045'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:40:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.568ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:40:46.048' AND status != 'pending'
	

2025/06/26 17:40:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.483ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:40:46.123' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:40:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.902ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:40:46.2'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[76.126ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:26:45.167' LIMIT 50

2025/06/26 17:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[76.166ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:41:45.167'

2025/06/26 17:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[76.022ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:26:45.173' LIMIT 50

2025/06/26 17:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.594ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:41:45.167'

2025/06/26 17:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.085ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:41:45.167'

2025/06/26 17:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.039ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:11:45.673'

2025/06/26 17:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.817ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:41:45.748' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.913ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[35.729ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.190ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:11:45.821'

2025/06/26 17:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[72.499ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:41:45.898' AND status != 'pending'
	

2025/06/26 17:41:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.738ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:41:45.903' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:41:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.344ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:41:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.831ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:41:45.97' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:41:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.549ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:41:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.702ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:41:46.045'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:41:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[80.007ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:41:46.064' AND status != 'pending'
	

2025/06/26 17:41:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.929ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:41:46.145' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:41:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.096ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:41:46.223'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:42:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[77.461ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:42:45.167'

2025/06/26 17:42:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.707ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:42:45.167'

2025/06/26 17:42:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.868ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:42:45.167'

2025/06/26 17:42:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.688ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:12:45.673'

2025/06/26 17:42:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.965ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:42:45.753' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:42:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.127ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:42:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.490ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:12:45.82'

2025/06/26 17:42:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.252ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:42:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.828ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:42:45.895' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:42:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.001ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:42:45.906' AND status != 'pending'
	

2025/06/26 17:42:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.592ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:42:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.444ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:42:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.048ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:42:45.981' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:42:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.060ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:42:46.052' AND status != 'pending'
	

2025/06/26 17:42:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.216ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:42:46.057'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:42:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.294ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:42:46.127' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:42:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.466ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:42:46.206'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[76.779ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:28:45.173' LIMIT 50

2025/06/26 17:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.522ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:28:45.167' LIMIT 50

2025/06/26 17:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.510ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:43:45.167'

2025/06/26 17:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.468ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:43:45.167'

2025/06/26 17:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.256ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:43:45.167'

2025/06/26 17:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.528ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:13:45.673'

2025/06/26 17:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.220ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:43:45.751' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.457ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.689ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:13:45.82'

2025/06/26 17:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.351ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.176ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:43:45.896' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:43:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[72.421ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:43:45.904' AND status != 'pending'
	

2025/06/26 17:43:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.148ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:43:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.335ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:43:45.976' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:43:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.793ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:43:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.068ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:43:46.053'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:43:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.590ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:43:46.054' AND status != 'pending'
	

2025/06/26 17:43:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.823ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:43:46.129' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:43:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.855ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:43:46.209'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:44:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.524ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:44:45.167'

2025/06/26 17:44:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.442ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:44:45.167'

2025/06/26 17:44:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.640ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:44:45.167'

2025/06/26 17:44:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.438ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:14:45.672'

2025/06/26 17:44:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.159ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:44:45.752' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:44:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.970ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:44:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.888ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:14:45.821'

2025/06/26 17:44:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.496ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:44:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.872ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:44:45.898' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:44:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.281ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:44:45.909' AND status != 'pending'
	

2025/06/26 17:44:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.218ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:44:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.703ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:44:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.015ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:44:45.983' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:44:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.777ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:44:46.057' AND status != 'pending'
	

2025/06/26 17:44:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.680ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:44:46.059'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:44:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.917ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:44:46.133' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:44:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.552ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:44:46.211'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[85.026ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:45:45.167'

2025/06/26 17:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.600ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:30:45.173' LIMIT 50

2025/06/26 17:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[85.452ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:30:45.167' LIMIT 50

2025/06/26 17:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.262ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:45:45.167'

2025/06/26 17:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.321ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:45:45.167'

2025/06/26 17:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.719ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:15:45.673'

2025/06/26 17:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.613ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:45:45.75' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.565ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.135ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:15:45.821'

2025/06/26 17:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.542ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.720ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:45:45.904' AND status != 'pending'
	

2025/06/26 17:45:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.257ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:45:45.9' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:45:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.205ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:45:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.965ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:45:45.978' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:45:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.714ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:45:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.597ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:45:46.057'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:45:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.956ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:45:46.058' AND status != 'pending'
	

2025/06/26 17:45:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.737ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:45:46.135' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:45:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.541ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:45:46.214'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:46:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.631ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:46:45.167'

2025/06/26 17:46:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.475ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:46:45.167'

2025/06/26 17:46:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.810ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:46:45.167'

2025/06/26 17:46:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.828ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:16:45.672'

2025/06/26 17:46:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[76.082ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:46:45.752' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:46:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.821ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:46:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.802ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:16:45.821'

2025/06/26 17:46:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.172ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:46:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.605ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:46:45.9' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:46:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.469ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:46:45.902' AND status != 'pending'
	

2025/06/26 17:46:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.316ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:46:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.770ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:46:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.668ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:46:45.98' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:46:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.634ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:46:46.055' AND status != 'pending'
	

2025/06/26 17:46:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.749ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:46:46.056'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:46:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.319ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:46:46.135' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:46:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.653ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:46:46.214'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.607ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:47:45.167'

2025/06/26 17:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.288ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:32:45.167' LIMIT 50

2025/06/26 17:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.046ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:32:45.173' LIMIT 50

2025/06/26 17:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.747ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:47:45.167'

2025/06/26 17:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.837ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:47:45.167'

2025/06/26 17:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.827ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:17:45.672'

2025/06/26 17:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.334ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:47:45.751' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.057ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.445ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:17:45.821'

2025/06/26 17:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.586ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.855ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:47:45.897' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:47:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[72.402ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:47:45.904' AND status != 'pending'
	

2025/06/26 17:47:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.600ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:47:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.946ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:47:45.976' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:47:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.117ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:47:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.027ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:47:46.052'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:47:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.755ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:47:46.053' AND status != 'pending'
	

2025/06/26 17:47:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.706ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:47:46.127' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:47:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.605ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:47:46.205'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:48:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.166ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:48:45.167'

2025/06/26 17:48:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.594ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:48:45.167'

2025/06/26 17:48:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.091ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:48:45.167'

2025/06/26 17:48:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.668ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:18:45.672'

2025/06/26 17:48:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.002ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:48:45.751' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:48:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.435ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:48:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.758ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:18:45.821'

2025/06/26 17:48:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.847ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:48:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.795ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:48:45.896' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:48:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[72.878ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:48:45.904' AND status != 'pending'
	

2025/06/26 17:48:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.188ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:48:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.063ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:48:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.020ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:48:45.977' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:48:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.240ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:48:46.053'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:48:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.098ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:48:46.052' AND status != 'pending'
	

2025/06/26 17:48:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.503ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:48:46.127' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:48:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.023ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:48:46.204'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.348ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:34:45.167' LIMIT 50

2025/06/26 17:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[78.671ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:34:45.173' LIMIT 50

2025/06/26 17:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[84.998ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:49:45.167'

2025/06/26 17:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.460ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:49:45.167'

2025/06/26 17:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.877ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:49:45.167'

2025/06/26 17:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.084ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:19:45.672'

2025/06/26 17:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.720ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:49:45.751' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.473ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.060ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:19:45.821'

2025/06/26 17:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.721ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.179ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:49:45.897' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:49:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.212ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:49:45.903' AND status != 'pending'
	

2025/06/26 17:49:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.022ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:49:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.441ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:49:45.979' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:49:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[45.681ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:49:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.420ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:49:46.062'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:49:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.632ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:49:46.063' AND status != 'pending'
	

2025/06/26 17:49:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.879ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:49:46.137' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:49:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.297ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:49:46.216'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:50:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.268ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:50:45.167'

2025/06/26 17:50:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.594ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:50:45.167'

2025/06/26 17:50:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.629ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:50:45.167'

2025/06/26 17:50:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.977ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:20:45.672'

2025/06/26 17:50:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.141ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:50:45.754' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:50:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.270ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:50:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.365ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:20:45.821'

2025/06/26 17:50:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.114ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:50:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.082ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:50:45.898' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:50:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.740ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:50:45.908' AND status != 'pending'
	

2025/06/26 17:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.478ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.867ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.067ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:50:45.982' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.534ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:50:46.057' AND status != 'pending'
	

2025/06/26 17:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.565ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:50:46.058'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.011ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:50:46.133' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:50:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.403ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:50:46.211'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.231ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:36:45.173' LIMIT 50

2025/06/26 17:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.939ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:36:45.167' LIMIT 50

2025/06/26 17:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.942ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:51:45.167'

2025/06/26 17:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.531ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:51:45.167'

2025/06/26 17:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.431ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:51:45.167'

2025/06/26 17:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.386ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:21:45.672'

2025/06/26 17:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.829ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:51:45.755' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.613ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.137ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:21:45.82'

2025/06/26 17:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.646ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.014ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:51:45.895' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:51:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.018ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:51:45.91' AND status != 'pending'
	

2025/06/26 17:51:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.576ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:51:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.085ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:51:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.553ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:51:45.988' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:51:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.374ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:51:46.047' AND status != 'pending'
	

2025/06/26 17:51:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.279ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:51:46.067'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:51:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.812ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:51:46.127' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:51:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.263ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:51:46.206'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:52:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.084ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:52:45.166'

2025/06/26 17:52:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.855ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:52:45.166'

2025/06/26 17:52:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.993ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:52:45.166'

2025/06/26 17:52:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.448ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:22:45.672'

2025/06/26 17:52:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.452ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:52:45.752' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:52:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.090ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:52:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.174ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:22:45.821'

2025/06/26 17:52:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.946ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:52:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.073ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:52:45.898' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:52:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[72.860ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:52:45.905' AND status != 'pending'
	

2025/06/26 17:52:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.832ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:52:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.316ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:52:45.978' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:52:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.200ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:52:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.679ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:52:46.055'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:52:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.730ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:52:46.056' AND status != 'pending'
	

2025/06/26 17:52:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.171ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:52:46.131' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:52:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.110ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:52:46.21'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.741ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:53:45.167'

2025/06/26 17:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.573ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:38:45.167' LIMIT 50

2025/06/26 17:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[74.216ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:38:45.173' LIMIT 50

2025/06/26 17:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.366ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:53:45.167'

2025/06/26 17:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.484ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:53:45.167'

2025/06/26 17:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.505ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:23:45.673'

2025/06/26 17:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.670ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:53:45.752' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.690ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.660ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:23:45.82'

2025/06/26 17:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.298ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.857ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:53:45.896' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:53:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.608ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:53:45.904' AND status != 'pending'
	

2025/06/26 17:53:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.361ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:53:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.888ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:53:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.616ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:53:45.979' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:53:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[75.296ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:53:46.056'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:53:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.834ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:53:46.055' AND status != 'pending'
	

2025/06/26 17:53:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.240ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:53:46.131' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:53:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.314ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:53:46.211'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.764ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:54:45.167'

2025/06/26 17:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.802ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:54:45.167'

2025/06/26 17:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.258ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:54:45.167'

2025/06/26 17:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.898ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:24:45.672'

2025/06/26 17:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.060ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:54:45.751' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.493ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.903ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:24:45.821'

2025/06/26 17:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.702ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.767ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:54:45.896' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:54:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.037ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:54:45.904' AND status != 'pending'
	

2025/06/26 17:54:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.795ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:54:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.779ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:54:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.255ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:54:45.978' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:54:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.202ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:54:46.054'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:54:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[79.730ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:54:46.053' AND status != 'pending'
	

2025/06/26 17:54:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.055ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:54:46.133' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:54:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[79.290ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:54:46.212'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.893ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:55:45.167'

2025/06/26 17:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[75.898ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:40:45.173' LIMIT 50

2025/06/26 17:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.225ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:40:45.167' LIMIT 50

2025/06/26 17:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.986ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:55:45.167'

2025/06/26 17:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.024ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:55:45.167'

2025/06/26 17:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.322ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:25:45.672'

2025/06/26 17:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.891ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:55:45.75' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.400ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.705ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:25:45.821'

2025/06/26 17:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.508ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[72.419ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:55:45.901' AND status != 'pending'
	

2025/06/26 17:55:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.087ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:55:45.896' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:55:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.962ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:55:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.277ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:55:45.974' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:55:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.127ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:55:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.873ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:55:46.051'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:55:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.183ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:55:46.052' AND status != 'pending'
	

2025/06/26 17:55:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.746ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:55:46.127' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:55:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.493ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:55:46.206'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.170ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:56:45.166'

2025/06/26 17:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.736ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:56:45.166'

2025/06/26 17:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[76.690ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:56:45.166'

2025/06/26 17:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.345ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:26:45.672'

2025/06/26 17:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.221ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:56:45.75' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.716ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.604ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:26:45.821'

2025/06/26 17:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.799ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.013ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:56:45.901' AND status != 'pending'
	

2025/06/26 17:56:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.746ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:56:45.901' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.581ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.358ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:56:45.978' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.068ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.347ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:56:46.055'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.045ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:56:46.055' AND status != 'pending'
	

2025/06/26 17:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.268ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:56:46.129' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:56:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.610ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:56:46.208'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.863ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:57:45.167'

2025/06/26 17:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.757ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:42:45.173' LIMIT 50

2025/06/26 17:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[86.939ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:42:45.167' LIMIT 50

2025/06/26 17:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.990ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:57:45.167'

2025/06/26 17:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.390ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:57:45.167'

2025/06/26 17:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.706ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:27:45.672'

2025/06/26 17:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.502ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:57:45.752' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.214ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.403ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:27:45.82'

2025/06/26 17:57:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.279ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:57:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[99.560ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:57:45.908' AND status != 'pending'
	

2025/06/26 17:57:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[91.420ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:57:46.007' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:57:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[88.353ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:57:46.099'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:57:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[401.596ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:57:45.896' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:57:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.125ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:57:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.311ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:57:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.813ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:57:46.382' AND status != 'pending'
	

2025/06/26 17:57:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.507ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:57:46.461' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:57:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.957ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:57:46.537'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.725ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:58:45.167'

2025/06/26 17:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.118ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:58:45.167'

2025/06/26 17:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.333ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:58:45.167'

2025/06/26 17:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.130ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:28:45.672'

2025/06/26 17:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.119ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:58:45.748' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.260ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.912ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:28:45.821'

2025/06/26 17:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.939ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.758ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:58:45.899' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:58:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.031ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:58:45.911' AND status != 'pending'
	

2025/06/26 17:58:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.241ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:58:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.038ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:58:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[73.619ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:58:45.984' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:58:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.746ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:58:46.049' AND status != 'pending'
	

2025/06/26 17:58:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.978ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:58:46.058'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:58:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.959ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:58:46.128' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:58:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.599ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:58:46.204'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.579ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:44:45.236' LIMIT 50

2025/06/26 17:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.730ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 17:59:45.236'

2025/06/26 17:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[75.145ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:44:45.243' LIMIT 50

2025/06/26 17:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[80.895ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 17:59:45.236'

2025/06/26 17:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.397ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 17:59:45.236'

2025/06/26 17:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[87.762ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:29:45.742'

2025/06/26 17:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.163ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:59:45.83' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.597ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.314ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:29:45.891'

2025/06/26 17:59:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.843ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:59:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.472ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 16:59:45.966' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 17:59:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.595ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:59:45.981' AND status != 'pending'
	

2025/06/26 17:59:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.673ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 17:59:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.303ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 17:59:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.202ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:59:46.059' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:59:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.337ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 16:59:46.121' AND status != 'pending'
	

2025/06/26 17:59:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.958ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:59:46.136'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 17:59:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.468ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 16:59:46.198' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 17:59:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.510ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 16:59:46.277'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:00:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[80.235ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 18:00:45.238'

2025/06/26 18:00:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[76.511ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 18:00:45.238'

2025/06/26 18:00:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[79.234ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 18:00:45.238'

2025/06/26 18:00:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.891ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:30:45.743'

2025/06/26 18:00:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.363ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:00:45.826' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:00:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.228ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:00:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.764ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:30:45.892'

2025/06/26 18:00:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.235ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:00:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[75.332ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:00:45.967' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:00:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.980ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:00:45.982' AND status != 'pending'
	

2025/06/26 18:00:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.661ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:00:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.132ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:00:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.743ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:00:46.06' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:00:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.106ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:00:46.118' AND status != 'pending'
	

2025/06/26 18:00:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.661ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:00:46.138'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:00:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.955ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:00:46.194' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:00:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[76.322ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:00:46.272'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[82.519ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 18:01:45.239' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/26 18:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.985ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:46:45.239' LIMIT 50

2025/06/26 18:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[83.202ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 18:01:45.239'

2025/06/26 18:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[37.216ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-19 18:01:45.322'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/26 18:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.268ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 18:01:45.239'

2025/06/26 18:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.473ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 18:01:45.239'

2025/06/26 18:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[238.404ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 18:01:45.245' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/26 18:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[256.808ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:46:45.245' LIMIT 50

2025/06/26 18:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[41.140ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-19 18:01:45.484'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/26 18:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.555ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:31:45.744'

2025/06/26 18:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[80.465ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:01:45.831' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.224ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[85.263ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:31:45.893'

2025/06/26 18:01:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[38.971ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:01:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.749ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:01:45.989' AND status != 'pending'
	

2025/06/26 18:01:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.030ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:01:45.978' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:01:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.996ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:01:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.719ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:01:46.066' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:01:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.549ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:01:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.207ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:01:46.148'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:01:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.023ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:01:46.149' AND status != 'pending'
	

2025/06/26 18:01:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.776ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:01:46.232' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:01:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[84.265ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:01:46.319'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.884ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 18:02:45.24'

2025/06/26 18:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[88.054ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 18:02:45.24'

2025/06/26 18:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[84.999ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 18:02:45.24'

2025/06/26 18:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[88.160ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:32:45.745'

2025/06/26 18:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.176ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:02:45.834' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.757ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:02:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.563ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:32:45.894'

2025/06/26 18:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.107ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.993ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:02:45.968' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.293ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[84.833ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:02:46.002' AND status != 'pending'
	

2025/06/26 18:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.668ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[81.151ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:02:46.087' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.421ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:02:46.123' AND status != 'pending'
	

2025/06/26 18:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.373ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:02:46.168'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.050ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:02:46.196' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:02:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.401ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:02:46.273'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[81.809ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 18:03:45.241'

2025/06/26 18:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[84.121ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:48:45.241' LIMIT 50

2025/06/26 18:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[79.120ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 18:03:45.241'

2025/06/26 18:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[74.595ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 18:03:45.241'

2025/06/26 18:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[267.665ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:48:45.247' LIMIT 50

2025/06/26 18:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[96.441ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:33:45.746'

2025/06/26 18:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.065ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:03:45.843' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.821ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:33:45.894'

2025/06/26 18:03:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.143ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[43.200ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.897ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:03:45.972' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.459ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[86.108ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:03:46.02' AND status != 'pending'
	

2025/06/26 18:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.622ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[85.444ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:03:46.106' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.488ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:03:46.124' AND status != 'pending'
	

2025/06/26 18:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.275ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:03:46.201' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.181ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:03:46.191'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:03:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.666ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:03:46.277'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[82.969ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 18:04:45.242'

2025/06/26 18:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[78.516ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 18:04:45.242'

2025/06/26 18:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.537ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 18:04:45.242'

2025/06/26 18:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[77.909ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:34:45.747'

2025/06/26 18:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.620ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:04:45.825' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.699ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.121ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:34:45.896'

2025/06/26 18:04:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.226ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[78.504ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:04:45.985' AND status != 'pending'
	

2025/06/26 18:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[88.203ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:04:45.982' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[43.180ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.695ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:04:46.064' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.915ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.929ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:04:46.141'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.455ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:04:46.157' AND status != 'pending'
	

2025/06/26 18:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.708ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:04:46.246' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:04:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[87.003ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:04:46.333'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[79.775ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 18:05:45.243'

2025/06/26 18:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[86.987ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:50:45.243' LIMIT 50

2025/06/26 18:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[80.754ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:50:45.249' LIMIT 50

2025/06/26 18:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[77.768ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 18:05:45.243'

2025/06/26 18:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[75.125ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 18:05:45.243'

2025/06/26 18:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.040ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:35:45.748'

2025/06/26 18:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.812ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:05:45.827' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.420ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[82.576ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:35:45.897'

2025/06/26 18:05:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.953ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.568ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:05:45.981' AND status != 'pending'
	

2025/06/26 18:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[84.716ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:05:45.979' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.433ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.141ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:05:46.058' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.163ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.945ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:05:46.136'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[83.371ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:05:46.147' AND status != 'pending'
	

2025/06/26 18:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.221ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:05:46.231' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:05:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[86.846ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:05:46.314'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[86.852ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 18:06:45.244'

2025/06/26 18:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[86.515ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 18:06:45.244'

2025/06/26 18:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[83.681ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 18:06:45.244'

2025/06/26 18:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.239ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:36:45.749'

2025/06/26 18:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[81.985ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:06:45.836' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.532ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:06:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.751ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:36:45.898'

2025/06/26 18:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.237ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[78.043ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:06:45.974' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[81.490ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:06:46.002' AND status != 'pending'
	

2025/06/26 18:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.940ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.297ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.459ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:06:46.083' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[74.945ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:06:46.128' AND status != 'pending'
	

2025/06/26 18:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[80.176ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:06:46.168'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.952ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:06:46.203' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:06:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.203ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:06:46.284'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[75.712ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 18:07:45.245'

2025/06/26 18:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.445ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:52:45.245' LIMIT 50

2025/06/26 18:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.669ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:52:45.251' LIMIT 50

2025/06/26 18:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[74.423ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 18:07:45.245'

2025/06/26 18:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.469ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 18:07:45.245'

2025/06/26 18:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[78.638ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:37:45.75'

2025/06/26 18:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[79.348ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:07:45.829' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.593ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.031ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:07:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[86.593ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:37:45.899'

2025/06/26 18:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.042ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:07:45.981' AND status != 'pending'
	

2025/06/26 18:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[86.077ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:07:45.985' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.867ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[76.314ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:07:46.059' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.588ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[71.954ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:07:46.135'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[89.347ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:07:46.157' AND status != 'pending'
	

2025/06/26 18:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.213ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:07:46.247' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:07:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.359ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:07:46.333'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[94.830ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 18:08:45.246'

2025/06/26 18:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[90.197ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 18:08:45.246'

2025/06/26 18:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.730ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 18:08:45.246'

2025/06/26 18:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.457ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:38:45.751'

2025/06/26 18:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[90.660ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:08:45.841' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.487ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:08:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.768ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:38:45.9'

2025/06/26 18:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.222ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[85.715ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:08:45.974' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.565ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.811ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:08:46.016' AND status != 'pending'
	

2025/06/26 18:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.202ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.538ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:08:46.102' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[77.721ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:08:46.135' AND status != 'pending'
	

2025/06/26 18:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.903ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:08:46.187'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.630ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:08:46.213' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:08:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[74.822ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:08:46.292'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[82.912ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:54:45.247' LIMIT 50

2025/06/26 18:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[87.473ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-26 18:09:45.247'

2025/06/26 18:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_system_init.go:163
[81.596ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:54:45.253' LIMIT 50

2025/06/26 18:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[85.728ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-26 18:09:45.247'

2025/06/26 18:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.237ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-25 18:09:45.247'

2025/06/26 18:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[89.836ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:39:45.752'

2025/06/26 18:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[89.592ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:09:45.842' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[42.264ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:09:45 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:129
[81.759ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-26 17:39:45.901'

2025/06/26 18:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[42.197ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:177
[82.331ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-26 17:09:45.982' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/26 18:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[87.698ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:09:46.017' AND status != 'pending'
	

2025/06/26 18:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:201
[41.044ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/26 18:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.275ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/26 18:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[87.532ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:09:46.104' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:246
[85.713ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-26 17:09:46.147' AND status != 'pending'
	

2025/06/26 18:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.275ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:09:46.192'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/26 18:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:305
[86.813ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-26 17:09:46.233' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/26 18:09:46 /Users/wensiyuan/mycode/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.929ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-26 17:09:46.32'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	
