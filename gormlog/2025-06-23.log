
2025/06/23 20:09:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.587ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:39:41.674'

2025/06/23 20:09:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.059ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:09:41.738' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:09:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.528ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:09:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.487ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:09:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.559ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:09:41.859' AND status != 'pending'
	

2025/06/23 20:09:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.422ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:09:41.92' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.336ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:09:41.98'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[187.272ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:39:41.942'

2025/06/23 20:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.242ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:09:42.129' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.275ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.212ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[55.551ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:09:42.251' AND status != 'pending'
	

2025/06/23 20:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.329ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:09:42.306' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.260ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:09:42.364'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:09:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[57.090ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:10:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.450ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:10:41.674'

2025/06/23 20:10:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.316ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:10:41.674'

2025/06/23 20:10:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.737ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:10:41.674'

2025/06/23 20:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.727ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:40:42.043'

2025/06/23 20:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.799ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:10:42.101' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.588ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.096ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.172ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:10:42.218' AND status != 'pending'
	

2025/06/23 20:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.982ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:10:42.276' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.675ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:10:42.334'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.418ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:40:42.421'

2025/06/23 20:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.181ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:10:42.478' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.787ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.590ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.333ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:10:42.592' AND status != 'pending'
	

2025/06/23 20:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.342ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:10:42.65' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.846ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:10:42.707'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:11:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.649ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:56:41.674' LIMIT 50

2025/06/23 20:11:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.500ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:11:41.674'

2025/06/23 20:11:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.688ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:11:41.674'

2025/06/23 20:11:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.970ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:11:41.674'

2025/06/23 20:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.750ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:56:41.943' LIMIT 50

2025/06/23 20:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[69.609ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:41:42.043'

2025/06/23 20:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.360ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:11:42.113' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.779ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.639ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.331ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:11:42.237' AND status != 'pending'
	

2025/06/23 20:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.460ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:11:42.299' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.193ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:11:42.361'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.050ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:41:42.421'

2025/06/23 20:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.414ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:11:42.479' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.172ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.947ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.810ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:11:42.596' AND status != 'pending'
	

2025/06/23 20:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.500ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:11:42.654' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.917ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:11:42.712'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:12:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.205ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:12:41.675'

2025/06/23 20:12:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.751ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:12:41.675'

2025/06/23 20:12:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.525ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:12:41.675'

2025/06/23 20:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.203ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:42:42.043'

2025/06/23 20:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.764ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:12:42.102' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.744ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.506ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.825ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:12:42.217' AND status != 'pending'
	

2025/06/23 20:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.847ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:12:42.276' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.731ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:12:42.333'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.150ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:42:42.422'

2025/06/23 20:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.313ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:12:42.481' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.443ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.691ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.300ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:12:42.599' AND status != 'pending'
	

2025/06/23 20:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.988ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:12:42.658' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.232ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:12:42.717'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:13:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.748ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:58:41.674' LIMIT 50

2025/06/23 20:13:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.269ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:13:41.675'

2025/06/23 20:13:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.551ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:13:41.675'

2025/06/23 20:13:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.253ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:13:41.675'

2025/06/23 20:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.181ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:58:41.943' LIMIT 50

2025/06/23 20:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.575ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:43:42.043'

2025/06/23 20:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.662ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:13:42.106' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.442ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.490ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.412ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:13:42.229' AND status != 'pending'
	

2025/06/23 20:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.359ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:13:42.291' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.227ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:13:42.352'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.073ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:43:42.422'

2025/06/23 20:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[291.145ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:13:42.483' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.331ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.649ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.049ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:13:42.832' AND status != 'pending'
	

2025/06/23 20:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.095ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:13:42.89' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:13:43 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.307ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:13:42.948'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:14:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.428ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:14:41.675'

2025/06/23 20:14:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.419ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:14:41.675'

2025/06/23 20:14:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.515ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:14:41.675'

2025/06/23 20:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.817ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:44:42.043'

2025/06/23 20:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.568ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:14:42.101' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.944ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.709ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.214ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:14:42.217' AND status != 'pending'
	

2025/06/23 20:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.701ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:14:42.274' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.371ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:14:42.332'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.996ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:44:42.422'

2025/06/23 20:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.420ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:14:42.48' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.799ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.545ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.100ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:14:42.594' AND status != 'pending'
	

2025/06/23 20:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.951ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:14:42.652' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.325ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:14:42.709'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:15:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.199ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:15:41.675'

2025/06/23 20:15:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.917ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:00:41.675' LIMIT 50

2025/06/23 20:15:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.983ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:15:41.675'

2025/06/23 20:15:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.690ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:15:41.675'

2025/06/23 20:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.148ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:00:41.944' LIMIT 50

2025/06/23 20:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.550ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:45:42.045'

2025/06/23 20:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.250ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:15:42.105' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.876ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.088ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.072ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:15:42.22' AND status != 'pending'
	

2025/06/23 20:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.568ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:15:42.279' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.211ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:15:42.337'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.428ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:45:42.423'

2025/06/23 20:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.360ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:15:42.481' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.272ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.548ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.884ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:15:42.6' AND status != 'pending'
	

2025/06/23 20:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.541ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:15:42.659' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.764ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:15:42.716'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:16:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.951ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:16:41.675'

2025/06/23 20:16:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.855ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:16:41.675'

2025/06/23 20:16:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.673ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:16:41.675'

2025/06/23 20:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.384ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:46:42.044'

2025/06/23 20:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.727ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:16:42.103' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.260ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.236ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.901ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:16:42.22' AND status != 'pending'
	

2025/06/23 20:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.950ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:16:42.279' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.239ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:16:42.338'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.257ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:46:42.422'

2025/06/23 20:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.415ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:16:42.482' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.513ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.523ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.169ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:16:42.604' AND status != 'pending'
	

2025/06/23 20:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.914ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:16:42.663' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.808ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:16:42.723'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:17:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.962ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:17:41.675'

2025/06/23 20:17:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.713ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:02:41.675' LIMIT 50

2025/06/23 20:17:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.054ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:17:41.675'

2025/06/23 20:17:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.901ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:17:41.675'

2025/06/23 20:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.728ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:02:41.944' LIMIT 50

2025/06/23 20:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.787ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:47:42.044'

2025/06/23 20:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.479ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:17:42.102' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.568ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.765ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.792ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:17:42.218' AND status != 'pending'
	

2025/06/23 20:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.173ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:17:42.276' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.854ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:17:42.336'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.954ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:47:42.422'

2025/06/23 20:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.285ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:17:42.479' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.668ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.565ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.145ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:17:42.596' AND status != 'pending'
	

2025/06/23 20:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.108ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:17:42.658' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.678ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:17:42.716'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:18:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.889ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:18:41.675'

2025/06/23 20:18:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.256ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:18:41.675'

2025/06/23 20:18:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.173ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:18:41.675'

2025/06/23 20:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.489ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:48:42.044'

2025/06/23 20:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.538ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:18:42.103' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.105ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.028ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.857ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:18:42.22' AND status != 'pending'
	

2025/06/23 20:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.096ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:18:42.278' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.494ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:18:42.337'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.870ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:48:42.422'

2025/06/23 20:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.663ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:18:42.482' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.353ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.210ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.614ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:18:42.601' AND status != 'pending'
	

2025/06/23 20:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.853ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:18:42.66' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.210ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:18:42.718'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:19:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.631ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:19:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.841ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:04:41.675' LIMIT 50

2025/06/23 20:19:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.660ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:19:41.675'

2025/06/23 20:19:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.868ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:19:41.675'

2025/06/23 20:19:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.918ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:19:41.675'

2025/06/23 20:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.910ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:04:41.944' LIMIT 50

2025/06/23 20:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.346ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:49:42.044'

2025/06/23 20:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.245ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:19:42.107' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.579ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.548ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.784ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:19:42.231' AND status != 'pending'
	

2025/06/23 20:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.165ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:19:42.291' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.186ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:19:42.354'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.070ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:49:42.422'

2025/06/23 20:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.980ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:19:42.483' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.243ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.256ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.491ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:19:42.604' AND status != 'pending'
	

2025/06/23 20:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.701ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:19:42.665' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.407ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:19:42.73'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:20:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.933ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:20:41.675'

2025/06/23 20:20:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.561ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:20:41.675'

2025/06/23 20:20:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.812ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:20:41.675'

2025/06/23 20:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.921ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:50:42.045'

2025/06/23 20:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.794ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:20:42.108' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.981ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.872ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.406ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:20:42.232' AND status != 'pending'
	

2025/06/23 20:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.440ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:20:42.294' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.909ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:20:42.356'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.433ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:50:42.422'

2025/06/23 20:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.775ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:20:42.484' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.870ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.586ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.712ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:20:42.61' AND status != 'pending'
	

2025/06/23 20:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.265ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:20:42.67' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.847ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:20:42.733'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:21:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.790ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:21:41.676'

2025/06/23 20:21:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.403ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:06:41.675' LIMIT 50

2025/06/23 20:21:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.823ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:21:41.676'

2025/06/23 20:21:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.729ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:21:41.676'

2025/06/23 20:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.368ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:06:41.944' LIMIT 50

2025/06/23 20:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.596ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:51:42.045'

2025/06/23 20:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.999ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:21:42.102' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.865ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.241ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.280ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:21:42.218' AND status != 'pending'
	

2025/06/23 20:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.303ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:21:42.276' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.095ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:21:42.334'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.121ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:51:42.423'

2025/06/23 20:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.538ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:21:42.48' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.729ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.453ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.235ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:21:42.595' AND status != 'pending'
	

2025/06/23 20:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.101ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:21:42.653' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.017ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:21:42.71'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:22:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.197ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:22:41.676'

2025/06/23 20:22:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.124ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:22:41.676'

2025/06/23 20:22:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[56.831ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:22:41.676'

2025/06/23 20:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.658ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:52:42.044'

2025/06/23 20:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.829ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:22:42.104' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.756ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.868ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.154ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:22:42.22' AND status != 'pending'
	

2025/06/23 20:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.856ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:22:42.279' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.100ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:22:42.337'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.235ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:52:42.422'

2025/06/23 20:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.697ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:22:42.483' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.937ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.828ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.916ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:22:42.602' AND status != 'pending'
	

2025/06/23 20:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.770ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:22:42.659' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.865ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:22:42.716'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:23:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.101ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:23:41.676'

2025/06/23 20:23:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.798ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:08:41.675' LIMIT 50

2025/06/23 20:23:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.797ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:23:41.676'

2025/06/23 20:23:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.455ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:23:41.676'

2025/06/23 20:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.105ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:08:41.945' LIMIT 50

2025/06/23 20:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.575ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:53:42.045'

2025/06/23 20:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.007ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:23:42.105' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.473ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.168ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.336ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:23:42.222' AND status != 'pending'
	

2025/06/23 20:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.300ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:23:42.28' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.058ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:23:42.339'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.602ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:53:42.423'

2025/06/23 20:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.948ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:23:42.481' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.670ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.319ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.712ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:23:42.596' AND status != 'pending'
	

2025/06/23 20:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.839ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:23:42.653' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.338ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:23:42.71'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:24:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.087ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:24:41.676'

2025/06/23 20:24:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.336ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:24:41.676'

2025/06/23 20:24:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.904ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:24:41.676'

2025/06/23 20:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.051ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:54:42.045'

2025/06/23 20:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.027ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:24:42.103' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.054ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.342ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.697ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:24:42.219' AND status != 'pending'
	

2025/06/23 20:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.285ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:24:42.277' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.545ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:24:42.335'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.622ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:54:42.423'

2025/06/23 20:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.063ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:24:42.481' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.601ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.024ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.370ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:24:42.599' AND status != 'pending'
	

2025/06/23 20:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.278ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:24:42.657' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.962ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:24:42.714'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:25:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.413ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:10:41.678' LIMIT 50

2025/06/23 20:25:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.688ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:25:41.678'

2025/06/23 20:25:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[67.079ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:25:41.678'

2025/06/23 20:25:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.527ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:25:41.678'

2025/06/23 20:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.913ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:10:41.947' LIMIT 50

2025/06/23 20:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.956ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:55:42.048'

2025/06/23 20:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.773ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:25:42.11' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.461ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.211ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.963ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:25:42.231' AND status != 'pending'
	

2025/06/23 20:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.872ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:25:42.293' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.851ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:25:42.354'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.671ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:55:42.426'

2025/06/23 20:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.933ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:25:42.487' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.118ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.352ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.268ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:25:42.609' AND status != 'pending'
	

2025/06/23 20:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.871ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:25:42.67' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.715ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:25:42.731'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:26:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.806ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:26:41.683'

2025/06/23 20:26:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.611ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:26:41.683'

2025/06/23 20:26:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.285ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:26:41.683'

2025/06/23 20:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.482ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:56:42.052'

2025/06/23 20:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.040ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:26:42.113' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.981ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.316ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.459ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:26:42.234' AND status != 'pending'
	

2025/06/23 20:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.750ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:26:42.295' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.509ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:26:42.359'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.363ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:56:42.43'

2025/06/23 20:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.408ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:26:42.491' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.523ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.346ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.766ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:26:42.612' AND status != 'pending'
	

2025/06/23 20:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.006ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:26:42.673' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.997ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:26:42.734'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:27:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.072ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:27:41.683'

2025/06/23 20:27:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.636ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:12:41.683' LIMIT 50

2025/06/23 20:27:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.605ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:27:41.683'

2025/06/23 20:27:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[56.902ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:27:41.683'

2025/06/23 20:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.557ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:12:41.952' LIMIT 50

2025/06/23 20:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.998ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:57:42.052'

2025/06/23 20:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.772ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:27:42.11' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.426ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.368ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.012ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:27:42.225' AND status != 'pending'
	

2025/06/23 20:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.645ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:27:42.282' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.820ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:27:42.34'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.640ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:57:42.43'

2025/06/23 20:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.885ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:27:42.487' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.366ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.590ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.532ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:27:42.601' AND status != 'pending'
	

2025/06/23 20:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.228ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:27:42.657' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.871ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:27:42.715'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:28:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[56.952ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:28:41.683'

2025/06/23 20:28:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.490ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:28:41.683'

2025/06/23 20:28:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.019ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:28:41.683'

2025/06/23 20:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.390ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:58:42.052'

2025/06/23 20:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.958ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:28:42.109' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.615ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.431ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.808ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:28:42.226' AND status != 'pending'
	

2025/06/23 20:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.700ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:28:42.283' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.736ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:28:42.341'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.377ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:58:42.431'

2025/06/23 20:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.990ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:28:42.487' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.226ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.399ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.511ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:28:42.601' AND status != 'pending'
	

2025/06/23 20:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.239ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:28:42.659' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.273ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:28:42.716'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:29:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[58.291ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:29:30 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[58.798ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:29:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[56.857ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[58.097ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:29:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.845ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:14:41.683' LIMIT 50

2025/06/23 20:29:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.720ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:29:41.684'

2025/06/23 20:29:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.588ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:29:41.684'

2025/06/23 20:29:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.713ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:29:41.684'

2025/06/23 20:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.550ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:14:41.953' LIMIT 50

2025/06/23 20:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.637ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:59:42.052'

2025/06/23 20:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.453ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:29:42.114' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.827ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.559ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.923ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:29:42.237' AND status != 'pending'
	

2025/06/23 20:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.405ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:29:42.3' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.101ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:29:42.364'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.239ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 19:59:42.43'

2025/06/23 20:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.082ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:29:42.492' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.434ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.161ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.937ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:29:42.614' AND status != 'pending'
	

2025/06/23 20:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.952ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:29:42.676' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.302ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:29:42.737'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:30:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.422ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:30:41.684'

2025/06/23 20:30:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.430ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:30:41.684'

2025/06/23 20:30:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.275ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:30:41.684'

2025/06/23 20:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.964ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:00:42.053'

2025/06/23 20:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.102ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:30:42.115' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.887ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.811ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.751ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:30:42.239' AND status != 'pending'
	

2025/06/23 20:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.030ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:30:42.304' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.592ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:30:42.366'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.402ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:00:42.431'

2025/06/23 20:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.772ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:30:42.491' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.704ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.376ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.541ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:30:42.614' AND status != 'pending'
	

2025/06/23 20:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.256ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:30:42.675' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.188ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:30:42.737'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:31:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.120ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:16:41.684' LIMIT 50

2025/06/23 20:31:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.886ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:31:41.685'

2025/06/23 20:31:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.599ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:31:41.685'

2025/06/23 20:31:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.748ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:31:41.685'

2025/06/23 20:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.858ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:16:41.953' LIMIT 50

2025/06/23 20:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.232ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:01:42.053'

2025/06/23 20:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.668ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:31:42.115' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.237ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.737ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.209ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:31:42.238' AND status != 'pending'
	

2025/06/23 20:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.789ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:31:42.299' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.811ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:31:42.36'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.798ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:01:42.432'

2025/06/23 20:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.722ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:31:42.496' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.155ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.166ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.050ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:31:42.617' AND status != 'pending'
	

2025/06/23 20:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.355ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:31:42.678' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.202ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:31:42.739'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:32:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.775ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:32:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[65.597ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:32:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.919ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:32:41.685'

2025/06/23 20:32:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.094ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:32:41.685'

2025/06/23 20:32:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.970ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:32:41.685'

2025/06/23 20:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.334ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:02:42.054'

2025/06/23 20:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.798ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:32:42.122' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.031ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.453ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.945ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:32:42.247' AND status != 'pending'
	

2025/06/23 20:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.326ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:32:42.31' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.211ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:32:42.371'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.977ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:02:42.432'

2025/06/23 20:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.968ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:32:42.49' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.748ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.631ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.959ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:32:42.605' AND status != 'pending'
	

2025/06/23 20:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.834ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:32:42.663' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.424ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:32:42.721'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:33:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.451ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:33:41.685'

2025/06/23 20:33:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.421ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:18:41.684' LIMIT 50

2025/06/23 20:33:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.135ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:33:41.685'

2025/06/23 20:33:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.485ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:33:41.685'

2025/06/23 20:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.089ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:18:41.953' LIMIT 50

2025/06/23 20:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.706ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:03:42.054'

2025/06/23 20:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.672ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:33:42.112' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.078ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.511ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.735ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:33:42.23' AND status != 'pending'
	

2025/06/23 20:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.633ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:33:42.288' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.358ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:33:42.348'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.416ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:03:42.432'

2025/06/23 20:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.141ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:33:42.49' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.695ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.404ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.743ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:33:42.605' AND status != 'pending'
	

2025/06/23 20:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.011ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:33:42.663' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.314ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:33:42.72'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:34:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[57.489ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:34:41.685'

2025/06/23 20:34:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.566ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:34:41.685'

2025/06/23 20:34:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.198ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:34:41.685'

2025/06/23 20:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.039ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:04:42.054'

2025/06/23 20:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.028ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:34:42.113' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.549ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.624ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.907ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:34:42.228' AND status != 'pending'
	

2025/06/23 20:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.354ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:34:42.285' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.712ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:34:42.342'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.654ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:04:42.433'

2025/06/23 20:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.389ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:34:42.491' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.998ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.627ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.456ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:34:42.609' AND status != 'pending'
	

2025/06/23 20:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.010ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:34:42.666' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.023ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:34:42.723'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:35:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.786ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:20:41.685' LIMIT 50

2025/06/23 20:35:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.227ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:35:41.685'

2025/06/23 20:35:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.933ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:35:41.685'

2025/06/23 20:35:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.941ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:35:41.685'

2025/06/23 20:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.522ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:20:41.954' LIMIT 50

2025/06/23 20:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.167ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:05:42.054'

2025/06/23 20:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[55.940ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:35:42.114' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.185ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.353ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.262ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:35:42.227' AND status != 'pending'
	

2025/06/23 20:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.040ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:35:42.283' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.597ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:35:42.34'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.816ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:05:42.433'

2025/06/23 20:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.006ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:35:42.492' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.140ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.835ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.941ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:35:42.61' AND status != 'pending'
	

2025/06/23 20:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.063ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:35:42.667' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.961ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:35:42.725'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:36:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[57.264ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:36:41.686'

2025/06/23 20:36:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.975ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:36:41.686'

2025/06/23 20:36:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.985ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:36:41.686'

2025/06/23 20:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.389ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:06:42.055'

2025/06/23 20:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.426ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:36:42.112' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.806ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.615ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.220ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:36:42.227' AND status != 'pending'
	

2025/06/23 20:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.986ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:36:42.286' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.954ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:36:42.343'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.539ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:06:42.433'

2025/06/23 20:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.467ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:36:42.491' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.336ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.340ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.222ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:36:42.606' AND status != 'pending'
	

2025/06/23 20:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.717ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:36:42.665' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.343ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:36:42.724'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:36:43 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[56.393ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:37:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.849ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:37:41.686'

2025/06/23 20:37:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.207ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:22:41.686' LIMIT 50

2025/06/23 20:37:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.096ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:37:41.686'

2025/06/23 20:37:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.604ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:37:41.686'

2025/06/23 20:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.420ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:22:41.954' LIMIT 50

2025/06/23 20:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.678ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:07:42.054'

2025/06/23 20:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.858ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:37:42.112' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.730ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.995ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.938ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:37:42.227' AND status != 'pending'
	

2025/06/23 20:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.443ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:37:42.285' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.628ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:37:42.343'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.467ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:07:42.433'

2025/06/23 20:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.671ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:37:42.491' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.692ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.108ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.870ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:37:42.607' AND status != 'pending'
	

2025/06/23 20:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.227ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:37:42.664' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.941ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:37:42.721'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:38:02 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.506ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:38:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.236ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:38:41.686'

2025/06/23 20:38:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.031ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:38:41.686'

2025/06/23 20:38:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.351ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:38:41.686'

2025/06/23 20:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.892ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:08:42.055'

2025/06/23 20:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.047ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:38:42.112' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.670ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.519ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.924ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:38:42.227' AND status != 'pending'
	

2025/06/23 20:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.073ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:38:42.284' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.757ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:38:42.341'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.900ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:08:42.433'

2025/06/23 20:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.127ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:38:42.49' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.611ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.446ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.845ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:38:42.605' AND status != 'pending'
	

2025/06/23 20:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.236ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:38:42.662' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.266ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:38:42.719'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:38:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[56.978ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:39:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.171ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:24:41.686' LIMIT 50

2025/06/23 20:39:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.091ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:39:41.686'

2025/06/23 20:39:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.865ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:39:41.686'

2025/06/23 20:39:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.317ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:39:41.686'

2025/06/23 20:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.258ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:24:41.955' LIMIT 50

2025/06/23 20:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.713ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:09:42.056'

2025/06/23 20:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.382ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:39:42.117' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.057ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.839ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.881ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:39:42.24' AND status != 'pending'
	

2025/06/23 20:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.866ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:39:42.301' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.560ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:39:42.363'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.698ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:09:42.434'

2025/06/23 20:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.405ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:39:42.495' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.175ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.854ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.095ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:39:42.623' AND status != 'pending'
	

2025/06/23 20:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.715ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:39:42.683' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.550ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:39:42.745'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:40:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.466ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:40:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.966ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:40:41.687'

2025/06/23 20:40:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.414ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:40:41.687'

2025/06/23 20:40:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.857ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:40:41.687'

2025/06/23 20:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.803ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:10:42.056'

2025/06/23 20:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.852ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:40:42.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.238ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.538ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.732ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:40:42.24' AND status != 'pending'
	

2025/06/23 20:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.406ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:40:42.301' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.989ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:40:42.362'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.694ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:10:42.434'

2025/06/23 20:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.954ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:40:42.495' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.228ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.261ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.735ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:40:42.616' AND status != 'pending'
	

2025/06/23 20:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.711ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:40:42.677' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.865ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:40:42.738'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:40:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.323ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:41:34 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[66.029ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:41:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.703ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:26:41.686' LIMIT 50

2025/06/23 20:41:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.345ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:41:41.687'

2025/06/23 20:41:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.499ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:41:41.687'

2025/06/23 20:41:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.545ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:41:41.687'

2025/06/23 20:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.967ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:26:41.956' LIMIT 50

2025/06/23 20:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.686ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:11:42.056'

2025/06/23 20:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.315ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:41:42.123' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.478ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.388ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.727ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:41:42.251' AND status != 'pending'
	

2025/06/23 20:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.921ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:41:42.317' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.000ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:41:42.379'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.361ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:11:42.434'

2025/06/23 20:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.008ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:41:42.492' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.945ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.391ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.500ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:41:42.609' AND status != 'pending'
	

2025/06/23 20:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.587ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:41:42.666' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.540ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:41:42.724'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:42:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.623ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:42:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[57.925ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:42:41.687'

2025/06/23 20:42:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.109ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:42:41.687'

2025/06/23 20:42:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[56.501ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:42:41.687'

2025/06/23 20:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.044ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:12:42.056'

2025/06/23 20:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.519ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:42:42.114' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.428ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.852ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.547ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:42:42.229' AND status != 'pending'
	

2025/06/23 20:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.060ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:42:42.287' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.335ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:42:42.344'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.563ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:12:42.435'

2025/06/23 20:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.934ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:42:42.491' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.611ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.348ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.102ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:42:42.608' AND status != 'pending'
	

2025/06/23 20:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.299ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:42:42.667' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.688ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:42:42.725'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:42:43 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[57.420ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:43:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[57.556ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:43:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.745ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:43:41.687'

2025/06/23 20:43:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.522ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:28:41.687' LIMIT 50

2025/06/23 20:43:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.408ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:43:41.687'

2025/06/23 20:43:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.318ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:43:41.687'

2025/06/23 20:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.045ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:28:41.956' LIMIT 50

2025/06/23 20:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.311ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:13:42.057'

2025/06/23 20:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.272ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:43:42.115' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.968ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.895ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.403ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:43:42.233' AND status != 'pending'
	

2025/06/23 20:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.560ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:43:42.291' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.455ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:43:42.349'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.544ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:13:42.435'

2025/06/23 20:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.238ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:43:42.492' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.790ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.865ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.923ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:43:42.608' AND status != 'pending'
	

2025/06/23 20:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.954ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:43:42.668' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.645ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:43:42.725'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:44:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.194ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:44:41.69'

2025/06/23 20:44:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.296ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:44:41.69'

2025/06/23 20:44:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.513ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:44:41.69'

2025/06/23 20:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.555ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:14:42.057'

2025/06/23 20:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.292ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:44:42.115' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.711ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.814ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.294ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:44:42.231' AND status != 'pending'
	

2025/06/23 20:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.790ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:44:42.289' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.879ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:44:42.347'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.266ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:14:42.435'

2025/06/23 20:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.696ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:44:42.493' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.668ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.710ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.541ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:44:42.609' AND status != 'pending'
	

2025/06/23 20:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.200ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:44:42.667' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.737ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:44:42.728'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:45:01 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[57.439ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:45:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[57.462ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:45:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.113ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:45:41.689'

2025/06/23 20:45:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[74.212ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:30:41.688' LIMIT 50

2025/06/23 20:45:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.843ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:45:41.689'

2025/06/23 20:45:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[56.133ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:45:41.689'

2025/06/23 20:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.820ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:30:41.957' LIMIT 50

2025/06/23 20:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.430ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:15:42.057'

2025/06/23 20:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.751ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:45:42.115' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.296ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[40.183ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.972ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:45:42.248' AND status != 'pending'
	

2025/06/23 20:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.128ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:45:42.306' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.154ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:45:42.364'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.055ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:15:42.435'

2025/06/23 20:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.415ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:45:42.494' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.456ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.834ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.275ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:45:42.609' AND status != 'pending'
	

2025/06/23 20:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.178ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:45:42.665' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.907ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:45:42.723'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:46:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[57.643ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:46:41.688'

2025/06/23 20:46:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.819ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:46:41.688'

2025/06/23 20:46:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[56.972ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:46:41.688'

2025/06/23 20:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.677ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:16:42.057'

2025/06/23 20:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.125ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:46:42.116' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.751ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.123ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.848ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:46:42.231' AND status != 'pending'
	

2025/06/23 20:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.229ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:46:42.29' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.997ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:46:42.347'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.593ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:16:42.436'

2025/06/23 20:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.942ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:46:42.493' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.547ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.437ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.845ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:46:42.608' AND status != 'pending'
	

2025/06/23 20:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.890ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:46:42.668' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.712ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:46:42.725'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:46:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.088ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:47:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.011ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:32:41.688' LIMIT 50

2025/06/23 20:47:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.998ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:47:41.689'

2025/06/23 20:47:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.292ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:47:41.689'

2025/06/23 20:47:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.079ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:47:41.689'

2025/06/23 20:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.838ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:32:41.958' LIMIT 50

2025/06/23 20:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.879ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:17:42.058'

2025/06/23 20:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.117ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:47:42.119' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.824ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.567ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.019ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:47:42.243' AND status != 'pending'
	

2025/06/23 20:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.077ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:47:42.304' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.331ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:47:42.366'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.040ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:17:42.435'

2025/06/23 20:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.697ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:47:42.495' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.488ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.632ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.042ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:47:42.617' AND status != 'pending'
	

2025/06/23 20:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.474ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:47:42.678' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.151ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:47:42.739'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:48:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.326ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 20:48:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.150ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:48:41.689'

2025/06/23 20:48:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.364ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:48:41.689'

2025/06/23 20:48:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.825ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:48:41.689'

2025/06/23 20:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.350ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:18:42.058'

2025/06/23 20:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.928ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:48:42.12' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.226ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.132ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.308ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:48:42.242' AND status != 'pending'
	

2025/06/23 20:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.510ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:48:42.304' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.686ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:48:42.366'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.727ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:18:42.436'

2025/06/23 20:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.424ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:48:42.496' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.625ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.466ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.311ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:48:42.619' AND status != 'pending'
	

2025/06/23 20:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.247ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:48:42.68' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.015ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:48:42.74'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:49:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.058ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:34:41.689' LIMIT 50

2025/06/23 20:49:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.557ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:49:41.689'

2025/06/23 20:49:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.051ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:49:41.689'

2025/06/23 20:49:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.112ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:49:41.689'

2025/06/23 20:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.149ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:34:41.958' LIMIT 50

2025/06/23 20:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.968ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:19:42.058'

2025/06/23 20:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.845ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:49:42.119' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.872ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.431ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.027ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:49:42.241' AND status != 'pending'
	

2025/06/23 20:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.544ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:49:42.301' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.125ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:49:42.362'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.689ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:19:42.436'

2025/06/23 20:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.292ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:49:42.501' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.836ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.164ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.959ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:49:42.624' AND status != 'pending'
	

2025/06/23 20:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.934ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:49:42.684' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.990ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:49:42.746'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:50:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.377ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:50:41.689'

2025/06/23 20:50:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.780ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:50:41.689'

2025/06/23 20:50:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.939ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:50:41.689'

2025/06/23 20:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.629ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:20:42.058'

2025/06/23 20:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.051ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:50:42.12' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.513ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.857ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.736ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:50:42.243' AND status != 'pending'
	

2025/06/23 20:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.030ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:50:42.305' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.149ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:50:42.366'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.352ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:20:42.436'

2025/06/23 20:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.017ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:50:42.498' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.130ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.364ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.083ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:50:42.619' AND status != 'pending'
	

2025/06/23 20:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.886ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:50:42.68' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.734ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:50:42.74'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:51:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.383ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:51:41.69'

2025/06/23 20:51:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.718ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:36:41.689' LIMIT 50

2025/06/23 20:51:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.461ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:51:41.69'

2025/06/23 20:51:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.489ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:51:41.69'

2025/06/23 20:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.028ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:36:41.959' LIMIT 50

2025/06/23 20:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.185ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:21:42.059'

2025/06/23 20:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.506ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:51:42.119' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.497ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.818ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.152ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:51:42.235' AND status != 'pending'
	

2025/06/23 20:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.013ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:51:42.292' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.712ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:51:42.349'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.464ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:21:42.437'

2025/06/23 20:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.227ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:51:42.494' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.726ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.255ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.357ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:51:42.608' AND status != 'pending'
	

2025/06/23 20:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.856ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:51:42.665' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[55.901ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:51:42.724'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:52:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.879ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:52:41.69'

2025/06/23 20:52:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.625ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:52:41.69'

2025/06/23 20:52:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.594ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:52:41.69'

2025/06/23 20:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.922ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:22:42.059'

2025/06/23 20:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.843ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:52:42.12' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.513ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.233ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.625ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:52:42.236' AND status != 'pending'
	

2025/06/23 20:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.895ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:52:42.295' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.953ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:52:42.353'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.788ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:22:42.437'

2025/06/23 20:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.088ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:52:42.497' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.617ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.708ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.893ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:52:42.615' AND status != 'pending'
	

2025/06/23 20:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.095ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:52:42.676' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.154ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:52:42.734'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:53:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.495ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:53:41.69'

2025/06/23 20:53:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.042ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:38:41.689' LIMIT 50

2025/06/23 20:53:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.822ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:53:41.69'

2025/06/23 20:53:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.491ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:53:41.69'

2025/06/23 20:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.386ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:38:41.959' LIMIT 50

2025/06/23 20:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.902ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:23:42.059'

2025/06/23 20:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.366ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:53:42.117' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.704ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.863ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.771ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:53:42.233' AND status != 'pending'
	

2025/06/23 20:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.757ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:53:42.291' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.661ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:53:42.348'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[55.367ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:23:42.437'

2025/06/23 20:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.163ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:53:42.494' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.588ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.686ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.165ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:53:42.608' AND status != 'pending'
	

2025/06/23 20:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.162ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:53:42.665' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.846ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:53:42.722'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:54:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.693ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:54:41.69'

2025/06/23 20:54:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.009ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:54:41.69'

2025/06/23 20:54:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.273ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:54:41.69'

2025/06/23 20:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.927ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:24:42.06'

2025/06/23 20:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.099ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:54:42.12' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.724ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.983ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.049ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:54:42.233' AND status != 'pending'
	

2025/06/23 20:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.467ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:54:42.289' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.551ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:54:42.348'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.372ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:24:42.437'

2025/06/23 20:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.357ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:54:42.497' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.939ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.474ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.342ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:54:42.61' AND status != 'pending'
	

2025/06/23 20:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.730ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:54:42.667' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.685ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:54:42.725'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:55:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.602ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:40:41.69' LIMIT 50

2025/06/23 20:55:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.300ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:55:41.691'

2025/06/23 20:55:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.307ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:55:41.691'

2025/06/23 20:55:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.235ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:55:41.691'

2025/06/23 20:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.042ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:40:41.96' LIMIT 50

2025/06/23 20:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.332ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:25:42.063'

2025/06/23 20:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.363ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:55:42.124' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.310ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.760ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.676ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:55:42.246' AND status != 'pending'
	

2025/06/23 20:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.638ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:55:42.307' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.940ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:55:42.368'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.918ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:25:42.438'

2025/06/23 20:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.816ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:55:42.499' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.143ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.302ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.022ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:55:42.621' AND status != 'pending'
	

2025/06/23 20:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.657ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:55:42.682' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.777ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:55:42.743'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:56:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.156ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:56:41.691'

2025/06/23 20:56:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.437ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:56:41.691'

2025/06/23 20:56:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.597ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:56:41.691'

2025/06/23 20:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.660ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:26:42.059'

2025/06/23 20:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.009ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:56:42.122' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.846ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.564ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.404ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:56:42.246' AND status != 'pending'
	

2025/06/23 20:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.378ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:56:42.31' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.328ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:56:42.371'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.785ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:26:42.438'

2025/06/23 20:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.298ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:56:42.5' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.687ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.780ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.010ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:56:42.62' AND status != 'pending'
	

2025/06/23 20:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.222ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:56:42.681' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.167ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:56:42.744'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:57:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.419ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:57:41.691'

2025/06/23 20:57:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.423ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:42:41.691' LIMIT 50

2025/06/23 20:57:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.285ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:57:41.691'

2025/06/23 20:57:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[56.646ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:57:41.691'

2025/06/23 20:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.325ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:42:41.96' LIMIT 50

2025/06/23 20:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.785ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:27:42.06'

2025/06/23 20:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.839ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:57:42.117' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.771ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.811ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.822ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:57:42.234' AND status != 'pending'
	

2025/06/23 20:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.073ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:57:42.292' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.095ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:57:42.351'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.723ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:27:42.439'

2025/06/23 20:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.528ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:57:42.495' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.994ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.147ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.238ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:57:42.611' AND status != 'pending'
	

2025/06/23 20:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.303ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:57:42.671' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.639ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:57:42.729'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:58:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.702ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:58:41.692'

2025/06/23 20:58:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.190ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:58:41.692'

2025/06/23 20:58:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.344ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:58:41.692'

2025/06/23 20:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.469ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:28:42.06'

2025/06/23 20:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.802ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:58:42.117' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.872ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.272ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.160ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:58:42.231' AND status != 'pending'
	

2025/06/23 20:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.222ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:58:42.29' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.385ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:58:42.347'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.158ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:28:42.439'

2025/06/23 20:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.620ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:58:42.496' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.321ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.596ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.247ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:58:42.611' AND status != 'pending'
	

2025/06/23 20:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.084ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:58:42.67' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.381ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:58:42.726'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[56.787ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 20:59:41.692'

2025/06/23 20:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.689ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:44:41.691' LIMIT 50

2025/06/23 20:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.190ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 20:59:41.692'

2025/06/23 20:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.026ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 20:59:41.692'

2025/06/23 20:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.485ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:44:41.961' LIMIT 50

2025/06/23 20:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.167ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:29:42.061'

2025/06/23 20:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.250ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:59:42.12' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.656ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.885ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.981ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:59:42.237' AND status != 'pending'
	

2025/06/23 20:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.999ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:59:42.296' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.301ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:59:42.354'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 20:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.086ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:29:42.439'

2025/06/23 20:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.578ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 19:59:42.498' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 20:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.583ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 20:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.162ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 20:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.485ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 19:59:42.611' AND status != 'pending'
	

2025/06/23 20:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.345ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 19:59:42.669' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 20:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.826ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 19:59:42.727'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:00:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[57.257ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:00:41.692'

2025/06/23 21:00:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.707ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:00:41.692'

2025/06/23 21:00:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.571ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:00:41.692'

2025/06/23 21:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.748ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:30:42.061'

2025/06/23 21:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.243ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:00:42.119' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.764ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.560ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.793ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:00:42.234' AND status != 'pending'
	

2025/06/23 21:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.522ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:00:42.292' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.615ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:00:42.35'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.425ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:30:42.439'

2025/06/23 21:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.956ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:00:42.498' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.626ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.836ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.098ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:00:42.617' AND status != 'pending'
	

2025/06/23 21:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.705ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:00:42.674' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.075ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:00:42.731'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:01:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.691ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:46:41.692' LIMIT 50

2025/06/23 21:01:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.411ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:01:41.692'

2025/06/23 21:01:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.947ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:01:41.692'

2025/06/23 21:01:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.206ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:01:41.692'

2025/06/23 21:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.122ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:46:41.961' LIMIT 50

2025/06/23 21:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.082ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:31:42.061'

2025/06/23 21:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.212ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:01:42.124' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.698ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.100ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.354ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:01:42.247' AND status != 'pending'
	

2025/06/23 21:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.285ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:01:42.309' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.897ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:01:42.37'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.621ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:31:42.439'

2025/06/23 21:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.334ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:01:42.501' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.497ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.537ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.714ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:01:42.622' AND status != 'pending'
	

2025/06/23 21:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.696ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:01:42.683' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.112ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:01:42.745'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:02:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.498ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 21:02:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.282ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:02:41.693'

2025/06/23 21:02:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.760ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:02:41.693'

2025/06/23 21:02:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.427ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:02:41.693'

2025/06/23 21:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.941ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:32:42.061'

2025/06/23 21:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.049ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:02:42.123' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.252ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.597ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.554ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:02:42.245' AND status != 'pending'
	

2025/06/23 21:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.927ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:02:42.307' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.814ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:02:42.372'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.136ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:32:42.439'

2025/06/23 21:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.420ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:02:42.501' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.462ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.011ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.619ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:02:42.623' AND status != 'pending'
	

2025/06/23 21:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.015ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:02:42.683' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.314ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:02:42.743'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:03:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.541ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:03:41.693'

2025/06/23 21:03:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.117ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:48:41.692' LIMIT 50

2025/06/23 21:03:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.019ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:03:41.693'

2025/06/23 21:03:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.372ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:03:41.693'

2025/06/23 21:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.337ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:48:41.962' LIMIT 50

2025/06/23 21:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.194ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:33:42.062'

2025/06/23 21:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.175ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:03:42.12' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.253ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.593ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.664ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:03:42.234' AND status != 'pending'
	

2025/06/23 21:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.332ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:03:42.294' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.605ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:03:42.352'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.003ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:33:42.439'

2025/06/23 21:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.895ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:03:42.497' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.894ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.982ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.169ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:03:42.613' AND status != 'pending'
	

2025/06/23 21:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.468ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:03:42.67' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.551ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:03:42.728'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:03:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[57.626ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 21:04:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.551ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:04:41.693'

2025/06/23 21:04:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.612ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:04:41.693'

2025/06/23 21:04:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.527ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:04:41.693'

2025/06/23 21:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.706ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:34:42.062'

2025/06/23 21:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.241ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:04:42.12' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.099ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.389ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.060ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:04:42.237' AND status != 'pending'
	

2025/06/23 21:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.435ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:04:42.299' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.488ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:04:42.358'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.804ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:34:42.44'

2025/06/23 21:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.560ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:04:42.498' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.732ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.433ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.920ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:04:42.614' AND status != 'pending'
	

2025/06/23 21:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.122ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:04:42.671' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.336ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:04:42.728'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:05:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.443ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:50:41.693' LIMIT 50

2025/06/23 21:05:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.504ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:05:41.693'

2025/06/23 21:05:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.551ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:05:41.693'

2025/06/23 21:05:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.325ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:05:41.693'

2025/06/23 21:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.582ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:50:41.962' LIMIT 50

2025/06/23 21:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.187ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:35:42.062'

2025/06/23 21:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.909ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:05:42.125' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.673ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.743ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.714ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:05:42.246' AND status != 'pending'
	

2025/06/23 21:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[68.818ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:05:42.308' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.810ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:05:42.377'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.605ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:35:42.44'

2025/06/23 21:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.250ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:05:42.499' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.692ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.724ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.982ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:05:42.614' AND status != 'pending'
	

2025/06/23 21:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.941ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:05:42.672' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.018ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:05:42.73'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:06:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[57.767ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:06:41.694'

2025/06/23 21:06:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.652ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:06:41.694'

2025/06/23 21:06:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.748ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:06:41.694'

2025/06/23 21:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.581ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:36:42.063'

2025/06/23 21:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.155ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:06:42.122' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.203ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.603ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.858ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:06:42.236' AND status != 'pending'
	

2025/06/23 21:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.338ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:06:42.295' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.213ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:06:42.353'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.228ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:36:42.441'

2025/06/23 21:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.293ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:06:42.498' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.724ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.726ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.263ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:06:42.614' AND status != 'pending'
	

2025/06/23 21:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.624ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:06:42.671' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.581ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:06:42.73'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:07:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.136ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:52:41.693' LIMIT 50

2025/06/23 21:07:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.005ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:07:41.694'

2025/06/23 21:07:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.358ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:07:41.694'

2025/06/23 21:07:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.986ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:07:41.694'

2025/06/23 21:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.403ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:52:41.963' LIMIT 50

2025/06/23 21:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.683ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:37:42.063'

2025/06/23 21:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.569ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:07:42.128' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.744ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.400ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.199ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:07:42.25' AND status != 'pending'
	

2025/06/23 21:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.121ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:07:42.312' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.270ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:07:42.374'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.622ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:37:42.441'

2025/06/23 21:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.346ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:07:42.5' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.325ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.953ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.452ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:07:42.621' AND status != 'pending'
	

2025/06/23 21:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.814ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:07:42.682' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.527ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:07:42.742'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:08:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.551ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:08:41.694'

2025/06/23 21:08:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.462ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:08:41.694'

2025/06/23 21:08:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.353ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:08:41.694'

2025/06/23 21:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.405ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:38:42.063'

2025/06/23 21:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.902ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:08:42.126' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.249ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.103ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.519ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:08:42.246' AND status != 'pending'
	

2025/06/23 21:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.386ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:08:42.307' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.631ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:08:42.368'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.661ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:38:42.441'

2025/06/23 21:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.980ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:08:42.502' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.732ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.743ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.723ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:08:42.624' AND status != 'pending'
	

2025/06/23 21:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.476ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:08:42.687' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.650ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:08:42.748'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:09:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.686ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:09:41.694'

2025/06/23 21:09:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.482ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:09:41.694'

2025/06/23 21:09:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.447ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:09:41.694'

2025/06/23 21:09:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[220.695ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:54:41.694' LIMIT 50

2025/06/23 21:09:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[235.009ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:09:41.694' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/23 21:09:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[32.603ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-16 21:09:41.93'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/23 21:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[56.992ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:54:41.963' LIMIT 50

2025/06/23 21:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[57.919ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:09:41.963' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/23 21:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[29.314ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-16 21:09:42.021'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/23 21:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.402ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:39:42.063'

2025/06/23 21:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.902ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:09:42.123' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.807ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.847ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.536ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:09:42.246' AND status != 'pending'
	

2025/06/23 21:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.929ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:09:42.308' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.350ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:09:42.368'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.053ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:39:42.442'

2025/06/23 21:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.318ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:09:42.502' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.988ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.512ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.965ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:09:42.621' AND status != 'pending'
	

2025/06/23 21:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.013ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:09:42.681' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.437ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:09:42.742'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:10:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.104ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:10:41.695'

2025/06/23 21:10:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.428ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:10:41.695'

2025/06/23 21:10:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.746ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:10:41.695'

2025/06/23 21:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.765ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:40:42.064'

2025/06/23 21:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.614ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:10:42.124' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.844ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.759ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.683ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:10:42.243' AND status != 'pending'
	

2025/06/23 21:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.895ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:10:42.304' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.508ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:10:42.364'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.968ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:40:42.441'

2025/06/23 21:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.912ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:10:42.501' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.545ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.948ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.564ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:10:42.621' AND status != 'pending'
	

2025/06/23 21:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.969ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:10:42.68' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.270ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:10:42.741'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:11:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.918ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:11:41.695'

2025/06/23 21:11:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.312ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:56:41.694' LIMIT 50

2025/06/23 21:11:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.257ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:11:41.695'

2025/06/23 21:11:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.958ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:11:41.695'

2025/06/23 21:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.365ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:56:41.963' LIMIT 50

2025/06/23 21:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.463ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:41:42.063'

2025/06/23 21:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.456ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:11:42.123' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.354ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.454ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.448ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:11:42.247' AND status != 'pending'
	

2025/06/23 21:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.125ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:11:42.308' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.108ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:11:42.369'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.232ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:41:42.441'

2025/06/23 21:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.475ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:11:42.501' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.104ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.257ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.633ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:11:42.62' AND status != 'pending'
	

2025/06/23 21:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.264ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:11:42.683' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.280ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:11:42.742'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:12:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.685ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:12:41.695'

2025/06/23 21:12:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.398ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:12:41.695'

2025/06/23 21:12:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.281ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:12:41.695'

2025/06/23 21:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.998ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:42:42.064'

2025/06/23 21:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.861ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:12:42.126' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.518ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.846ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.105ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:12:42.245' AND status != 'pending'
	

2025/06/23 21:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.591ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:12:42.305' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.819ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:12:42.364'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.170ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:42:42.443'

2025/06/23 21:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.521ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:12:42.504' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.517ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.575ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.266ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:12:42.622' AND status != 'pending'
	

2025/06/23 21:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.846ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:12:42.681' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.112ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:12:42.742'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:13:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.615ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:58:41.695' LIMIT 50

2025/06/23 21:13:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.763ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:13:41.696'

2025/06/23 21:13:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[68.272ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:13:41.696'

2025/06/23 21:13:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.069ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:13:41.696'

2025/06/23 21:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[69.811ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:58:41.965' LIMIT 50

2025/06/23 21:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.542ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:43:42.065'

2025/06/23 21:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[68.122ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:13:42.131' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.188ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.014ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.389ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:13:42.266' AND status != 'pending'
	

2025/06/23 21:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.327ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:13:42.333' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.792ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:13:42.399'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.428ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:43:42.443'

2025/06/23 21:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.466ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:13:42.502' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.399ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.669ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.282ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:13:42.624' AND status != 'pending'
	

2025/06/23 21:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.014ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:13:42.685' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.017ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:13:42.745'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:14:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.339ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:14:41.697'

2025/06/23 21:14:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.425ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:14:41.697'

2025/06/23 21:14:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.806ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:14:41.697'

2025/06/23 21:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.548ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:44:42.064'

2025/06/23 21:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.999ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:14:42.125' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.241ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.182ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.749ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:14:42.243' AND status != 'pending'
	

2025/06/23 21:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.329ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:14:42.302' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.003ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:14:42.362'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.912ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:44:42.443'

2025/06/23 21:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.000ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:14:42.502' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.722ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.519ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.826ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:14:42.622' AND status != 'pending'
	

2025/06/23 21:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.265ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:14:42.68' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.298ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:14:42.738'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:15:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.546ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:00:41.696' LIMIT 50

2025/06/23 21:15:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[73.647ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:15:41.696'

2025/06/23 21:15:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[75.316ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:15:41.696'

2025/06/23 21:15:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.649ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:15:41.696'

2025/06/23 21:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.112ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:00:41.964' LIMIT 50

2025/06/23 21:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.715ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:45:42.065'

2025/06/23 21:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.224ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:15:42.132' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.646ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.653ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.956ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:15:42.272' AND status != 'pending'
	

2025/06/23 21:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.841ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:15:42.34' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.098ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:15:42.408'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.239ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:45:42.442'

2025/06/23 21:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.396ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:15:42.502' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.595ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.311ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.090ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:15:42.62' AND status != 'pending'
	

2025/06/23 21:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.884ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:15:42.68' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.319ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:15:42.74'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:16:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.138ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:16:41.696'

2025/06/23 21:16:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.659ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:16:41.696'

2025/06/23 21:16:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.120ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:16:41.696'

2025/06/23 21:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.073ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:46:42.065'

2025/06/23 21:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.865ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:16:42.126' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.607ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.167ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.252ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:16:42.246' AND status != 'pending'
	

2025/06/23 21:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.742ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:16:42.307' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.194ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:16:42.367'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.236ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:46:42.444'

2025/06/23 21:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.276ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:16:42.504' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.771ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.007ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.122ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:16:42.625' AND status != 'pending'
	

2025/06/23 21:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.819ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:16:42.684' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.389ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:16:42.744'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:17:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.740ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:02:41.696' LIMIT 50

2025/06/23 21:17:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.941ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:17:41.697'

2025/06/23 21:17:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[67.049ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:17:41.697'

2025/06/23 21:17:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.843ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:17:41.697'

2025/06/23 21:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.419ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:02:41.965' LIMIT 50

2025/06/23 21:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.724ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:47:42.065'

2025/06/23 21:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.588ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:17:42.132' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.337ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.774ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[69.358ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:17:42.267' AND status != 'pending'
	

2025/06/23 21:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.130ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:17:42.339' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.124ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:17:42.407'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.694ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:47:42.443'

2025/06/23 21:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[73.696ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:17:42.503' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[51.455ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.237ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.978ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:17:42.661' AND status != 'pending'
	

2025/06/23 21:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.466ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:17:42.724' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.934ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:17:42.784'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:18:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.771ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:18:41.697'

2025/06/23 21:18:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.577ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:18:41.697'

2025/06/23 21:18:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.852ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:18:41.697'

2025/06/23 21:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.638ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:48:42.065'

2025/06/23 21:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.374ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:18:42.125' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.792ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.983ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.063ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:18:42.245' AND status != 'pending'
	

2025/06/23 21:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.809ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:18:42.305' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.006ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:18:42.365'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.707ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:48:42.444'

2025/06/23 21:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.828ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:18:42.503' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.168ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.342ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.737ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:18:42.622' AND status != 'pending'
	

2025/06/23 21:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.681ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:18:42.682' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.812ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:18:42.742'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:19:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.246ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:19:41.697'

2025/06/23 21:19:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[69.583ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:04:41.697' LIMIT 50

2025/06/23 21:19:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.388ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:19:41.697'

2025/06/23 21:19:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.442ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:19:41.697'

2025/06/23 21:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.897ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:04:41.966' LIMIT 50

2025/06/23 21:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.944ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:49:42.066'

2025/06/23 21:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.816ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:19:42.129' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.124ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.094ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.772ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:19:42.247' AND status != 'pending'
	

2025/06/23 21:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.565ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:19:42.308' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.174ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:19:42.368'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.773ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:49:42.444'

2025/06/23 21:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.625ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:19:42.503' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.330ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.764ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.282ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:19:42.624' AND status != 'pending'
	

2025/06/23 21:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.695ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:19:42.684' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.188ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:19:42.744'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:20:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.547ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:20:41.697'

2025/06/23 21:20:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.955ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:20:41.697'

2025/06/23 21:20:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.767ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:20:41.697'

2025/06/23 21:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.077ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:50:42.067'

2025/06/23 21:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.254ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:20:42.127' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.372ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.995ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.033ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:20:42.247' AND status != 'pending'
	

2025/06/23 21:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.782ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:20:42.307' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.013ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:20:42.367'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.593ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:50:42.444'

2025/06/23 21:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.918ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:20:42.504' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.421ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.649ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.652ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:20:42.624' AND status != 'pending'
	

2025/06/23 21:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.023ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:20:42.684' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.828ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:20:42.744'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:21:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.511ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:06:41.697' LIMIT 50

2025/06/23 21:21:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.701ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:21:41.698'

2025/06/23 21:21:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.886ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:21:41.698'

2025/06/23 21:21:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[67.656ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:21:41.698'

2025/06/23 21:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.649ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:06:41.967' LIMIT 50

2025/06/23 21:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.490ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:51:42.067'

2025/06/23 21:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.050ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:21:42.133' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.910ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.391ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.702ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:21:42.267' AND status != 'pending'
	

2025/06/23 21:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.048ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:21:42.335' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.786ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:21:42.401'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.829ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:51:42.445'

2025/06/23 21:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.883ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:21:42.505' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.579ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.013ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.449ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:21:42.626' AND status != 'pending'
	

2025/06/23 21:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.938ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:21:42.687' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.558ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:21:42.747'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:22:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.729ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:22:41.698'

2025/06/23 21:22:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.016ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:22:41.698'

2025/06/23 21:22:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.487ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:22:41.698'

2025/06/23 21:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.530ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:52:42.066'

2025/06/23 21:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.363ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:22:42.126' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.345ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.384ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.593ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:22:42.243' AND status != 'pending'
	

2025/06/23 21:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.845ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:22:42.303' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.615ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:22:42.362'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.249ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:52:42.445'

2025/06/23 21:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.469ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:22:42.506' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.018ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.625ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.927ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:22:42.626' AND status != 'pending'
	

2025/06/23 21:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.057ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:22:42.686' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.604ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:22:42.746'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:23:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.358ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:08:41.698' LIMIT 50

2025/06/23 21:23:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.355ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:23:41.698'

2025/06/23 21:23:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.661ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:23:41.698'

2025/06/23 21:23:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.654ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:23:41.698'

2025/06/23 21:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.753ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:08:41.967' LIMIT 50

2025/06/23 21:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.892ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:53:42.067'

2025/06/23 21:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.224ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:23:42.135' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.231ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.246ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[72.750ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:23:42.27' AND status != 'pending'
	

2025/06/23 21:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.740ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:23:42.343' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.904ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:23:42.409'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.903ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:53:42.445'

2025/06/23 21:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.334ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:23:42.504' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.092ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.822ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.352ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:23:42.624' AND status != 'pending'
	

2025/06/23 21:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.297ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:23:42.683' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.147ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:23:42.744'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:24:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.866ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:24:41.698'

2025/06/23 21:24:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.755ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:24:41.698'

2025/06/23 21:24:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.418ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:24:41.698'

2025/06/23 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.855ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:54:42.067'

2025/06/23 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.927ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:24:42.129' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.356ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.118ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.212ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:24:42.251' AND status != 'pending'
	

2025/06/23 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.606ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:24:42.312' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.443ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:24:42.372'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.197ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:54:42.446'

2025/06/23 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.613ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:24:42.506' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.871ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.915ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.824ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:24:42.627' AND status != 'pending'
	

2025/06/23 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.853ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:24:42.687' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.312ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:24:42.747'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:25:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.905ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:10:41.698' LIMIT 50

2025/06/23 21:25:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[71.431ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:25:41.699'

2025/06/23 21:25:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.743ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:25:41.699'

2025/06/23 21:25:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.828ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:25:41.699'

2025/06/23 21:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.216ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:10:41.968' LIMIT 50

2025/06/23 21:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.236ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:55:42.068'

2025/06/23 21:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.531ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:25:42.134' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.804ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.298ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[68.700ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:25:42.267' AND status != 'pending'
	

2025/06/23 21:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[68.822ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:25:42.336' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.024ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:25:42.405'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.223ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:55:42.446'

2025/06/23 21:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.571ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:25:42.505' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.196ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.538ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.538ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:25:42.63' AND status != 'pending'
	

2025/06/23 21:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.505ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:25:42.691' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.728ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:25:42.751'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:26:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[72.749ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:26:41.699'

2025/06/23 21:26:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.937ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:26:41.699'

2025/06/23 21:26:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.243ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:26:41.699'

2025/06/23 21:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.452ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:56:42.068'

2025/06/23 21:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.477ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:26:42.134' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.929ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.001ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.513ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:26:42.254' AND status != 'pending'
	

2025/06/23 21:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.743ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:26:42.314' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.125ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:26:42.38'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.561ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:56:42.446'

2025/06/23 21:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.234ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:26:42.505' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.893ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[55.975ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.594ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:26:42.664' AND status != 'pending'
	

2025/06/23 21:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.165ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:26:42.725' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.211ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:26:42.79'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:27:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.349ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:27:41.699'

2025/06/23 21:27:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.671ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:12:41.699' LIMIT 50

2025/06/23 21:27:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.438ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:27:41.699'

2025/06/23 21:27:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.733ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:27:41.699'

2025/06/23 21:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.017ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:12:41.968' LIMIT 50

2025/06/23 21:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.660ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:57:42.068'

2025/06/23 21:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.045ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:27:42.127' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.351ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.772ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.875ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:27:42.261' AND status != 'pending'
	

2025/06/23 21:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.313ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:27:42.321' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.332ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:27:42.382'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.282ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:57:42.446'

2025/06/23 21:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.115ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:27:42.505' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.982ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.105ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.626ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:27:42.626' AND status != 'pending'
	

2025/06/23 21:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.053ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:27:42.685' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.021ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:27:42.745'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:28:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.938ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:28:41.699'

2025/06/23 21:28:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.882ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:28:41.699'

2025/06/23 21:28:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.994ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:28:41.699'

2025/06/23 21:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.389ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:58:42.069'

2025/06/23 21:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[70.429ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:28:42.129' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.163ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.560ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.120ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:28:42.26' AND status != 'pending'
	

2025/06/23 21:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.611ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:28:42.32' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.380ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:28:42.38'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.433ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:58:42.447'

2025/06/23 21:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.277ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:28:42.506' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.839ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.741ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.873ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:28:42.627' AND status != 'pending'
	

2025/06/23 21:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.040ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:28:42.686' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.165ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:28:42.746'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:29:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.377ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:29:41.7'

2025/06/23 21:29:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[69.797ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:14:41.699' LIMIT 50

2025/06/23 21:29:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.750ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:29:41.7'

2025/06/23 21:29:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.045ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:29:41.7'

2025/06/23 21:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.078ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:14:41.969' LIMIT 50

2025/06/23 21:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.026ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:59:42.069'

2025/06/23 21:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.982ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:29:42.128' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.859ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.095ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.754ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:29:42.248' AND status != 'pending'
	

2025/06/23 21:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.056ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:29:42.309' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.741ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:29:42.369'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.911ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 20:59:42.447'

2025/06/23 21:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.277ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:29:42.507' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.917ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.677ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.989ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:29:42.626' AND status != 'pending'
	

2025/06/23 21:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.807ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:29:42.685' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.976ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:29:42.745'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:30:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.379ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:30:41.659'

2025/06/23 21:30:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.295ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:30:41.659'

2025/06/23 21:30:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.272ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:30:41.659'

2025/06/23 21:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.141ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:00:42.028'

2025/06/23 21:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.037ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:30:42.091' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.077ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.517ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.282ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:30:42.212' AND status != 'pending'
	

2025/06/23 21:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.469ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:30:42.273' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.425ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:30:42.335'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.181ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:00:42.406'

2025/06/23 21:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.805ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:30:42.467' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.003ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.468ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.945ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:30:42.587' AND status != 'pending'
	

2025/06/23 21:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.608ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:30:42.649' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.234ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:30:42.709'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:30:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.139ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 21:31:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.507ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:16:41.656' LIMIT 50

2025/06/23 21:31:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.635ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:31:41.657'

2025/06/23 21:31:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.478ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:31:41.657'

2025/06/23 21:31:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.793ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:31:41.657'

2025/06/23 21:31:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.507ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:16:41.925' LIMIT 50

2025/06/23 21:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.273ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:01:42.026'

2025/06/23 21:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.049ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:31:42.093' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.264ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.107ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.539ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:31:42.226' AND status != 'pending'
	

2025/06/23 21:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.791ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:31:42.293' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.915ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:31:42.359'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.530ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:01:42.404'

2025/06/23 21:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.535ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:31:42.464' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.818ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.073ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.739ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:31:42.583' AND status != 'pending'
	

2025/06/23 21:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.961ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:31:42.643' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.392ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:31:42.703'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:32:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.581ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:32:41.656'

2025/06/23 21:32:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.881ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:32:41.656'

2025/06/23 21:32:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.896ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:32:41.656'

2025/06/23 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.172ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:02:42.025'

2025/06/23 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.883ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:32:42.087' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.629ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.479ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.172ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:32:42.207' AND status != 'pending'
	

2025/06/23 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.217ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:32:42.267' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.041ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:32:42.328'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.203ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:02:42.403'

2025/06/23 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.843ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:32:42.463' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.378ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.663ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.182ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:32:42.581' AND status != 'pending'
	

2025/06/23 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.104ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:32:42.639' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.551ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:32:42.698'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:33:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.272ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:18:41.655' LIMIT 50

2025/06/23 21:33:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.124ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:33:41.656'

2025/06/23 21:33:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[67.370ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:33:41.656'

2025/06/23 21:33:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[67.343ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:33:41.656'

2025/06/23 21:33:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.104ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:18:41.925' LIMIT 50

2025/06/23 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.695ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:03:42.025'

2025/06/23 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.214ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:33:42.093' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.769ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.343ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.877ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:33:42.225' AND status != 'pending'
	

2025/06/23 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.845ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:33:42.291' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.085ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:33:42.358'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.827ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:03:42.403'

2025/06/23 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.045ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:33:42.464' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.917ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.536ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.195ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:33:42.583' AND status != 'pending'
	

2025/06/23 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.935ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:33:42.643' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.347ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:33:42.703'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:34:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.114ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:34:41.655'

2025/06/23 21:34:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.265ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:34:41.655'

2025/06/23 21:34:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.439ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:34:41.655'

2025/06/23 21:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.867ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:04:42.025'

2025/06/23 21:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.471ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:34:42.085' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.467ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.509ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.510ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:34:42.204' AND status != 'pending'
	

2025/06/23 21:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.490ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:34:42.264' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.728ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:34:42.324'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.543ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:04:42.403'

2025/06/23 21:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.492ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:34:42.461' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.174ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.512ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.536ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:34:42.58' AND status != 'pending'
	

2025/06/23 21:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.773ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:34:42.641' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.751ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:34:42.699'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:35:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.540ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:35:41.655'

2025/06/23 21:35:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.684ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:20:41.655' LIMIT 50

2025/06/23 21:35:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.302ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:35:41.655'

2025/06/23 21:35:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.394ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:35:41.655'

2025/06/23 21:35:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.914ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:20:41.924' LIMIT 50

2025/06/23 21:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.769ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:05:42.024'

2025/06/23 21:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.260ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:35:42.083' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.408ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.275ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.603ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:35:42.202' AND status != 'pending'
	

2025/06/23 21:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.806ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:35:42.261' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.732ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:35:42.321'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.292ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:05:42.402'

2025/06/23 21:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.427ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:35:42.462' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.771ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.166ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.787ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:35:42.581' AND status != 'pending'
	

2025/06/23 21:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.298ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:35:42.641' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.031ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:35:42.701'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:36:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.578ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:36:41.655'

2025/06/23 21:36:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.230ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:36:41.655'

2025/06/23 21:36:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.923ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:36:41.655'

2025/06/23 21:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.319ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:06:42.024'

2025/06/23 21:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.191ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:36:42.083' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.832ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.404ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.018ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:36:42.203' AND status != 'pending'
	

2025/06/23 21:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.875ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:36:42.262' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.716ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:36:42.322'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.683ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:06:42.402'

2025/06/23 21:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.455ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:36:42.461' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.907ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.355ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.655ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:36:42.578' AND status != 'pending'
	

2025/06/23 21:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.237ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:36:42.638' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.572ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:36:42.696'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:37:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.737ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:22:41.654' LIMIT 50

2025/06/23 21:37:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.212ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:37:41.654'

2025/06/23 21:37:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.998ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:37:41.654'

2025/06/23 21:37:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.245ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:37:41.654'

2025/06/23 21:37:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.605ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:22:41.923' LIMIT 50

2025/06/23 21:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.189ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:07:42.023'

2025/06/23 21:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.944ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:37:42.09' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.586ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.856ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.129ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:37:42.223' AND status != 'pending'
	

2025/06/23 21:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.928ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:37:42.289' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.746ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:37:42.356'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.651ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:07:42.402'

2025/06/23 21:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.429ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:37:42.464' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.816ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.922ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.490ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:37:42.583' AND status != 'pending'
	

2025/06/23 21:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.758ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:37:42.643' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.887ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:37:42.703'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:38:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.688ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:38:41.654'

2025/06/23 21:38:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.582ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:38:41.654'

2025/06/23 21:38:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.413ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:38:41.654'

2025/06/23 21:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.618ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:08:42.022'

2025/06/23 21:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.996ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:38:42.082' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.684ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.627ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.568ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:38:42.201' AND status != 'pending'
	

2025/06/23 21:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.481ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:38:42.26' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.409ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:38:42.32'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.476ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:08:42.401'

2025/06/23 21:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.914ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:38:42.459' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.393ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.642ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.632ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:38:42.577' AND status != 'pending'
	

2025/06/23 21:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.517ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:38:42.636' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.135ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:38:42.696'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:39:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.794ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:24:41.653' LIMIT 50

2025/06/23 21:39:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[108.781ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:39:41.654'

2025/06/23 21:39:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.543ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:39:41.654'

2025/06/23 21:39:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[68.502ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:39:41.654'

2025/06/23 21:39:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.349ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:24:41.924' LIMIT 50

2025/06/23 21:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.904ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:09:42.022'

2025/06/23 21:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.020ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:39:42.088' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.281ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.954ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.982ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:39:42.221' AND status != 'pending'
	

2025/06/23 21:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.208ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:39:42.288' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.559ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:39:42.355'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.791ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:09:42.4'

2025/06/23 21:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.862ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:39:42.46' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.974ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.105ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.027ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:39:42.581' AND status != 'pending'
	

2025/06/23 21:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.514ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:39:42.641' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.890ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:39:42.7'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:40:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.663ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:40:41.653'

2025/06/23 21:40:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.407ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:40:41.653'

2025/06/23 21:40:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[86.468ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:40:41.653'

2025/06/23 21:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.171ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:10:42.022'

2025/06/23 21:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.414ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:40:42.081' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.865ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.784ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.889ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:40:42.201' AND status != 'pending'
	

2025/06/23 21:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.992ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:40:42.26' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.835ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:40:42.32'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.902ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:10:42.402'

2025/06/23 21:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.659ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:40:42.461' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.862ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.449ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.480ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:40:42.58' AND status != 'pending'
	

2025/06/23 21:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.393ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:40:42.639' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.951ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:40:42.698'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:41:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.825ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:26:41.653' LIMIT 50

2025/06/23 21:41:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.773ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:41:41.653'

2025/06/23 21:41:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.338ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:41:41.653'

2025/06/23 21:41:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.965ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:41:41.653'

2025/06/23 21:41:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.286ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:26:41.922' LIMIT 50

2025/06/23 21:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.044ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:11:42.021'

2025/06/23 21:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.892ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:41:42.088' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.026ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.045ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.798ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:41:42.22' AND status != 'pending'
	

2025/06/23 21:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.684ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:41:42.288' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.141ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:41:42.356'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.042ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:11:42.4'

2025/06/23 21:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.616ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:41:42.46' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.315ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.277ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.708ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:41:42.58' AND status != 'pending'
	

2025/06/23 21:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.962ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:41:42.64' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.234ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:41:42.7'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:42:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.928ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:42:41.653'

2025/06/23 21:42:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.421ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:42:41.653'

2025/06/23 21:42:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.096ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:42:41.653'

2025/06/23 21:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.703ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:12:42.021'

2025/06/23 21:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.478ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:42:42.083' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.929ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.204ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.129ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:42:42.204' AND status != 'pending'
	

2025/06/23 21:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.165ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:42:42.264' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.142ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:42:42.325'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.451ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:12:42.4'

2025/06/23 21:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.977ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:42:42.461' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.734ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.858ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.235ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:42:42.581' AND status != 'pending'
	

2025/06/23 21:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.228ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:42:42.64' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.413ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:42:42.701'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:43:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.069ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 21:43:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.185ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 21:43:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.751ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 21:43:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.566ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:43:41.652'

2025/06/23 21:43:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.385ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:28:41.652' LIMIT 50

2025/06/23 21:43:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.378ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:43:41.652'

2025/06/23 21:43:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.925ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:43:41.652'

2025/06/23 21:43:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.113ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:28:41.921' LIMIT 50

2025/06/23 21:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.863ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:13:42.02'

2025/06/23 21:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.673ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:43:42.083' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.497ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.177ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.193ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:43:42.205' AND status != 'pending'
	

2025/06/23 21:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.540ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:43:42.265' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.850ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:43:42.326'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.993ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:13:42.4'

2025/06/23 21:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.814ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:43:42.46' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.702ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.999ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.815ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:43:42.58' AND status != 'pending'
	

2025/06/23 21:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.706ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:43:42.64' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.773ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:43:42.7'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.195ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 21:44:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.451ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:44:41.652'

2025/06/23 21:44:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.841ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:44:41.652'

2025/06/23 21:44:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.709ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:44:41.652'

2025/06/23 21:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.013ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:14:42.021'

2025/06/23 21:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.750ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:44:42.081' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.928ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.078ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.614ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:44:42.202' AND status != 'pending'
	

2025/06/23 21:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.973ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:44:42.262' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.906ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:44:42.323'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.618ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:14:42.399'

2025/06/23 21:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.027ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:44:42.459' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.570ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.064ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.355ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:44:42.58' AND status != 'pending'
	

2025/06/23 21:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.373ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:44:42.64' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.180ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:44:42.7'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:45:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.159ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:30:41.651' LIMIT 50

2025/06/23 21:45:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.636ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:45:41.652'

2025/06/23 21:45:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.363ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:45:41.652'

2025/06/23 21:45:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.389ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:45:41.652'

2025/06/23 21:45:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.725ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:30:41.921' LIMIT 50

2025/06/23 21:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.644ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:15:42.02'

2025/06/23 21:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.187ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:45:42.087' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.252ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.166ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.383ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:45:42.22' AND status != 'pending'
	

2025/06/23 21:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.979ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:45:42.287' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.837ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:45:42.354'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.001ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:15:42.399'

2025/06/23 21:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.067ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:45:42.46' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.132ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.853ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.381ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:45:42.588' AND status != 'pending'
	

2025/06/23 21:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.610ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:45:42.65' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.839ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:45:42.714'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:46:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.968ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:46:41.651'

2025/06/23 21:46:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.594ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:46:41.651'

2025/06/23 21:46:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.143ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:46:41.651'

2025/06/23 21:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.976ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:16:42.02'

2025/06/23 21:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.242ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:46:42.081' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.840ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.326ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.664ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:46:42.202' AND status != 'pending'
	

2025/06/23 21:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.059ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:46:42.266' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.758ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:46:42.326'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.080ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:16:42.398'

2025/06/23 21:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.262ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:46:42.459' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.657ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.756ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.270ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:46:42.578' AND status != 'pending'
	

2025/06/23 21:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.025ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:46:42.639' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.136ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:46:42.7'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:47:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.844ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:32:41.65' LIMIT 50

2025/06/23 21:47:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.059ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:47:41.651'

2025/06/23 21:47:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.884ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:47:41.651'

2025/06/23 21:47:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.428ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:47:41.651'

2025/06/23 21:47:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.087ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:32:41.92' LIMIT 50

2025/06/23 21:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.600ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:17:42.019'

2025/06/23 21:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.083ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:47:42.086' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.878ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.575ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.750ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:47:42.22' AND status != 'pending'
	

2025/06/23 21:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.449ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:47:42.286' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.683ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:47:42.353'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.866ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:17:42.398'

2025/06/23 21:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.009ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:47:42.457' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.738ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.781ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.546ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:47:42.581' AND status != 'pending'
	

2025/06/23 21:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.647ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:47:42.641' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.929ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:47:42.7'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:47:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.555ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 21:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.090ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 21:48:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.937ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 21:48:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.601ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:48:41.65'

2025/06/23 21:48:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.517ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:48:41.65'

2025/06/23 21:48:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.760ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:48:41.65'

2025/06/23 21:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.200ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:18:42.02'

2025/06/23 21:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.322ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:48:42.081' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.681ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.758ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.280ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:48:42.203' AND status != 'pending'
	

2025/06/23 21:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.281ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:48:42.263' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.798ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:48:42.328'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.818ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:18:42.397'

2025/06/23 21:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.488ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:48:42.457' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.020ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.717ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.253ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:48:42.578' AND status != 'pending'
	

2025/06/23 21:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.549ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:48:42.637' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.478ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:48:42.697'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:49:02 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[82.042ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 21:49:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.955ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:49:41.65'

2025/06/23 21:49:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.927ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:34:41.65' LIMIT 50

2025/06/23 21:49:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.817ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:49:41.65'

2025/06/23 21:49:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.037ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:49:41.65'

2025/06/23 21:49:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.183ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:34:41.919' LIMIT 50

2025/06/23 21:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.551ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:19:42.019'

2025/06/23 21:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.440ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:49:42.081' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.723ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.768ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.731ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:49:42.2' AND status != 'pending'
	

2025/06/23 21:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.070ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:49:42.26' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.850ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:49:42.321'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.304ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:19:42.397'

2025/06/23 21:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.203ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:49:42.457' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.818ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.770ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.058ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:49:42.577' AND status != 'pending'
	

2025/06/23 21:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.608ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:49:42.644' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.099ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:49:42.703'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:50:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.745ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:50:41.65'

2025/06/23 21:50:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.721ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:50:41.65'

2025/06/23 21:50:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.702ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:50:41.65'

2025/06/23 21:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.487ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:20:42.019'

2025/06/23 21:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.218ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:50:42.08' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.208ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.409ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.234ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:50:42.201' AND status != 'pending'
	

2025/06/23 21:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.208ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:50:42.262' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.627ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:50:42.322'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.449ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:20:42.397'

2025/06/23 21:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.023ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:50:42.457' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.643ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.768ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.424ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:50:42.578' AND status != 'pending'
	

2025/06/23 21:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.172ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:50:42.639' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.342ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:50:42.701'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:50:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.412ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 21:51:03 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.816ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 21:51:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.988ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:36:41.649' LIMIT 50

2025/06/23 21:51:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.442ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:51:41.649'

2025/06/23 21:51:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.660ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:51:41.649'

2025/06/23 21:51:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.196ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:51:41.649'

2025/06/23 21:51:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[68.175ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:36:41.918' LIMIT 50

2025/06/23 21:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.455ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:21:42.018'

2025/06/23 21:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.374ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:51:42.089' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.063ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.327ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.618ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:51:42.223' AND status != 'pending'
	

2025/06/23 21:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.347ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:51:42.291' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[68.199ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:51:42.358'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.682ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:21:42.396'

2025/06/23 21:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.490ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:51:42.456' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.841ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.298ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[70.148ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:51:42.577' AND status != 'pending'
	

2025/06/23 21:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.014ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:51:42.648' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.837ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:51:42.713'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:52:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.758ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:52:41.649'

2025/06/23 21:52:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.098ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:52:41.649'

2025/06/23 21:52:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.399ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:52:41.649'

2025/06/23 21:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.375ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:22:42.018'

2025/06/23 21:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.247ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:52:42.079' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.779ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.675ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.727ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:52:42.2' AND status != 'pending'
	

2025/06/23 21:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.191ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:52:42.26' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.166ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:52:42.32'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.200ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:22:42.396'

2025/06/23 21:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.078ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:52:42.456' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.405ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.919ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.798ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:52:42.58' AND status != 'pending'
	

2025/06/23 21:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.401ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:52:42.64' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.711ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:52:42.699'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:53:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.949ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:38:41.648' LIMIT 50

2025/06/23 21:53:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.477ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:53:41.649'

2025/06/23 21:53:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.331ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:53:41.649'

2025/06/23 21:53:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.566ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:53:41.649'

2025/06/23 21:53:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.097ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:38:41.918' LIMIT 50

2025/06/23 21:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.229ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:23:42.018'

2025/06/23 21:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.076ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:53:42.083' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.613ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.441ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[68.261ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:53:42.221' AND status != 'pending'
	

2025/06/23 21:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.755ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:53:42.289' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.236ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:53:42.356'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.376ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:23:42.395'

2025/06/23 21:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.528ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:53:42.457' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.099ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.159ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.282ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:53:42.582' AND status != 'pending'
	

2025/06/23 21:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.536ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:53:42.644' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.812ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:53:42.706'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:54:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.729ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 21:54:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.333ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:54:41.648'

2025/06/23 21:54:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.910ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:54:41.648'

2025/06/23 21:54:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.360ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:54:41.648'

2025/06/23 21:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.414ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:24:42.017'

2025/06/23 21:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.644ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:54:42.078' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.912ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.863ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.693ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:54:42.198' AND status != 'pending'
	

2025/06/23 21:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.051ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:54:42.258' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.207ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:54:42.319'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.735ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:24:42.395'

2025/06/23 21:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.556ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:54:42.456' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.838ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.981ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.683ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:54:42.576' AND status != 'pending'
	

2025/06/23 21:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.083ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:54:42.636' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:54:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.942ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:54:42.697'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:55:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.811ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 21:55:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.110ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:40:41.647' LIMIT 50

2025/06/23 21:55:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.587ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:55:41.648'

2025/06/23 21:55:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[67.305ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:55:41.648'

2025/06/23 21:55:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.254ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:55:41.648'

2025/06/23 21:55:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.016ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:40:41.917' LIMIT 50

2025/06/23 21:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.228ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:25:42.019'

2025/06/23 21:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[76.160ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:55:42.085' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.608ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.590ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.889ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:55:42.232' AND status != 'pending'
	

2025/06/23 21:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[68.025ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:55:42.299' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[68.166ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:55:42.368'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.730ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:25:42.395'

2025/06/23 21:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.704ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:55:42.459' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.130ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.896ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.931ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:55:42.588' AND status != 'pending'
	

2025/06/23 21:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.248ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:55:42.648' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:55:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.670ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:55:42.707'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:56:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.421ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 21:56:27 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.194ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 21:56:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.966ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:56:41.647'

2025/06/23 21:56:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.602ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:56:41.647'

2025/06/23 21:56:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.659ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:56:41.647'

2025/06/23 21:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.644ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:26:42.017'

2025/06/23 21:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.124ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:56:42.076' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.837ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.665ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.464ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:56:42.196' AND status != 'pending'
	

2025/06/23 21:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.234ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:56:42.256' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.347ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:56:42.315'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.593ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:26:42.395'

2025/06/23 21:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.272ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:56:42.454' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.707ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.816ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.082ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:56:42.573' AND status != 'pending'
	

2025/06/23 21:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.742ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:56:42.633' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:56:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.813ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:56:42.694'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:57:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.265ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 21:57:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.664ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:42:41.647' LIMIT 50

2025/06/23 21:57:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.380ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:57:41.647'

2025/06/23 21:57:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.745ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:57:41.647'

2025/06/23 21:57:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.070ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:57:41.647'

2025/06/23 21:57:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.878ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:42:41.916' LIMIT 50

2025/06/23 21:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.938ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:27:42.016'

2025/06/23 21:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.306ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:57:42.084' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.415ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.924ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.999ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:57:42.218' AND status != 'pending'
	

2025/06/23 21:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.061ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:57:42.284' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.360ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:57:42.351'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.072ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:27:42.394'

2025/06/23 21:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.460ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:57:42.453' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.628ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.432ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.879ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:57:42.573' AND status != 'pending'
	

2025/06/23 21:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.145ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:57:42.633' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:57:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.626ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:57:42.696'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:58:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.015ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:58:41.647'

2025/06/23 21:58:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.159ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:58:41.647'

2025/06/23 21:58:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.543ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:58:41.647'

2025/06/23 21:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.908ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:28:42.016'

2025/06/23 21:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.544ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:58:42.076' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.503ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.750ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.692ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:58:42.198' AND status != 'pending'
	

2025/06/23 21:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.777ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:58:42.257' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.259ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:58:42.318'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.717ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:28:42.394'

2025/06/23 21:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.842ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:58:42.457' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.026ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.345ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.057ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:58:42.579' AND status != 'pending'
	

2025/06/23 21:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.995ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:58:42.638' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:58:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.474ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:58:42.698'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.048ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:44:41.646' LIMIT 50

2025/06/23 21:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.389ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 21:59:41.646'

2025/06/23 21:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.687ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 21:59:41.646'

2025/06/23 21:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.635ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 21:59:41.646'

2025/06/23 21:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[70.927ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:44:41.916' LIMIT 50

2025/06/23 21:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[69.391ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:29:42.015'

2025/06/23 21:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.820ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:59:42.085' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.603ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.625ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.709ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:59:42.219' AND status != 'pending'
	

2025/06/23 21:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.145ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:59:42.287' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.212ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:59:42.354'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.936ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:29:42.393'

2025/06/23 21:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.777ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 20:59:42.453' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 21:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.913ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 21:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.690ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 21:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.279ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 20:59:42.571' AND status != 'pending'
	

2025/06/23 21:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.918ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 20:59:42.631' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 21:59:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.016ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 20:59:42.691'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 21:59:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.824ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:00:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.202ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:00:41.646'

2025/06/23 22:00:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.998ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:00:41.646'

2025/06/23 22:00:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.214ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:00:41.646'

2025/06/23 22:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.738ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:30:42.014'

2025/06/23 22:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.000ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:00:42.076' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.571ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.870ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.265ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:00:42.195' AND status != 'pending'
	

2025/06/23 22:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.988ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:00:42.256' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.986ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:00:42.316'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.032ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:30:42.394'

2025/06/23 22:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.603ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:00:42.453' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.793ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.840ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.320ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:00:42.573' AND status != 'pending'
	

2025/06/23 22:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.291ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:00:42.632' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:00:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.816ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:00:42.692'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:01:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.866ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:46:41.645' LIMIT 50

2025/06/23 22:01:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.568ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:01:41.646'

2025/06/23 22:01:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.312ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:01:41.646'

2025/06/23 22:01:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.323ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:01:41.646'

2025/06/23 22:01:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.474ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:46:41.914' LIMIT 50

2025/06/23 22:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.801ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:31:42.015'

2025/06/23 22:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[68.091ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:01:42.083' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.859ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.890ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.961ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:01:42.218' AND status != 'pending'
	

2025/06/23 22:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.630ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:01:42.284' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.275ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:01:42.351'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.297ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:31:42.393'

2025/06/23 22:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.236ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:01:42.452' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.894ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.916ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.523ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:01:42.574' AND status != 'pending'
	

2025/06/23 22:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.517ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:01:42.633' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:01:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.859ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:01:42.693'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:02:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.764ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:02:41.645'

2025/06/23 22:02:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.487ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:02:41.645'

2025/06/23 22:02:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.531ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:02:41.645'

2025/06/23 22:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.709ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:32:42.014'

2025/06/23 22:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.048ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:02:42.075' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.338ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.346ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.857ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:02:42.197' AND status != 'pending'
	

2025/06/23 22:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.376ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:02:42.257' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.526ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:02:42.317'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.985ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:32:42.393'

2025/06/23 22:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.136ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:02:42.452' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.459ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.756ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.527ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:02:42.574' AND status != 'pending'
	

2025/06/23 22:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.229ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:02:42.634' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.502ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:02:42.695'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:03:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.693ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:03:41.645'

2025/06/23 22:03:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.441ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:48:41.644' LIMIT 50

2025/06/23 22:03:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.778ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:03:41.645'

2025/06/23 22:03:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.079ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:03:41.645'

2025/06/23 22:03:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.577ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:48:41.914' LIMIT 50

2025/06/23 22:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.935ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:33:42.014'

2025/06/23 22:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.430ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:03:42.073' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.457ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.572ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.625ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:03:42.194' AND status != 'pending'
	

2025/06/23 22:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.061ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:03:42.255' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.723ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:03:42.315'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.153ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:33:42.392'

2025/06/23 22:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.326ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:03:42.452' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.832ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.293ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.094ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:03:42.57' AND status != 'pending'
	

2025/06/23 22:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.796ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:03:42.629' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:03:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.597ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:03:42.688'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:04:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.792ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:04:41.645'

2025/06/23 22:04:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.294ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:04:41.645'

2025/06/23 22:04:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.013ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:04:41.645'

2025/06/23 22:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.225ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:34:42.014'

2025/06/23 22:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.658ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:04:42.073' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.324ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.858ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.564ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:04:42.193' AND status != 'pending'
	

2025/06/23 22:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.722ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:04:42.252' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.866ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:04:42.313'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.210ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:34:42.391'

2025/06/23 22:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.099ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:04:42.452' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.270ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.917ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.973ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:04:42.572' AND status != 'pending'
	

2025/06/23 22:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.970ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:04:42.633' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:04:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.392ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:04:42.693'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:05:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.837ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:50:41.644' LIMIT 50

2025/06/23 22:05:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.375ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:05:41.644'

2025/06/23 22:05:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.887ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:05:41.644'

2025/06/23 22:05:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.864ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:05:41.644'

2025/06/23 22:05:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.277ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:50:41.913' LIMIT 50

2025/06/23 22:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.521ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:35:42.012'

2025/06/23 22:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.184ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:05:42.079' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.068ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.799ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.622ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:05:42.212' AND status != 'pending'
	

2025/06/23 22:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.288ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:05:42.279' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.869ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:05:42.346'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.460ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:35:42.392'

2025/06/23 22:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.720ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:05:42.451' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.997ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.835ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.728ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:05:42.571' AND status != 'pending'
	

2025/06/23 22:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.288ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:05:42.633' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:05:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.175ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:05:42.694'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:06:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.645ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:06:41.644'

2025/06/23 22:06:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.497ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:06:41.644'

2025/06/23 22:06:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.124ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:06:41.644'

2025/06/23 22:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.360ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:36:42.013'

2025/06/23 22:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.121ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:06:42.074' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.607ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.342ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.546ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:06:42.194' AND status != 'pending'
	

2025/06/23 22:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.218ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:06:42.254' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.953ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:06:42.313'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.219ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:36:42.39'

2025/06/23 22:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.446ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:06:42.449' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.005ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.526ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.737ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:06:42.569' AND status != 'pending'
	

2025/06/23 22:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.918ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:06:42.63' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:06:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.413ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:06:42.69'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:07:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.849ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:07:41.643'

2025/06/23 22:07:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.621ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:52:41.643' LIMIT 50

2025/06/23 22:07:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.489ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:07:41.643'

2025/06/23 22:07:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.145ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:07:41.643'

2025/06/23 22:07:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.446ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:52:41.912' LIMIT 50

2025/06/23 22:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.382ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:37:42.013'

2025/06/23 22:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.545ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:07:42.071' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.715ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.390ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.415ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:07:42.19' AND status != 'pending'
	

2025/06/23 22:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.632ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:07:42.251' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.795ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:07:42.309'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.615ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:37:42.391'

2025/06/23 22:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.000ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:07:42.451' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.644ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.354ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.251ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:07:42.57' AND status != 'pending'
	

2025/06/23 22:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.090ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:07:42.628' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:07:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.456ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:07:42.687'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:08:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.323ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:08:41.643'

2025/06/23 22:08:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.283ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:08:41.643'

2025/06/23 22:08:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.581ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:08:41.643'

2025/06/23 22:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.422ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:38:42.012'

2025/06/23 22:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.438ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:08:42.074' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.208ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.792ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.856ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:08:42.199' AND status != 'pending'
	

2025/06/23 22:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.815ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:08:42.259' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.931ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:08:42.319'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.989ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:38:42.39'

2025/06/23 22:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.089ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:08:42.451' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.198ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.974ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.105ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:08:42.57' AND status != 'pending'
	

2025/06/23 22:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.955ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:08:42.63' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:08:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.139ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:08:42.69'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:09:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.693ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:09:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.599ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:09:41.643'

2025/06/23 22:09:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[68.762ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:54:41.642' LIMIT 50

2025/06/23 22:09:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.711ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:09:41.643'

2025/06/23 22:09:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.174ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:09:41.643'

2025/06/23 22:09:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[194.499ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:09:41.644' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/23 22:09:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[38.360ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-16 22:09:41.838'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/23 22:09:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[62.208ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:09:41.912' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/23 22:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[30.998ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-16 22:09:41.974'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/23 22:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.056ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:39:42.012'

2025/06/23 22:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[195.274ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:54:41.912' LIMIT 50

2025/06/23 22:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.762ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:09:42.074' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.748ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.579ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.822ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:09:42.198' AND status != 'pending'
	

2025/06/23 22:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[70.365ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:09:42.259' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.963ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:09:42.33'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.153ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:39:42.389'

2025/06/23 22:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.523ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:09:42.452' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.841ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.286ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.980ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:09:42.58' AND status != 'pending'
	

2025/06/23 22:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.054ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:09:42.644' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.566ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:09:42.706'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:10:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.649ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:10:41.642'

2025/06/23 22:10:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.517ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:10:41.642'

2025/06/23 22:10:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.002ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:10:41.642'

2025/06/23 22:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.220ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:40:42.011'

2025/06/23 22:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.225ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:10:42.076' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.070ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.356ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.413ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:10:42.201' AND status != 'pending'
	

2025/06/23 22:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.126ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:10:42.264' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.570ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:10:42.327'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.467ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:40:42.39'

2025/06/23 22:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.562ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:10:42.452' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.890ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.851ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.885ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:10:42.577' AND status != 'pending'
	

2025/06/23 22:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.095ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:10:42.639' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:10:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.832ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:10:42.701'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:11:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.925ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:56:41.642' LIMIT 50

2025/06/23 22:11:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.796ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:11:41.642'

2025/06/23 22:11:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.203ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:11:41.642'

2025/06/23 22:11:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.062ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:11:41.642'

2025/06/23 22:11:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.980ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:56:41.911' LIMIT 50

2025/06/23 22:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.934ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:41:42.011'

2025/06/23 22:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.330ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:11:42.073' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.542ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.277ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.800ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:11:42.198' AND status != 'pending'
	

2025/06/23 22:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.084ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:11:42.261' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.341ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:11:42.325'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.927ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:41:42.389'

2025/06/23 22:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.120ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:11:42.452' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.568ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.137ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.897ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:11:42.579' AND status != 'pending'
	

2025/06/23 22:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.018ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:11:42.639' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:11:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.807ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:11:42.702'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:12:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.900ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:12:41.642'

2025/06/23 22:12:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.508ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:12:41.642'

2025/06/23 22:12:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.100ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:12:41.642'

2025/06/23 22:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.205ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:42:42.012'

2025/06/23 22:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.742ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:12:42.076' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.316ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.286ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.761ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:12:42.201' AND status != 'pending'
	

2025/06/23 22:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.034ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:12:42.264' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.466ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:12:42.327'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.591ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:42:42.388'

2025/06/23 22:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.562ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:12:42.45' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.607ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.310ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.016ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:12:42.573' AND status != 'pending'
	

2025/06/23 22:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.828ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:12:42.635' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:12:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.467ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:12:42.697'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:13:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.082ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:58:41.641' LIMIT 50

2025/06/23 22:13:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.501ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:13:41.641'

2025/06/23 22:13:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.726ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:13:41.641'

2025/06/23 22:13:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.583ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:13:41.641'

2025/06/23 22:13:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.342ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:58:41.91' LIMIT 50

2025/06/23 22:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.608ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:43:42.01'

2025/06/23 22:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.461ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:13:42.072' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.044ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.878ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.415ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:13:42.202' AND status != 'pending'
	

2025/06/23 22:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.793ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:13:42.264' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.536ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:13:42.328'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.679ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:43:42.389'

2025/06/23 22:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.973ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:13:42.45' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.288ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.634ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.323ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:13:42.574' AND status != 'pending'
	

2025/06/23 22:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.740ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:13:42.634' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.605ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:13:42.696'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:14:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.142ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:14:41.641'

2025/06/23 22:14:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.675ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:14:41.641'

2025/06/23 22:14:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.921ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:14:41.641'

2025/06/23 22:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.928ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:44:42.01'

2025/06/23 22:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.644ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:14:42.072' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.292ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.427ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.959ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:14:42.195' AND status != 'pending'
	

2025/06/23 22:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.744ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:14:42.256' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.032ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:14:42.317'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.516ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:44:42.388'

2025/06/23 22:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.719ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:14:42.449' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.241ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.599ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.592ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:14:42.573' AND status != 'pending'
	

2025/06/23 22:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.528ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:14:42.634' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:14:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.137ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:14:42.694'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:15:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.964ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:00:41.64' LIMIT 50

2025/06/23 22:15:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.101ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:15:41.641'

2025/06/23 22:15:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.069ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:15:41.641'

2025/06/23 22:15:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.861ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:15:41.641'

2025/06/23 22:15:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.275ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:00:41.909' LIMIT 50

2025/06/23 22:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.428ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:45:42.01'

2025/06/23 22:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.913ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:15:42.072' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.139ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.098ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.369ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:15:42.197' AND status != 'pending'
	

2025/06/23 22:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.659ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:15:42.26' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.011ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:15:42.322'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.554ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:45:42.387'

2025/06/23 22:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.982ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:15:42.45' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.338ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.048ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.534ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:15:42.576' AND status != 'pending'
	

2025/06/23 22:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.094ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:15:42.639' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:15:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.946ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:15:42.701'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:16:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.782ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:16:41.64'

2025/06/23 22:16:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.700ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:16:41.64'

2025/06/23 22:16:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.362ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:16:41.64'

2025/06/23 22:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.335ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:46:42.009'

2025/06/23 22:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.493ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:16:42.074' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.977ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.028ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.434ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:16:42.201' AND status != 'pending'
	

2025/06/23 22:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.031ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:16:42.263' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.084ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:16:42.329'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.923ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:46:42.387'

2025/06/23 22:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.291ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:16:42.452' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.537ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.193ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.076ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:16:42.573' AND status != 'pending'
	

2025/06/23 22:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.259ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:16:42.635' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:16:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.687ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:16:42.697'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:17:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.818ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:02:41.64' LIMIT 50

2025/06/23 22:17:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.340ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:17:41.64'

2025/06/23 22:17:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.872ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:17:41.64'

2025/06/23 22:17:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.153ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:17:41.64'

2025/06/23 22:17:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.032ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:02:41.909' LIMIT 50

2025/06/23 22:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.704ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:47:42.009'

2025/06/23 22:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.074ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:17:42.071' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.689ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.424ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.804ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:17:42.197' AND status != 'pending'
	

2025/06/23 22:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.284ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:17:42.26' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.002ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:17:42.324'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.536ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:47:42.387'

2025/06/23 22:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.581ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:17:42.45' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.353ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.124ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.144ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:17:42.576' AND status != 'pending'
	

2025/06/23 22:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.008ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:17:42.639' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:17:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.362ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:17:42.703'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:18:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.818ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:18:41.639'

2025/06/23 22:18:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.546ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:18:41.639'

2025/06/23 22:18:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.199ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:18:41.639'

2025/06/23 22:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.599ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:48:42.008'

2025/06/23 22:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.629ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:18:42.071' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[35.142ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.068ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.129ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:18:42.201' AND status != 'pending'
	

2025/06/23 22:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.031ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:18:42.263' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.833ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:18:42.326'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.030ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:48:42.386'

2025/06/23 22:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.009ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:18:42.447' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.247ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.269ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.533ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:18:42.569' AND status != 'pending'
	

2025/06/23 22:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.797ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:18:42.631' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:18:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.887ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:18:42.692'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:19:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.974ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:19:41.639'

2025/06/23 22:19:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.861ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:04:41.639' LIMIT 50

2025/06/23 22:19:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.524ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:19:41.639'

2025/06/23 22:19:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.239ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:19:41.639'

2025/06/23 22:19:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.588ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:04:41.908' LIMIT 50

2025/06/23 22:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.591ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:49:42.008'

2025/06/23 22:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.620ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:19:42.071' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.790ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.795ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.766ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:19:42.195' AND status != 'pending'
	

2025/06/23 22:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.829ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:19:42.257' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.891ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:19:42.32'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.693ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:49:42.386'

2025/06/23 22:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.418ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:19:42.448' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.608ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.433ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.866ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:19:42.57' AND status != 'pending'
	

2025/06/23 22:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.833ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:19:42.632' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:19:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.305ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:19:42.694'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:20:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.999ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:20:41.639'

2025/06/23 22:20:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.330ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:20:41.639'

2025/06/23 22:20:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.827ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:20:41.639'

2025/06/23 22:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.651ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:50:42.008'

2025/06/23 22:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.558ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:20:42.071' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.885ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.650ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.542ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:20:42.195' AND status != 'pending'
	

2025/06/23 22:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.549ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:20:42.256' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.595ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:20:42.318'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.268ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:50:42.385'

2025/06/23 22:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.959ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:20:42.445' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.829ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.040ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.717ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:20:42.57' AND status != 'pending'
	

2025/06/23 22:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.244ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:20:42.632' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:20:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.406ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:20:42.693'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:21:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.547ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:06:41.638' LIMIT 50

2025/06/23 22:21:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.624ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:21:41.638'

2025/06/23 22:21:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.888ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:21:41.638'

2025/06/23 22:21:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.664ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:21:41.638'

2025/06/23 22:21:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.955ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:06:41.907' LIMIT 50

2025/06/23 22:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.307ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:51:42.007'

2025/06/23 22:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.285ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:21:42.07' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.184ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.832ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.918ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:21:42.195' AND status != 'pending'
	

2025/06/23 22:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.004ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:21:42.257' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.402ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:21:42.319'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.353ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:51:42.385'

2025/06/23 22:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.851ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:21:42.447' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.610ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.902ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.429ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:21:42.573' AND status != 'pending'
	

2025/06/23 22:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.825ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:21:42.636' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:21:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.258ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:21:42.699'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:22:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.308ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:22:41.638'

2025/06/23 22:22:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.251ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:22:41.638'

2025/06/23 22:22:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.351ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:22:41.638'

2025/06/23 22:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.569ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:52:42.007'

2025/06/23 22:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.383ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:22:42.073' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.893ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.062ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.751ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:22:42.198' AND status != 'pending'
	

2025/06/23 22:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.704ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:22:42.261' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.865ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:22:42.325'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.170ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:52:42.385'

2025/06/23 22:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.186ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:22:42.447' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.287ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.334ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.260ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:22:42.57' AND status != 'pending'
	

2025/06/23 22:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.856ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:22:42.631' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:22:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.635ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:22:42.692'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:23:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.643ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:08:41.637' LIMIT 50

2025/06/23 22:23:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.606ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:23:41.638'

2025/06/23 22:23:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.465ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:23:41.638'

2025/06/23 22:23:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.642ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:23:41.638'

2025/06/23 22:23:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.046ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:08:41.906' LIMIT 50

2025/06/23 22:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.337ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:53:42.007'

2025/06/23 22:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.140ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:23:42.07' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.392ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.995ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.463ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:23:42.196' AND status != 'pending'
	

2025/06/23 22:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.902ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:23:42.261' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.836ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:23:42.324'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.097ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:53:42.385'

2025/06/23 22:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.196ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:23:42.447' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.526ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.266ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.738ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:23:42.57' AND status != 'pending'
	

2025/06/23 22:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.284ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:23:42.631' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:23:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.327ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:23:42.692'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:24:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.429ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:24:41.637'

2025/06/23 22:24:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.797ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:24:41.637'

2025/06/23 22:24:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.185ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:24:41.637'

2025/06/23 22:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.245ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:54:42.006'

2025/06/23 22:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.168ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:24:42.069' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.046ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.128ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.045ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:24:42.195' AND status != 'pending'
	

2025/06/23 22:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.786ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:24:42.261' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[71.580ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:24:42.325'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.227ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:54:42.384'

2025/06/23 22:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.731ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:24:42.447' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.662ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.526ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.619ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:24:42.578' AND status != 'pending'
	

2025/06/23 22:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.328ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:24:42.641' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.863ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:24:42.703'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:25:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.529ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:25:41.637'

2025/06/23 22:25:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.448ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:10:41.636' LIMIT 50

2025/06/23 22:25:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.782ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:25:41.637'

2025/06/23 22:25:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.565ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:25:41.637'

2025/06/23 22:25:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.224ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:10:41.906' LIMIT 50

2025/06/23 22:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.587ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:55:42.006'

2025/06/23 22:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.189ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:25:42.069' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.439ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.691ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.334ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:25:42.193' AND status != 'pending'
	

2025/06/23 22:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.277ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:25:42.256' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.746ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:25:42.318'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.995ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:55:42.384'

2025/06/23 22:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.915ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:25:42.445' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.648ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.794ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.071ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:25:42.569' AND status != 'pending'
	

2025/06/23 22:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.494ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:25:42.63' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:25:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.027ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:25:42.692'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:26:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.131ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:26:41.636'

2025/06/23 22:26:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.219ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:26:41.636'

2025/06/23 22:26:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.503ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:26:41.636'

2025/06/23 22:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.797ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:56:42.006'

2025/06/23 22:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.824ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:26:42.067' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.570ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.478ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.754ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:26:42.19' AND status != 'pending'
	

2025/06/23 22:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.996ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:26:42.251' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.849ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:26:42.312'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.693ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:56:42.384'

2025/06/23 22:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.823ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:26:42.445' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.437ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.981ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.899ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:26:42.566' AND status != 'pending'
	

2025/06/23 22:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.696ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:26:42.627' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:26:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.824ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:26:42.688'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:27:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.891ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:27:41.636'

2025/06/23 22:27:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.562ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:12:41.636' LIMIT 50

2025/06/23 22:27:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.945ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:27:41.636'

2025/06/23 22:27:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.673ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:27:41.636'

2025/06/23 22:27:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.004ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:12:41.904' LIMIT 50

2025/06/23 22:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.184ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:57:42.004'

2025/06/23 22:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.658ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:27:42.067' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.530ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.735ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.138ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:27:42.19' AND status != 'pending'
	

2025/06/23 22:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.749ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:27:42.251' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.701ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:27:42.313'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.503ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:57:42.383'

2025/06/23 22:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.827ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:27:42.444' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.642ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.272ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.503ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:27:42.572' AND status != 'pending'
	

2025/06/23 22:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.470ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:27:42.634' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:27:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.498ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:27:42.695'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.740ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:28:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.604ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:28:41.637'

2025/06/23 22:28:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.950ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:28:41.637'

2025/06/23 22:28:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.966ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:28:41.637'

2025/06/23 22:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.853ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:58:42.005'

2025/06/23 22:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.041ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:28:42.07' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.590ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.402ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.961ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:28:42.194' AND status != 'pending'
	

2025/06/23 22:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.683ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:28:42.256' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.608ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:28:42.319'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.963ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:58:42.382'

2025/06/23 22:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.597ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:28:42.442' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.644ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.933ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.694ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:28:42.565' AND status != 'pending'
	

2025/06/23 22:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.695ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:28:42.626' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:28:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.627ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:28:42.687'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:29:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[68.211ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:29:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.835ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:29:41.636'

2025/06/23 22:29:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[68.999ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:14:41.635' LIMIT 50

2025/06/23 22:29:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[85.050ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:29:41.636'

2025/06/23 22:29:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.097ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:29:41.636'

2025/06/23 22:29:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.740ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:14:41.904' LIMIT 50

2025/06/23 22:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.996ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:59:42.005'

2025/06/23 22:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.195ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:29:42.068' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.859ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.202ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.980ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:29:42.193' AND status != 'pending'
	

2025/06/23 22:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.295ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:29:42.254' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.842ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:29:42.316'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.506ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 21:59:42.382'

2025/06/23 22:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.329ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:29:42.446' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.458ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.783ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.408ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:29:42.569' AND status != 'pending'
	

2025/06/23 22:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.283ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:29:42.63' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:29:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.558ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:29:42.691'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:30:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.423ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:30:41.635'

2025/06/23 22:30:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.068ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:30:41.635'

2025/06/23 22:30:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.801ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:30:41.635'

2025/06/23 22:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.288ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:00:42.004'

2025/06/23 22:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.717ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:30:42.069' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.981ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.744ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.420ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:30:42.194' AND status != 'pending'
	

2025/06/23 22:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.417ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:30:42.256' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.695ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:30:42.318'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.504ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:00:42.382'

2025/06/23 22:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.152ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:30:42.444' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.566ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.873ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.501ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:30:42.567' AND status != 'pending'
	

2025/06/23 22:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.312ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:30:42.629' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:30:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.407ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:30:42.689'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:31:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.462ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:31:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.956ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:31:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.584ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:16:41.634' LIMIT 50

2025/06/23 22:31:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.170ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:31:41.636'

2025/06/23 22:31:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.837ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:31:41.636'

2025/06/23 22:31:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.279ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:31:41.636'

2025/06/23 22:31:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.135ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:16:41.903' LIMIT 50

2025/06/23 22:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.856ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:01:42.004'

2025/06/23 22:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.686ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:31:42.067' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.645ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.280ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.197ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:31:42.193' AND status != 'pending'
	

2025/06/23 22:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.378ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:31:42.256' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.272ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:31:42.32'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.229ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:01:42.381'

2025/06/23 22:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.507ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:31:42.442' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.544ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.335ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.693ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:31:42.565' AND status != 'pending'
	

2025/06/23 22:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.428ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:31:42.626' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:31:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.101ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:31:42.688'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:32:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.901ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:32:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.241ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:32:41.635'

2025/06/23 22:32:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.579ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:32:41.635'

2025/06/23 22:32:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.822ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:32:41.635'

2025/06/23 22:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.217ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:02:42.004'

2025/06/23 22:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.290ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:32:42.066' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.239ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.487ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.325ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:32:42.19' AND status != 'pending'
	

2025/06/23 22:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.362ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:32:42.251' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.722ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:32:42.313'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.840ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:02:42.381'

2025/06/23 22:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.589ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:32:42.443' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.266ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.040ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.784ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:32:42.567' AND status != 'pending'
	

2025/06/23 22:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.728ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:32:42.628' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.942ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:32:42.689'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:33:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[66.888ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:33:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.655ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:18:41.633' LIMIT 50

2025/06/23 22:33:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.890ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:33:41.634'

2025/06/23 22:33:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.914ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:33:41.634'

2025/06/23 22:33:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.819ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:33:41.634'

2025/06/23 22:33:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.599ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:18:41.903' LIMIT 50

2025/06/23 22:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.184ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:03:42.003'

2025/06/23 22:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.841ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:33:42.065' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.297ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.186ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.470ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:33:42.192' AND status != 'pending'
	

2025/06/23 22:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.765ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:33:42.255' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.903ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:33:42.318'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.147ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:03:42.381'

2025/06/23 22:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.214ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:33:42.441' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.608ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.235ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.716ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:33:42.564' AND status != 'pending'
	

2025/06/23 22:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.322ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:33:42.625' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.220ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:33:42.686'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:34:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.537ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:34:41.634'

2025/06/23 22:34:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.404ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:34:41.634'

2025/06/23 22:34:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.867ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:34:41.634'

2025/06/23 22:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.093ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:04:42.003'

2025/06/23 22:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[77.852ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:34:42.068' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.041ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.436ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.266ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:34:42.214' AND status != 'pending'
	

2025/06/23 22:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.696ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:34:42.275' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.897ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:34:42.337'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.482ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:04:42.38'

2025/06/23 22:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.973ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:34:42.443' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.870ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.269ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.216ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:34:42.568' AND status != 'pending'
	

2025/06/23 22:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.721ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:34:42.632' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:34:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.452ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:34:42.695'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:35:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.321ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:35:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.063ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:35:41.633'

2025/06/23 22:35:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.077ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:20:41.633' LIMIT 50

2025/06/23 22:35:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.343ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:35:41.633'

2025/06/23 22:35:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.477ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:35:41.633'

2025/06/23 22:35:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.167ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:20:41.902' LIMIT 50

2025/06/23 22:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.548ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:05:42.003'

2025/06/23 22:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.966ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:35:42.064' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.609ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.843ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.728ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:35:42.189' AND status != 'pending'
	

2025/06/23 22:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.896ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:35:42.25' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.605ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:35:42.311'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.611ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:05:42.38'

2025/06/23 22:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.920ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:35:42.441' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.117ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.623ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.286ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:35:42.564' AND status != 'pending'
	

2025/06/23 22:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.443ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:35:42.626' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:35:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.430ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:35:42.687'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:36:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.680ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:36:41.633'

2025/06/23 22:36:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.407ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:36:41.633'

2025/06/23 22:36:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.349ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:36:41.633'

2025/06/23 22:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.480ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:06:42.002'

2025/06/23 22:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.661ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:36:42.065' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.064ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.055ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.578ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:36:42.188' AND status != 'pending'
	

2025/06/23 22:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.056ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:36:42.249' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.166ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:36:42.312'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.763ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:06:42.38'

2025/06/23 22:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.814ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:36:42.442' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.504ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.306ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.286ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:36:42.564' AND status != 'pending'
	

2025/06/23 22:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.780ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:36:42.626' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.879ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:36:42.687'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:37:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.684ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:22:41.632' LIMIT 50

2025/06/23 22:37:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.641ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:37:41.632'

2025/06/23 22:37:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.129ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:37:41.632'

2025/06/23 22:37:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.547ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:37:41.632'

2025/06/23 22:37:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.647ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:22:41.901' LIMIT 50

2025/06/23 22:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.988ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:07:42.002'

2025/06/23 22:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.463ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:37:42.065' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.385ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.921ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.107ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:37:42.19' AND status != 'pending'
	

2025/06/23 22:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.811ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:37:42.254' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.769ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:37:42.317'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.167ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:07:42.38'

2025/06/23 22:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.804ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:37:42.44' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.659ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.268ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.157ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:37:42.565' AND status != 'pending'
	

2025/06/23 22:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.730ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:37:42.625' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:37:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.486ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:37:42.686'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:37:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.619ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:38:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.644ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:38:41.632'

2025/06/23 22:38:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.647ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:38:41.632'

2025/06/23 22:38:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.736ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:38:41.632'

2025/06/23 22:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.283ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:08:42.001'

2025/06/23 22:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.737ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:38:42.063' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.373ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.333ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.222ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:38:42.186' AND status != 'pending'
	

2025/06/23 22:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.945ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:38:42.247' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.810ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:38:42.31'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.056ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:08:42.379'

2025/06/23 22:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.088ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:38:42.441' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.859ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.192ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.967ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:38:42.563' AND status != 'pending'
	

2025/06/23 22:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.418ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:38:42.624' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.796ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:38:42.686'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:39:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.731ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:24:41.631' LIMIT 50

2025/06/23 22:39:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.195ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:39:41.632'

2025/06/23 22:39:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.779ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:39:41.632'

2025/06/23 22:39:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.861ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:39:41.632'

2025/06/23 22:39:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.248ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:24:41.9' LIMIT 50

2025/06/23 22:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.863ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:09:42.001'

2025/06/23 22:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.809ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:39:42.064' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.288ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.076ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.153ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:39:42.19' AND status != 'pending'
	

2025/06/23 22:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.654ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:39:42.253' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.315ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:39:42.316'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.773ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:09:42.38'

2025/06/23 22:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.154ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:39:42.443' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.427ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.255ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.898ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:39:42.568' AND status != 'pending'
	

2025/06/23 22:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.781ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:39:42.631' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.584ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:39:42.694'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:40:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[66.692ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:40:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.289ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:40:41.631'

2025/06/23 22:40:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.328ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:40:41.631'

2025/06/23 22:40:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.230ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:40:41.631'

2025/06/23 22:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.696ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:10:42'

2025/06/23 22:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.325ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:40:42.066' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.381ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.873ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.477ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:40:42.195' AND status != 'pending'
	

2025/06/23 22:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.556ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:40:42.258' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.907ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:40:42.32'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.051ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:10:42.379'

2025/06/23 22:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.271ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:40:42.443' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.664ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.761ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.984ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:40:42.578' AND status != 'pending'
	

2025/06/23 22:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.911ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:40:42.641' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:40:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.267ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:40:42.703'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:41:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.208ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:41:41.631'

2025/06/23 22:41:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.245ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:26:41.631' LIMIT 50

2025/06/23 22:41:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.719ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:41:41.631'

2025/06/23 22:41:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.879ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:41:41.631'

2025/06/23 22:41:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.235ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:26:41.9' LIMIT 50

2025/06/23 22:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.361ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:11:42'

2025/06/23 22:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.610ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:41:42.064' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.096ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.419ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.851ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:41:42.19' AND status != 'pending'
	

2025/06/23 22:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.771ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:41:42.253' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.375ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:41:42.316'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.824ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:11:42.378'

2025/06/23 22:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.549ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:41:42.442' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.436ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.361ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.124ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:41:42.568' AND status != 'pending'
	

2025/06/23 22:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.938ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:41:42.63' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:41:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.313ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:41:42.693'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:42:01 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.021ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:42:02 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[67.084ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:42:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.029ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:42:41.642'

2025/06/23 22:42:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.305ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:42:41.642'

2025/06/23 22:42:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.967ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:42:41.642'

2025/06/23 22:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.975ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:12:42.011'

2025/06/23 22:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.525ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:42:42.075' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.200ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.414ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.931ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:42:42.201' AND status != 'pending'
	

2025/06/23 22:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.789ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:42:42.264' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.951ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:42:42.327'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.370ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:12:42.39'

2025/06/23 22:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.362ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:42:42.453' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.321ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.459ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.129ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:42:42.58' AND status != 'pending'
	

2025/06/23 22:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.649ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:42:42.643' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:42:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.341ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:42:42.705'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:43:03 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[66.528ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:43:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.846ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:43:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[66.620ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:43:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.520ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:28:41.66' LIMIT 50

2025/06/23 22:43:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.941ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:43:41.66'

2025/06/23 22:43:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[67.521ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:43:41.66'

2025/06/23 22:43:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.634ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:43:41.66'

2025/06/23 22:43:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.343ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:28:41.929' LIMIT 50

2025/06/23 22:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.293ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:13:42.029'

2025/06/23 22:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.923ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:43:42.091' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.231ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.630ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.314ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:43:42.219' AND status != 'pending'
	

2025/06/23 22:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.841ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:43:42.282' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.773ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:43:42.344'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.516ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:13:42.408'

2025/06/23 22:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.937ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:43:42.47' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.472ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.239ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.949ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:43:42.597' AND status != 'pending'
	

2025/06/23 22:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.806ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:43:42.66' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:43:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.756ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:43:42.723'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:43:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[71.396ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/23 22:44:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[72.005ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:44:41.661'

2025/06/23 22:44:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.051ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:44:41.661'

2025/06/23 22:44:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.768ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:44:41.661'

2025/06/23 22:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.148ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:14:42.03'

2025/06/23 22:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.007ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:44:42.093' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.059ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.218ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.142ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:44:42.219' AND status != 'pending'
	

2025/06/23 22:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.546ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:44:42.283' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.914ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:44:42.347'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.568ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:14:42.408'

2025/06/23 22:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.063ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:44:42.471' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.614ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.591ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.104ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:44:42.598' AND status != 'pending'
	

2025/06/23 22:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.011ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:44:42.66' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:44:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.549ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:44:42.721'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:45:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.886ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:30:41.66' LIMIT 50

2025/06/23 22:45:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.450ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:45:41.661'

2025/06/23 22:45:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.293ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:45:41.661'

2025/06/23 22:45:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.291ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:45:41.661'

2025/06/23 22:45:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.633ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:30:41.929' LIMIT 50

2025/06/23 22:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.256ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:15:42.029'

2025/06/23 22:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.701ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:45:42.093' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.274ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.190ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.978ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:45:42.222' AND status != 'pending'
	

2025/06/23 22:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.728ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:45:42.285' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.846ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:45:42.348'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.022ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:15:42.408'

2025/06/23 22:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.654ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:45:42.471' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.544ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.800ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.850ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:45:42.595' AND status != 'pending'
	

2025/06/23 22:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.975ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:45:42.657' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:45:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.549ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:45:42.719'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:46:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.881ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:46:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.235ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.100ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:46:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.895ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:46:41.662'

2025/06/23 22:46:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.084ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:46:41.662'

2025/06/23 22:46:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.945ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:46:41.662'

2025/06/23 22:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.821ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:16:42.03'

2025/06/23 22:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.571ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:46:42.092' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.840ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.734ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.275ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:46:42.218' AND status != 'pending'
	

2025/06/23 22:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.468ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:46:42.28' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.367ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:46:42.342'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.719ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:16:42.407'

2025/06/23 22:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.925ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:46:42.47' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.901ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.111ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.539ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:46:42.596' AND status != 'pending'
	

2025/06/23 22:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.565ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:46:42.659' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:46:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.296ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:46:42.721'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:47:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.304ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:32:41.66' LIMIT 50

2025/06/23 22:47:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.004ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:47:41.661'

2025/06/23 22:47:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.064ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:47:41.661'

2025/06/23 22:47:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.643ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:47:41.661'

2025/06/23 22:47:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.386ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:32:41.93' LIMIT 50

2025/06/23 22:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.143ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:17:42.03'

2025/06/23 22:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.270ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:47:42.093' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.821ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.679ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.700ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:47:42.224' AND status != 'pending'
	

2025/06/23 22:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.084ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:47:42.286' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.976ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:47:42.348'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.234ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:17:42.408'

2025/06/23 22:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.758ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:47:42.469' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.047ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.666ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.419ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:47:42.595' AND status != 'pending'
	

2025/06/23 22:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.368ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:47:42.657' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:47:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.241ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:47:42.719'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:47:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[71.965ms] [rows:0] SELECT * FROM `app_user` WHERE phone = '16620436582' ORDER BY `app_user`.`id` LIMIT 1

2025/06/23 22:48:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[61.844ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/23 22:48:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[65.193ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/23 22:48:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.501ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:48:41.661'

2025/06/23 22:48:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.306ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:48:41.661'

2025/06/23 22:48:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.101ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:48:41.661'

2025/06/23 22:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.347ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:18:42.03'

2025/06/23 22:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.110ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:48:42.09' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.430ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.426ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.971ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:48:42.212' AND status != 'pending'
	

2025/06/23 22:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.150ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:48:42.273' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.142ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:48:42.336'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.466ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:18:42.408'

2025/06/23 22:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.037ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:48:42.469' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.277ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.753ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.134ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:48:42.592' AND status != 'pending'
	

2025/06/23 22:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.850ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:48:42.652' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:48:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.086ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:48:42.712'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:49:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.966ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:49:41.661'

2025/06/23 22:49:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.758ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:34:41.661' LIMIT 50

2025/06/23 22:49:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.666ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:49:41.661'

2025/06/23 22:49:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.717ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:49:41.661'

2025/06/23 22:49:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.438ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:34:41.93' LIMIT 50

2025/06/23 22:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.821ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:19:42.03'

2025/06/23 22:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.151ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:49:42.092' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.165ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.936ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.414ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:49:42.217' AND status != 'pending'
	

2025/06/23 22:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.177ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:49:42.278' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.619ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:49:42.339'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.428ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:19:42.408'

2025/06/23 22:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.860ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:49:42.468' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.616ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.418ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.598ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:49:42.591' AND status != 'pending'
	

2025/06/23 22:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.982ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:49:42.653' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:49:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.028ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:49:42.717'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:50:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[72.582ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:50:41.661'

2025/06/23 22:50:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[69.501ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:50:41.661'

2025/06/23 22:50:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.746ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:50:41.661'

2025/06/23 22:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.562ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:20:42.03'

2025/06/23 22:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.707ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:50:42.093' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.872ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.108ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.046ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:50:42.215' AND status != 'pending'
	

2025/06/23 22:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.230ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:50:42.277' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.103ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:50:42.339'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.663ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:20:42.408'

2025/06/23 22:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.965ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:50:42.47' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.674ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.339ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.832ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:50:42.595' AND status != 'pending'
	

2025/06/23 22:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.255ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:50:42.655' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:50:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.571ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:50:42.718'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:51:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.249ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:51:41.661'

2025/06/23 22:51:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.024ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:36:41.661' LIMIT 50

2025/06/23 22:51:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.707ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:51:41.661'

2025/06/23 22:51:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.470ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:51:41.661'

2025/06/23 22:51:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.547ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:36:41.93' LIMIT 50

2025/06/23 22:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.447ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:21:42.03'

2025/06/23 22:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.962ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:51:42.092' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.282ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.031ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.732ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:51:42.215' AND status != 'pending'
	

2025/06/23 22:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.857ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:51:42.276' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.455ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:51:42.337'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.696ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:21:42.408'

2025/06/23 22:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.757ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:51:42.47' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.210ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.431ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.775ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:51:42.592' AND status != 'pending'
	

2025/06/23 22:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.453ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:51:42.653' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:51:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.125ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:51:42.714'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:52:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.595ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:52:41.661'

2025/06/23 22:52:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.204ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:52:41.661'

2025/06/23 22:52:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.528ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:52:41.661'

2025/06/23 22:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.671ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:22:42.03'

2025/06/23 22:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.871ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:52:42.093' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.572ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.994ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.603ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:52:42.218' AND status != 'pending'
	

2025/06/23 22:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.420ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:52:42.28' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.100ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:52:42.342'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.572ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:22:42.408'

2025/06/23 22:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.709ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:52:42.468' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.396ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.459ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.531ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:52:42.59' AND status != 'pending'
	

2025/06/23 22:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.813ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:52:42.651' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:52:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.106ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:52:42.712'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:53:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.893ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/23 22:53:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.147ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-23 22:53:41.661'

2025/06/23 22:53:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[69.393ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:38:41.661' LIMIT 50

2025/06/23 22:53:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.854ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-23 22:53:41.661'

2025/06/23 22:53:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.085ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-22 22:53:41.661'

2025/06/23 22:53:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[189.719ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/23 22:53:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.400ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:38:41.93' LIMIT 50

2025/06/23 22:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.237ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:23:42.03'

2025/06/23 22:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.446ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:53:42.092' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.815ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.323ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.982ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:53:42.214' AND status != 'pending'
	

2025/06/23 22:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.808ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:53:42.277' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.700ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:53:42.338'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.121ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-23 22:23:42.408'

2025/06/23 22:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.754ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-23 21:53:42.47' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/23 22:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.729ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/23 22:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.881ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/23 22:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.164ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-23 21:53:42.594' AND status != 'pending'
	

2025/06/23 22:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.547ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 21:53:42.655' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/23 22:53:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.591ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-23 21:53:42.716'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/23 22:54:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.621ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC
