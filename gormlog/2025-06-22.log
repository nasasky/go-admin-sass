
2025/06/22 22:07:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.488ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:37:06.797'

2025/06/22 22:07:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.752ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:07:06.856' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:07:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.679ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:07:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.899ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[191.083ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:37:06.831'

2025/06/22 22:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.935ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:07:06.979' AND status != 'pending'
	

2025/06/22 22:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.545ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:07:07.022' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.988ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:07:07.04' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.407ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.291ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.784ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:07:07.1'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.779ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:07:07.149' AND status != 'pending'
	

2025/06/22 22:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.342ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:07:07.21' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.895ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:07:07.274'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:08:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[72.256ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:08:06.796'

2025/06/22 22:08:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.245ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:08:06.796'

2025/06/22 22:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.504ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:08:06.796'

2025/06/22 22:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.470ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:38:07.161'

2025/06/22 22:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.549ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:08:07.226' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.428ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.496ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.188ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:38:07.338'

2025/06/22 22:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.675ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:08:07.352' AND status != 'pending'
	

2025/06/22 22:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.147ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:08:07.398' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.827ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:08:07.415' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.201ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.381ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.372ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:08:07.478'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.789ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:08:07.517' AND status != 'pending'
	

2025/06/22 22:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.841ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:08:07.577' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.041ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:08:07.64'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:09:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.573ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:09:06.795'

2025/06/22 22:09:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.503ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:54:06.796' LIMIT 50

2025/06/22 22:09:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.093ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:09:06.795'

2025/06/22 22:09:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.903ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:09:06.795'

2025/06/22 22:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[183.408ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:54:06.831' LIMIT 50

2025/06/22 22:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.968ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:39:07.16'

2025/06/22 22:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.085ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:09:07.222' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.914ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.877ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.538ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:39:07.338'

2025/06/22 22:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.679ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:09:07.342' AND status != 'pending'
	

2025/06/22 22:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.744ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:09:07.398' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.008ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:09:07.402' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.141ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.815ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.781ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:09:07.462'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.603ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:09:07.521' AND status != 'pending'
	

2025/06/22 22:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.715ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:09:07.581' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.967ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:09:07.642'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:10:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.226ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:10:06.795'

2025/06/22 22:10:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.983ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:10:06.795'

2025/06/22 22:10:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.851ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:10:06.795'

2025/06/22 22:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.299ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:40:07.159'

2025/06/22 22:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.956ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:10:07.22' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.927ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.429ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.282ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:40:07.337'

2025/06/22 22:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.427ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:10:07.34' AND status != 'pending'
	

2025/06/22 22:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.931ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:10:07.399' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.793ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:10:07.399' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.872ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.392ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:10:07.46'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.326ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.817ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:10:07.522' AND status != 'pending'
	

2025/06/22 22:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.734ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:10:07.587' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.152ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:10:07.648'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:11:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.785ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:56:06.795' LIMIT 50

2025/06/22 22:11:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.417ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:11:06.795'

2025/06/22 22:11:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.372ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:56:06.831' LIMIT 50

2025/06/22 22:11:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.163ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:11:06.795'

2025/06/22 22:11:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.771ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:11:06.795'

2025/06/22 22:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.578ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:41:07.16'

2025/06/22 22:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.053ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:11:07.222' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.138ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.876ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.773ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:41:07.337'

2025/06/22 22:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.732ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:11:07.343' AND status != 'pending'
	

2025/06/22 22:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.769ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:11:07.4' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.253ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:11:07.404' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.161ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.269ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:11:07.464'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.875ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.224ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:11:07.525' AND status != 'pending'
	

2025/06/22 22:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.151ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:11:07.589' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[70.163ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:11:07.655'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:12:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.996ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:12:06.795'

2025/06/22 22:12:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.944ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:12:06.795'

2025/06/22 22:12:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.936ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:12:06.795'

2025/06/22 22:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.218ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:42:07.16'

2025/06/22 22:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.377ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:12:07.224' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.245ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.717ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.211ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:42:07.337'

2025/06/22 22:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.736ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:12:07.351' AND status != 'pending'
	

2025/06/22 22:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.207ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:12:07.398' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.631ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:12:07.414' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.185ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.832ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.635ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:12:07.477'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.111ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:12:07.519' AND status != 'pending'
	

2025/06/22 22:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.381ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:12:07.579' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.086ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:12:07.64'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:13:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.179ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:13:06.794'

2025/06/22 22:13:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.207ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:58:06.794' LIMIT 50

2025/06/22 22:13:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.216ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:58:06.83' LIMIT 50

2025/06/22 22:13:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.163ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:13:06.794'

2025/06/22 22:13:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.424ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:13:06.794'

2025/06/22 22:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.956ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:43:07.16'

2025/06/22 22:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.299ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:13:07.222' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.599ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.279ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.729ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:43:07.337'

2025/06/22 22:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.891ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:13:07.345' AND status != 'pending'
	

2025/06/22 22:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.527ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:13:07.398' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.292ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:13:07.406' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.247ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.623ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.766ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:13:07.466'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.181ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:13:07.519' AND status != 'pending'
	

2025/06/22 22:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.848ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:13:07.579' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.796ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:13:07.639'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:14:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.161ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:14:06.794'

2025/06/22 22:14:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.133ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:14:06.794'

2025/06/22 22:14:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.102ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:14:06.794'

2025/06/22 22:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.030ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:44:07.159'

2025/06/22 22:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.763ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:14:07.22' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.039ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.000ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.117ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:44:07.337'

2025/06/22 22:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.409ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:14:07.342' AND status != 'pending'
	

2025/06/22 22:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.520ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:14:07.398' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.937ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:14:07.401' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.686ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.247ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.731ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:14:07.46'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.366ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:14:07.519' AND status != 'pending'
	

2025/06/22 22:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.105ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:14:07.578' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.789ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:14:07.639'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:15:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.863ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:00:06.794' LIMIT 50

2025/06/22 22:15:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.944ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:15:06.795'

2025/06/22 22:15:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.782ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:00:06.831' LIMIT 50

2025/06/22 22:15:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.396ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:15:06.795'

2025/06/22 22:15:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[71.159ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:15:06.795'

2025/06/22 22:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.681ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:45:07.159'

2025/06/22 22:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.340ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:15:07.22' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.242ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.785ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.032ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:45:07.336'

2025/06/22 22:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.566ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:15:07.342' AND status != 'pending'
	

2025/06/22 22:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.890ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:15:07.398' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.530ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:15:07.402' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.891ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.342ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:15:07.462'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.993ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.914ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:15:07.524' AND status != 'pending'
	

2025/06/22 22:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.715ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:15:07.587' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.020ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:15:07.65'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:16:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[70.871ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:16:06.795'

2025/06/22 22:16:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.430ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:16:06.795'

2025/06/22 22:16:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.380ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:16:06.795'

2025/06/22 22:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.758ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:46:07.159'

2025/06/22 22:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.402ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:16:07.224' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.258ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.100ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.181ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:46:07.336'

2025/06/22 22:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.996ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:16:07.351' AND status != 'pending'
	

2025/06/22 22:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.301ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:16:07.397' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.016ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:16:07.416' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.225ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.992ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.040ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:16:07.48'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.040ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:16:07.518' AND status != 'pending'
	

2025/06/22 22:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.604ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:16:07.578' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.788ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:16:07.639'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:17:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.323ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:02:06.794' LIMIT 50

2025/06/22 22:17:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.004ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:17:06.794'

2025/06/22 22:17:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.468ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:02:06.83' LIMIT 50

2025/06/22 22:17:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.544ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:17:06.794'

2025/06/22 22:17:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.507ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:17:06.794'

2025/06/22 22:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.866ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:47:07.158'

2025/06/22 22:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.708ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:17:07.221' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.130ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.869ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.678ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:47:07.336'

2025/06/22 22:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.643ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:17:07.348' AND status != 'pending'
	

2025/06/22 22:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.745ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:17:07.396' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.857ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:17:07.412' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.668ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.171ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.906ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:17:07.475'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.912ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:17:07.515' AND status != 'pending'
	

2025/06/22 22:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.632ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:17:07.576' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.853ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:17:07.636'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:18:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.401ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:18:06.793'

2025/06/22 22:18:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.236ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:18:06.793'

2025/06/22 22:18:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.791ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:18:06.793'

2025/06/22 22:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.286ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:48:07.158'

2025/06/22 22:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.682ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:18:07.219' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.741ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.562ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.971ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:18:07.338' AND status != 'pending'
	

2025/06/22 22:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.986ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:48:07.336'

2025/06/22 22:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.594ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:18:07.398' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.309ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:18:07.399' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.960ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.360ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:18:07.456'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.485ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.296ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:18:07.524' AND status != 'pending'
	

2025/06/22 22:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.538ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:18:07.587' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.379ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:18:07.649'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:19:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.091ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:19:06.793'

2025/06/22 22:19:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.907ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:04:06.793' LIMIT 50

2025/06/22 22:19:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.230ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:04:06.829' LIMIT 50

2025/06/22 22:19:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.413ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:19:06.793'

2025/06/22 22:19:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.685ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:19:06.793'

2025/06/22 22:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.609ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:49:07.158'

2025/06/22 22:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.788ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:19:07.22' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.774ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.252ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.416ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:49:07.336'

2025/06/22 22:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.275ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:19:07.341' AND status != 'pending'
	

2025/06/22 22:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.720ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:19:07.396' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.637ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:19:07.4' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.028ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.364ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:19:07.459'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.056ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.549ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:19:07.52' AND status != 'pending'
	

2025/06/22 22:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.389ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:19:07.58' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.750ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:19:07.641'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:20:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.232ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:20:06.793'

2025/06/22 22:20:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.608ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:20:06.793'

2025/06/22 22:20:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.544ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:20:06.793'

2025/06/22 22:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.026ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:50:07.158'

2025/06/22 22:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.650ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:20:07.219' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.011ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.657ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[69.280ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:50:07.336'

2025/06/22 22:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.297ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:20:07.34' AND status != 'pending'
	

2025/06/22 22:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.789ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:20:07.406' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.571ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:20:07.405' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.747ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.767ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:20:07.467'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.068ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.696ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:20:07.527' AND status != 'pending'
	

2025/06/22 22:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.880ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:20:07.587' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.777ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:20:07.647'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:21:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.487ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:06:06.793' LIMIT 50

2025/06/22 22:21:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.602ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:21:06.793'

2025/06/22 22:21:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.040ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:06:06.829' LIMIT 50

2025/06/22 22:21:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.653ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:21:06.793'

2025/06/22 22:21:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.345ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:21:06.793'

2025/06/22 22:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.484ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:51:07.158'

2025/06/22 22:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.534ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:21:07.22' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.179ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.376ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.928ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:51:07.335'

2025/06/22 22:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.157ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:21:07.341' AND status != 'pending'
	

2025/06/22 22:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.491ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:21:07.399' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.887ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:21:07.402' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.269ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.072ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:21:07.463'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.853ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.270ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:21:07.524' AND status != 'pending'
	

2025/06/22 22:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.511ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:21:07.587' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.894ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:21:07.65'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:22:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.083ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:22:06.794'

2025/06/22 22:22:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.148ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:22:06.794'

2025/06/22 22:22:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.212ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:22:06.794'

2025/06/22 22:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.251ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:52:07.157'

2025/06/22 22:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.457ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:22:07.221' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.342ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.990ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.087ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:52:07.335'

2025/06/22 22:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.647ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:22:07.347' AND status != 'pending'
	

2025/06/22 22:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.759ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:22:07.395' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.565ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:22:07.409' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.303ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.413ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.912ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:22:07.472'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.155ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:22:07.517' AND status != 'pending'
	

2025/06/22 22:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.989ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:22:07.578' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.338ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:22:07.638'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:23:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.632ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:23:06.792'

2025/06/22 22:23:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.499ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:08:06.792' LIMIT 50

2025/06/22 22:23:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.207ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:08:06.829' LIMIT 50

2025/06/22 22:23:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.106ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:23:06.792'

2025/06/22 22:23:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.737ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:23:06.792'

2025/06/22 22:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.116ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:53:07.158'

2025/06/22 22:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.283ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:23:07.22' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.297ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.978ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.323ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:53:07.335'

2025/06/22 22:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.727ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:23:07.341' AND status != 'pending'
	

2025/06/22 22:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.991ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:23:07.395' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.626ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:23:07.401' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.453ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.641ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.818ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:23:07.461'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.347ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:23:07.514' AND status != 'pending'
	

2025/06/22 22:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.833ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:23:07.575' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.923ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:23:07.635'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:23:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[62.231ms] [rows:1] SELECT * FROM `user` WHERE (username = 'admin' OR phone = 'admin') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/22 22:23:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:481
[59.829ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 4

2025/06/22 22:23:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:493 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[29.992ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,3,4,5,6,7,8,23,24)

2025/06/22 22:24:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.393ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:24:06.792'

2025/06/22 22:24:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.631ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:24:06.792'

2025/06/22 22:24:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.773ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:24:06.792'

2025/06/22 22:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.564ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:54:07.158'

2025/06/22 22:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.242ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:24:07.219' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.009ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.977ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.489ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:54:07.334'

2025/06/22 22:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.802ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:24:07.34' AND status != 'pending'
	

2025/06/22 22:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.563ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:24:07.395' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.689ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:24:07.403' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.301ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.891ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.207ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:24:07.463'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.328ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:24:07.517' AND status != 'pending'
	

2025/06/22 22:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.412ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:24:07.577' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.331ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:24:07.639'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:25:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.036ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:10:06.792' LIMIT 50

2025/06/22 22:25:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.909ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:25:06.792'

2025/06/22 22:25:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.569ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:10:06.83' LIMIT 50

2025/06/22 22:25:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.599ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:25:06.792'

2025/06/22 22:25:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.105ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:25:06.792'

2025/06/22 22:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.358ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:55:07.157'

2025/06/22 22:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.651ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:25:07.218' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.837ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.819ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.473ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:55:07.335'

2025/06/22 22:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.128ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:25:07.339' AND status != 'pending'
	

2025/06/22 22:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.620ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:25:07.399' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.124ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:25:07.398' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.029ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.008ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:25:07.461'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.096ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.139ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:25:07.524' AND status != 'pending'
	

2025/06/22 22:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.921ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:25:07.587' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.849ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:25:07.65'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:26:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.322ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:26:06.792'

2025/06/22 22:26:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.971ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:26:06.792'

2025/06/22 22:26:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.388ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:26:06.792'

2025/06/22 22:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.263ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:56:07.157'

2025/06/22 22:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.997ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:26:07.221' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.097ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.245ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.492ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:56:07.334'

2025/06/22 22:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.055ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:26:07.347' AND status != 'pending'
	

2025/06/22 22:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.460ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:26:07.395' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.710ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:26:07.41' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.759ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.335ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.905ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:26:07.475'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.060ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:26:07.516' AND status != 'pending'
	

2025/06/22 22:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.045ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:26:07.576' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.308ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:26:07.636'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:27:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.107ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:12:06.792' LIMIT 50

2025/06/22 22:27:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[92.224ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:27:06.794'

2025/06/22 22:27:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.332ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:12:06.828' LIMIT 50

2025/06/22 22:27:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.954ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:27:06.794'

2025/06/22 22:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.746ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:27:06.794'

2025/06/22 22:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.404ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:57:07.157'

2025/06/22 22:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.540ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:27:07.221' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.011ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.230ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.319ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:57:07.334'

2025/06/22 22:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.560ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:27:07.347' AND status != 'pending'
	

2025/06/22 22:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.061ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:27:07.396' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.023ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:27:07.411' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.434ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.663ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.640ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:27:07.474'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.154ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:27:07.517' AND status != 'pending'
	

2025/06/22 22:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.081ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:27:07.578' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.040ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:27:07.637'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:28:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.265ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:28:06.791'

2025/06/22 22:28:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.230ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:28:06.791'

2025/06/22 22:28:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.645ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:28:06.791'

2025/06/22 22:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.316ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:58:07.157'

2025/06/22 22:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.496ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:28:07.217' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.492ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.999ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.430ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:58:07.334'

2025/06/22 22:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.128ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:28:07.342' AND status != 'pending'
	

2025/06/22 22:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.630ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:28:07.399' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.772ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:28:07.402' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.803ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.841ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:28:07.462'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.229ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.153ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:28:07.525' AND status != 'pending'
	

2025/06/22 22:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.399ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:28:07.589' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.488ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:28:07.656'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:29:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.199ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:14:06.793' LIMIT 50

2025/06/22 22:29:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[69.318ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:29:06.791'

2025/06/22 22:29:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.777ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:14:06.828' LIMIT 50

2025/06/22 22:29:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.120ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:29:06.791'

2025/06/22 22:29:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.765ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:29:06.791'

2025/06/22 22:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.150ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:59:07.157'

2025/06/22 22:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.303ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:29:07.221' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.645ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.668ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.167ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 21:59:07.334'

2025/06/22 22:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.131ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:29:07.349' AND status != 'pending'
	

2025/06/22 22:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.165ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:29:07.394' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.083ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:29:07.412' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.656ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.908ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.712ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:29:07.477'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.187ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:29:07.517' AND status != 'pending'
	

2025/06/22 22:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.845ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:29:07.577' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.310ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:29:07.638'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:30:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.646ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:30:06.791'

2025/06/22 22:30:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.131ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:30:06.791'

2025/06/22 22:30:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.173ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:30:06.791'

2025/06/22 22:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.908ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:00:07.156'

2025/06/22 22:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.721ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:30:07.217' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.143ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.169ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.116ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:00:07.334'

2025/06/22 22:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.698ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:30:07.339' AND status != 'pending'
	

2025/06/22 22:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.541ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:30:07.399' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.609ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:30:07.397' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.832ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.943ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:30:07.46'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.246ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.689ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:30:07.523' AND status != 'pending'
	

2025/06/22 22:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.679ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:30:07.586' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.911ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:30:07.649'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:31:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.688ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:31:06.791'

2025/06/22 22:31:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[68.646ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:16:06.791' LIMIT 50

2025/06/22 22:31:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.680ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:16:06.827' LIMIT 50

2025/06/22 22:31:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.192ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:31:06.791'

2025/06/22 22:31:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.277ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:31:06.791'

2025/06/22 22:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.310ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:01:07.156'

2025/06/22 22:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.783ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:31:07.217' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.926ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.029ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.630ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:01:07.334'

2025/06/22 22:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.629ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:31:07.338' AND status != 'pending'
	

2025/06/22 22:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.812ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:31:07.394' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.174ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:31:07.398' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.641ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.087ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.769ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:31:07.457'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.926ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:31:07.515' AND status != 'pending'
	

2025/06/22 22:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.112ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:31:07.576' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.208ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:31:07.636'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:32:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.248ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:32:06.794'

2025/06/22 22:32:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.569ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:32:06.794'

2025/06/22 22:32:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.954ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:32:06.794'

2025/06/22 22:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.603ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:02:07.156'

2025/06/22 22:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.570ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:32:07.217' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.034ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.938ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.887ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:02:07.333'

2025/06/22 22:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.743ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:32:07.339' AND status != 'pending'
	

2025/06/22 22:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.226ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:32:07.395' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.341ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:32:07.399' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.136ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.880ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.092ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:32:07.458'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.756ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:32:07.516' AND status != 'pending'
	

2025/06/22 22:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.422ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:32:07.577' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.960ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:32:07.637'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:33:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.515ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:18:06.791' LIMIT 50

2025/06/22 22:33:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.988ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:33:06.791'

2025/06/22 22:33:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.798ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:18:06.826' LIMIT 50

2025/06/22 22:33:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.785ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:33:06.791'

2025/06/22 22:33:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.393ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:33:06.791'

2025/06/22 22:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.397ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:03:07.156'

2025/06/22 22:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.222ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:33:07.218' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.009ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.721ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.079ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:03:07.333'

2025/06/22 22:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.856ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:33:07.341' AND status != 'pending'
	

2025/06/22 22:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.993ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:33:07.402' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.047ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:33:07.4' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.782ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.235ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:33:07.462'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.633ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.305ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:33:07.524' AND status != 'pending'
	

2025/06/22 22:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.440ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:33:07.588' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.869ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:33:07.652'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:34:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.827ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:34:06.791'

2025/06/22 22:34:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.435ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:34:06.791'

2025/06/22 22:34:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.511ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:34:06.791'

2025/06/22 22:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.653ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:04:07.156'

2025/06/22 22:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.024ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:34:07.22' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.057ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.447ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.319ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:04:07.333'

2025/06/22 22:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.875ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:34:07.346' AND status != 'pending'
	

2025/06/22 22:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.165ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:34:07.395' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.073ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:34:07.41' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.840ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.660ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.046ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:34:07.477'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.390ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:34:07.529' AND status != 'pending'
	

2025/06/22 22:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.446ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:34:07.594' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.188ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:34:07.661'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:34:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[65.942ms] [rows:0] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 22:35:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.997ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:35:06.791'

2025/06/22 22:35:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.892ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:20:06.791' LIMIT 50

2025/06/22 22:35:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.271ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:20:06.826' LIMIT 50

2025/06/22 22:35:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.840ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:35:06.791'

2025/06/22 22:35:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.310ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:35:06.791'

2025/06/22 22:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.797ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:05:07.156'

2025/06/22 22:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.651ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:35:07.218' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.014ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.548ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.441ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:05:07.333'

2025/06/22 22:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.108ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:35:07.341' AND status != 'pending'
	

2025/06/22 22:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.639ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:35:07.394' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.056ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:35:07.401' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.677ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.948ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.491ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:35:07.461'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.905ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:35:07.515' AND status != 'pending'
	

2025/06/22 22:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.648ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:35:07.575' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.063ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:35:07.635'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:36:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.224ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:36:06.79'

2025/06/22 22:36:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.578ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:36:06.79'

2025/06/22 22:36:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.201ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:36:06.79'

2025/06/22 22:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.393ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:06:07.155'

2025/06/22 22:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.643ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:36:07.216' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.936ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.088ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.444ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:06:07.333'

2025/06/22 22:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.616ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:36:07.336' AND status != 'pending'
	

2025/06/22 22:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.260ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:36:07.393' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.238ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:36:07.396' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.190ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.963ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.423ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:36:07.455'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.500ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:36:07.516' AND status != 'pending'
	

2025/06/22 22:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.189ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:36:07.577' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.608ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:36:07.637'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:36:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.395ms] [rows:0] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 22:37:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.191ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:37:06.79'

2025/06/22 22:37:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.002ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:22:06.79' LIMIT 50

2025/06/22 22:37:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.480ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:22:06.826' LIMIT 50

2025/06/22 22:37:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.705ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:37:06.79'

2025/06/22 22:37:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.454ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:37:06.79'

2025/06/22 22:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.273ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:07:07.155'

2025/06/22 22:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.187ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:37:07.217' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.197ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.141ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.234ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:07:07.332'

2025/06/22 22:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.716ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:37:07.338' AND status != 'pending'
	

2025/06/22 22:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.144ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:37:07.398' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.551ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:37:07.397' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.660ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.898ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:37:07.46'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.193ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.394ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:37:07.522' AND status != 'pending'
	

2025/06/22 22:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.136ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:37:07.585' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.999ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:37:07.648'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:38:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.746ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:38:06.789'

2025/06/22 22:38:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.271ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:38:06.789'

2025/06/22 22:38:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.691ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:38:06.789'

2025/06/22 22:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.207ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:08:07.155'

2025/06/22 22:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.841ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:38:07.218' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.721ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.962ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.786ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:08:07.332'

2025/06/22 22:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.158ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:38:07.347' AND status != 'pending'
	

2025/06/22 22:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.503ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:38:07.394' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.905ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:38:07.411' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.727ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.985ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.947ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:38:07.474'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.177ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:38:07.516' AND status != 'pending'
	

2025/06/22 22:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.330ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:38:07.576' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.251ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:38:07.638'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:39:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.867ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:39:06.79'

2025/06/22 22:39:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.687ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:24:06.79' LIMIT 50

2025/06/22 22:39:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.198ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:24:06.826' LIMIT 50

2025/06/22 22:39:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.045ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:39:06.79'

2025/06/22 22:39:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.730ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:39:06.79'

2025/06/22 22:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.772ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:09:07.155'

2025/06/22 22:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.936ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:39:07.217' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.963ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.229ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.854ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:09:07.332'

2025/06/22 22:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.739ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:39:07.339' AND status != 'pending'
	

2025/06/22 22:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.285ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:39:07.392' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.832ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:39:07.399' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.579ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.322ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.819ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:39:07.458'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.880ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:39:07.513' AND status != 'pending'
	

2025/06/22 22:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.913ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:39:07.573' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.103ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:39:07.633'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:40:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.830ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:40:06.789'

2025/06/22 22:40:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.003ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:40:06.789'

2025/06/22 22:40:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.491ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:40:06.789'

2025/06/22 22:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.854ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:10:07.154'

2025/06/22 22:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.582ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:40:07.216' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.177ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.999ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.235ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:10:07.332'

2025/06/22 22:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.309ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:40:07.337' AND status != 'pending'
	

2025/06/22 22:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.109ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:40:07.394' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.963ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:40:07.398' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.564ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.068ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:40:07.457'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.908ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.935ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:40:07.517' AND status != 'pending'
	

2025/06/22 22:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.873ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:40:07.578' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.848ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:40:07.639'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:41:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.167ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:26:06.789' LIMIT 50

2025/06/22 22:41:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.554ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:41:06.789'

2025/06/22 22:41:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.200ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:26:06.826' LIMIT 50

2025/06/22 22:41:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.605ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:41:06.789'

2025/06/22 22:41:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.934ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:41:06.789'

2025/06/22 22:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.025ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:11:07.154'

2025/06/22 22:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.740ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:41:07.217' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.121ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.196ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.964ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:11:07.331'

2025/06/22 22:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.207ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:41:07.338' AND status != 'pending'
	

2025/06/22 22:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.309ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:41:07.393' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.858ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:41:07.398' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.564ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.757ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:41:07.458'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.828ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.042ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:41:07.518' AND status != 'pending'
	

2025/06/22 22:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.097ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:41:07.58' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.041ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:41:07.643'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:42:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.772ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:42:06.789'

2025/06/22 22:42:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.655ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:42:06.789'

2025/06/22 22:42:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.383ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:42:06.789'

2025/06/22 22:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.358ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:12:07.154'

2025/06/22 22:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.910ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:42:07.22' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.408ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.089ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.834ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:12:07.331'

2025/06/22 22:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.698ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:42:07.345' AND status != 'pending'
	

2025/06/22 22:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.644ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:42:07.392' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.515ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:42:07.408' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.155ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.827ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.380ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:42:07.471'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.911ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:42:07.513' AND status != 'pending'
	

2025/06/22 22:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.287ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:42:07.573' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.456ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:42:07.633'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:43:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.062ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:28:06.789' LIMIT 50

2025/06/22 22:43:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.188ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:43:06.789'

2025/06/22 22:43:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.383ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:28:06.825' LIMIT 50

2025/06/22 22:43:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.456ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:43:06.789'

2025/06/22 22:43:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.221ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:43:06.789'

2025/06/22 22:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.887ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:13:07.154'

2025/06/22 22:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.953ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:43:07.217' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.835ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.533ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.617ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:13:07.331'

2025/06/22 22:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.834ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:43:07.349' AND status != 'pending'
	

2025/06/22 22:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.356ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:43:07.394' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.618ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:43:07.417' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.391ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.369ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.094ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:43:07.479'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.653ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:43:07.515' AND status != 'pending'
	

2025/06/22 22:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.822ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:43:07.574' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.914ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:43:07.634'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:44:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.096ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:44:06.788'

2025/06/22 22:44:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.690ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:44:06.788'

2025/06/22 22:44:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.815ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:44:06.788'

2025/06/22 22:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.566ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:14:07.154'

2025/06/22 22:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.238ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:44:07.215' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.627ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.701ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.851ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:14:07.331'

2025/06/22 22:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.659ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:44:07.335' AND status != 'pending'
	

2025/06/22 22:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.081ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:44:07.395' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.612ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:44:07.394' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.070ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.158ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:44:07.455'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.408ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.360ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:44:07.519' AND status != 'pending'
	

2025/06/22 22:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.302ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:44:07.582' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.635ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:44:07.646'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:45:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.588ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:45:06.789'

2025/06/22 22:45:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.737ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:30:06.789' LIMIT 50

2025/06/22 22:45:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.524ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:30:06.825' LIMIT 50

2025/06/22 22:45:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.022ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:45:06.789'

2025/06/22 22:45:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.215ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:45:06.789'

2025/06/22 22:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.943ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:15:07.154'

2025/06/22 22:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.807ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:45:07.215' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.920ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.734ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.891ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:15:07.331'

2025/06/22 22:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.798ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:45:07.335' AND status != 'pending'
	

2025/06/22 22:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.238ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:45:07.395' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.057ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:45:07.394' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.425ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.980ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:45:07.458'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.277ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.845ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:45:07.519' AND status != 'pending'
	

2025/06/22 22:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.052ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:45:07.58' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.999ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:45:07.641'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:46:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.781ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:46:06.788'

2025/06/22 22:46:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.017ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:46:06.788'

2025/06/22 22:46:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.545ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:46:06.788'

2025/06/22 22:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.686ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:16:07.154'

2025/06/22 22:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.740ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:46:07.214' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.147ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.903ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.964ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:16:07.33'

2025/06/22 22:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.833ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:46:07.336' AND status != 'pending'
	

2025/06/22 22:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.750ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:46:07.39' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.845ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:46:07.396' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.996ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.392ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.973ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:46:07.456'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.024ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:46:07.509' AND status != 'pending'
	

2025/06/22 22:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.633ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:46:07.571' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.979ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:46:07.632'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:47:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.394ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:47:06.788'

2025/06/22 22:47:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.263ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:32:06.788' LIMIT 50

2025/06/22 22:47:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.084ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:32:06.825' LIMIT 50

2025/06/22 22:47:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.376ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:47:06.788'

2025/06/22 22:47:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.371ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:47:06.788'

2025/06/22 22:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.302ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:17:07.153'

2025/06/22 22:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.032ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:47:07.215' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.169ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.060ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.510ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:17:07.331'

2025/06/22 22:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.665ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:47:07.337' AND status != 'pending'
	

2025/06/22 22:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.822ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:47:07.393' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.265ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:47:07.397' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.407ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.057ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:47:07.458'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.041ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.830ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:47:07.52' AND status != 'pending'
	

2025/06/22 22:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.417ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:47:07.583' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.903ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:47:07.647'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:48:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.260ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:48:06.788'

2025/06/22 22:48:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.208ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:48:06.788'

2025/06/22 22:48:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.656ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:48:06.788'

2025/06/22 22:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.645ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:18:07.153'

2025/06/22 22:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.258ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:48:07.217' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.620ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.691ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.954ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:18:07.33'

2025/06/22 22:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.966ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:48:07.345' AND status != 'pending'
	

2025/06/22 22:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.647ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:48:07.393' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.797ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:48:07.41' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.196ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.740ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.929ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:48:07.473'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.980ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:48:07.519' AND status != 'pending'
	

2025/06/22 22:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.015ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:48:07.579' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.543ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:48:07.64'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:48:30 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.630ms] [rows:0] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 22:48:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.950ms] [rows:0] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 22:48:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.515ms] [rows:0] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 22:49:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.490ms] [rows:0] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 22:49:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.019ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:34:06.788' LIMIT 50

2025/06/22 22:49:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.219ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:49:06.787'

2025/06/22 22:49:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.927ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:34:06.824' LIMIT 50

2025/06/22 22:49:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.580ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:49:06.787'

2025/06/22 22:49:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.973ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:49:06.787'

2025/06/22 22:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.976ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:19:07.153'

2025/06/22 22:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.499ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:49:07.216' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.549ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.068ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.999ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:19:07.33'

2025/06/22 22:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.879ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:49:07.342' AND status != 'pending'
	

2025/06/22 22:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.672ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:49:07.389' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.051ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:49:07.405' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.804ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.836ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.709ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:49:07.468'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.712ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:49:07.509' AND status != 'pending'
	

2025/06/22 22:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.949ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:49:07.569' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.915ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:49:07.629'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:50:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.590ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:50:06.788'

2025/06/22 22:50:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.601ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:50:06.788'

2025/06/22 22:50:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.791ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:50:06.788'

2025/06/22 22:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.445ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:20:07.153'

2025/06/22 22:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.046ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:50:07.216' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.280ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.540ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.688ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:20:07.33'

2025/06/22 22:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.420ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:50:07.337' AND status != 'pending'
	

2025/06/22 22:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.601ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:50:07.393' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.635ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:50:07.398' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.377ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.312ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:50:07.458'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.772ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.059ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:50:07.519' AND status != 'pending'
	

2025/06/22 22:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.303ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:50:07.582' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.805ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:50:07.645'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:51:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.357ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:36:06.787' LIMIT 50

2025/06/22 22:51:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.023ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:51:06.787'

2025/06/22 22:51:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.963ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:36:06.824' LIMIT 50

2025/06/22 22:51:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.445ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:51:06.787'

2025/06/22 22:51:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.722ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:51:06.787'

2025/06/22 22:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.948ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:21:07.153'

2025/06/22 22:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.290ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:51:07.216' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.253ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.138ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.412ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:21:07.33'

2025/06/22 22:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.732ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:51:07.342' AND status != 'pending'
	

2025/06/22 22:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.036ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:51:07.391' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.688ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:51:07.405' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.389ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.702ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.728ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:51:07.468'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.489ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:51:07.511' AND status != 'pending'
	

2025/06/22 22:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.893ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:51:07.573' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.887ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:51:07.634'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:52:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.514ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 22:52:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.821ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:52:06.846'

2025/06/22 22:52:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.432ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:52:06.846'

2025/06/22 22:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.289ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:52:06.846'

2025/06/22 22:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.011ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:22:07.211'

2025/06/22 22:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.215ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:52:07.272' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.847ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.330ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.057ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:22:07.388'

2025/06/22 22:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.541ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:52:07.393' AND status != 'pending'
	

2025/06/22 22:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.522ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:52:07.454' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.070ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:52:07.454' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.918ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.638ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:52:07.514'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.897ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.046ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:52:07.578' AND status != 'pending'
	

2025/06/22 22:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.611ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:52:07.641' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.309ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:52:07.704'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:52:54 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[72.671ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 22:53:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.991ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:38:06.846' LIMIT 50

2025/06/22 22:53:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.298ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:53:06.847'

2025/06/22 22:53:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.680ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:38:06.883' LIMIT 50

2025/06/22 22:53:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.069ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:53:06.847'

2025/06/22 22:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.274ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:53:06.847'

2025/06/22 22:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.852ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:23:07.211'

2025/06/22 22:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.743ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:53:07.275' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.240ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.552ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.959ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:23:07.389'

2025/06/22 22:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.484ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:53:07.401' AND status != 'pending'
	

2025/06/22 22:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.968ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:53:07.449' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.808ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:53:07.463' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.583ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.511ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.212ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:53:07.526'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.876ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:53:07.569' AND status != 'pending'
	

2025/06/22 22:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.263ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:53:07.629' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.078ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:53:07.689'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:54:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.425ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:54:06.848'

2025/06/22 22:54:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.696ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:54:06.848'

2025/06/22 22:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.173ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:54:06.848'

2025/06/22 22:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.981ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:24:07.212'

2025/06/22 22:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.837ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:54:07.274' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.457ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.755ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.243ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:24:07.389'

2025/06/22 22:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.373ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:54:07.394' AND status != 'pending'
	

2025/06/22 22:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.068ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:54:07.454' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.865ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:54:07.454' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.275ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.277ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:54:07.515'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.393ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.051ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:54:07.578' AND status != 'pending'
	

2025/06/22 22:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.463ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:54:07.641' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.018ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:54:07.705'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:55:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.564ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:55:06.848'

2025/06/22 22:55:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.541ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:40:06.848' LIMIT 50

2025/06/22 22:55:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.932ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:40:06.883' LIMIT 50

2025/06/22 22:55:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.944ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:55:06.848'

2025/06/22 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.801ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:55:06.848'

2025/06/22 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.697ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:25:07.213'

2025/06/22 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.978ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:55:07.273' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.223ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.491ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.034ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:25:07.39'

2025/06/22 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.256ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:55:07.392' AND status != 'pending'
	

2025/06/22 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.073ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:55:07.45' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.326ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:55:07.451' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.939ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.188ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:55:07.511'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.729ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.806ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:55:07.573' AND status != 'pending'
	

2025/06/22 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.700ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:55:07.633' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.083ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:55:07.694'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:56:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.899ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:56:06.848'

2025/06/22 22:56:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.878ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:56:06.848'

2025/06/22 22:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.070ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:56:06.848'

2025/06/22 22:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.552ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:26:07.213'

2025/06/22 22:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.240ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:56:07.275' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.249ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.812ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.590ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:26:07.391'

2025/06/22 22:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.389ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:56:07.396' AND status != 'pending'
	

2025/06/22 22:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.780ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:56:07.452' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.935ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:56:07.456' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.583ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.869ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.775ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:56:07.516'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.840ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:56:07.572' AND status != 'pending'
	

2025/06/22 22:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.781ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:56:07.632' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.959ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:56:07.694'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:56:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.271ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 22:57:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.754ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:57:06.848'

2025/06/22 22:57:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.301ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:42:06.848' LIMIT 50

2025/06/22 22:57:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.459ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:42:06.884' LIMIT 50

2025/06/22 22:57:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.837ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:57:06.848'

2025/06/22 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.644ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:57:06.848'

2025/06/22 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.901ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:27:07.214'

2025/06/22 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.782ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:57:07.275' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.011ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.225ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.498ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:27:07.391'

2025/06/22 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.037ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:57:07.397' AND status != 'pending'
	

2025/06/22 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.426ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:57:07.457' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.764ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:57:07.456' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.244ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.664ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:57:07.519'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.485ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.544ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:57:07.582' AND status != 'pending'
	

2025/06/22 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.157ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:57:07.645' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.898ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:57:07.709'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:57:34 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[73.592ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 22:57:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.454ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 22:57:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.215ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 22:57:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[66.836ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 22:58:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.142ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:58:06.85'

2025/06/22 22:58:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.603ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:58:06.85'

2025/06/22 22:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.040ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:58:06.85'

2025/06/22 22:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.361ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:28:07.214'

2025/06/22 22:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.133ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:58:07.277' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.523ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.219ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.604ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:28:07.392'

2025/06/22 22:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.860ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:58:07.404' AND status != 'pending'
	

2025/06/22 22:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.789ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:58:07.453' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.640ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:58:07.467' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.613ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.417ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.818ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:58:07.53'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.546ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:58:07.573' AND status != 'pending'
	

2025/06/22 22:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.953ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:58:07.633' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.763ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:58:07.693'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:58:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[64.893ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 22:59:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.213ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:44:06.85' LIMIT 50

2025/06/22 22:59:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.919ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 22:59:06.85'

2025/06/22 22:59:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.585ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:44:06.886' LIMIT 50

2025/06/22 22:59:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.866ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 22:59:06.85'

2025/06/22 22:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[72.019ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 22:59:06.85'

2025/06/22 22:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.102ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:29:07.215'

2025/06/22 22:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.582ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:59:07.278' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.439ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.841ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.003ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:29:07.392'

2025/06/22 22:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.484ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:59:07.405' AND status != 'pending'
	

2025/06/22 22:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.548ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 21:59:07.454' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 22:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.962ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:59:07.467' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.084ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 22:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.195ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 22:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.888ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:59:07.53'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 22:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.820ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 21:59:07.576' AND status != 'pending'
	

2025/06/22 22:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.135ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 21:59:07.637' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 22:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.663ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 21:59:07.697'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:00:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.508ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:00:06.85'

2025/06/22 23:00:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.903ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:00:06.85'

2025/06/22 23:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.742ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:00:06.85'

2025/06/22 23:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.386ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:30:07.216'

2025/06/22 23:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.116ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:00:07.276' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.365ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.066ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.872ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:30:07.393'

2025/06/22 23:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.442ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:00:07.397' AND status != 'pending'
	

2025/06/22 23:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.106ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:00:07.458' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.816ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:00:07.456' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.855ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.348ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:00:07.518'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.705ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.300ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:00:07.582' AND status != 'pending'
	

2025/06/22 23:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.982ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:00:07.645' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.170ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:00:07.711'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:00:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.991ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:01:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.767ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:01:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.531ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:46:06.851' LIMIT 50

2025/06/22 23:01:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.107ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:01:06.851'

2025/06/22 23:01:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.372ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:46:06.887' LIMIT 50

2025/06/22 23:01:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.584ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:01:06.851'

2025/06/22 23:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.216ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:01:06.851'

2025/06/22 23:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.315ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:31:07.216'

2025/06/22 23:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.997ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:01:07.28' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.741ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.253ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.360ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:31:07.393'

2025/06/22 23:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.014ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:01:07.406' AND status != 'pending'
	

2025/06/22 23:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.955ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:01:07.452' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.903ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:01:07.468' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.816ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.774ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.167ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:01:07.531'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.106ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:01:07.572' AND status != 'pending'
	

2025/06/22 23:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.764ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:01:07.632' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.405ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:01:07.692'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.925ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:01:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.197ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:01:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.442ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:01:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.837ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:01:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[70.588ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:01:54 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.597ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:01:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.625ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:02:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.835ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:02:06.852'

2025/06/22 23:02:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.858ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:02:06.852'

2025/06/22 23:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.098ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:02:06.852'

2025/06/22 23:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.976ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:32:07.216'

2025/06/22 23:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.533ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:02:07.279' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.329ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.063ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.115ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:32:07.394'

2025/06/22 23:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.956ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:02:07.406' AND status != 'pending'
	

2025/06/22 23:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.772ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:02:07.453' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.531ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:02:07.468' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.077ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.856ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.348ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:02:07.531'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.508ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:02:07.572' AND status != 'pending'
	

2025/06/22 23:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.057ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:02:07.632' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.911ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:02:07.692'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:02:22 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.477ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:02:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.876ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:02:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.154ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:02:43 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.944ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:03:01 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.570ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:03:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.085ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:03:06.852'

2025/06/22 23:03:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.766ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:48:06.852' LIMIT 50

2025/06/22 23:03:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.287ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:48:06.888' LIMIT 50

2025/06/22 23:03:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.512ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:03:06.852'

2025/06/22 23:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.642ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:03:06.852'

2025/06/22 23:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.207ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:33:07.217'

2025/06/22 23:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.741ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:03:07.278' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.740ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.689ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.765ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:33:07.393'

2025/06/22 23:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.038ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:03:07.398' AND status != 'pending'
	

2025/06/22 23:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.179ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:03:07.455' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.534ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:03:07.458' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.901ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.196ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.638ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:03:07.516'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.673ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:03:07.578' AND status != 'pending'
	

2025/06/22 23:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.258ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:03:07.638' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.049ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:03:07.698'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:04:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.142ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:04:06.852'

2025/06/22 23:04:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.607ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:04:06.852'

2025/06/22 23:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.097ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:04:06.852'

2025/06/22 23:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.534ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:34:07.217'

2025/06/22 23:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.288ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:04:07.278' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.310ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.278ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.444ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:34:07.395'

2025/06/22 23:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.867ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:04:07.399' AND status != 'pending'
	

2025/06/22 23:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.071ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:04:07.456' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.352ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:04:07.459' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.273ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.068ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.143ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:04:07.521'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.080ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:04:07.577' AND status != 'pending'
	

2025/06/22 23:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.891ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:04:07.637' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.362ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:04:07.697'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:04:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.498ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:05:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.639ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:50:06.853' LIMIT 50

2025/06/22 23:05:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.117ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:05:06.853'

2025/06/22 23:05:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.201ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:50:06.89' LIMIT 50

2025/06/22 23:05:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.435ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:05:06.853'

2025/06/22 23:05:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.411ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:05:06.853'

2025/06/22 23:05:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.874ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:35:07.218'

2025/06/22 23:05:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.642ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:05:07.279' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:05:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.502ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:05:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.962ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:05:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.538ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:35:07.396'

2025/06/22 23:05:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.452ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:05:07.401' AND status != 'pending'
	

2025/06/22 23:05:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.435ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:05:07.458' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:05:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.771ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:05:07.462' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:05:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.765ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:05:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.281ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:05:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.401ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:05:07.523'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:05:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.453ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:05:07.585' AND status != 'pending'
	

2025/06/22 23:05:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.400ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:05:07.646' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:05:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.266ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:05:07.707'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:05:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.074ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:05:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.769ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:06:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.131ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:06:06.854'

2025/06/22 23:06:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.607ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:06:06.854'

2025/06/22 23:06:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.963ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:06:06.854'

2025/06/22 23:06:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.009ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:36:07.219'

2025/06/22 23:06:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.361ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:06:07.279' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:06:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.369ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:06:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.098ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:06:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.826ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:36:07.396'

2025/06/22 23:06:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.159ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:06:07.4' AND status != 'pending'
	

2025/06/22 23:06:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.456ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:06:07.461' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:06:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.438ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:06:07.46' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:06:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.133ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:06:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.205ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:06:07.52'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:06:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.096ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:06:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.894ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:06:07.584' AND status != 'pending'
	

2025/06/22 23:06:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.593ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:06:07.647' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:06:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.258ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:06:07.71'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:06:22 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[73.380ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:07:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.632ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:52:06.854' LIMIT 50

2025/06/22 23:07:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.837ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:07:06.854'

2025/06/22 23:07:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.375ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:07:06.854'

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.992ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:07:06.854'

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[208.660ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-21 23:07:06.855' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[178.509ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:52:06.891' LIMIT 50

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[187.620ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-21 23:07:06.891' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[33.578ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-15 23:07:07.064'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[30.780ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-15 23:07:07.078'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.085ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:37:07.219'

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.346ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:07:07.282' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.939ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.093ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.946ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:37:07.397'

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.127ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:07:07.406' AND status != 'pending'
	

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.188ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:07:07.467' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.219ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:07:07.466' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.159ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.225ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:07:07.528'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.703ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.431ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:07:07.602' AND status != 'pending'
	

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.448ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:07:07.67' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[68.172ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:07:07.737'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:08:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[72.330ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:08:06.855'

2025/06/22 23:08:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[69.142ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:08:06.855'

2025/06/22 23:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[68.302ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:08:06.855'

2025/06/22 23:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.887ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:38:07.22'

2025/06/22 23:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.204ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:08:07.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.787ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.340ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.567ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:38:07.397'

2025/06/22 23:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.030ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:08:07.425' AND status != 'pending'
	

2025/06/22 23:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.829ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:08:07.458' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.744ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.102ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:08:07.492' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.614ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.649ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:08:07.559'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.466ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:08:07.584' AND status != 'pending'
	

2025/06/22 23:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.995ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:08:07.647' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.717ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:08:07.708'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:09:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.996ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:09:06.855'

2025/06/22 23:09:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[69.472ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:54:06.856' LIMIT 50

2025/06/22 23:09:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.624ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:54:06.891' LIMIT 50

2025/06/22 23:09:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.220ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:09:06.855'

2025/06/22 23:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.267ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:09:06.855'

2025/06/22 23:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.147ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:39:07.221'

2025/06/22 23:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.279ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:09:07.285' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.792ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.786ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.975ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:39:07.398'

2025/06/22 23:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.613ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:09:07.409' AND status != 'pending'
	

2025/06/22 23:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.891ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:09:07.457' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.542ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:09:07.471' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.260ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.383ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.935ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:09:07.532'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.010ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:09:07.575' AND status != 'pending'
	

2025/06/22 23:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.855ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:09:07.635' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:09:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.534ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:09:07.694'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:09:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.858ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:10:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.632ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:10:06.858'

2025/06/22 23:10:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.242ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:10:06.858'

2025/06/22 23:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.678ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:10:06.858'

2025/06/22 23:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.073ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:40:07.221'

2025/06/22 23:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.956ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:10:07.28' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.781ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.581ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.147ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:10:07.401' AND status != 'pending'
	

2025/06/22 23:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.544ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:40:07.398'

2025/06/22 23:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.504ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:10:07.459' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.632ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:10:07.46' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.802ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.522ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:10:07.518'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.738ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.297ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:10:07.583' AND status != 'pending'
	

2025/06/22 23:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.385ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:10:07.644' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:10:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.263ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:10:07.707'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:10:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.843ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:11:00 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.175ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:11:01 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[65.926ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:11:03 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.927ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:11:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.568ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:56:06.856' LIMIT 50

2025/06/22 23:11:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.620ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:11:06.856'

2025/06/22 23:11:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.888ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:56:06.893' LIMIT 50

2025/06/22 23:11:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.273ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:11:06.856'

2025/06/22 23:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.787ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:11:06.856'

2025/06/22 23:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.570ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:41:07.222'

2025/06/22 23:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.982ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:11:07.283' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[67.211ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.654ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.345ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.734ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:41:07.399'

2025/06/22 23:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.751ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:11:07.417' AND status != 'pending'
	

2025/06/22 23:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.459ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:11:07.467' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.517ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:11:07.479' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.030ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.277ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:11:07.54'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.253ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.794ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:11:07.603' AND status != 'pending'
	

2025/06/22 23:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.504ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:11:07.671' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:11:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.050ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:11:07.739'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:11:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[68.086ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:11:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[67.925ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:12:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.144ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:12:06.857'

2025/06/22 23:12:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[67.534ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:12:06.857'

2025/06/22 23:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[67.169ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:12:06.857'

2025/06/22 23:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[71.927ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:42:07.222'

2025/06/22 23:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.535ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:12:07.294' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.008ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.468ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.174ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:42:07.399'

2025/06/22 23:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.353ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:12:07.43' AND status != 'pending'
	

2025/06/22 23:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.758ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:12:07.46' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.697ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.330ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:12:07.497' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.679ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.509ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:12:07.565'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.208ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:12:07.584' AND status != 'pending'
	

2025/06/22 23:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.362ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:12:07.645' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.486ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:12:07.707'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:13:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.961ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:13:06.857'

2025/06/22 23:13:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.297ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:58:06.857' LIMIT 50

2025/06/22 23:13:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[56.689ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:58:06.894' LIMIT 50

2025/06/22 23:13:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.209ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:13:06.857'

2025/06/22 23:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.722ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:13:06.857'

2025/06/22 23:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.494ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:43:07.223'

2025/06/22 23:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.975ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:13:07.292' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.857ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.347ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.345ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:43:07.4'

2025/06/22 23:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.700ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:13:07.415' AND status != 'pending'
	

2025/06/22 23:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.127ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:13:07.459' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.871ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:13:07.477' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.869ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.346ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.947ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:13:07.539'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.462ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:13:07.576' AND status != 'pending'
	

2025/06/22 23:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.187ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:13:07.634' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:13:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.271ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:13:07.694'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:14:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.132ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:14:06.858'

2025/06/22 23:14:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.269ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:14:06.858'

2025/06/22 23:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.745ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:14:06.858'

2025/06/22 23:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.170ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:44:07.223'

2025/06/22 23:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.917ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:14:07.283' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.562ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.837ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.808ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:14:07.402' AND status != 'pending'
	

2025/06/22 23:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.092ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:44:07.401'

2025/06/22 23:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.908ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:14:07.464' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.025ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:14:07.464' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.732ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.853ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:14:07.523'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.966ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.815ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:14:07.588' AND status != 'pending'
	

2025/06/22 23:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.598ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:14:07.65' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:14:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.354ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:14:07.712'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:14:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.822ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:14:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.059ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:15:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.842ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:15:06.859'

2025/06/22 23:15:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.393ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:00:06.859' LIMIT 50

2025/06/22 23:15:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[68.009ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:00:06.895' LIMIT 50

2025/06/22 23:15:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.969ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:15:06.859'

2025/06/22 23:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.623ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:15:06.859'

2025/06/22 23:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.051ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:45:07.224'

2025/06/22 23:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.633ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:15:07.286' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.205ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.463ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.792ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:15:07.405' AND status != 'pending'
	

2025/06/22 23:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.014ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:45:07.401'

2025/06/22 23:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.266ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:15:07.464' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[68.101ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:15:07.469' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.499ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.603ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:15:07.527'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.834ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[68.005ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:15:07.604' AND status != 'pending'
	

2025/06/22 23:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[68.219ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:15:07.673' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:15:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[68.186ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:15:07.741'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:15:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[68.583ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:15:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[68.281ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:15:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[67.908ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:16:03 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[67.780ms] [rows:1] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:16:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[71.051ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:16:06.859'

2025/06/22 23:16:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.771ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:16:06.859'

2025/06/22 23:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[67.356ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:16:06.859'

2025/06/22 23:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[69.907ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:46:07.224'

2025/06/22 23:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.404ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:16:07.295' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.927ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.044ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.628ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:46:07.401'

2025/06/22 23:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[68.042ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:16:07.43' AND status != 'pending'
	

2025/06/22 23:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.269ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:16:07.462' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.291ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.813ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:16:07.498' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.707ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.028ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:16:07.566'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.990ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:16:07.58' AND status != 'pending'
	

2025/06/22 23:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.724ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:16:07.641' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:16:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.003ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:16:07.701'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:17:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.666ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:17:06.86'

2025/06/22 23:17:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.451ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:02:06.86' LIMIT 50

2025/06/22 23:17:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.251ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:02:06.896' LIMIT 50

2025/06/22 23:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[81.950ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:17:06.86'

2025/06/22 23:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.544ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:17:06.86'

2025/06/22 23:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.177ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:47:07.225'

2025/06/22 23:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.682ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:17:07.285' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.673ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.376ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.548ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:47:07.402'

2025/06/22 23:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.459ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:17:07.411' AND status != 'pending'
	

2025/06/22 23:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.256ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:17:07.465' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.479ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:17:07.47' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.728ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.505ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:17:07.528'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.897ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.155ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:17:07.588' AND status != 'pending'
	

2025/06/22 23:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.198ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:17:07.651' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.693ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:17:07.713'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:18:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.311ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:18:06.861'

2025/06/22 23:18:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.737ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:18:06.861'

2025/06/22 23:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.933ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:18:06.861'

2025/06/22 23:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.768ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:48:07.226'

2025/06/22 23:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.766ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:18:07.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.995ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.515ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.655ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:48:07.403'

2025/06/22 23:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.339ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:18:07.411' AND status != 'pending'
	

2025/06/22 23:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.348ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:18:07.462' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.932ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:18:07.472' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.979ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.099ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.813ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:18:07.534'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.068ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:18:07.58' AND status != 'pending'
	

2025/06/22 23:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.990ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:18:07.639' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:18:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.631ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:18:07.697'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:18:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.122ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:18:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.957ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:19:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.042ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:19:06.861'

2025/06/22 23:19:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.268ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:04:06.861' LIMIT 50

2025/06/22 23:19:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.700ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:04:06.897' LIMIT 50

2025/06/22 23:19:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.249ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:19:06.861'

2025/06/22 23:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.673ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:19:06.861'

2025/06/22 23:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.390ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:49:07.226'

2025/06/22 23:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.560ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:19:07.286' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.976ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.049ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.356ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:19:07.405' AND status != 'pending'
	

2025/06/22 23:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.674ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:49:07.404'

2025/06/22 23:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.061ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:19:07.464' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.518ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:19:07.471' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.964ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.874ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:19:07.522'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.321ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.324ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:19:07.606' AND status != 'pending'
	

2025/06/22 23:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.906ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:19:07.674' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:19:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.160ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:19:07.742'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[83.764ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:19:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[67.711ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:20:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.778ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:20:06.862'

2025/06/22 23:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[67.300ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:20:06.862'

2025/06/22 23:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[68.490ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:20:06.862'

2025/06/22 23:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.918ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:50:07.226'

2025/06/22 23:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.396ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:20:07.296' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.853ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.232ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.606ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:50:07.403'

2025/06/22 23:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.155ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:20:07.433' AND status != 'pending'
	

2025/06/22 23:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.636ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:20:07.462' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.767ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.330ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:20:07.5' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.788ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[71.174ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:20:07.568'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.564ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:20:07.581' AND status != 'pending'
	

2025/06/22 23:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.312ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:20:07.64' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.536ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:20:07.699'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:21:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.373ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:21:06.862'

2025/06/22 23:21:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.562ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:06:06.863' LIMIT 50

2025/06/22 23:21:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.620ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:06:06.898' LIMIT 50

2025/06/22 23:21:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.856ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:21:06.862'

2025/06/22 23:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.307ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:21:06.862'

2025/06/22 23:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.292ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:51:07.227'

2025/06/22 23:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.919ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:21:07.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.362ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.735ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.095ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:21:07.411' AND status != 'pending'
	

2025/06/22 23:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.885ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:51:07.405'

2025/06/22 23:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.879ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:21:07.47' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.588ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:21:07.47' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.885ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.093ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:21:07.529'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.587ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.903ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:21:07.593' AND status != 'pending'
	

2025/06/22 23:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.194ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:21:07.655' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:21:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.502ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:21:07.717'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:22:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.388ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:22:06.863'

2025/06/22 23:22:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.131ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:22:06.863'

2025/06/22 23:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.339ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:22:06.863'

2025/06/22 23:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.583ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:52:07.228'

2025/06/22 23:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.608ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:22:07.291' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.826ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.817ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.921ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:52:07.405'

2025/06/22 23:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.239ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:22:07.415' AND status != 'pending'
	

2025/06/22 23:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.566ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:22:07.465' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.891ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:22:07.476' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.161ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.464ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.630ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:22:07.538'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.096ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:22:07.583' AND status != 'pending'
	

2025/06/22 23:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.796ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:22:07.642' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:22:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.311ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:22:07.701'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:23:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.141ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:23:06.864'

2025/06/22 23:23:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.412ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:08:06.864' LIMIT 50

2025/06/22 23:23:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[68.015ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:08:06.9' LIMIT 50

2025/06/22 23:23:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.809ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:23:06.864'

2025/06/22 23:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.807ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:23:06.864'

2025/06/22 23:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.215ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:53:07.229'

2025/06/22 23:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.859ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:23:07.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.529ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.359ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.010ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:23:07.409' AND status != 'pending'
	

2025/06/22 23:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.624ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:53:07.406'

2025/06/22 23:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.529ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:23:07.469' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[71.012ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:23:07.474' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.381ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.921ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:23:07.53'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.192ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[72.661ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:23:07.614' AND status != 'pending'
	

2025/06/22 23:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[69.039ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:23:07.687' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[68.024ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:23:07.756'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:24:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[74.373ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:24:06.864'

2025/06/22 23:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[67.172ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:24:06.864'

2025/06/22 23:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[71.873ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:24:06.864'

2025/06/22 23:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[70.426ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:54:07.229'

2025/06/22 23:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.535ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:24:07.3' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.449ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.176ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.973ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:54:07.405'

2025/06/22 23:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.961ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:24:07.435' AND status != 'pending'
	

2025/06/22 23:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.441ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:24:07.465' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.556ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.333ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:24:07.503' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.323ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.788ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:24:07.57'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.634ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:24:07.584' AND status != 'pending'
	

2025/06/22 23:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.829ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:24:07.643' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.828ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:24:07.702'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:24:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.924ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:24:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.324ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:24:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.868ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:25:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.665ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:25:06.865'

2025/06/22 23:25:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.197ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:10:06.865' LIMIT 50

2025/06/22 23:25:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.305ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:10:06.9' LIMIT 50

2025/06/22 23:25:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.672ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:25:06.865'

2025/06/22 23:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.480ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:25:06.865'

2025/06/22 23:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.917ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:55:07.23'

2025/06/22 23:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.248ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:25:07.29' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.425ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.758ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.852ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:25:07.408' AND status != 'pending'
	

2025/06/22 23:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.986ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:55:07.407'

2025/06/22 23:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.534ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:25:07.469' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.288ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:25:07.469' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.444ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.248ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:25:07.528'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.367ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.661ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:25:07.593' AND status != 'pending'
	

2025/06/22 23:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.430ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:25:07.654' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.218ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:25:07.716'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:26:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.745ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:26:06.865'

2025/06/22 23:26:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.316ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:26:06.865'

2025/06/22 23:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.313ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:26:06.865'

2025/06/22 23:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.953ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:56:07.229'

2025/06/22 23:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.978ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:26:07.294' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.085ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.641ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.263ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:56:07.407'

2025/06/22 23:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.633ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:26:07.418' AND status != 'pending'
	

2025/06/22 23:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.833ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:26:07.468' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.921ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:26:07.48' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.518ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.439ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.841ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:26:07.542'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.102ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:26:07.586' AND status != 'pending'
	

2025/06/22 23:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.606ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:26:07.646' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.026ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:26:07.706'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:27:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.484ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:27:06.865'

2025/06/22 23:27:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.434ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:12:06.865' LIMIT 50

2025/06/22 23:27:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.013ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:12:06.902' LIMIT 50

2025/06/22 23:27:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.109ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:27:06.865'

2025/06/22 23:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.849ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:27:06.865'

2025/06/22 23:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.323ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:57:07.231'

2025/06/22 23:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.036ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:27:07.29' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.254ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.277ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.073ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:27:07.409' AND status != 'pending'
	

2025/06/22 23:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[70.996ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:57:07.408'

2025/06/22 23:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.218ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:27:07.468' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.994ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:27:07.479' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.978ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.574ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:27:07.526'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.762ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[68.353ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:27:07.614' AND status != 'pending'
	

2025/06/22 23:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[68.129ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:27:07.683' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.509ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:27:07.751'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:28:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[69.615ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:28:06.866'

2025/06/22 23:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[67.379ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:28:06.866'

2025/06/22 23:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[68.228ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:28:06.866'

2025/06/22 23:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.531ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:58:07.231'

2025/06/22 23:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.899ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:28:07.3' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.596ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.028ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.626ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:58:07.408'

2025/06/22 23:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.745ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:28:07.436' AND status != 'pending'
	

2025/06/22 23:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.157ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:28:07.469' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.406ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.766ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:28:07.503' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.161ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[68.398ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:28:07.571'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.210ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:28:07.587' AND status != 'pending'
	

2025/06/22 23:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.904ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:28:07.646' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.283ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:28:07.705'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:29:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.939ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:29:06.867'

2025/06/22 23:29:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[68.027ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:14:06.867' LIMIT 50

2025/06/22 23:29:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.426ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:14:06.903' LIMIT 50

2025/06/22 23:29:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.602ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:29:06.867'

2025/06/22 23:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.958ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:29:06.867'

2025/06/22 23:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.195ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:59:07.232'

2025/06/22 23:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.787ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:29:07.292' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.444ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.234ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.903ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:29:07.41' AND status != 'pending'
	

2025/06/22 23:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.088ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 22:59:07.409'

2025/06/22 23:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.672ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:29:07.469' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.772ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:29:07.47' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.869ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.678ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:29:07.529'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.684ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.062ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:29:07.595' AND status != 'pending'
	

2025/06/22 23:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.943ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:29:07.657' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.231ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:29:07.719'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:30:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.557ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:30:06.867'

2025/06/22 23:30:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.486ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:30:06.867'

2025/06/22 23:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.353ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:30:06.867'

2025/06/22 23:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.162ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:00:07.232'

2025/06/22 23:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.154ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:30:07.294' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.754ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.825ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.468ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:00:07.41'

2025/06/22 23:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.706ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:30:07.418' AND status != 'pending'
	

2025/06/22 23:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.362ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:30:07.468' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.455ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:30:07.48' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.353ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.323ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.409ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:30:07.542'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.993ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:30:07.587' AND status != 'pending'
	

2025/06/22 23:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.863ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:30:07.646' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.830ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:30:07.705'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:31:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.189ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:16:06.868' LIMIT 50

2025/06/22 23:31:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.045ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:31:06.867'

2025/06/22 23:31:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.429ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:16:06.904' LIMIT 50

2025/06/22 23:31:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.855ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:31:06.867'

2025/06/22 23:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.902ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:31:06.867'

2025/06/22 23:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.649ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:01:07.233'

2025/06/22 23:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.213ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:31:07.296' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.136ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.388ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.342ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:01:07.41'

2025/06/22 23:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.755ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:31:07.421' AND status != 'pending'
	

2025/06/22 23:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.536ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:31:07.483' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.918ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:31:07.479' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.251ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.832ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:31:07.544'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.505ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.999ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:31:07.613' AND status != 'pending'
	

2025/06/22 23:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[68.014ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:31:07.68' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.284ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:31:07.748'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:32:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[73.508ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:32:06.868'

2025/06/22 23:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[67.541ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:32:06.868'

2025/06/22 23:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[68.240ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:32:06.868'

2025/06/22 23:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.961ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:02:07.234'

2025/06/22 23:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.782ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:32:07.302' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.777ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.465ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.863ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:02:07.411'

2025/06/22 23:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[71.895ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:32:07.438' AND status != 'pending'
	

2025/06/22 23:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.489ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:32:07.477' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.545ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.563ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:32:07.51' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.323ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.458ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:32:07.578'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.554ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:32:07.599' AND status != 'pending'
	

2025/06/22 23:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.836ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:32:07.661' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.128ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:32:07.723'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:33:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.144ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:33:06.869'

2025/06/22 23:33:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[68.821ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:18:06.869' LIMIT 50

2025/06/22 23:33:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.805ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:18:06.905' LIMIT 50

2025/06/22 23:33:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.152ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:33:06.869'

2025/06/22 23:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.949ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:33:06.869'

2025/06/22 23:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.790ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:03:07.234'

2025/06/22 23:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.780ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:33:07.296' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.725ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.892ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.973ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:03:07.411'

2025/06/22 23:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.294ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:33:07.42' AND status != 'pending'
	

2025/06/22 23:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.953ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:33:07.471' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.973ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:33:07.482' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.535ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.390ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.867ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:33:07.544'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.412ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:33:07.59' AND status != 'pending'
	

2025/06/22 23:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.057ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:33:07.65' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.845ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:33:07.709'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:34:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.972ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:34:06.869'

2025/06/22 23:34:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.875ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:34:06.869'

2025/06/22 23:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.737ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:34:06.869'

2025/06/22 23:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.203ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:04:07.235'

2025/06/22 23:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.728ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:34:07.294' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.285ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.797ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.593ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:34:07.412' AND status != 'pending'
	

2025/06/22 23:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.339ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:04:07.412'

2025/06/22 23:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.423ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:34:07.473' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.721ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:34:07.474' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.749ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.650ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:34:07.532'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.419ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.559ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:34:07.597' AND status != 'pending'
	

2025/06/22 23:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.375ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:34:07.658' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.826ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:34:07.72'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:35:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.702ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:20:06.87' LIMIT 50

2025/06/22 23:35:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.088ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:35:06.87'

2025/06/22 23:35:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.709ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:20:06.906' LIMIT 50

2025/06/22 23:35:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.297ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:35:06.87'

2025/06/22 23:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.345ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:35:06.87'

2025/06/22 23:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.989ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:05:07.235'

2025/06/22 23:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.784ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:35:07.297' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.394ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.964ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.585ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:05:07.412'

2025/06/22 23:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.821ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:35:07.421' AND status != 'pending'
	

2025/06/22 23:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[69.540ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:35:07.482' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[68.528ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:35:07.483' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.263ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.263ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:35:07.552'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.128ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.799ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:35:07.618' AND status != 'pending'
	

2025/06/22 23:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.637ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:35:07.686' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.792ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:35:07.754'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:35:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[71.658ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/22 23:36:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[73.262ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:36:06.871'

2025/06/22 23:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[67.872ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:36:06.871'

2025/06/22 23:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[67.516ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:36:06.871'

2025/06/22 23:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[69.844ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:06:07.236'

2025/06/22 23:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.816ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:36:07.306' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.586ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.347ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.299ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:06:07.413'

2025/06/22 23:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.010ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:36:07.442' AND status != 'pending'
	

2025/06/22 23:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.578ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:36:07.473' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.845ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.403ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:36:07.509' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.819ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.045ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:36:07.577'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.378ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:36:07.597' AND status != 'pending'
	

2025/06/22 23:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.391ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:36:07.659' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.771ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:36:07.721'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:37:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.492ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:37:06.871'

2025/06/22 23:37:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.735ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:22:06.871' LIMIT 50

2025/06/22 23:37:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.466ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:22:06.907' LIMIT 50

2025/06/22 23:37:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.836ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:37:06.871'

2025/06/22 23:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.686ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:37:06.871'

2025/06/22 23:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.762ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:07:07.236'

2025/06/22 23:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.654ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:37:07.298' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.229ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.856ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.992ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:07:07.413'

2025/06/22 23:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.858ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:37:07.422' AND status != 'pending'
	

2025/06/22 23:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.115ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:37:07.472' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.928ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:37:07.484' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.197ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.806ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.388ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:37:07.546'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.733ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:37:07.591' AND status != 'pending'
	

2025/06/22 23:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.363ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:37:07.65' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.036ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:37:07.709'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:38:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.330ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:38:06.872'

2025/06/22 23:38:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.948ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:38:06.872'

2025/06/22 23:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.892ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:38:06.872'

2025/06/22 23:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.059ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:08:07.237'

2025/06/22 23:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.749ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:38:07.296' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.268ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.687ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.602ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:38:07.415' AND status != 'pending'
	

2025/06/22 23:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.427ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:08:07.414'

2025/06/22 23:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.832ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:38:07.474' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.405ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:38:07.477' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.412ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.801ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:38:07.533'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.857ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.175ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:38:07.6' AND status != 'pending'
	

2025/06/22 23:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.733ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:38:07.661' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.832ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:38:07.723'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:39:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.481ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:24:06.872' LIMIT 50

2025/06/22 23:39:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.697ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:39:06.872'

2025/06/22 23:39:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.033ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:24:06.908' LIMIT 50

2025/06/22 23:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.622ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:39:06.872'

2025/06/22 23:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.778ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:39:06.872'

2025/06/22 23:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.796ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:09:07.237'

2025/06/22 23:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.157ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:39:07.299' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.428ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.908ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.235ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:09:07.415'

2025/06/22 23:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.291ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:39:07.424' AND status != 'pending'
	

2025/06/22 23:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.110ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:39:07.486' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[69.479ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:39:07.483' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.832ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.112ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:39:07.55'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.867ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.964ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:39:07.621' AND status != 'pending'
	

2025/06/22 23:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[68.391ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:39:07.689' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.823ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:39:07.758'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:40:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.430ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-22 23:40:06.873'

2025/06/22 23:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[67.595ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-22 23:40:06.873'

2025/06/22 23:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[67.809ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-21 23:40:06.873'

2025/06/22 23:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.500ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:10:07.238'

2025/06/22 23:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.695ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:40:07.306' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.417ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.799ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.654ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-22 23:10:07.415'

2025/06/22 23:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.629ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:40:07.442' AND status != 'pending'
	

2025/06/22 23:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.010ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-22 22:40:07.476' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/22 23:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.582ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/22 23:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[68.080ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:40:07.51' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.781ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/22 23:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.347ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:40:07.578'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/22 23:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.412ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-22 22:40:07.6' AND status != 'pending'
	

2025/06/22 23:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.002ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-22 22:40:07.661' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/22 23:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.861ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-22 22:40:07.723'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	
