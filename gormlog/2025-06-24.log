
2025/06/24 20:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.056ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 19:53:07.283'

2025/06/24 20:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.506ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:23:07.349' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.798ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.817ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[191.477ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 19:53:07.32'

2025/06/24 20:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.923ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:23:07.472' AND status != 'pending'
	

2025/06/24 20:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.869ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:23:07.511' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.486ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:23:07.535' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.434ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.145ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.545ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:23:07.597'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.815ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:23:07.635' AND status != 'pending'
	

2025/06/24 20:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.272ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:23:07.696' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.797ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:23:07.759'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.793ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:24:07.284'

2025/06/24 20:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.312ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:24:07.284'

2025/06/24 20:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.710ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:24:07.284'

2025/06/24 20:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.953ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 19:54:07.659'

2025/06/24 20:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.797ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:24:07.721' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.632ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.927ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.774ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 19:54:07.819'

2025/06/24 20:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.642ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:24:07.845' AND status != 'pending'
	

2025/06/24 20:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.819ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:24:07.881' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.634ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:24:07.907' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:24:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.863ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:24:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.999ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:24:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.402ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:24:07.969'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:24:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.926ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:24:08.005' AND status != 'pending'
	

2025/06/24 20:24:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.294ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:24:08.067' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:24:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.729ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:24:08.131'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.141ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:25:07.281'

2025/06/24 20:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.276ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:10:07.279' LIMIT 50

2025/06/24 20:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.947ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:25:07.281'

2025/06/24 20:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.209ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:25:07.281'

2025/06/24 20:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[182.838ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:10:07.316' LIMIT 50

2025/06/24 20:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.188ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 19:55:07.657'

2025/06/24 20:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.756ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:25:07.717' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.546ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.660ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.435ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 19:55:07.817'

2025/06/24 20:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.593ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:25:07.835' AND status != 'pending'
	

2025/06/24 20:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.111ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:25:07.88' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.317ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:25:07.894' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:25:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.052ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:25:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.656ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:25:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.480ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:25:07.953'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:25:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.662ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:25:08.004' AND status != 'pending'
	

2025/06/24 20:25:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.940ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:25:08.066' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:25:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.229ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:25:08.128'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.928ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:26:07.279'

2025/06/24 20:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.033ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:26:07.279'

2025/06/24 20:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.490ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:26:07.279'

2025/06/24 20:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.350ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 19:56:07.655'

2025/06/24 20:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.000ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:26:07.719' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.706ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.996ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.175ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 19:56:07.815'

2025/06/24 20:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.979ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:26:07.844' AND status != 'pending'
	

2025/06/24 20:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.203ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:26:07.874' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.789ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.562ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:26:07.907' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:26:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.398ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:26:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.543ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:26:07.967'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:26:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.191ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:26:07.995' AND status != 'pending'
	

2025/06/24 20:26:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.128ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:26:08.054' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:26:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.482ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:26:08.114'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.689ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:12:07.275' LIMIT 50

2025/06/24 20:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.347ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:27:07.277'

2025/06/24 20:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.403ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:12:07.312' LIMIT 50

2025/06/24 20:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.577ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:27:07.277'

2025/06/24 20:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.997ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:27:07.277'

2025/06/24 20:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.135ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 19:57:07.652'

2025/06/24 20:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.999ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:27:07.715' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.869ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.287ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.169ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 19:57:07.813'

2025/06/24 20:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.761ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:27:07.84' AND status != 'pending'
	

2025/06/24 20:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.454ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:27:07.874' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.060ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:27:07.902' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.433ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.093ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:27:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.530ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:27:07.964'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:27:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.141ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:27:07.996' AND status != 'pending'
	

2025/06/24 20:27:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.154ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:27:08.057' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:27:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.831ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:27:08.119'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.667ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:28:07.275'

2025/06/24 20:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.603ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:28:07.275'

2025/06/24 20:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.241ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:28:07.275'

2025/06/24 20:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.836ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 19:58:07.652'

2025/06/24 20:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.349ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:28:07.715' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.967ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.488ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.079ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 19:58:07.811'

2025/06/24 20:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.284ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:28:07.839' AND status != 'pending'
	

2025/06/24 20:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.557ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:28:07.872' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.261ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:28:07.902' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.326ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:28:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.395ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:28:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.856ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:28:07.963'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:28:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.290ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:28:07.995' AND status != 'pending'
	

2025/06/24 20:28:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.834ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:28:08.057' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:28:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.733ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:28:08.119'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.226ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:14:07.27' LIMIT 50

2025/06/24 20:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.434ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:29:07.273'

2025/06/24 20:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.460ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:14:07.308' LIMIT 50

2025/06/24 20:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.090ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:29:07.273'

2025/06/24 20:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.895ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:29:07.273'

2025/06/24 20:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.586ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 19:59:07.65'

2025/06/24 20:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.835ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:29:07.714' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.300ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.551ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.683ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 19:59:07.809'

2025/06/24 20:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.845ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:29:07.839' AND status != 'pending'
	

2025/06/24 20:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.721ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:29:07.868' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.176ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.304ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:29:07.9' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:29:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.516ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:29:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.721ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:29:07.961'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:29:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.767ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:29:07.986' AND status != 'pending'
	

2025/06/24 20:29:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.947ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:29:08.044' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:29:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.672ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:29:08.104'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.802ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:30:07.271'

2025/06/24 20:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.943ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:30:07.271'

2025/06/24 20:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.940ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:30:07.271'

2025/06/24 20:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.355ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:00:07.647'

2025/06/24 20:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.312ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:30:07.709' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.253ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.628ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.688ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:00:07.808'

2025/06/24 20:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.299ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:30:07.828' AND status != 'pending'
	

2025/06/24 20:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.175ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:30:07.87' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.890ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:30:07.887' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.891ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.237ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:30:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.802ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:30:07.945'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:30:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.873ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:30:07.994' AND status != 'pending'
	

2025/06/24 20:30:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.994ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:30:08.056' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:30:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.849ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:30:08.119'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.124ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:31:07.269'

2025/06/24 20:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.199ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:16:07.266' LIMIT 50

2025/06/24 20:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.052ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:16:07.304' LIMIT 50

2025/06/24 20:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.416ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:31:07.269'

2025/06/24 20:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.042ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:31:07.269'

2025/06/24 20:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.956ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:01:07.645'

2025/06/24 20:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.413ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:31:07.706' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.322ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.536ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.650ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:01:07.806'

2025/06/24 20:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.895ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:31:07.823' AND status != 'pending'
	

2025/06/24 20:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.820ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:31:07.869' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.351ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:31:07.881' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.975ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.768ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:31:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.840ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:31:07.94'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:31:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.603ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:31:07.993' AND status != 'pending'
	

2025/06/24 20:31:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.036ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:31:08.055' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:31:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.884ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:31:08.119'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.131ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:32:07.267'

2025/06/24 20:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.232ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:32:07.267'

2025/06/24 20:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.457ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:32:07.267'

2025/06/24 20:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.041ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:02:07.643'

2025/06/24 20:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.101ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:32:07.706' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.569ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.217ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.156ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:02:07.803'

2025/06/24 20:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.285ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:32:07.83' AND status != 'pending'
	

2025/06/24 20:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.164ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:32:07.861' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.008ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.456ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:32:07.892' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:32:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.492ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:32:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.866ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:32:07.952'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:32:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.622ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:32:07.98' AND status != 'pending'
	

2025/06/24 20:32:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.967ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:32:08.038' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:32:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.297ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:32:08.097'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.921ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:18:07.263' LIMIT 50

2025/06/24 20:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.136ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:33:07.265'

2025/06/24 20:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.099ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:18:07.299' LIMIT 50

2025/06/24 20:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.081ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:33:07.265'

2025/06/24 20:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.926ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:33:07.265'

2025/06/24 20:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.558ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:03:07.64'

2025/06/24 20:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.130ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:33:07.703' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.808ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.593ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.764ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:03:07.801'

2025/06/24 20:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.266ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:33:07.828' AND status != 'pending'
	

2025/06/24 20:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.108ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:33:07.862' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.808ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:33:07.891' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.898ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:33:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.768ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:33:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.483ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:33:07.953'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:33:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.964ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:33:07.984' AND status != 'pending'
	

2025/06/24 20:33:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.804ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:33:08.046' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:33:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.022ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:33:08.109'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.082ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:34:07.312'

2025/06/24 20:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.243ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:34:07.312'

2025/06/24 20:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.372ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:34:07.312'

2025/06/24 20:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.739ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:04:07.689'

2025/06/24 20:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.191ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:34:07.752' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.104ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.221ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.698ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:04:07.849'

2025/06/24 20:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.521ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:34:07.878' AND status != 'pending'
	

2025/06/24 20:34:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.689ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:34:07.91' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:34:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.212ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:34:07.943' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:34:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.019ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:34:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.292ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:34:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.660ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:34:08.006'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:34:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.939ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:34:08.039' AND status != 'pending'
	

2025/06/24 20:34:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.821ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:34:08.101' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:34:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.405ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:34:08.164'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:35:01 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[69.712ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 20:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.226ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:20:07.313' LIMIT 50

2025/06/24 20:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.992ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:35:07.316'

2025/06/24 20:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.034ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:20:07.351' LIMIT 50

2025/06/24 20:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.338ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:35:07.316'

2025/06/24 20:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.884ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:35:07.316'

2025/06/24 20:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.892ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:05:07.692'

2025/06/24 20:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.895ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:35:07.755' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.267ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.960ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.131ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:05:07.851'

2025/06/24 20:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.066ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:35:07.881' AND status != 'pending'
	

2025/06/24 20:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.832ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:35:07.909' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:35:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.510ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:35:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.856ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:35:07.942' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:35:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.431ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:35:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.608ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:35:08.003'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:35:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.343ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:35:08.027' AND status != 'pending'
	

2025/06/24 20:35:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.992ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:35:08.085' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:35:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.506ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:35:08.144'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.007ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:36:07.316'

2025/06/24 20:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.714ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:36:07.316'

2025/06/24 20:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.391ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:36:07.316'

2025/06/24 20:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.951ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:06:07.693'

2025/06/24 20:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.227ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:36:07.754' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.168ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.362ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.538ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:06:07.853'

2025/06/24 20:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.182ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:36:07.871' AND status != 'pending'
	

2025/06/24 20:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.056ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:36:07.915' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:36:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.879ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:36:07.93' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:36:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.525ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:36:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.857ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:36:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.745ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:36:07.989'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:36:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.968ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:36:08.039' AND status != 'pending'
	

2025/06/24 20:36:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.880ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:36:08.101' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:36:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.852ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:36:08.163'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:36:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[68.129ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 20:36:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[66.841ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 20:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.423ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:22:07.315' LIMIT 50

2025/06/24 20:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.818ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:37:07.318'

2025/06/24 20:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.593ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:22:07.352' LIMIT 50

2025/06/24 20:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.667ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:37:07.318'

2025/06/24 20:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.607ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:37:07.318'

2025/06/24 20:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.499ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:07:07.694'

2025/06/24 20:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.501ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:37:07.758' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.629ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.104ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.297ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:07:07.853'

2025/06/24 20:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.682ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:37:07.882' AND status != 'pending'
	

2025/06/24 20:37:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.431ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:37:07.914' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:37:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.616ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:37:07.944' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:37:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.425ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:37:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.771ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:37:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.915ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:37:08.009'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:37:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.699ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:37:08.04' AND status != 'pending'
	

2025/06/24 20:37:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.569ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:37:08.102' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:37:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.898ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:37:08.164'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.560ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:38:07.318'

2025/06/24 20:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.767ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:38:07.318'

2025/06/24 20:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.019ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:38:07.318'

2025/06/24 20:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.079ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:08:07.694'

2025/06/24 20:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.167ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:38:07.756' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.012ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.059ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.948ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:08:07.854'

2025/06/24 20:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.010ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:38:07.881' AND status != 'pending'
	

2025/06/24 20:38:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.969ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:38:07.915' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:38:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.433ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:38:07.943' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:38:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.379ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:38:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.147ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:38:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.217ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:38:08.005'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:38:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.721ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:38:08.038' AND status != 'pending'
	

2025/06/24 20:38:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.912ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:38:08.1' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:38:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.006ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:38:08.162'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.439ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:39:07.318'

2025/06/24 20:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[68.714ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:24:07.317' LIMIT 50

2025/06/24 20:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.249ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:24:07.354' LIMIT 50

2025/06/24 20:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.339ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:39:07.318'

2025/06/24 20:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.817ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:39:07.318'

2025/06/24 20:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.100ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:09:07.695'

2025/06/24 20:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.004ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:39:07.757' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.750ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.832ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.537ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:09:07.855'

2025/06/24 20:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.420ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:39:07.881' AND status != 'pending'
	

2025/06/24 20:39:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.475ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:39:07.912' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:39:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.048ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:39:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.399ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:39:07.943' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:39:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.329ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:39:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.078ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:39:08.005'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:39:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.851ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:39:08.03' AND status != 'pending'
	

2025/06/24 20:39:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.397ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:39:08.089' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:39:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.368ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:39:08.147'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.296ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:40:07.319'

2025/06/24 20:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.020ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:40:07.319'

2025/06/24 20:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.304ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:40:07.319'

2025/06/24 20:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.566ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:10:07.696'

2025/06/24 20:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.592ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:40:07.756' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.175ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.086ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.300ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:10:07.856'

2025/06/24 20:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.861ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:40:07.873' AND status != 'pending'
	

2025/06/24 20:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.938ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:40:07.918' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:40:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.829ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:40:07.932' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:40:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.082ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:40:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.832ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:40:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.654ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:40:07.991'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:40:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.881ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:40:08.042' AND status != 'pending'
	

2025/06/24 20:40:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[78.995ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:40:08.104' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:40:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.648ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:40:08.183'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.368ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:26:07.318' LIMIT 50

2025/06/24 20:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.781ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:41:07.32'

2025/06/24 20:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.323ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:26:07.355' LIMIT 50

2025/06/24 20:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.436ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:41:07.32'

2025/06/24 20:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.192ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:41:07.32'

2025/06/24 20:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.165ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:11:07.697'

2025/06/24 20:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.111ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:41:07.756' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.551ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.230ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.357ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:11:07.856'

2025/06/24 20:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.106ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:41:07.875' AND status != 'pending'
	

2025/06/24 20:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.972ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:41:07.918' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:41:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.852ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:41:07.933' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:41:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.214ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:41:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.851ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:41:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.347ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:41:07.991'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:41:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.131ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:41:08.042' AND status != 'pending'
	

2025/06/24 20:41:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.250ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:41:08.105' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:41:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.059ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:41:08.167'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.677ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:42:07.321'

2025/06/24 20:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.997ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:42:07.321'

2025/06/24 20:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.974ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:42:07.321'

2025/06/24 20:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.354ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:12:07.697'

2025/06/24 20:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.169ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:42:07.761' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.818ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.070ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.239ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:12:07.857'

2025/06/24 20:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.774ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:42:07.887' AND status != 'pending'
	

2025/06/24 20:42:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.915ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:42:07.915' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:42:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.848ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:42:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.194ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:42:07.949' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:42:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.412ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:42:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.388ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:42:08.01'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:42:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.090ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:42:08.037' AND status != 'pending'
	

2025/06/24 20:42:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.828ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:42:08.099' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:42:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.867ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:42:08.158'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.689ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:28:07.321' LIMIT 50

2025/06/24 20:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.693ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:43:07.321'

2025/06/24 20:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.636ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:28:07.357' LIMIT 50

2025/06/24 20:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.771ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:43:07.321'

2025/06/24 20:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.461ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:43:07.321'

2025/06/24 20:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.082ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:13:07.698'

2025/06/24 20:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.015ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:43:07.761' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.977ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.168ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.699ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:13:07.858'

2025/06/24 20:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.116ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:43:07.885' AND status != 'pending'
	

2025/06/24 20:43:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.946ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:43:07.92' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:43:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.987ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:43:07.948' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:43:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.345ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:43:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.519ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:43:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.487ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:43:08.01'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:43:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.121ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:43:08.044' AND status != 'pending'
	

2025/06/24 20:43:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.995ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:43:08.105' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:43:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.710ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:43:08.167'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.859ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:44:07.322'

2025/06/24 20:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.767ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:44:07.322'

2025/06/24 20:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.359ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:44:07.322'

2025/06/24 20:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.839ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:14:07.699'

2025/06/24 20:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.663ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:44:07.762' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.058ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.089ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.270ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:14:07.859'

2025/06/24 20:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.094ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:44:07.887' AND status != 'pending'
	

2025/06/24 20:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.593ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:44:07.92' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:44:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.105ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:44:07.949' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:44:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.459ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:44:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.942ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:44:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.676ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:44:08.01'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:44:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.639ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:44:08.044' AND status != 'pending'
	

2025/06/24 20:44:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.163ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:44:08.106' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:44:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.143ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:44:08.168'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.936ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:30:07.321' LIMIT 50

2025/06/24 20:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.406ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:45:07.323'

2025/06/24 20:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.646ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:30:07.358' LIMIT 50

2025/06/24 20:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.682ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:45:07.323'

2025/06/24 20:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.341ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:45:07.323'

2025/06/24 20:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.483ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:15:07.7'

2025/06/24 20:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.883ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:45:07.762' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.061ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.673ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.701ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:15:07.859'

2025/06/24 20:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.011ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:45:07.886' AND status != 'pending'
	

2025/06/24 20:45:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.394ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:45:07.917' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:45:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.014ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:45:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.400ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:45:07.948' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:45:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.301ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:45:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.829ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:45:08.009'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:45:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.838ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:45:08.034' AND status != 'pending'
	

2025/06/24 20:45:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.349ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:45:08.093' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:45:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.177ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:45:08.153'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.508ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:46:07.324'

2025/06/24 20:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.182ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:46:07.324'

2025/06/24 20:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.947ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:46:07.324'

2025/06/24 20:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.416ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:16:07.7'

2025/06/24 20:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.674ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:46:07.761' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.205ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.787ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.760ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:16:07.86'

2025/06/24 20:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.605ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:46:07.879' AND status != 'pending'
	

2025/06/24 20:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.471ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:46:07.922' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:46:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.345ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:46:07.938' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:46:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.823ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:46:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.854ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:46:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.559ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:46:07.995'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:46:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.923ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:46:08.045' AND status != 'pending'
	

2025/06/24 20:46:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.905ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:46:08.107' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:46:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.977ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:46:08.171'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.060ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:47:07.324'

2025/06/24 20:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.946ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:32:07.323' LIMIT 50

2025/06/24 20:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.102ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:32:07.359' LIMIT 50

2025/06/24 20:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.564ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:47:07.324'

2025/06/24 20:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.194ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:47:07.324'

2025/06/24 20:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.567ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:17:07.701'

2025/06/24 20:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.187ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:47:07.762' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.891ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.081ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.936ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:17:07.861'

2025/06/24 20:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.116ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:47:07.88' AND status != 'pending'
	

2025/06/24 20:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.707ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:47:07.924' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.229ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:47:07.939' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:47:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.900ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:47:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.262ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:47:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.912ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:47:07.997'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:47:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.162ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:47:08.048' AND status != 'pending'
	

2025/06/24 20:47:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.741ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:47:08.11' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:47:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.614ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:47:08.172'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.534ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:48:07.325'

2025/06/24 20:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.355ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:48:07.325'

2025/06/24 20:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.755ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:48:07.325'

2025/06/24 20:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.263ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:18:07.702'

2025/06/24 20:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.729ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:48:07.764' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.759ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.592ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.994ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:18:07.862'

2025/06/24 20:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.425ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:48:07.889' AND status != 'pending'
	

2025/06/24 20:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.139ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:48:07.92' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:48:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.390ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:48:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.198ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:48:07.95' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:48:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.478ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:48:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.878ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:48:08.011'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:48:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.729ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:48:08.037' AND status != 'pending'
	

2025/06/24 20:48:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.089ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:48:08.097' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:48:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.529ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:48:08.156'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.697ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:34:07.324' LIMIT 50

2025/06/24 20:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.274ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:49:07.326'

2025/06/24 20:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.484ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:34:07.361' LIMIT 50

2025/06/24 20:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.167ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:49:07.326'

2025/06/24 20:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.064ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:49:07.326'

2025/06/24 20:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.357ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:19:07.703'

2025/06/24 20:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.788ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:49:07.765' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.859ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.213ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.520ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:19:07.862'

2025/06/24 20:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.383ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:49:07.893' AND status != 'pending'
	

2025/06/24 20:49:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.720ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:49:07.924' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:49:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.790ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:49:07.954' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:49:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.766ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:49:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.977ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:49:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.165ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:49:08.019'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:49:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.078ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:49:08.051' AND status != 'pending'
	

2025/06/24 20:49:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.891ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:49:08.114' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:49:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.599ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:49:08.176'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.814ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:50:07.327'

2025/06/24 20:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.456ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:50:07.327'

2025/06/24 20:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.271ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:50:07.327'

2025/06/24 20:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.385ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:20:07.704'

2025/06/24 20:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.267ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:50:07.767' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.887ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.977ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.830ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:20:07.863'

2025/06/24 20:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.586ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:50:07.891' AND status != 'pending'
	

2025/06/24 20:50:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.585ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:50:07.924' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:50:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.987ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:50:07.953' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:50:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.521ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:50:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.395ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:50:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.654ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:50:08.014'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:50:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.468ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:50:08.049' AND status != 'pending'
	

2025/06/24 20:50:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.003ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:50:08.11' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:50:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.094ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:50:08.172'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.324ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:51:07.327'

2025/06/24 20:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.093ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:36:07.327' LIMIT 50

2025/06/24 20:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.492ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:36:07.362' LIMIT 50

2025/06/24 20:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.589ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:51:07.327'

2025/06/24 20:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.963ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:51:07.327'

2025/06/24 20:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.730ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:21:07.704'

2025/06/24 20:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.010ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:51:07.767' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.346ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.800ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.942ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:21:07.864'

2025/06/24 20:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.138ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:51:07.892' AND status != 'pending'
	

2025/06/24 20:51:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.693ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:51:07.922' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:51:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.448ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:51:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.266ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:51:07.953' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:51:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.333ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:51:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.343ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:51:08.015'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:51:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.827ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:51:08.04' AND status != 'pending'
	

2025/06/24 20:51:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.974ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:51:08.099' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:51:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.243ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:51:08.158'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.145ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:52:07.328'

2025/06/24 20:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.795ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:52:07.328'

2025/06/24 20:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.233ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:52:07.328'

2025/06/24 20:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.779ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:22:07.706'

2025/06/24 20:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.247ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:52:07.766' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.287ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.876ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.541ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:22:07.866'

2025/06/24 20:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.669ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:52:07.885' AND status != 'pending'
	

2025/06/24 20:52:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.051ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:52:07.929' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:52:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.465ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:52:07.944' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:52:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.079ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:52:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.363ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:52:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.636ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:52:08.002'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:52:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.872ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:52:08.054' AND status != 'pending'
	

2025/06/24 20:52:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.656ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:52:08.116' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:52:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.122ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:52:08.179'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.897ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:38:07.327' LIMIT 50

2025/06/24 20:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.596ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:53:07.329'

2025/06/24 20:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.878ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:38:07.365' LIMIT 50

2025/06/24 20:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.458ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:53:07.329'

2025/06/24 20:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.246ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:53:07.329'

2025/06/24 20:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.385ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:23:07.706'

2025/06/24 20:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.534ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:53:07.767' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.227ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.334ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.332ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:23:07.866'

2025/06/24 20:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.327ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:53:07.886' AND status != 'pending'
	

2025/06/24 20:53:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.276ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:53:07.927' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:53:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.749ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:53:07.945' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:53:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.282ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:53:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.866ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:53:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.836ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:53:08.003'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:53:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.222ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:53:08.051' AND status != 'pending'
	

2025/06/24 20:53:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.090ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:53:08.113' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:53:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.716ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:53:08.176'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.224ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:54:07.33'

2025/06/24 20:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.352ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:54:07.33'

2025/06/24 20:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.685ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:54:07.33'

2025/06/24 20:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.586ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:24:07.707'

2025/06/24 20:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.851ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:54:07.77' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.821ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.791ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.749ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:24:07.866'

2025/06/24 20:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.190ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:54:07.894' AND status != 'pending'
	

2025/06/24 20:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.119ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:54:07.925' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:54:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.866ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:54:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.262ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:54:07.955' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:54:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.720ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:54:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.885ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:54:08.018'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:54:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.914ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:54:08.044' AND status != 'pending'
	

2025/06/24 20:54:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.450ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:54:08.103' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:54:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.083ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:54:08.163'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.485ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:40:07.328' LIMIT 50

2025/06/24 20:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.448ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:55:07.33'

2025/06/24 20:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.686ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:40:07.365' LIMIT 50

2025/06/24 20:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.046ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:55:07.33'

2025/06/24 20:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.848ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:55:07.33'

2025/06/24 20:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.943ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:25:07.707'

2025/06/24 20:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.273ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:55:07.77' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.571ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.165ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.383ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:25:07.867'

2025/06/24 20:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.544ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:55:07.894' AND status != 'pending'
	

2025/06/24 20:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.870ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:55:07.928' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:55:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.121ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:55:07.956' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:55:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.275ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:55:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.903ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:55:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.780ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:55:08.018'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:55:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.201ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:55:08.051' AND status != 'pending'
	

2025/06/24 20:55:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.261ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:55:08.113' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:55:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.672ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:55:08.175'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.480ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:56:07.331'

2025/06/24 20:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.528ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:56:07.331'

2025/06/24 20:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.984ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:56:07.331'

2025/06/24 20:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.969ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:26:07.708'

2025/06/24 20:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.837ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:56:07.77' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.944ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.095ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.652ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:26:07.867'

2025/06/24 20:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.084ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:56:07.895' AND status != 'pending'
	

2025/06/24 20:56:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.912ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:56:07.929' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:56:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.255ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:56:07.958' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:56:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.058ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:56:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.604ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:56:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.993ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:56:08.019'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:56:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.834ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:56:08.052' AND status != 'pending'
	

2025/06/24 20:56:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.955ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:56:08.114' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:56:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.666ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:56:08.176'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.289ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:42:07.33' LIMIT 50

2025/06/24 20:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.279ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:57:07.332'

2025/06/24 20:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.992ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:42:07.367' LIMIT 50

2025/06/24 20:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.151ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:57:07.332'

2025/06/24 20:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.786ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:57:07.332'

2025/06/24 20:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.491ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:27:07.708'

2025/06/24 20:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.704ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:57:07.772' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.216ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.726ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.298ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:27:07.868'

2025/06/24 20:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.312ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:57:07.897' AND status != 'pending'
	

2025/06/24 20:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.482ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:57:07.927' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:57:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.187ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:57:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.067ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:57:07.958' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:57:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.520ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:57:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.830ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:57:08.021'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:57:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.753ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:57:08.044' AND status != 'pending'
	

2025/06/24 20:57:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.981ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:57:08.103' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:57:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.368ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:57:08.162'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.491ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:58:07.333'

2025/06/24 20:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.803ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:58:07.333'

2025/06/24 20:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.025ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:58:07.333'

2025/06/24 20:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.881ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:28:07.709'

2025/06/24 20:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.364ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:58:07.769' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.891ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.388ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.448ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:28:07.869'

2025/06/24 20:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.974ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:58:07.894' AND status != 'pending'
	

2025/06/24 20:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.666ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:58:07.931' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:58:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.797ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:58:07.953' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:58:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.735ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:58:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.047ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:58:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.463ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:58:08.012'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:58:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.900ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:58:08.055' AND status != 'pending'
	

2025/06/24 20:58:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.078ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:58:08.117' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:58:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.346ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:58:08.179'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.641ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 20:59:07.333'

2025/06/24 20:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.630ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:44:07.332' LIMIT 50

2025/06/24 20:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.612ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:44:07.368' LIMIT 50

2025/06/24 20:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.014ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 20:59:07.333'

2025/06/24 20:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.896ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 20:59:07.333'

2025/06/24 20:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.352ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:29:07.71'

2025/06/24 20:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.708ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:59:07.77' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.115ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.519ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.477ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:29:07.87'

2025/06/24 20:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.102ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:59:07.888' AND status != 'pending'
	

2025/06/24 20:59:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.380ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 19:59:07.932' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 20:59:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.200ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:59:07.947' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:59:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.270ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 20:59:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.329ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 20:59:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.255ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:59:08.005'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 20:59:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.802ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 19:59:08.056' AND status != 'pending'
	

2025/06/24 20:59:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.931ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 19:59:08.118' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 20:59:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.003ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 19:59:08.181'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.690ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:00:07.334'

2025/06/24 21:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.426ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:00:07.334'

2025/06/24 21:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.344ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:00:07.334'

2025/06/24 21:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.351ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:30:07.71'

2025/06/24 21:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.973ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:00:07.773' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.228ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.041ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.298ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:30:07.871'

2025/06/24 21:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.868ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:00:07.898' AND status != 'pending'
	

2025/06/24 21:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.608ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:00:07.928' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:00:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.320ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:00:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.540ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:00:07.959' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:00:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.193ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:00:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.712ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:00:08.02'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:00:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.218ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:00:08.046' AND status != 'pending'
	

2025/06/24 21:00:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.883ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:00:08.105' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:00:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.878ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:00:08.164'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.162ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:46:07.332' LIMIT 50

2025/06/24 21:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.818ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:01:07.335'

2025/06/24 21:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.271ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:46:07.37' LIMIT 50

2025/06/24 21:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.278ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:01:07.335'

2025/06/24 21:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.264ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:01:07.335'

2025/06/24 21:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.786ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:31:07.711'

2025/06/24 21:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.815ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:01:07.774' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.758ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.754ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.432ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:31:07.871'

2025/06/24 21:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.586ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:01:07.898' AND status != 'pending'
	

2025/06/24 21:01:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.338ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:01:07.933' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:01:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.102ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:01:07.96' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:01:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.686ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:01:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.066ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:01:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.892ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:01:08.023'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:01:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.646ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:01:08.058' AND status != 'pending'
	

2025/06/24 21:01:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.104ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:01:08.119' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:01:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.879ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:01:08.182'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.184ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:02:07.336'

2025/06/24 21:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.307ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:02:07.336'

2025/06/24 21:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.808ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:02:07.336'

2025/06/24 21:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.158ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:32:07.712'

2025/06/24 21:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.499ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:02:07.776' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.030ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.431ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.756ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:32:07.872'

2025/06/24 21:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.941ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:02:07.9' AND status != 'pending'
	

2025/06/24 21:02:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.400ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:02:07.933' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:02:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.052ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:02:07.963' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:02:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.016ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:02:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.545ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:02:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.090ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:02:08.025'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:02:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.134ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:02:08.056' AND status != 'pending'
	

2025/06/24 21:02:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.384ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:02:08.118' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:02:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.575ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:02:08.18'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[69.117ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:48:07.334' LIMIT 50

2025/06/24 21:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.530ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:03:07.34'

2025/06/24 21:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.481ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:48:07.371' LIMIT 50

2025/06/24 21:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.952ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:03:07.34'

2025/06/24 21:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.537ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:03:07.34'

2025/06/24 21:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.169ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:33:07.713'

2025/06/24 21:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.257ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:03:07.775' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.163ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.713ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.371ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:33:07.873'

2025/06/24 21:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.316ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:03:07.9' AND status != 'pending'
	

2025/06/24 21:03:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.728ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:03:07.93' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:03:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.583ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:03:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.330ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:03:07.961' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:03:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.332ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:03:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.451ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:03:08.023'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:03:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.716ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:03:08.048' AND status != 'pending'
	

2025/06/24 21:03:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.398ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:03:08.107' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:03:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.015ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:03:08.167'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:03:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[61.694ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.951ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:04:07.337'

2025/06/24 21:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.976ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:04:07.337'

2025/06/24 21:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.536ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:04:07.337'

2025/06/24 21:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.578ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:34:07.714'

2025/06/24 21:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.095ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:04:07.774' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.640ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.360ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.327ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:34:07.874'

2025/06/24 21:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.047ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:04:07.892' AND status != 'pending'
	

2025/06/24 21:04:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.187ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:04:07.936' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:04:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.087ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:04:07.95' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:04:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.714ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:04:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.941ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:04:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.774ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:04:08.01'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:04:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.385ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:04:08.06' AND status != 'pending'
	

2025/06/24 21:04:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.996ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:04:08.121' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:04:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.176ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:04:08.184'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.234ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:35:37.45'

2025/06/24 21:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[55.205ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:05:37.513' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.726ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.695ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[197.457ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:35:37.459'

2025/06/24 21:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[55.540ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:05:37.624' AND status != 'pending'
	

2025/06/24 21:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.500ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:05:37.657' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.027ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:05:37.68' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.268ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.028ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.360ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:05:37.737'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.675ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:05:37.783' AND status != 'pending'
	

2025/06/24 21:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.605ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:05:37.847' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.352ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:05:37.911'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:05:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[68.287ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:05:51 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[64.905ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:05:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[63.988ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:05:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[64.163ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[69.421ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:06:37.451'

2025/06/24 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.597ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:06:37.451'

2025/06/24 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.067ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:06:37.451'

2025/06/24 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.232ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:36:37.795'

2025/06/24 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.768ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:06:37.859' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.626ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.562ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.774ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:36:37.976'

2025/06/24 21:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.382ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:06:37.986' AND status != 'pending'
	

2025/06/24 21:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[55.892ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:06:38.041' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.292ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:06:38.049' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.709ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.988ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.980ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:06:38.112'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.393ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:06:38.153' AND status != 'pending'
	

2025/06/24 21:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.519ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:06:38.21' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.560ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:06:38.266'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:06:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[56.978ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:07:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[61.083ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.021ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:52:37.451' LIMIT 50

2025/06/24 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.902ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:07:37.452'

2025/06/24 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.318ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:07:37.452'

2025/06/24 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.223ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:07:37.452'

2025/06/24 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[196.641ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:52:37.461' LIMIT 50

2025/06/24 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.039ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:37:37.796'

2025/06/24 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.032ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:07:37.861' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.038ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.411ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.672ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:37:37.977'

2025/06/24 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.983ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:07:37.987' AND status != 'pending'
	

2025/06/24 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.786ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:07:38.042' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.142ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:07:38.05' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.536ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.536ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.352ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:07:38.114'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.032ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:07:38.169' AND status != 'pending'
	

2025/06/24 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.918ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:07:38.233' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.075ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:07:38.296'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.193ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:08:37.452'

2025/06/24 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.510ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:08:37.452'

2025/06/24 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.508ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:08:37.452'

2025/06/24 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.270ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:38:37.797'

2025/06/24 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.240ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:08:37.862' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.689ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.401ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.939ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:38:37.978'

2025/06/24 21:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.236ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:08:37.988' AND status != 'pending'
	

2025/06/24 21:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.763ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:08:38.041' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.913ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:08:38.053' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.505ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.154ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.299ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:08:38.116'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.944ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:08:38.167' AND status != 'pending'
	

2025/06/24 21:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.662ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:08:38.23' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.219ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:08:38.293'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.005ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:54:37.452' LIMIT 50

2025/06/24 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.402ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:09:37.452'

2025/06/24 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[55.155ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:54:37.462' LIMIT 50

2025/06/24 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.640ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:09:37.452'

2025/06/24 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.083ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:09:37.452'

2025/06/24 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.694ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:39:37.797'

2025/06/24 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.243ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:09:37.862' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.601ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.713ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.228ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:39:37.978'

2025/06/24 21:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.324ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:09:37.99' AND status != 'pending'
	

2025/06/24 21:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.569ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:09:38.039' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.784ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:09:38.054' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.884ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.313ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.903ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:09:38.117'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[55.626ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:09:38.152' AND status != 'pending'
	

2025/06/24 21:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.147ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:09:38.208' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[55.402ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:09:38.265'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[56.905ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:10:37.453'

2025/06/24 21:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[55.478ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:10:37.453'

2025/06/24 21:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.648ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:10:37.453'

2025/06/24 21:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.443ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:40:37.799'

2025/06/24 21:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[55.204ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:10:37.856' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.755ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.845ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[55.760ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:10:37.968' AND status != 'pending'
	

2025/06/24 21:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.467ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:40:37.979'

2025/06/24 21:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[54.967ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:10:38.023' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.991ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:10:38.045' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[55.783ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:10:38.079'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.096ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.395ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.387ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:10:38.171' AND status != 'pending'
	

2025/06/24 21:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.473ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:10:38.234' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.234ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:10:38.298'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:11:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.417ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:11:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[64.079ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[56.640ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:11:37.454'

2025/06/24 21:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.036ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:56:37.454' LIMIT 50

2025/06/24 21:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.623ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:56:37.464' LIMIT 50

2025/06/24 21:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.090ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:11:37.454'

2025/06/24 21:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[56.158ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:11:37.454'

2025/06/24 21:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[55.801ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:41:37.799'

2025/06/24 21:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[55.672ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:11:37.855' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.723ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.916ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[55.306ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:11:37.967' AND status != 'pending'
	

2025/06/24 21:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.552ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:41:37.98'

2025/06/24 21:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[55.170ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:11:38.022' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.557ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:11:38.045' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[55.755ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:11:38.078'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.330ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.496ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.424ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:11:38.171' AND status != 'pending'
	

2025/06/24 21:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.950ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:11:38.234' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.454ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:11:38.297'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:11:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.334ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:12:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[64.453ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[73.210ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:12:37.445'

2025/06/24 21:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.927ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:12:37.445'

2025/06/24 21:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.319ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:12:37.445'

2025/06/24 21:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.177ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:42:37.791'

2025/06/24 21:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.713ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:12:37.856' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.239ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.410ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.171ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:42:37.971'

2025/06/24 21:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.274ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:12:37.983' AND status != 'pending'
	

2025/06/24 21:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.335ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:12:38.035' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.786ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:12:38.046' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.999ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.678ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.326ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:12:38.109'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[55.644ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:12:38.153' AND status != 'pending'
	

2025/06/24 21:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.638ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:12:38.209' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.209ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:12:38.266'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.852ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:58:37.445' LIMIT 50

2025/06/24 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.691ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:13:37.445'

2025/06/24 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.460ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:58:37.455' LIMIT 50

2025/06/24 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.229ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:13:37.445'

2025/06/24 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.289ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:13:37.445'

2025/06/24 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.165ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:43:37.791'

2025/06/24 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.800ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:13:37.855' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.670ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.845ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.007ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:43:37.971'

2025/06/24 21:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.759ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:13:37.989' AND status != 'pending'
	

2025/06/24 21:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.363ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:13:38.034' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.739ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:13:38.052' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.458ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.605ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.296ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:13:38.115'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.878ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:13:38.161' AND status != 'pending'
	

2025/06/24 21:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.206ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:13:38.224' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.224ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:13:38.287'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:13:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[64.238ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:13:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.949ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:13:54 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.958ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:13:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.002ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.068ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:14:37.446'

2025/06/24 21:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.952ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:14:37.446'

2025/06/24 21:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.444ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:14:37.446'

2025/06/24 21:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.246ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:44:37.791'

2025/06/24 21:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.193ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:14:37.855' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.660ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.311ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.585ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:44:37.972'

2025/06/24 21:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.967ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:14:37.982' AND status != 'pending'
	

2025/06/24 21:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.796ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:14:38.035' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.745ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:14:38.045' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.186ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.320ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.923ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:14:38.108'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.802ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:14:38.161' AND status != 'pending'
	

2025/06/24 21:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.422ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:14:38.224' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.689ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:14:38.289'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:15:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[64.609ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.501ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:00:37.456' LIMIT 50

2025/06/24 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[77.243ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:00:37.446' LIMIT 50

2025/06/24 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[78.508ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:15:37.446'

2025/06/24 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.924ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:15:37.446'

2025/06/24 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.620ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:15:37.446'

2025/06/24 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.448ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:45:37.791'

2025/06/24 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.107ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:15:37.854' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.627ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.446ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.184ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:45:37.972'

2025/06/24 21:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.988ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:15:37.981' AND status != 'pending'
	

2025/06/24 21:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.759ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:15:38.036' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.159ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:15:38.044' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.210ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.310ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.614ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:15:38.108'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.295ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:15:38.162' AND status != 'pending'
	

2025/06/24 21:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.081ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:15:38.226' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[68.052ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:15:38.289'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:15:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.993ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:15:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.290ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:16:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.569ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:16:37.447'

2025/06/24 21:16:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.601ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:16:37.447'

2025/06/24 21:16:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.204ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:16:37.447'

2025/06/24 21:16:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.444ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:46:37.792'

2025/06/24 21:16:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.127ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:16:37.86' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:16:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.713ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:16:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.479ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.976ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:46:37.973'

2025/06/24 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.182ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:16:37.987' AND status != 'pending'
	

2025/06/24 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.397ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:16:38.036' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.487ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:16:38.05' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.359ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.485ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.203ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:16:38.113'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.844ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:16:38.164' AND status != 'pending'
	

2025/06/24 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.146ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:16:38.228' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.556ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:16:38.291'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:16:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[68.850ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:16:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[68.785ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:16:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[68.511ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:16:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[69.206ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:17:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.780ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:17:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[66.192ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:17:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[67.369ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[55.360ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:02:37.457' LIMIT 50

2025/06/24 21:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.394ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:02:37.447' LIMIT 50

2025/06/24 21:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.162ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:17:37.447'

2025/06/24 21:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.312ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:17:37.447'

2025/06/24 21:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.776ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:17:37.447'

2025/06/24 21:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.614ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:47:37.793'

2025/06/24 21:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.047ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:17:37.857' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.446ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.818ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.944ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:47:37.973'

2025/06/24 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.773ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:17:37.985' AND status != 'pending'
	

2025/06/24 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.785ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:17:38.037' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.852ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:17:38.048' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.332ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.363ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.788ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:17:38.111'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.893ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:17:38.163' AND status != 'pending'
	

2025/06/24 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.972ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:17:38.226' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.782ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:17:38.289'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.884ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:18:37.448'

2025/06/24 21:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[67.428ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:18:37.448'

2025/06/24 21:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[71.615ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:18:37.448'

2025/06/24 21:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.232ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:48:37.793'

2025/06/24 21:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.115ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:18:37.862' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.224ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.367ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[72.305ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:48:37.974'

2025/06/24 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.948ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:18:37.988' AND status != 'pending'
	

2025/06/24 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.030ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:18:38.046' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.441ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:18:38.051' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[52.827ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[89.280ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:18:38.113'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.486ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.351ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:18:38.202' AND status != 'pending'
	

2025/06/24 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[83.350ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:18:38.276' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[83.084ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:18:38.359'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[55.534ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:04:37.458' LIMIT 50

2025/06/24 21:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.216ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:04:37.448' LIMIT 50

2025/06/24 21:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.369ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:19:37.448'

2025/06/24 21:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.633ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:19:37.448'

2025/06/24 21:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.148ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:19:37.448'

2025/06/24 21:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.401ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:49:37.794'

2025/06/24 21:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.230ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:19:37.859' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.262ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.372ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.603ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:49:37.974'

2025/06/24 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.158ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:19:37.985' AND status != 'pending'
	

2025/06/24 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.899ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:19:38.037' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.002ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:19:38.047' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.291ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.410ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.805ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:19:38.11'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.415ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:19:38.163' AND status != 'pending'
	

2025/06/24 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.959ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:19:38.227' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.272ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:19:38.29'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.177ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:20:37.449'

2025/06/24 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.626ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:20:37.449'

2025/06/24 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.245ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:20:37.449'

2025/06/24 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.603ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:50:37.794'

2025/06/24 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.898ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:20:37.858' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.435ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.389ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.168ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:50:37.975'

2025/06/24 21:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.717ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:20:37.984' AND status != 'pending'
	

2025/06/24 21:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.233ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:20:38.038' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.452ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:20:38.047' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.683ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.381ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.281ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:20:38.11'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.849ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:20:38.165' AND status != 'pending'
	

2025/06/24 21:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.971ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:20:38.228' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.215ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:20:38.291'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.927ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:06:37.449' LIMIT 50

2025/06/24 21:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.164ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:06:37.46' LIMIT 50

2025/06/24 21:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.334ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:21:37.449'

2025/06/24 21:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.094ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:21:37.449'

2025/06/24 21:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.601ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:21:37.449'

2025/06/24 21:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.739ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:51:37.795'

2025/06/24 21:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.181ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:21:37.859' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.560ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.571ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.616ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:51:37.976'

2025/06/24 21:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.563ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:21:37.986' AND status != 'pending'
	

2025/06/24 21:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.365ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:21:38.032' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.465ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:21:38.052' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.471ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.932ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.069ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:21:38.116'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.129ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:21:38.144' AND status != 'pending'
	

2025/06/24 21:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.848ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:21:38.201' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[55.601ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:21:38.258'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[56.909ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:22:37.451'

2025/06/24 21:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[55.281ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:22:37.451'

2025/06/24 21:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[55.981ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:22:37.451'

2025/06/24 21:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[55.787ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:52:37.796'

2025/06/24 21:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[55.720ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:22:37.852' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.788ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.878ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[55.373ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:22:37.964' AND status != 'pending'
	

2025/06/24 21:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.098ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:52:37.976'

2025/06/24 21:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[55.804ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:22:38.02' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.671ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:22:38.041' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.460ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:22:38.076'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.893ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.198ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.462ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:22:38.167' AND status != 'pending'
	

2025/06/24 21:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.109ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:22:38.23' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.513ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:22:38.293'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.024ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:08:37.452' LIMIT 50

2025/06/24 21:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.822ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:23:37.451'

2025/06/24 21:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.504ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:08:37.461' LIMIT 50

2025/06/24 21:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.728ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:23:37.451'

2025/06/24 21:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.462ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:23:37.451'

2025/06/24 21:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.940ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:53:37.796'

2025/06/24 21:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.537ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:23:37.862' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.631ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.429ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.046ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:53:37.977'

2025/06/24 21:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.372ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:23:37.989' AND status != 'pending'
	

2025/06/24 21:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.513ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:23:38.04' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.874ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:23:38.053' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.328ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.367ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.877ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:23:38.116'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.445ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:23:38.166' AND status != 'pending'
	

2025/06/24 21:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.453ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:23:38.229' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.843ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:23:38.292'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[70.544ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:24:37.452'

2025/06/24 21:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.667ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:24:37.452'

2025/06/24 21:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.005ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:24:37.452'

2025/06/24 21:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.221ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:54:37.798'

2025/06/24 21:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.780ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:24:37.861' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.278ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.412ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.534ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:54:37.978'

2025/06/24 21:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.251ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:24:37.987' AND status != 'pending'
	

2025/06/24 21:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.629ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:24:38.042' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.324ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:24:38.05' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.276ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.568ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.122ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:24:38.113'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.744ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:24:38.169' AND status != 'pending'
	

2025/06/24 21:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.419ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:24:38.232' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.889ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:24:38.296'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[55.460ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:10:37.462' LIMIT 50

2025/06/24 21:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.486ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:10:37.453' LIMIT 50

2025/06/24 21:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.616ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:25:37.453'

2025/06/24 21:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.024ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:25:37.453'

2025/06/24 21:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.621ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:25:37.453'

2025/06/24 21:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.268ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:55:37.796'

2025/06/24 21:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.576ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:25:37.861' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.113ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.596ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.387ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:55:37.977'

2025/06/24 21:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.879ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:25:37.989' AND status != 'pending'
	

2025/06/24 21:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.900ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:25:38.042' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.621ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:25:38.054' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.497ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.081ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.990ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:25:38.118'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.247ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:25:38.17' AND status != 'pending'
	

2025/06/24 21:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.337ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:25:38.233' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.197ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:25:38.297'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.413ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:26:37.453'

2025/06/24 21:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.474ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:26:37.453'

2025/06/24 21:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.158ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:26:37.453'

2025/06/24 21:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.612ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:56:37.797'

2025/06/24 21:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.372ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:26:37.861' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.099ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.107ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.032ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:56:37.979'

2025/06/24 21:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.210ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:26:37.987' AND status != 'pending'
	

2025/06/24 21:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.817ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:26:38.045' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.377ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:26:38.05' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.335ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.691ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:26:38.112'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.950ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.729ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:26:38.174' AND status != 'pending'
	

2025/06/24 21:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.443ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:26:38.237' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.410ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:26:38.301'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.490ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:12:37.453' LIMIT 50

2025/06/24 21:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[56.221ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:12:37.463' LIMIT 50

2025/06/24 21:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.856ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:27:37.453'

2025/06/24 21:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.021ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:27:37.453'

2025/06/24 21:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.896ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:27:37.453'

2025/06/24 21:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.152ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:57:37.798'

2025/06/24 21:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.093ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:27:37.862' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.055ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.146ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.929ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:57:37.978'

2025/06/24 21:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.605ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:27:37.989' AND status != 'pending'
	

2025/06/24 21:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[54.622ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:27:38.037' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.487ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:27:38.053' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.679ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.250ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.111ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:27:38.116'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.390ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:27:38.148' AND status != 'pending'
	

2025/06/24 21:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.705ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:27:38.204' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[55.787ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:27:38.261'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:27:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[56.338ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:27:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[56.647ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:27:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[55.507ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:27:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.172ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:27:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[64.291ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:28:00 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[56.954ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:28:00 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.850ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.791ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:28:37.453'

2025/06/24 21:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.020ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:28:37.453'

2025/06/24 21:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.373ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:28:37.453'

2025/06/24 21:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.487ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:58:37.799'

2025/06/24 21:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.477ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:28:37.862' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.227ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.745ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[55.327ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:58:37.978'

2025/06/24 21:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.373ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:28:37.989' AND status != 'pending'
	

2025/06/24 21:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[55.602ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:28:38.034' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.521ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:28:38.053' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.538ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.914ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.762ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:28:38.116'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.095ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:28:38.146' AND status != 'pending'
	

2025/06/24 21:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[55.996ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:28:38.202' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[55.838ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:28:38.259'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[56.431ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:14:37.453' LIMIT 50

2025/06/24 21:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.838ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:29:37.454'

2025/06/24 21:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.537ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:14:37.464' LIMIT 50

2025/06/24 21:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.113ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:29:37.454'

2025/06/24 21:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.817ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:29:37.454'

2025/06/24 21:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.793ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:59:37.799'

2025/06/24 21:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.924ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:29:37.864' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.626ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.184ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.081ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 20:59:37.98'

2025/06/24 21:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.343ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:29:37.991' AND status != 'pending'
	

2025/06/24 21:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.250ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:29:38.047' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.840ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:29:38.054' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.009ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.398ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.473ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:29:38.117'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.730ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:29:38.173' AND status != 'pending'
	

2025/06/24 21:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.154ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:29:38.237' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.774ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:29:38.301'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:30:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[64.151ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:30:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[64.114ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.275ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:30:37.455'

2025/06/24 21:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.781ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:30:37.455'

2025/06/24 21:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.441ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:30:37.455'

2025/06/24 21:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.141ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:00:37.8'

2025/06/24 21:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.179ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:30:37.864' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.589ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.467ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.590ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:00:37.98'

2025/06/24 21:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.758ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:30:37.993' AND status != 'pending'
	

2025/06/24 21:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.430ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:30:38.044' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.713ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:30:38.057' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.934ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.610ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.195ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:30:38.12'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.322ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:30:38.172' AND status != 'pending'
	

2025/06/24 21:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.782ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:30:38.236' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.890ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:30:38.3'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:30:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.755ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:31:03 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[63.593ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.779ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:31:37.455'

2025/06/24 21:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.160ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:16:37.454' LIMIT 50

2025/06/24 21:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.596ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:16:37.465' LIMIT 50

2025/06/24 21:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.578ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:31:37.455'

2025/06/24 21:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.275ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:31:37.455'

2025/06/24 21:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.828ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:01:37.8'

2025/06/24 21:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.844ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:31:37.864' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.378ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.279ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[55.661ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:01:37.981'

2025/06/24 21:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.968ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:31:37.991' AND status != 'pending'
	

2025/06/24 21:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[55.728ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:31:38.037' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.662ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:31:38.054' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.702ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.750ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.917ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:31:38.117'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.434ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:31:38.149' AND status != 'pending'
	

2025/06/24 21:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.426ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:31:38.206' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.383ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:31:38.262'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[56.378ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:32:37.455'

2025/06/24 21:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[71.716ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:32:37.455'

2025/06/24 21:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[56.293ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:32:37.455'

2025/06/24 21:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.746ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:02:37.801'

2025/06/24 21:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.498ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:32:37.858' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.786ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.829ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.411ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:32:37.972' AND status != 'pending'
	

2025/06/24 21:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.233ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:02:37.981'

2025/06/24 21:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[55.756ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:32:38.028' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.739ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:32:38.047' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[54.578ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:32:38.084'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.369ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.456ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.337ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:32:38.174' AND status != 'pending'
	

2025/06/24 21:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.089ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:32:38.237' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.242ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:32:38.301'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:33:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.616ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[56.601ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:33:37.456'

2025/06/24 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.485ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:18:37.456' LIMIT 50

2025/06/24 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.282ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:18:37.466' LIMIT 50

2025/06/24 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[55.453ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:33:37.456'

2025/06/24 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[56.712ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:33:37.456'

2025/06/24 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.837ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:03:37.801'

2025/06/24 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.521ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:33:37.858' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.811ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.912ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.443ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:33:37.971' AND status != 'pending'
	

2025/06/24 21:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.608ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:03:37.982'

2025/06/24 21:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.145ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:33:38.028' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.706ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:33:38.046' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[55.462ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:33:38.084'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.434ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.452ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.402ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:33:38.173' AND status != 'pending'
	

2025/06/24 21:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.731ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:33:38.237' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.610ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:33:38.301'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.052ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:34:37.458'

2025/06/24 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.202ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:34:37.458'

2025/06/24 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.758ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:34:37.458'

2025/06/24 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.043ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:04:37.807'

2025/06/24 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.714ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:34:37.87' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.482ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.399ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[55.249ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:04:37.982'

2025/06/24 21:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.725ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:34:37.998' AND status != 'pending'
	

2025/06/24 21:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[55.351ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:34:38.037' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.374ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.053ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:34:38.063' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.055ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.301ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:34:38.125'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[55.802ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:34:38.148' AND status != 'pending'
	

2025/06/24 21:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.065ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:34:38.204' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[55.902ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:34:38.261'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:34:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.933ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:34:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[56.717ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:35:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[55.451ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:35:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[56.453ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:35:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[55.825ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:35:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[55.625ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:35:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[56.342ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:35:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.709ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:35:22 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.348ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.174ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.486ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.348ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:20:37.457' LIMIT 50

2025/06/24 21:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.452ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:35:37.457'

2025/06/24 21:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.022ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:20:37.467' LIMIT 50

2025/06/24 21:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.093ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:35:37.457'

2025/06/24 21:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.839ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:35:37.457'

2025/06/24 21:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.368ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:05:37.802'

2025/06/24 21:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.897ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:35:37.868' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.343ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.147ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.577ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:05:37.983'

2025/06/24 21:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.056ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:35:37.995' AND status != 'pending'
	

2025/06/24 21:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.919ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:35:38.048' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.262ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:35:38.058' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.899ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.539ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.270ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:35:38.123'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.226ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:35:38.18' AND status != 'pending'
	

2025/06/24 21:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.914ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:35:38.243' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.891ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:35:38.307'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:36:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[67.902ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:36:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.338ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:36:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.478ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.815ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:36:37.457'

2025/06/24 21:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.077ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:36:37.457'

2025/06/24 21:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.256ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:36:37.457'

2025/06/24 21:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.145ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:06:37.802'

2025/06/24 21:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.019ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:36:37.866' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.458ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.287ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.678ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:06:37.984'

2025/06/24 21:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.773ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:36:37.993' AND status != 'pending'
	

2025/06/24 21:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.423ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:36:38.047' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.200ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:36:38.056' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.651ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.192ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.730ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:36:38.12'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[72.751ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:36:38.175' AND status != 'pending'
	

2025/06/24 21:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.896ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:36:38.248' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.268ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:36:38.311'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:37:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[64.701ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:37:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.542ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:37:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.753ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.458ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:22:37.458' LIMIT 50

2025/06/24 21:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.114ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:22:37.468' LIMIT 50

2025/06/24 21:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.467ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:37:37.458'

2025/06/24 21:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.739ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:37:37.458'

2025/06/24 21:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.016ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:37:37.458'

2025/06/24 21:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.754ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:07:37.803'

2025/06/24 21:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.811ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:37:37.868' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.772ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.643ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[55.965ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:07:37.984'

2025/06/24 21:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.689ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:37:37.998' AND status != 'pending'
	

2025/06/24 21:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[55.764ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:37:38.041' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.041ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:37:38.06' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.326ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.297ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.361ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:37:38.124'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[55.962ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:37:38.153' AND status != 'pending'
	

2025/06/24 21:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.006ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:37:38.209' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.294ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:37:38.265'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:38:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[56.363ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:38:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.783ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.364ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:38:37.458'

2025/06/24 21:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.985ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:38:37.458'

2025/06/24 21:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.433ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:38:37.458'

2025/06/24 21:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[64.321ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.641ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:08:37.804'

2025/06/24 21:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.977ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:38:37.868' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.720ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.676ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.588ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:08:37.984'

2025/06/24 21:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.802ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:38:37.997' AND status != 'pending'
	

2025/06/24 21:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.926ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:38:38.043' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.833ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:38:38.06' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.918ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.507ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.210ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:38:38.124'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[55.624ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:38:38.156' AND status != 'pending'
	

2025/06/24 21:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.072ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:38:38.212' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.420ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:38:38.27'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:38:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.698ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:38:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.130ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:38:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.176ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:38:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[56.280ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.000ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:24:37.459' LIMIT 50

2025/06/24 21:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.451ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:39:37.459'

2025/06/24 21:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.189ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:24:37.469' LIMIT 50

2025/06/24 21:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.891ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:39:37.459'

2025/06/24 21:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.882ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:39:37.459'

2025/06/24 21:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.111ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:09:37.804'

2025/06/24 21:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.868ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:39:37.869' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.840ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.269ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.570ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:09:37.985'

2025/06/24 21:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.804ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:39:37.995' AND status != 'pending'
	

2025/06/24 21:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.438ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:39:38.049' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.162ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:39:38.058' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.564ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.070ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.305ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:39:38.12'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.946ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:39:38.178' AND status != 'pending'
	

2025/06/24 21:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.880ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:39:38.241' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.438ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:39:38.305'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.414ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:40:37.46'

2025/06/24 21:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.401ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:40:37.46'

2025/06/24 21:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.279ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:40:37.46'

2025/06/24 21:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.210ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:10:37.805'

2025/06/24 21:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.837ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:40:37.868' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.355ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.315ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.860ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:10:37.986'

2025/06/24 21:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.241ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:40:37.996' AND status != 'pending'
	

2025/06/24 21:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.718ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:40:38.049' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.426ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:40:38.058' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.729ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.037ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.510ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:40:38.121'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.941ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:40:38.175' AND status != 'pending'
	

2025/06/24 21:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.557ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:40:38.238' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.166ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:40:38.301'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.395ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:26:37.46' LIMIT 50

2025/06/24 21:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[55.619ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:26:37.47' LIMIT 50

2025/06/24 21:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.695ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:41:37.46'

2025/06/24 21:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.117ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:41:37.46'

2025/06/24 21:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.986ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:41:37.46'

2025/06/24 21:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.561ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:11:37.806'

2025/06/24 21:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.636ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:41:37.869' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.904ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.382ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[55.799ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:11:37.986'

2025/06/24 21:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.321ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:41:37.997' AND status != 'pending'
	

2025/06/24 21:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.122ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:41:38.042' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.519ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:41:38.06' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.480ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.065ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.330ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:41:38.123'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.139ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:41:38.154' AND status != 'pending'
	

2025/06/24 21:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.175ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:41:38.211' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[55.977ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:41:38.269'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.695ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:42:37.461'

2025/06/24 21:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[55.248ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:42:37.461'

2025/06/24 21:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.245ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:42:37.461'

2025/06/24 21:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.368ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:12:37.806'

2025/06/24 21:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[55.630ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:42:37.863' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.721ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.890ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[55.840ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:42:37.974' AND status != 'pending'
	

2025/06/24 21:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.567ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:12:37.986'

2025/06/24 21:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[55.870ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:42:38.03' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.280ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:42:38.049' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.045ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:42:38.086'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.365ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.355ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.160ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:42:38.175' AND status != 'pending'
	

2025/06/24 21:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.086ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:42:38.238' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.228ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:42:38.302'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:42:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.431ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:43:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[64.540ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:43:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[65.187ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:43:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.410ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[56.717ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:28:37.461' LIMIT 50

2025/06/24 21:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.103ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:43:37.461'

2025/06/24 21:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.826ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:28:37.471' LIMIT 50

2025/06/24 21:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.066ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:43:37.461'

2025/06/24 21:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.789ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:43:37.461'

2025/06/24 21:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.114ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:13:37.807'

2025/06/24 21:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.508ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:43:37.872' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.522ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.338ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.995ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:13:37.986'

2025/06/24 21:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.928ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:43:38.001' AND status != 'pending'
	

2025/06/24 21:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.397ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:43:38.053' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.652ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:43:38.064' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.148ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.371ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.279ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:43:38.127'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[72.268ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:43:38.18' AND status != 'pending'
	

2025/06/24 21:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.108ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:43:38.252' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.663ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:43:38.318'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:43:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.850ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:43:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[64.564ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:43:51 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.198ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:43:51 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.609ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.475ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[64.236ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:44:02 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[63.557ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:44:02 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.037ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.308ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:44:37.462'

2025/06/24 21:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.552ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:44:37.462'

2025/06/24 21:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.733ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:44:37.462'

2025/06/24 21:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.936ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:14:37.806'

2025/06/24 21:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.302ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:44:37.872' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.812ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.753ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.770ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:14:37.988'

2025/06/24 21:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.070ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:44:37.999' AND status != 'pending'
	

2025/06/24 21:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.769ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:44:38.052' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.311ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:44:38.062' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.510ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.855ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.232ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:44:38.127'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.331ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:44:38.179' AND status != 'pending'
	

2025/06/24 21:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.095ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:44:38.244' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.248ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:44:38.307'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:44:43 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.774ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[55.333ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:30:37.472' LIMIT 50

2025/06/24 21:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.632ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:45:37.462'

2025/06/24 21:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.212ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:30:37.462' LIMIT 50

2025/06/24 21:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.836ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:45:37.462'

2025/06/24 21:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.509ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:45:37.462'

2025/06/24 21:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.329ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:15:37.808'

2025/06/24 21:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.454ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:45:37.872' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.336ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.445ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.229ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:15:37.988'

2025/06/24 21:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.753ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:45:37.998' AND status != 'pending'
	

2025/06/24 21:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.148ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:45:38.05' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.657ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:45:38.062' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.334ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.346ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.989ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:45:38.125'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.237ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:45:38.178' AND status != 'pending'
	

2025/06/24 21:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.533ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:45:38.241' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.952ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:45:38.305'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:46:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.905ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:46:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.081ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.203ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:46:37.463'

2025/06/24 21:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.784ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:46:37.463'

2025/06/24 21:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.176ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:46:37.463'

2025/06/24 21:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.214ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:16:37.808'

2025/06/24 21:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.765ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:46:37.872' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.828ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.129ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.627ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:16:37.989'

2025/06/24 21:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.928ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:46:38.001' AND status != 'pending'
	

2025/06/24 21:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.982ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:46:38.052' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.293ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:46:38.064' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.417ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.266ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.583ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:46:38.126'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.835ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:46:38.179' AND status != 'pending'
	

2025/06/24 21:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.843ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:46:38.243' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.298ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:46:38.307'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:46:54 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.681ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:46:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.596ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:46:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[63.932ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:46:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[64.005ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:47:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.105ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:47:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.902ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:47:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[67.198ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:47:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.574ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:47:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.819ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:47:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[67.810ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:47:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[67.471ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:47:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[64.382ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:47:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[64.617ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.948ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:32:37.463' LIMIT 50

2025/06/24 21:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.899ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:47:37.463'

2025/06/24 21:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[55.996ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:32:37.473' LIMIT 50

2025/06/24 21:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[55.825ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:47:37.463'

2025/06/24 21:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[56.173ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:47:37.463'

2025/06/24 21:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.415ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:17:37.809'

2025/06/24 21:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.556ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:47:37.869' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.736ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.944ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.895ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:47:37.982' AND status != 'pending'
	

2025/06/24 21:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.714ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:17:37.989'

2025/06/24 21:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.071ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:47:38.039' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.748ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:47:38.052' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.200ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[55.578ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:47:38.096'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.052ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.989ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:47:38.18' AND status != 'pending'
	

2025/06/24 21:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.074ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:47:38.243' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.043ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:47:38.307'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:48:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.628ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:48:22 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.879ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:48:22 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.394ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:48:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.074ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:48:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.304ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:48:37.465'

2025/06/24 21:48:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.775ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:48:37.465'

2025/06/24 21:48:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.924ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:48:37.465'

2025/06/24 21:48:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.185ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:18:37.808'

2025/06/24 21:48:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.110ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:48:37.875' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:48:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.091ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.864ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.484ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:18:37.99'

2025/06/24 21:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.828ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:48:38.001' AND status != 'pending'
	

2025/06/24 21:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[55.992ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:48:38.047' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.398ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:48:38.065' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.615ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.000ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.937ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:48:38.129'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[55.926ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:48:38.159' AND status != 'pending'
	

2025/06/24 21:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.361ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:48:38.215' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.271ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:48:38.271'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:48:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.446ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:48:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.358ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.741ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:34:37.466' LIMIT 50

2025/06/24 21:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[69.378ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:49:37.464'

2025/06/24 21:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.721ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:34:37.474' LIMIT 50

2025/06/24 21:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.268ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:49:37.464'

2025/06/24 21:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.908ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:49:37.464'

2025/06/24 21:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.434ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:19:37.809'

2025/06/24 21:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.958ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:49:37.874' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.890ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.289ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.598ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:19:37.99'

2025/06/24 21:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.348ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:49:38.002' AND status != 'pending'
	

2025/06/24 21:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.907ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:49:38.053' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.998ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:49:38.066' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.254ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.183ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.454ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:49:38.129'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.843ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:49:38.18' AND status != 'pending'
	

2025/06/24 21:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.048ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:49:38.243' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.084ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:49:38.306'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:50:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.619ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:50:22 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.172ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:50:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.193ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:50:37.465'

2025/06/24 21:50:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.944ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:50:37.465'

2025/06/24 21:50:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.345ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:50:37.465'

2025/06/24 21:50:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.970ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:20:37.81'

2025/06/24 21:50:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.787ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:50:37.874' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:50:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.595ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.593ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.729ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:20:37.991'

2025/06/24 21:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.788ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:50:38.002' AND status != 'pending'
	

2025/06/24 21:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.463ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:50:38.055' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.899ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:50:38.065' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.747ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.977ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.364ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:50:38.128'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.411ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:50:38.184' AND status != 'pending'
	

2025/06/24 21:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.029ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:50:38.248' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.862ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:50:38.311'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.439ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:51:37.466'

2025/06/24 21:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.745ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:36:37.475' LIMIT 50

2025/06/24 21:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[69.123ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:36:37.465' LIMIT 50

2025/06/24 21:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.430ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:51:37.466'

2025/06/24 21:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.953ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:51:37.466'

2025/06/24 21:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.637ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:21:37.811'

2025/06/24 21:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.467ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:51:37.875' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.204ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.268ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.517ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:21:37.991'

2025/06/24 21:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.346ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:51:38.003' AND status != 'pending'
	

2025/06/24 21:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.552ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:51:38.055' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.849ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:51:38.065' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.264ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.432ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.633ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:51:38.13'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.907ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:51:38.182' AND status != 'pending'
	

2025/06/24 21:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[75.100ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:51:38.245' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.594ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:51:38.32'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:51:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.831ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:51:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[63.536ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:51:51 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.442ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:52:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.936ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:52:37.466'

2025/06/24 21:52:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.260ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:52:37.466'

2025/06/24 21:52:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.744ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:52:37.466'

2025/06/24 21:52:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.506ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:22:37.811'

2025/06/24 21:52:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.694ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:52:37.875' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:52:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.672ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.704ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.415ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:22:37.991'

2025/06/24 21:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.242ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:52:38.004' AND status != 'pending'
	

2025/06/24 21:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.682ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:52:38.054' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.424ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:52:38.067' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.268ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.561ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.817ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:52:38.13'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.838ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:52:38.18' AND status != 'pending'
	

2025/06/24 21:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.109ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:52:38.243' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.741ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:52:38.306'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.701ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:53:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.200ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.056ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:38:37.466' LIMIT 50

2025/06/24 21:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.024ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:53:37.467'

2025/06/24 21:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[55.314ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:38:37.477' LIMIT 50

2025/06/24 21:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.752ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:53:37.467'

2025/06/24 21:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.322ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:53:37.467'

2025/06/24 21:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.362ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:23:37.812'

2025/06/24 21:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.729ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:53:37.876' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.398ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.561ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[55.714ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:23:37.993'

2025/06/24 21:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.167ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:53:38.003' AND status != 'pending'
	

2025/06/24 21:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.049ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:53:38.049' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.236ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:53:38.066' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.193ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.388ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.137ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:53:38.13'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.566ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:53:38.161' AND status != 'pending'
	

2025/06/24 21:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[55.932ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:53:38.219' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.278ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:53:38.275'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:53:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[55.850ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:54:02 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[56.481ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[55.946ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[55.471ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:54:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[61.727ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:54:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[56.801ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:54:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.834ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:54:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[64.269ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:54:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.657ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:54:37.467'

2025/06/24 21:54:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.617ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:54:37.467'

2025/06/24 21:54:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.621ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:54:37.467'

2025/06/24 21:54:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.164ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:24:37.813'

2025/06/24 21:54:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.460ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:54:37.877' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:54:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.678ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.796ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[55.615ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:24:37.993'

2025/06/24 21:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.352ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:54:38.004' AND status != 'pending'
	

2025/06/24 21:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.062ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:54:38.049' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.638ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:54:38.068' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.160ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.933ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.383ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:54:38.131'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.081ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:54:38.163' AND status != 'pending'
	

2025/06/24 21:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.387ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:54:38.219' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.334ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:54:38.275'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.924ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:55:37.467'

2025/06/24 21:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.735ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:40:37.467' LIMIT 50

2025/06/24 21:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.615ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:40:37.477' LIMIT 50

2025/06/24 21:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.216ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:55:37.467'

2025/06/24 21:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[56.433ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:55:37.467'

2025/06/24 21:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.212ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:25:37.813'

2025/06/24 21:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.461ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:55:37.871' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.785ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.856ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[55.852ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:55:37.986' AND status != 'pending'
	

2025/06/24 21:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.390ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:25:37.993'

2025/06/24 21:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[55.719ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:55:38.042' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.959ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:55:38.056' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.332ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[55.155ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:55:38.098'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.233ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.836ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:55:38.182' AND status != 'pending'
	

2025/06/24 21:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.547ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:55:38.245' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.236ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:55:38.308'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:55:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[66.864ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:56:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.947ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:56:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.538ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:56:37.468'

2025/06/24 21:56:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.581ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:56:37.468'

2025/06/24 21:56:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.849ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:56:37.468'

2025/06/24 21:56:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.367ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:26:37.813'

2025/06/24 21:56:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.455ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:56:37.877' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:56:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.011ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.457ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.056ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:26:37.994'

2025/06/24 21:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.015ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:56:38.004' AND status != 'pending'
	

2025/06/24 21:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[55.557ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:56:38.052' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.576ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:56:38.068' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.709ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.828ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.889ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:56:38.131'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.099ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:56:38.165' AND status != 'pending'
	

2025/06/24 21:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.088ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:56:38.222' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[55.927ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:56:38.278'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:57:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[55.979ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:42:37.469' LIMIT 50

2025/06/24 21:57:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.291ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:57:37.469'

2025/06/24 21:57:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.059ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:42:37.479' LIMIT 50

2025/06/24 21:57:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.475ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:57:37.469'

2025/06/24 21:57:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.349ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:57:37.469'

2025/06/24 21:57:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.226ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:27:37.814'

2025/06/24 21:57:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.964ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:57:37.877' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:57:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.236ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.421ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.248ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:27:37.995'

2025/06/24 21:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.751ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:57:38.003' AND status != 'pending'
	

2025/06/24 21:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.206ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:57:38.058' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.011ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:57:38.066' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.515ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.500ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.192ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:57:38.128'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.439ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:57:38.185' AND status != 'pending'
	

2025/06/24 21:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.840ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:57:38.248' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.048ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:57:38.311'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:57:43 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.724ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[64.127ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.544ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.536ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 21:58:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[69.583ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:58:37.469'

2025/06/24 21:58:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.211ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:58:37.469'

2025/06/24 21:58:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.096ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:58:37.469'

2025/06/24 21:58:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.167ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:28:37.815'

2025/06/24 21:58:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.002ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:58:37.879' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:58:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.516ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.563ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.586ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:28:37.995'

2025/06/24 21:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.636ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:58:38.006' AND status != 'pending'
	

2025/06/24 21:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.514ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:58:38.059' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.300ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:58:38.069' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.312ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.399ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.073ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:58:38.131'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.330ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:58:38.189' AND status != 'pending'
	

2025/06/24 21:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.219ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:58:38.252' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.506ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:58:38.316'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:59:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.522ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 21:59:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[71.429ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 21:59:37.47'

2025/06/24 21:59:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.385ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:44:37.48' LIMIT 50

2025/06/24 21:59:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[74.580ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:44:37.469' LIMIT 50

2025/06/24 21:59:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.828ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 21:59:37.47'

2025/06/24 21:59:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.205ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 21:59:37.47'

2025/06/24 21:59:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.524ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:29:37.815'

2025/06/24 21:59:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.907ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:59:37.879' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:59:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.127ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.245ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.016ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:29:37.995'

2025/06/24 21:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.719ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:59:38.006' AND status != 'pending'
	

2025/06/24 21:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.404ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 20:59:38.059' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 21:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.948ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:59:38.069' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.381ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 21:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.939ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 21:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.610ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:59:38.132'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 21:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.136ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 20:59:38.185' AND status != 'pending'
	

2025/06/24 21:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.992ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 20:59:38.249' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 21:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.339ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 20:59:38.312'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:00:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.304ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:00:37.47'

2025/06/24 22:00:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.447ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:00:37.47'

2025/06/24 22:00:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.926ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:00:37.47'

2025/06/24 22:00:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.801ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:30:37.816'

2025/06/24 22:00:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.270ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:00:37.88' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:00:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.699ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.736ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.934ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:30:37.996'

2025/06/24 22:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.470ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:00:38.008' AND status != 'pending'
	

2025/06/24 22:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.997ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:00:38.059' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.601ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:00:38.072' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.605ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.418ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.761ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:00:38.136'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.251ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:00:38.188' AND status != 'pending'
	

2025/06/24 22:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.204ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:00:38.252' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.415ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:00:38.315'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:01:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.892ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:46:37.47' LIMIT 50

2025/06/24 22:01:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.320ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:01:37.471'

2025/06/24 22:01:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[55.338ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:46:37.481' LIMIT 50

2025/06/24 22:01:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.371ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:01:37.471'

2025/06/24 22:01:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.812ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:01:37.471'

2025/06/24 22:01:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.667ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:31:37.816'

2025/06/24 22:01:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.374ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:01:37.881' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:01:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.603ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.572ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[55.617ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:31:37.997'

2025/06/24 22:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.217ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:01:38.007' AND status != 'pending'
	

2025/06/24 22:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[55.868ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:01:38.053' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.031ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:01:38.07' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.262ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.124ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.095ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:01:38.134'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.447ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:01:38.165' AND status != 'pending'
	

2025/06/24 22:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[55.840ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:01:38.224' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.214ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:01:38.28'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:02:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[56.361ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:02:37.471'

2025/06/24 22:02:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[55.636ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:02:37.471'

2025/06/24 22:02:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[56.789ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:02:37.471'

2025/06/24 22:02:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.595ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:32:37.817'

2025/06/24 22:02:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.631ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:02:37.875' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:02:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.993ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:02:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.094ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.068ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:02:37.988' AND status != 'pending'
	

2025/06/24 22:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.452ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:32:37.997'

2025/06/24 22:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[55.861ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:02:38.044' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.820ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:02:38.061' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[55.281ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:02:38.1'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.313ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.255ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.374ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:02:38.189' AND status != 'pending'
	

2025/06/24 22:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.779ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:02:38.253' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.978ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:02:38.317'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:03:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[57.280ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:03:37.472'

2025/06/24 22:03:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.383ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:48:37.471' LIMIT 50

2025/06/24 22:03:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.494ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:48:37.482' LIMIT 50

2025/06/24 22:03:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[55.989ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:03:37.472'

2025/06/24 22:03:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[56.824ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:03:37.472'

2025/06/24 22:03:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.397ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:33:37.817'

2025/06/24 22:03:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.372ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:03:37.874' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:03:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.162ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:03:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.601ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[55.725ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:03:37.987' AND status != 'pending'
	

2025/06/24 22:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.935ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:33:37.997'

2025/06/24 22:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[55.625ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:03:38.043' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.884ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:03:38.063' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[55.501ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:03:38.099'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.886ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.202ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.813ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:03:38.189' AND status != 'pending'
	

2025/06/24 22:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.552ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:03:38.252' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.045ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:03:38.316'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:04:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.963ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:04:37.472'

2025/06/24 22:04:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.280ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:04:37.472'

2025/06/24 22:04:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.028ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:04:37.472'

2025/06/24 22:04:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.506ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:34:37.818'

2025/06/24 22:04:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.247ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:04:37.882' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:04:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.104ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.295ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.526ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:34:37.998'

2025/06/24 22:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.671ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:04:38.008' AND status != 'pending'
	

2025/06/24 22:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[55.862ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:04:38.055' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.058ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:04:38.072' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.616ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.504ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.588ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:04:38.135'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.461ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:04:38.168' AND status != 'pending'
	

2025/06/24 22:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.045ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:04:38.224' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.052ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:04:38.281'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.170ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:05:37.473'

2025/06/24 22:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.764ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:50:37.472' LIMIT 50

2025/06/24 22:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.969ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:05:37.473'

2025/06/24 22:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[176.199ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:50:37.483' LIMIT 50

2025/06/24 22:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[184.319ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 22:05:37.474' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/24 22:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[178.662ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 22:05:37.483' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/24 22:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.176ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:05:37.473'

2025/06/24 22:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[28.990ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-17 22:05:37.659'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/24 22:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[29.862ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-17 22:05:37.661'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/24 22:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.469ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:35:37.825'

2025/06/24 22:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.637ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:05:37.885' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.366ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.693ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.032ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:35:37.999'

2025/06/24 22:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.784ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:05:38.003' AND status != 'pending'
	

2025/06/24 22:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.652ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:05:38.058' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.046ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:05:38.062' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.924ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.610ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.801ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:05:38.121'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.753ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:05:38.177' AND status != 'pending'
	

2025/06/24 22:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.955ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:05:38.236' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.246ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:05:38.294'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.210ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:06:37.474'

2025/06/24 22:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.983ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:06:37.474'

2025/06/24 22:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.638ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:06:37.474'

2025/06/24 22:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.646ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:36:37.819'

2025/06/24 22:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.317ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:06:37.878' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.959ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.836ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.173ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:06:37.999' AND status != 'pending'
	

2025/06/24 22:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.312ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:36:37.999'

2025/06/24 22:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.891ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:06:38.058' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.021ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:06:38.058' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.902ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.802ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:06:38.116'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.800ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.922ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:06:38.177' AND status != 'pending'
	

2025/06/24 22:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.765ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:06:38.236' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.184ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:06:38.295'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:07:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.774ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:07:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.339ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:07:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.134ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:07:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.804ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:07:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.029ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.131ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:52:37.474' LIMIT 50

2025/06/24 22:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.216ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:07:37.474'

2025/06/24 22:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.824ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:52:37.484' LIMIT 50

2025/06/24 22:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.260ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:07:37.474'

2025/06/24 22:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.659ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:07:37.474'

2025/06/24 22:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.206ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:37:37.819'

2025/06/24 22:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.470ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:07:37.88' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.252ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.170ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.720ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:07:37.997' AND status != 'pending'
	

2025/06/24 22:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.393ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:37:37.999'

2025/06/24 22:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.775ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:07:38.058' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.532ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:07:38.057' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.479ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.568ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:07:38.118'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.571ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.743ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:07:38.178' AND status != 'pending'
	

2025/06/24 22:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.449ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:07:38.237' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.467ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:07:38.295'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:08:00 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.222ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:08:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.398ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.776ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.099ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:08:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.097ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:08:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.767ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:08:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.446ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:08:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[58.594ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:08:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[58.568ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:08:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.019ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:08:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.187ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:08:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.256ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:08:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.487ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.596ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:08:37.474'

2025/06/24 22:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.166ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:08:37.474'

2025/06/24 22:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.691ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:08:37.474'

2025/06/24 22:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.523ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:38:37.82'

2025/06/24 22:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.714ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:08:37.88' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.232ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.280ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.192ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:08:37.997' AND status != 'pending'
	

2025/06/24 22:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.036ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:38:38'

2025/06/24 22:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.003ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:08:38.056' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.383ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:08:38.057' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.317ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.542ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:08:38.114'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.706ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.216ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:08:38.173' AND status != 'pending'
	

2025/06/24 22:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.823ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:08:38.231' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.661ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:08:38.29'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:09:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.555ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:09:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[59.604ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:09:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.119ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:09:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.206ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.903ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:09:37.475'

2025/06/24 22:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.708ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:54:37.475' LIMIT 50

2025/06/24 22:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[56.555ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:54:37.485' LIMIT 50

2025/06/24 22:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.057ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:09:37.475'

2025/06/24 22:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.158ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:09:37.475'

2025/06/24 22:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.059ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:39:37.82'

2025/06/24 22:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.744ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:09:37.883' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.383ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.497ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.924ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:39:38.001'

2025/06/24 22:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.782ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:09:38.001' AND status != 'pending'
	

2025/06/24 22:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.909ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:09:38.058' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.986ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:09:38.059' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.326ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.280ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:09:38.116'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.491ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.815ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:09:38.182' AND status != 'pending'
	

2025/06/24 22:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.191ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:09:38.24' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.166ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:09:38.298'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:09:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[58.292ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:09:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.606ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:09:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[56.789ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:09:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[57.781ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:09:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.910ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:09:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.344ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:09:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.671ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:09:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[57.965ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:10:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.060ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:10:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[58.683ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:10:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.831ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:10:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.151ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:10:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.310ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:10:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.093ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:10:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.256ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:10:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.463ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.047ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:10:37.476'

2025/06/24 22:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.734ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:10:37.476'

2025/06/24 22:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.126ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:10:37.476'

2025/06/24 22:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.429ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:40:37.821'

2025/06/24 22:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.428ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:10:37.882' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.743ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.370ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.402ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:40:38.001'

2025/06/24 22:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.399ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:10:37.999' AND status != 'pending'
	

2025/06/24 22:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.408ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:10:38.058' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.661ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:10:38.059' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.982ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.080ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.488ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:10:38.117'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.966ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:10:38.174' AND status != 'pending'
	

2025/06/24 22:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.571ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:10:38.237' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.166ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:10:38.294'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:10:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[57.829ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:10:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.038ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:10:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[57.146ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:11:03 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[57.469ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:11:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.184ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:11:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.307ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:11:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[57.338ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:11:22 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[57.953ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:11:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[56.942ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:11:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[56.458ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:11:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[57.627ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:11:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.312ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.823ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:11:37.476'

2025/06/24 22:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.231ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:56:37.476' LIMIT 50

2025/06/24 22:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.872ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:56:37.486' LIMIT 50

2025/06/24 22:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.273ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:11:37.476'

2025/06/24 22:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.132ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:11:37.476'

2025/06/24 22:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.066ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:41:37.821'

2025/06/24 22:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.186ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:11:37.88' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.479ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.849ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.404ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:11:37.996' AND status != 'pending'
	

2025/06/24 22:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.037ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:41:38.002'

2025/06/24 22:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.060ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:11:38.054' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.079ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:11:38.062' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.228ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.114ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:11:38.111'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.998ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.483ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:11:38.18' AND status != 'pending'
	

2025/06/24 22:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.132ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:11:38.239' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.223ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:11:38.299'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.958ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:12:37.476'

2025/06/24 22:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.958ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:12:37.476'

2025/06/24 22:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.914ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:12:37.476'

2025/06/24 22:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.816ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:42:37.822'

2025/06/24 22:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.351ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:12:37.883' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.745ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.979ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.204ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:42:38.002'

2025/06/24 22:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.132ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:12:38.002' AND status != 'pending'
	

2025/06/24 22:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.124ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:12:38.059' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.018ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:12:38.06' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.721ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.469ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.228ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:12:38.119'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.793ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:12:38.174' AND status != 'pending'
	

2025/06/24 22:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.048ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:12:38.232' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.658ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:12:38.289'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.654ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:13:37.477'

2025/06/24 22:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.317ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:58:37.477' LIMIT 50

2025/06/24 22:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.612ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:58:37.487' LIMIT 50

2025/06/24 22:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.350ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:13:37.477'

2025/06/24 22:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.307ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:13:37.477'

2025/06/24 22:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.705ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:43:37.823'

2025/06/24 22:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.441ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:13:37.88' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.684ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.457ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.844ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:13:37.996' AND status != 'pending'
	

2025/06/24 22:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.618ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:43:38.003'

2025/06/24 22:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.883ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:13:38.054' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.664ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:13:38.061' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.241ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.368ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:13:38.111'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.039ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.625ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:13:38.178' AND status != 'pending'
	

2025/06/24 22:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.271ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:13:38.237' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.459ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:13:38.296'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:13:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.450ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:14:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.256ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:14:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[58.605ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.171ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:14:37.478'

2025/06/24 22:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.306ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:14:37.478'

2025/06/24 22:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.589ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:14:37.478'

2025/06/24 22:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.582ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:44:37.824'

2025/06/24 22:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.005ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:14:37.909' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.220ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.516ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.484ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:44:38.003'

2025/06/24 22:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.956ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:14:38.025' AND status != 'pending'
	

2025/06/24 22:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.848ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:14:38.06' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.406ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:14:38.083' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.359ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.469ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.825ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:14:38.142'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.209ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:14:38.174' AND status != 'pending'
	

2025/06/24 22:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.589ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:14:38.231' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.389ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:14:38.29'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:15:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[57.756ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:15:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[58.042ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.335ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:00:37.478' LIMIT 50

2025/06/24 22:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.211ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:15:37.478'

2025/06/24 22:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.638ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:00:37.488' LIMIT 50

2025/06/24 22:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.184ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:15:37.478'

2025/06/24 22:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.858ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:15:37.478'

2025/06/24 22:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.683ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:45:37.824'

2025/06/24 22:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.163ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:15:37.883' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.816ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.877ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.312ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:15:38.001' AND status != 'pending'
	

2025/06/24 22:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.221ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:45:38.003'

2025/06/24 22:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.408ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:15:38.06' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.821ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:15:38.062' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.211ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.577ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:15:38.118'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.086ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.067ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:15:38.18' AND status != 'pending'
	

2025/06/24 22:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.295ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:15:38.239' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.313ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:15:38.298'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:15:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.778ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:16:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.755ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:16:37.479'

2025/06/24 22:16:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.851ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:16:37.479'

2025/06/24 22:16:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.820ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:16:37.479'

2025/06/24 22:16:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.354ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:46:37.824'

2025/06/24 22:16:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.478ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:16:37.885' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:16:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.338ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.640ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.815ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:16:38.004' AND status != 'pending'
	

2025/06/24 22:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.940ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:46:38.004'

2025/06/24 22:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.525ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:16:38.063' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.598ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:16:38.063' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.751ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.965ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.465ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:16:38.124'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.061ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:16:38.182' AND status != 'pending'
	

2025/06/24 22:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.412ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:16:38.242' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.743ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:16:38.3'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.768ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:17:37.479'

2025/06/24 22:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.194ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:02:37.479' LIMIT 50

2025/06/24 22:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[56.922ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:02:37.489' LIMIT 50

2025/06/24 22:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.581ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:17:37.479'

2025/06/24 22:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.706ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:17:37.479'

2025/06/24 22:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.407ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:47:37.825'

2025/06/24 22:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.466ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:17:37.883' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.232ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.071ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.277ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:17:38.001' AND status != 'pending'
	

2025/06/24 22:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.564ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:47:38.005'

2025/06/24 22:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.004ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:17:38.059' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.968ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:17:38.061' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.886ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.526ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.378ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:17:38.118'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.993ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:17:38.175' AND status != 'pending'
	

2025/06/24 22:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.096ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:17:38.232' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.812ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:17:38.291'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.659ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:18:37.48'

2025/06/24 22:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.447ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:18:37.48'

2025/06/24 22:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.519ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:18:37.48'

2025/06/24 22:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.971ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:48:37.825'

2025/06/24 22:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.486ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:18:37.882' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.217ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.504ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.202ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:18:37.997' AND status != 'pending'
	

2025/06/24 22:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.987ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:48:38.005'

2025/06/24 22:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.669ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:18:38.055' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.235ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:18:38.064' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.099ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.076ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:18:38.112'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.645ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.465ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:18:38.18' AND status != 'pending'
	

2025/06/24 22:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.668ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:18:38.239' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.155ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:18:38.298'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.723ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:04:37.465' LIMIT 50

2025/06/24 22:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.073ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:19:37.463'

2025/06/24 22:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.633ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:04:37.473' LIMIT 50

2025/06/24 22:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.314ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:19:37.463'

2025/06/24 22:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.680ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:19:37.463'

2025/06/24 22:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.929ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:49:37.809'

2025/06/24 22:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.779ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:19:37.872' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.560ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.249ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.365ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:49:37.989'

2025/06/24 22:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.827ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:19:37.989' AND status != 'pending'
	

2025/06/24 22:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.974ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:19:38.048' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.587ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:19:38.047' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.028ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.946ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:19:38.107'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.790ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.232ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:19:38.165' AND status != 'pending'
	

2025/06/24 22:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.043ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:19:38.224' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.364ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:19:38.283'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.120ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:20:37.462'

2025/06/24 22:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.491ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:20:37.462'

2025/06/24 22:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.882ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:20:37.462'

2025/06/24 22:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.394ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:50:37.808'

2025/06/24 22:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.018ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:20:37.867' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.309ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.404ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.601ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:50:37.987'

2025/06/24 22:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.787ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:20:37.986' AND status != 'pending'
	

2025/06/24 22:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.203ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:20:38.045' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.290ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:20:38.046' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.579ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.602ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:20:38.106'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.550ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.334ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:20:38.166' AND status != 'pending'
	

2025/06/24 22:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.959ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:20:38.225' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.759ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:20:38.283'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.140ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:06:37.462' LIMIT 50

2025/06/24 22:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.198ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:21:37.463'

2025/06/24 22:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[56.446ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:06:37.473' LIMIT 50

2025/06/24 22:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.560ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:21:37.463'

2025/06/24 22:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.843ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:21:37.463'

2025/06/24 22:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.822ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:51:37.808'

2025/06/24 22:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.548ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:21:37.867' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.021ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.946ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.317ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:51:37.988'

2025/06/24 22:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.330ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:21:37.984' AND status != 'pending'
	

2025/06/24 22:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.643ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:21:38.044' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.668ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:21:38.045' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.961ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.534ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.703ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:21:38.102'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.477ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:21:38.161' AND status != 'pending'
	

2025/06/24 22:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.219ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:21:38.219' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.401ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:21:38.276'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[57.137ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:22:37.463'

2025/06/24 22:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.517ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:22:37.463'

2025/06/24 22:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.407ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:22:37.463'

2025/06/24 22:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.672ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:52:37.808'

2025/06/24 22:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.020ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:22:37.867' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.593ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.882ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.483ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:22:37.982' AND status != 'pending'
	

2025/06/24 22:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.371ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:52:37.988'

2025/06/24 22:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.194ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:22:38.04' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.813ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:22:38.047' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.229ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.777ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:22:38.099'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.316ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.479ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:22:38.164' AND status != 'pending'
	

2025/06/24 22:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.509ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:22:38.223' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.578ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:22:38.282'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.996ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:08:37.463' LIMIT 50

2025/06/24 22:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.472ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:23:37.463'

2025/06/24 22:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.693ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:08:37.473' LIMIT 50

2025/06/24 22:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.751ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:23:37.463'

2025/06/24 22:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.401ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:23:37.463'

2025/06/24 22:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.869ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:53:37.808'

2025/06/24 22:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.104ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:23:37.867' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.248ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.344ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.006ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:23:37.984' AND status != 'pending'
	

2025/06/24 22:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.058ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:53:37.99'

2025/06/24 22:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.710ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:23:38.048' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.114ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:23:38.049' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.578ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.691ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:23:38.106'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.919ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.039ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:23:38.167' AND status != 'pending'
	

2025/06/24 22:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.628ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:23:38.227' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.243ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:23:38.286'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.441ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:24:37.463'

2025/06/24 22:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.989ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:24:37.463'

2025/06/24 22:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.232ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:24:37.463'

2025/06/24 22:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.764ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:54:37.809'

2025/06/24 22:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.600ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:24:37.868' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.000ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.663ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.730ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:24:37.986' AND status != 'pending'
	

2025/06/24 22:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.930ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:54:37.988'

2025/06/24 22:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.055ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:24:38.045' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.373ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:24:38.045' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.645ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.094ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.967ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:24:38.109'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.972ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:24:38.168' AND status != 'pending'
	

2025/06/24 22:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.995ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:24:38.228' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.447ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:24:38.287'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:25:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[64.401ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.505ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:25:37.464'

2025/06/24 22:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.749ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:10:37.464' LIMIT 50

2025/06/24 22:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[56.799ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:10:37.473' LIMIT 50

2025/06/24 22:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.430ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:25:37.464'

2025/06/24 22:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.336ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:25:37.464'

2025/06/24 22:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.891ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:55:37.809'

2025/06/24 22:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.247ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:25:37.868' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.023ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.252ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.424ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:25:37.985' AND status != 'pending'
	

2025/06/24 22:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[55.666ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:55:37.989'

2025/06/24 22:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.285ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:25:38.045' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.137ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:25:38.044' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.711ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.761ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.448ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:25:38.102'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.199ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:25:38.159' AND status != 'pending'
	

2025/06/24 22:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.690ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:25:38.215' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.006ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:25:38.273'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.976ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:26:37.464'

2025/06/24 22:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.463ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:26:37.464'

2025/06/24 22:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.498ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:26:37.464'

2025/06/24 22:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.805ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:56:37.809'

2025/06/24 22:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.722ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:26:37.867' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.536ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.852ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.588ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:26:37.983' AND status != 'pending'
	

2025/06/24 22:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.080ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:56:37.989'

2025/06/24 22:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.063ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:26:38.041' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.998ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:26:38.047' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.599ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.134ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:26:38.098'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.327ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.616ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:26:38.165' AND status != 'pending'
	

2025/06/24 22:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.390ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:26:38.224' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.587ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:26:38.282'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.193ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:12:37.464' LIMIT 50

2025/06/24 22:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.764ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:27:37.464'

2025/06/24 22:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.657ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:12:37.474' LIMIT 50

2025/06/24 22:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.276ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:27:37.464'

2025/06/24 22:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.920ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:27:37.464'

2025/06/24 22:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.886ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:57:37.81'

2025/06/24 22:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.543ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:27:37.869' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.141ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.219ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.766ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:27:37.989' AND status != 'pending'
	

2025/06/24 22:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.019ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:57:37.989'

2025/06/24 22:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.506ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:27:38.048' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.036ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:27:38.048' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.094ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.553ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:27:38.106'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.639ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.684ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:27:38.168' AND status != 'pending'
	

2025/06/24 22:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.208ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:27:38.227' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.911ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:27:38.286'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.750ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:28:37.464'

2025/06/24 22:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.842ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:28:37.464'

2025/06/24 22:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.895ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:28:37.464'

2025/06/24 22:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.348ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:58:37.81'

2025/06/24 22:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.224ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:28:37.869' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.622ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.515ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.879ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:58:37.99'

2025/06/24 22:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.396ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:28:37.989' AND status != 'pending'
	

2025/06/24 22:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.229ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:28:38.048' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.437ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:28:38.048' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.156ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.579ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:28:38.107'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.867ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.855ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:28:38.167' AND status != 'pending'
	

2025/06/24 22:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.290ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:28:38.227' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.246ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:28:38.286'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.104ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:14:37.464' LIMIT 50

2025/06/24 22:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.648ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:29:37.465'

2025/06/24 22:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.908ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:14:37.475' LIMIT 50

2025/06/24 22:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.424ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:29:37.465'

2025/06/24 22:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.811ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:29:37.465'

2025/06/24 22:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.780ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:59:37.81'

2025/06/24 22:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.944ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:29:37.871' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.686ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.207ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.995ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 21:59:37.99'

2025/06/24 22:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.155ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:29:37.99' AND status != 'pending'
	

2025/06/24 22:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.638ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:29:38.048' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.046ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:29:38.049' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.316ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.304ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.846ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:29:38.106'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.206ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:29:38.162' AND status != 'pending'
	

2025/06/24 22:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.855ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:29:38.219' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.474ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:29:38.278'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:30:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.357ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.300ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:30:37.465'

2025/06/24 22:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.471ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:30:37.465'

2025/06/24 22:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.221ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:30:37.465'

2025/06/24 22:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.953ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:00:37.81'

2025/06/24 22:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.722ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:30:37.869' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.709ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.709ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.951ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:30:37.983' AND status != 'pending'
	

2025/06/24 22:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.603ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:00:37.991'

2025/06/24 22:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.752ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:30:38.042' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.304ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:30:38.05' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.463ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.227ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:30:38.1'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.405ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.790ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:30:38.168' AND status != 'pending'
	

2025/06/24 22:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.852ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:30:38.227' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.705ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:30:38.286'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.071ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:31:37.465'

2025/06/24 22:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.932ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:16:37.465' LIMIT 50

2025/06/24 22:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.225ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:16:37.475' LIMIT 50

2025/06/24 22:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.453ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:31:37.465'

2025/06/24 22:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.339ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:31:37.465'

2025/06/24 22:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.999ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:01:37.81'

2025/06/24 22:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.640ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:31:37.868' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.742ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.303ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.008ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:31:37.984' AND status != 'pending'
	

2025/06/24 22:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.404ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:01:37.99'

2025/06/24 22:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.682ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:31:38.042' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.835ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:31:38.048' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.979ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.294ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:31:38.101'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.776ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.567ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:31:38.164' AND status != 'pending'
	

2025/06/24 22:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.626ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:31:38.223' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.265ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:31:38.282'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.713ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:32:37.465'

2025/06/24 22:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.965ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:32:37.465'

2025/06/24 22:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.031ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:32:37.465'

2025/06/24 22:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.033ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:02:37.811'

2025/06/24 22:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.961ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:32:37.87' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.000ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.462ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.676ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:02:37.992'

2025/06/24 22:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.476ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:32:37.991' AND status != 'pending'
	

2025/06/24 22:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.838ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:32:38.05' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.666ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:32:38.05' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.358ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.609ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.235ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:32:38.108'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.235ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:32:38.167' AND status != 'pending'
	

2025/06/24 22:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.363ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:32:38.225' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.558ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:32:38.283'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.774ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:33:37.466'

2025/06/24 22:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.851ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:18:37.465' LIMIT 50

2025/06/24 22:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.322ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:18:37.476' LIMIT 50

2025/06/24 22:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.086ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:33:37.466'

2025/06/24 22:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.455ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:33:37.466'

2025/06/24 22:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.281ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:03:37.811'

2025/06/24 22:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.939ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:33:37.869' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.065ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.377ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.733ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:33:37.983' AND status != 'pending'
	

2025/06/24 22:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.594ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:03:37.992'

2025/06/24 22:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.652ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:33:38.039' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.816ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:33:38.049' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.272ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.870ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:33:38.097'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.599ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.086ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:33:38.168' AND status != 'pending'
	

2025/06/24 22:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.995ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:33:38.226' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.810ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:33:38.285'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.551ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:34:37.466'

2025/06/24 22:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.977ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:34:37.466'

2025/06/24 22:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.142ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:34:37.466'

2025/06/24 22:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.194ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:04:37.811'

2025/06/24 22:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.025ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:34:37.872' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.905ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.689ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.433ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:04:37.992'

2025/06/24 22:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.533ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:34:37.993' AND status != 'pending'
	

2025/06/24 22:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.131ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:34:38.05' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.973ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:34:38.05' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.270ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.502ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.912ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:34:38.108'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.059ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:34:38.166' AND status != 'pending'
	

2025/06/24 22:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.137ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:34:38.223' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.110ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:34:38.281'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:35:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.357ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.471ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:35:37.466'

2025/06/24 22:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.451ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:20:37.466' LIMIT 50

2025/06/24 22:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.930ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:20:37.476' LIMIT 50

2025/06/24 22:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.132ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:35:37.466'

2025/06/24 22:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.038ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:35:37.466'

2025/06/24 22:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.239ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:05:37.811'

2025/06/24 22:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.437ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:35:37.87' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.738ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.084ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.157ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:05:37.992'

2025/06/24 22:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.223ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:35:37.986' AND status != 'pending'
	

2025/06/24 22:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.623ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:35:38.052' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.115ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:35:38.052' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.156ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.208ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.088ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:35:38.11'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.966ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:35:38.166' AND status != 'pending'
	

2025/06/24 22:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.662ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:35:38.224' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.833ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:35:38.282'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.075ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:36:37.466'

2025/06/24 22:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.569ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:36:37.466'

2025/06/24 22:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.888ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:36:37.466'

2025/06/24 22:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.398ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:06:37.811'

2025/06/24 22:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.626ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:36:37.869' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.046ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.752ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.064ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:36:37.985' AND status != 'pending'
	

2025/06/24 22:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.366ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:06:37.993'

2025/06/24 22:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.289ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:36:38.043' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.232ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:36:38.051' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.991ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.817ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:36:38.1'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.741ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.090ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:36:38.169' AND status != 'pending'
	

2025/06/24 22:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.413ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:36:38.228' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.938ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:36:38.286'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:37:03 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[58.213ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.495ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:22:37.467' LIMIT 50

2025/06/24 22:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.318ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:37:37.467'

2025/06/24 22:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.086ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:22:37.477' LIMIT 50

2025/06/24 22:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.410ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:37:37.467'

2025/06/24 22:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.083ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:37:37.467'

2025/06/24 22:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.401ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:07:37.812'

2025/06/24 22:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.120ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:37:37.872' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.148ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.966ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.457ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:37:37.988' AND status != 'pending'
	

2025/06/24 22:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.247ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:07:37.992'

2025/06/24 22:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.228ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:37:38.047' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.033ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:37:38.05' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.499ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.927ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:37:38.105'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.377ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.545ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:37:38.167' AND status != 'pending'
	

2025/06/24 22:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.867ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:37:38.225' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.423ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:37:38.284'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.320ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:38:37.467'

2025/06/24 22:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.617ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:38:37.467'

2025/06/24 22:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.956ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:38:37.467'

2025/06/24 22:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.203ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:08:37.813'

2025/06/24 22:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.578ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:38:37.872' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.833ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.950ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.081ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:08:37.992'

2025/06/24 22:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.929ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:38:37.992' AND status != 'pending'
	

2025/06/24 22:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.145ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:38:38.05' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.107ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:38:38.051' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.001ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.319ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.307ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:38:38.109'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.922ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:38:38.169' AND status != 'pending'
	

2025/06/24 22:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.370ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:38:38.228' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.501ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:38:38.287'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.725ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:24:37.467' LIMIT 50

2025/06/24 22:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.771ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:39:37.467'

2025/06/24 22:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[56.104ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:24:37.478' LIMIT 50

2025/06/24 22:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.251ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:39:37.467'

2025/06/24 22:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.563ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:39:37.467'

2025/06/24 22:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.323ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:09:37.813'

2025/06/24 22:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.340ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:39:37.872' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.556ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.414ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.614ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:09:37.993'

2025/06/24 22:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.785ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:39:38.002' AND status != 'pending'
	

2025/06/24 22:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.317ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:39:38.05' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.994ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:39:38.061' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.311ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.525ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.525ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:39:38.12'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.466ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:39:38.164' AND status != 'pending'
	

2025/06/24 22:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.357ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:39:38.222' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.803ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:39:38.278'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.408ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:40:37.468'

2025/06/24 22:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.829ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:40:37.468'

2025/06/24 22:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.062ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:40:37.468'

2025/06/24 22:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.036ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:10:37.813'

2025/06/24 22:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.826ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:40:37.871' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.510ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.586ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.809ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:40:37.987' AND status != 'pending'
	

2025/06/24 22:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.370ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:10:37.993'

2025/06/24 22:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.983ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:40:38.045' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.504ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:40:38.052' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.303ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.255ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:40:38.102'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.037ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.647ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:40:38.17' AND status != 'pending'
	

2025/06/24 22:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.968ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:40:38.229' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.206ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:40:38.288'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.772ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:41:37.468'

2025/06/24 22:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.850ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:26:37.468' LIMIT 50

2025/06/24 22:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.894ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:26:37.478' LIMIT 50

2025/06/24 22:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.689ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:41:37.468'

2025/06/24 22:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.215ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:41:37.468'

2025/06/24 22:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.959ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:11:37.813'

2025/06/24 22:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.697ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:41:37.872' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.701ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.647ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.565ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:41:37.987' AND status != 'pending'
	

2025/06/24 22:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.606ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:11:37.994'

2025/06/24 22:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.386ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:41:38.045' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.551ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:41:38.052' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.817ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.876ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:41:38.103'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.879ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.206ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:41:38.168' AND status != 'pending'
	

2025/06/24 22:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.071ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:41:38.227' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.598ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:41:38.286'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.099ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:42:37.468'

2025/06/24 22:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.175ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:42:37.468'

2025/06/24 22:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.610ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:42:37.468'

2025/06/24 22:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.046ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:12:37.814'

2025/06/24 22:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.690ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:42:37.874' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.175ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.265ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.384ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:42:37.99' AND status != 'pending'
	

2025/06/24 22:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.490ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:12:37.994'

2025/06/24 22:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.569ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:42:38.049' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.593ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:42:38.05' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.528ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.491ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.307ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:42:38.107'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.931ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:42:38.165' AND status != 'pending'
	

2025/06/24 22:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.515ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:42:38.223' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.851ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:42:38.28'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.281ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:43:37.469'

2025/06/24 22:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.248ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:28:37.469' LIMIT 50

2025/06/24 22:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.380ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:28:37.478' LIMIT 50

2025/06/24 22:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.784ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:43:37.469'

2025/06/24 22:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.678ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:43:37.469'

2025/06/24 22:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.466ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:13:37.813'

2025/06/24 22:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.357ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:43:37.871' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.532ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.327ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.604ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:43:37.987' AND status != 'pending'
	

2025/06/24 22:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.682ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:13:37.994'

2025/06/24 22:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.204ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:43:38.045' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.718ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:43:38.053' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.348ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.492ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:43:38.102'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.351ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.702ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:43:38.171' AND status != 'pending'
	

2025/06/24 22:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.259ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:43:38.23' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.452ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:43:38.289'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.217ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:44:37.469'

2025/06/24 22:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.906ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:44:37.469'

2025/06/24 22:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.129ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:44:37.469'

2025/06/24 22:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.176ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:14:37.814'

2025/06/24 22:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.039ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:44:37.874' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.244ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.531ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.616ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:14:37.994'

2025/06/24 22:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.587ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:44:37.992' AND status != 'pending'
	

2025/06/24 22:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.350ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:44:38.052' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.850ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:44:38.052' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.448ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.453ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.828ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:44:38.11'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.262ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:44:38.166' AND status != 'pending'
	

2025/06/24 22:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.505ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:44:38.224' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.072ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:44:38.282'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:45:34 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.152ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.811ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:45:37.469'

2025/06/24 22:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.316ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:30:37.469' LIMIT 50

2025/06/24 22:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.066ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:30:37.479' LIMIT 50

2025/06/24 22:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.446ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:45:37.469'

2025/06/24 22:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.926ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:45:37.469'

2025/06/24 22:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.216ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:15:37.815'

2025/06/24 22:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.129ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:45:37.873' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.651ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.226ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.934ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:45:37.989' AND status != 'pending'
	

2025/06/24 22:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.962ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:15:37.995'

2025/06/24 22:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.503ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:45:38.046' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.056ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:45:38.053' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.040ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.550ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:45:38.104'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.934ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.588ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:45:38.17' AND status != 'pending'
	

2025/06/24 22:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.708ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:45:38.229' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.864ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:45:38.288'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:45:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.785ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:45:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.446ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:45:43 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[57.988ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:45:43 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.768ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:46:00 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.119ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:46:02 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.432ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:46:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[63.112ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:46:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.761ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.380ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:46:37.469'

2025/06/24 22:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.488ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:46:37.469'

2025/06/24 22:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.540ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:46:37.469'

2025/06/24 22:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.967ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:16:37.815'

2025/06/24 22:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.112ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:46:37.874' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.484ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.028ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.203ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:16:37.996'

2025/06/24 22:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.486ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:46:37.996' AND status != 'pending'
	

2025/06/24 22:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.162ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:46:38.054' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.409ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:46:38.054' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.124ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.928ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.079ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:46:38.112'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.516ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:46:38.171' AND status != 'pending'
	

2025/06/24 22:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.103ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:46:38.228' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.660ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:46:38.286'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:46:43 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.156ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:47:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[58.549ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:47:27 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.014ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:47:27 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.323ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:47:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.486ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:47:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.974ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:47:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.511ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:47:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.038ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.077ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:47:37.47'

2025/06/24 22:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.601ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:32:37.469' LIMIT 50

2025/06/24 22:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.330ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:32:37.48' LIMIT 50

2025/06/24 22:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.778ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:47:37.47'

2025/06/24 22:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.035ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:47:37.47'

2025/06/24 22:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.798ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:17:37.815'

2025/06/24 22:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.077ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:47:37.873' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.349ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.936ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.796ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:47:37.992' AND status != 'pending'
	

2025/06/24 22:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.833ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:17:37.995'

2025/06/24 22:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.816ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:47:38.049' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.660ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:47:38.054' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.415ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.856ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:47:38.107'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.372ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.043ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:47:38.172' AND status != 'pending'
	

2025/06/24 22:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.980ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:47:38.232' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.171ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:47:38.291'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:48:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.739ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:48:37.47'

2025/06/24 22:48:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.357ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:48:37.47'

2025/06/24 22:48:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.677ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:48:37.47'

2025/06/24 22:48:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.997ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:18:37.815'

2025/06/24 22:48:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.452ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:48:37.875' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:48:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.394ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:48:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.705ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.603ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:18:37.995'

2025/06/24 22:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.650ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:48:37.994' AND status != 'pending'
	

2025/06/24 22:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.443ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:48:38.053' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.512ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:48:38.053' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.709ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.625ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.569ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:48:38.111'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.340ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:48:38.168' AND status != 'pending'
	

2025/06/24 22:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.686ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:48:38.226' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.077ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:48:38.283'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:48:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.382ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:48:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.964ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.132ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:34:37.47' LIMIT 50

2025/06/24 22:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.598ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:49:37.47'

2025/06/24 22:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.457ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:34:37.48' LIMIT 50

2025/06/24 22:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.485ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:49:37.47'

2025/06/24 22:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.724ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:49:37.47'

2025/06/24 22:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.052ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:19:37.816'

2025/06/24 22:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.495ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:49:37.875' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.377ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.380ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.701ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:49:37.993' AND status != 'pending'
	

2025/06/24 22:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.660ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:19:37.995'

2025/06/24 22:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.816ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:49:38.052' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.547ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:49:38.053' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.761ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.758ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:49:38.111'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.124ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.031ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:49:38.17' AND status != 'pending'
	

2025/06/24 22:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.795ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:49:38.228' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.567ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:49:38.287'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:50:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[62.142ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:50:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.117ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:50:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.884ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:50:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.934ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:50:37.47'

2025/06/24 22:50:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.460ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:50:37.47'

2025/06/24 22:50:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.409ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:50:37.47'

2025/06/24 22:50:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.441ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:20:37.816'

2025/06/24 22:50:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.897ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:50:37.874' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:50:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.327ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:50:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.254ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.157ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:50:37.992' AND status != 'pending'
	

2025/06/24 22:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.135ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:20:37.996'

2025/06/24 22:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.381ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:50:38.052' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.611ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:50:38.054' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.388ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.152ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:50:38.11'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.213ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.974ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:50:38.172' AND status != 'pending'
	

2025/06/24 22:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.875ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:50:38.231' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.326ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:50:38.29'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.576ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:36:37.471' LIMIT 50

2025/06/24 22:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.774ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:51:37.471'

2025/06/24 22:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[56.400ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:36:37.481' LIMIT 50

2025/06/24 22:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.587ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:51:37.471'

2025/06/24 22:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.586ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:51:37.471'

2025/06/24 22:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.547ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:21:37.816'

2025/06/24 22:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.008ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:51:37.875' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.638ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.067ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.104ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:21:37.996'

2025/06/24 22:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.931ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:51:37.994' AND status != 'pending'
	

2025/06/24 22:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.420ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:51:38.052' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.054ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:51:38.055' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.654ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.887ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.407ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:51:38.113'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.739ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:51:38.168' AND status != 'pending'
	

2025/06/24 22:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.351ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:51:38.226' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.053ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:51:38.283'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:52:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.046ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:52:37.471'

2025/06/24 22:52:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.063ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:52:37.471'

2025/06/24 22:52:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.018ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:52:37.471'

2025/06/24 22:52:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.707ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:22:37.816'

2025/06/24 22:52:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.517ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:52:37.874' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:52:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.646ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:52:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.622ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.529ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:52:37.991' AND status != 'pending'
	

2025/06/24 22:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.093ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:22:37.997'

2025/06/24 22:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.811ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:52:38.049' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.368ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:52:38.055' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.306ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.975ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:52:38.107'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.340ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.036ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:52:38.173' AND status != 'pending'
	

2025/06/24 22:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.289ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:52:38.232' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.872ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:52:38.291'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:53:34 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.018ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:53:34 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.353ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.611ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:38:37.472' LIMIT 50

2025/06/24 22:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.416ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:53:37.471'

2025/06/24 22:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.013ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:38:37.481' LIMIT 50

2025/06/24 22:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.664ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:53:37.471'

2025/06/24 22:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.135ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:53:37.471'

2025/06/24 22:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.659ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:23:37.817'

2025/06/24 22:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.765ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:53:37.877' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.122ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.255ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.930ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:53:37.995' AND status != 'pending'
	

2025/06/24 22:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.839ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:23:37.997'

2025/06/24 22:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.885ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:53:38.055' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.948ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:53:38.055' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.537ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.581ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.733ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:53:38.115'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.781ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:53:38.175' AND status != 'pending'
	

2025/06/24 22:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.875ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:53:38.234' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.383ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:53:38.293'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:53:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.121ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:53:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.975ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:53:54 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.060ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:53:54 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.513ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:54:02 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.390ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:54:02 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.524ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:54:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.230ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:54:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.823ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[59.295ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.731ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:54:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.543ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:54:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.498ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:54:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.547ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:54:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[66.955ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:54:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.168ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:54:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.333ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:54:27 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.307ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:54:27 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.565ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:54:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.955ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:54:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.603ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:54:30 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.227ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:54:30 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[64.217ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:54:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.269ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:54:37.472'

2025/06/24 22:54:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.871ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:54:37.472'

2025/06/24 22:54:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.968ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:54:37.472'

2025/06/24 22:54:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.337ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:24:37.817'

2025/06/24 22:54:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.338ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:54:37.878' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:54:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.488ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:54:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.370ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.683ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:54:37.997' AND status != 'pending'
	

2025/06/24 22:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.528ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:24:37.997'

2025/06/24 22:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.166ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:54:38.055' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.468ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:54:38.056' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.270ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.907ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:54:38.115'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.494ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.128ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:54:38.175' AND status != 'pending'
	

2025/06/24 22:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.321ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:54:38.234' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.914ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:54:38.294'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:55:27 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.262ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:55:27 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.710ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.541ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:40:37.471' LIMIT 50

2025/06/24 22:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.556ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:55:37.472'

2025/06/24 22:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[56.887ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:40:37.482' LIMIT 50

2025/06/24 22:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.823ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:55:37.472'

2025/06/24 22:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.204ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:55:37.472'

2025/06/24 22:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.405ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:25:37.817'

2025/06/24 22:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.051ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:55:37.877' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.552ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.485ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.207ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:25:37.997'

2025/06/24 22:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.076ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:55:37.996' AND status != 'pending'
	

2025/06/24 22:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.171ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:55:38.054' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.406ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:55:38.055' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.818ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.850ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.752ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:55:38.113'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.659ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:55:38.171' AND status != 'pending'
	

2025/06/24 22:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.819ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:55:38.229' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.278ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:55:38.287'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:56:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[57.359ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:56:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.375ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:56:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.297ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:56:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.912ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:56:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.651ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:56:37.472'

2025/06/24 22:56:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.728ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:56:37.472'

2025/06/24 22:56:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.598ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:56:37.472'

2025/06/24 22:56:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.066ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:26:37.818'

2025/06/24 22:56:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.310ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:56:37.878' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:56:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.803ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:56:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.217ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.046ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:26:37.997'

2025/06/24 22:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.986ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:56:37.997' AND status != 'pending'
	

2025/06/24 22:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.271ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:56:38.054' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.532ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:56:38.055' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.532ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.010ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.752ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:56:38.114'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.241ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:56:38.17' AND status != 'pending'
	

2025/06/24 22:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.835ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:56:38.227' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:56:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.038ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:56:38.285'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:57:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.921ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:57:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.570ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:57:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.359ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:57:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.420ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:57:22 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.665ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:57:22 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.686ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:57:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.894ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:57:37.472'

2025/06/24 22:57:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.867ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:42:37.473' LIMIT 50

2025/06/24 22:57:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.914ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:42:37.482' LIMIT 50

2025/06/24 22:57:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.429ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:57:37.472'

2025/06/24 22:57:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[56.374ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:57:37.472'

2025/06/24 22:57:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.134ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:27:37.817'

2025/06/24 22:57:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.133ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:57:37.874' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:57:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.519ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:57:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.536ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.270ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:57:37.989' AND status != 'pending'
	

2025/06/24 22:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.011ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:27:37.999'

2025/06/24 22:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.590ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:57:38.047' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.974ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:57:38.057' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.120ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.728ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:57:38.104'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.242ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.823ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:57:38.175' AND status != 'pending'
	

2025/06/24 22:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.078ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:57:38.234' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:57:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.597ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:57:38.293'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:57:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.194ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:57:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.763ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:58:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.722ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:58:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.836ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[57.858ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.918ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:58:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.095ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:58:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.151ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:58:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.307ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:58:37.473'

2025/06/24 22:58:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.645ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:58:37.473'

2025/06/24 22:58:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.870ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:58:37.473'

2025/06/24 22:58:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.247ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:28:37.818'

2025/06/24 22:58:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.149ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:58:37.876' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:58:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.005ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:58:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.002ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.851ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:58:37.994' AND status != 'pending'
	

2025/06/24 22:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.554ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:28:37.998'

2025/06/24 22:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.195ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:58:38.053' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.712ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:58:38.055' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.896ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.558ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.790ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:58:38.112'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.323ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:58:38.171' AND status != 'pending'
	

2025/06/24 22:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.875ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:58:38.228' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:58:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.734ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:58:38.286'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:59:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.120ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:59:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.944ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:59:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.230ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:59:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.489ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:59:27 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[59.156ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:59:27 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.048ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:59:27 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.021ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:59:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.921ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:44:37.473' LIMIT 50

2025/06/24 22:59:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.135ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 22:59:37.473'

2025/06/24 22:59:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.063ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:44:37.483' LIMIT 50

2025/06/24 22:59:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.916ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 22:59:37.473'

2025/06/24 22:59:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.368ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 22:59:37.473'

2025/06/24 22:59:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.990ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:29:37.818'

2025/06/24 22:59:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.112ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:59:37.877' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:59:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.097ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:59:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.333ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.283ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:59:37.997' AND status != 'pending'
	

2025/06/24 22:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.002ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:29:37.998'

2025/06/24 22:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.343ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:59:38.057' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.363ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 21:59:38.057' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 22:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.806ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 22:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.398ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:59:38.117'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.404ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 22:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.457ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 21:59:38.176' AND status != 'pending'
	

2025/06/24 22:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.220ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 21:59:38.235' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 22:59:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.101ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 21:59:38.294'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 22:59:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[58.583ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 22:59:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[59.663ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:59:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.857ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 22:59:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.274ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:00:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.972ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:00:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.963ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:00:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.448ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:00:37.473'

2025/06/24 23:00:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.957ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:00:37.473'

2025/06/24 23:00:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.197ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:00:37.473'

2025/06/24 23:00:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.446ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:30:37.819'

2025/06/24 23:00:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.127ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:00:37.878' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:00:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.643ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:00:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.313ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.947ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:00:37.996' AND status != 'pending'
	

2025/06/24 23:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.521ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:30:37.999'

2025/06/24 23:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.482ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:00:38.055' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.250ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:00:38.056' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.421ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.948ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:00:38.114'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.433ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.447ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:00:38.174' AND status != 'pending'
	

2025/06/24 23:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.144ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:00:38.232' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:00:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.586ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:00:38.291'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:00:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.511ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:00:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.387ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:01:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.234ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:01:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.597ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:01:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.001ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:01:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.579ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:01:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.643ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:01:37.474'

2025/06/24 23:01:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.319ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:46:37.473' LIMIT 50

2025/06/24 23:01:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.617ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:46:37.484' LIMIT 50

2025/06/24 23:01:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.811ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:01:37.474'

2025/06/24 23:01:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.821ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:01:37.474'

2025/06/24 23:01:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.488ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:31:37.819'

2025/06/24 23:01:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.248ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:01:37.878' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:01:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.457ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:01:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.758ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.395ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:01:37.996' AND status != 'pending'
	

2025/06/24 23:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.124ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:31:37.999'

2025/06/24 23:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.129ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:01:38.055' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.243ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:01:38.054' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.706ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.861ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.903ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:01:38.115'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.405ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:01:38.172' AND status != 'pending'
	

2025/06/24 23:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.076ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:01:38.23' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:01:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.566ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:01:38.288'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:01:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.909ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:01:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.085ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:01:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.285ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:01:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.749ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:02:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.181ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:02:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.557ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:02:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.791ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:02:37.474'

2025/06/24 23:02:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.628ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:02:37.474'

2025/06/24 23:02:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.113ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:02:37.474'

2025/06/24 23:02:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.456ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:32:37.819'

2025/06/24 23:02:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.270ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:02:37.878' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:02:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.004ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:02:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.027ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.332ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:02:37.996' AND status != 'pending'
	

2025/06/24 23:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.710ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:32:37.999'

2025/06/24 23:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.328ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:02:38.054' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.157ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:02:38.056' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.000ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.497ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.486ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:02:38.113'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.297ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:02:38.17' AND status != 'pending'
	

2025/06/24 23:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.174ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:02:38.228' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:02:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.116ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:02:38.285'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:03:02 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.502ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:03:02 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.088ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:03:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.592ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:48:37.474' LIMIT 50

2025/06/24 23:03:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.085ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:03:37.474'

2025/06/24 23:03:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.819ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:48:37.484' LIMIT 50

2025/06/24 23:03:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.809ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:03:37.474'

2025/06/24 23:03:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.503ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:03:37.474'

2025/06/24 23:03:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.657ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:33:37.82'

2025/06/24 23:03:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.193ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:03:37.879' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:03:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.134ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:03:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.352ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.517ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:03:37.997' AND status != 'pending'
	

2025/06/24 23:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.272ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:33:37.999'

2025/06/24 23:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.142ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:03:38.055' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.162ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:03:38.057' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.449ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.013ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:03:38.114'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.358ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.176ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:03:38.176' AND status != 'pending'
	

2025/06/24 23:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.289ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:03:38.236' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:03:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.748ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:03:38.295'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:04:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.955ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:04:37.474'

2025/06/24 23:04:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.308ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:04:37.474'

2025/06/24 23:04:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.831ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:04:37.474'

2025/06/24 23:04:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.323ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:34:37.82'

2025/06/24 23:04:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.231ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:04:37.879' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:04:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.731ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:04:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.422ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.478ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:34:38'

2025/06/24 23:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.180ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:04:37.998' AND status != 'pending'
	

2025/06/24 23:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.505ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:04:38.057' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.562ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:04:38.057' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.008ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.419ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.688ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:04:38.117'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.223ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:04:38.178' AND status != 'pending'
	

2025/06/24 23:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.440ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:04:38.236' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:04:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.658ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:04:38.294'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:04:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.994ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:04:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.325ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:04:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.158ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:04:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.301ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:05:00 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.071ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:05:00 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.701ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[60.467ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 23:05:37.475' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/24 23:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.544ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:05:37.475'

2025/06/24 23:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.212ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:50:37.474' LIMIT 50

2025/06/24 23:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[28.722ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-17 23:05:37.536'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/24 23:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.202ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:05:37.475'

2025/06/24 23:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.089ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:05:37.475'

2025/06/24 23:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[187.421ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:50:37.484' LIMIT 50

2025/06/24 23:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[218.636ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-23 23:05:37.484' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/24 23:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[29.812ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-17 23:05:37.703'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/24 23:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.204ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:35:37.82'

2025/06/24 23:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.603ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:05:37.881' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:05:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.446ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.947ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.837ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:35:38.001'

2025/06/24 23:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.014ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:05:38.005' AND status != 'pending'
	

2025/06/24 23:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.230ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:05:38.062' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.153ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:05:38.064' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.863ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.974ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.405ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:05:38.123'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.664ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:05:38.182' AND status != 'pending'
	

2025/06/24 23:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.322ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:05:38.242' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:05:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.384ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:05:38.302'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.407ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:06:37.475'

2025/06/24 23:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.325ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:06:37.475'

2025/06/24 23:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.210ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:06:37.475'

2025/06/24 23:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.321ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:36:37.82'

2025/06/24 23:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[72.230ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:06:37.881' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[39.968ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[58.026ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[83.024ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:36:38'

2025/06/24 23:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[68.502ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:06:38.052' AND status != 'pending'
	

2025/06/24 23:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[72.101ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:06:38.084' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.711ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.860ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:06:38.121' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.560ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.722ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:06:38.187'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.084ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:06:38.221' AND status != 'pending'
	

2025/06/24 23:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.283ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:06:38.28' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:06:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.257ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:06:38.341'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.899ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:07:37.475'

2025/06/24 23:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.816ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:52:37.475' LIMIT 50

2025/06/24 23:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.381ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:07:37.475'

2025/06/24 23:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.744ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:07:37.475'

2025/06/24 23:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[188.483ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:52:37.486' LIMIT 50

2025/06/24 23:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.724ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:37:37.82'

2025/06/24 23:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.909ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:07:37.881' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.426ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.046ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.971ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:37:38.001'

2025/06/24 23:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.980ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:07:38.002' AND status != 'pending'
	

2025/06/24 23:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.671ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:07:38.061' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.647ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:07:38.062' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.230ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.255ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.775ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:07:38.122'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.237ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:07:38.181' AND status != 'pending'
	

2025/06/24 23:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.487ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:07:38.241' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.079ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:07:38.301'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:08:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.383ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:08:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.575ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.832ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:08:37.475'

2025/06/24 23:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.675ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:08:37.475'

2025/06/24 23:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.991ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:08:37.475'

2025/06/24 23:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.069ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:38:37.821'

2025/06/24 23:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.357ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:08:37.885' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.197ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.015ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.784ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:38:38.001'

2025/06/24 23:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.348ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:08:38.006' AND status != 'pending'
	

2025/06/24 23:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.639ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:08:38.062' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.670ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:08:38.067' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.837ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.784ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.813ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:08:38.126'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.833ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:08:38.182' AND status != 'pending'
	

2025/06/24 23:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.240ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:08:38.249' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.026ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:08:38.308'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.375ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:54:37.475' LIMIT 50

2025/06/24 23:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.284ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:09:37.476'

2025/06/24 23:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.715ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:54:37.486' LIMIT 50

2025/06/24 23:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.553ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:09:37.476'

2025/06/24 23:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.512ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:09:37.476'

2025/06/24 23:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.337ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:39:37.821'

2025/06/24 23:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.091ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:09:37.883' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.623ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.117ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.943ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:39:38.001'

2025/06/24 23:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.715ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:09:38.003' AND status != 'pending'
	

2025/06/24 23:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.612ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:09:38.061' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.880ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:09:38.063' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.413ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.064ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.451ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:09:38.121'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.894ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:09:38.18' AND status != 'pending'
	

2025/06/24 23:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.011ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:09:38.24' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.422ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:09:38.3'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:09:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.232ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:09:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.939ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.507ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:10:37.478'

2025/06/24 23:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.683ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:10:37.478'

2025/06/24 23:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.855ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:10:37.478'

2025/06/24 23:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.188ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:40:37.821'

2025/06/24 23:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.685ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:10:37.883' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:10:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.360ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.030ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.001ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:40:38.004'

2025/06/24 23:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.029ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:10:38.005' AND status != 'pending'
	

2025/06/24 23:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.384ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:10:38.064' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.906ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:10:38.065' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.822ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.340ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.515ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:10:38.126'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.256ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:10:38.188' AND status != 'pending'
	

2025/06/24 23:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.005ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:10:38.248' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:10:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.580ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:10:38.31'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.460ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:56:37.476' LIMIT 50

2025/06/24 23:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.750ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:11:37.476'

2025/06/24 23:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.636ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:56:37.486' LIMIT 50

2025/06/24 23:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.327ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:11:37.476'

2025/06/24 23:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.529ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:11:37.476'

2025/06/24 23:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.223ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:41:37.821'

2025/06/24 23:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.176ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:11:37.881' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.674ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.170ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.255ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:41:38.002'

2025/06/24 23:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.420ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:11:38.004' AND status != 'pending'
	

2025/06/24 23:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.335ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:11:38.062' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.522ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:11:38.064' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.139ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.082ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.536ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:11:38.124'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.534ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:11:38.182' AND status != 'pending'
	

2025/06/24 23:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.340ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:11:38.242' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:11:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.568ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:11:38.302'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:12:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.876ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:12:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.187ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.225ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:12:37.477'

2025/06/24 23:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.487ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:12:37.477'

2025/06/24 23:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.050ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:12:37.477'

2025/06/24 23:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.223ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:42:37.822'

2025/06/24 23:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.206ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:12:37.882' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.937ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.865ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.141ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:42:38.003'

2025/06/24 23:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.989ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:12:38.003' AND status != 'pending'
	

2025/06/24 23:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.812ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:12:38.063' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.149ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:12:38.063' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.452ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.852ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.085ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:12:38.125'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.499ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:12:38.186' AND status != 'pending'
	

2025/06/24 23:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.842ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:12:38.246' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:12:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.022ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:12:38.307'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.987ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:58:37.476' LIMIT 50

2025/06/24 23:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.212ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:13:37.477'

2025/06/24 23:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.137ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:58:37.487' LIMIT 50

2025/06/24 23:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.518ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:13:37.477'

2025/06/24 23:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.377ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:13:37.477'

2025/06/24 23:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.662ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:43:37.822'

2025/06/24 23:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.710ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:13:37.883' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.316ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.990ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.168ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:43:38.003'

2025/06/24 23:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.463ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:13:38.005' AND status != 'pending'
	

2025/06/24 23:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.291ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:13:38.063' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.650ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:13:38.064' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.468ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.661ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.062ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:13:38.124'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.110ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:13:38.187' AND status != 'pending'
	

2025/06/24 23:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.248ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:13:38.249' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:13:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.955ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:13:38.309'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.103ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:14:37.477'

2025/06/24 23:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.506ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:14:37.477'

2025/06/24 23:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.588ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:14:37.477'

2025/06/24 23:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.176ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:44:37.822'

2025/06/24 23:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.042ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:14:37.884' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.045ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.385ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.388ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:14:38.005' AND status != 'pending'
	

2025/06/24 23:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.052ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:44:38.003'

2025/06/24 23:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.307ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:14:38.065' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.888ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:14:38.065' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.516ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.031ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:14:38.128'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.098ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.802ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:14:38.191' AND status != 'pending'
	

2025/06/24 23:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.011ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:14:38.25' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:14:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.941ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:14:38.311'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.117ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:15:37.478'

2025/06/24 23:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.705ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:00:37.477' LIMIT 50

2025/06/24 23:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.771ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:00:37.487' LIMIT 50

2025/06/24 23:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.839ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:15:37.478'

2025/06/24 23:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.483ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:15:37.478'

2025/06/24 23:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.783ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:45:37.823'

2025/06/24 23:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.503ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:15:37.884' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.249ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.526ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.734ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:45:38.003'

2025/06/24 23:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.003ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:15:38.004' AND status != 'pending'
	

2025/06/24 23:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.133ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:15:38.062' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.286ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:15:38.064' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.156ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.720ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.310ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:15:38.124'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.852ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:15:38.182' AND status != 'pending'
	

2025/06/24 23:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.891ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:15:38.242' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:15:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.831ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:15:38.302'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:16:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.382ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:16:37.478'

2025/06/24 23:16:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.524ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:16:37.478'

2025/06/24 23:16:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.955ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:16:37.478'

2025/06/24 23:16:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.122ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:46:37.823'

2025/06/24 23:16:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.849ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:16:37.882' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:16:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.241ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.686ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.652ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:16:38.002' AND status != 'pending'
	

2025/06/24 23:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.183ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:46:38.003'

2025/06/24 23:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.929ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:16:38.062' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.897ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:16:38.062' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.177ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.893ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:16:38.123'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.209ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.895ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:16:38.184' AND status != 'pending'
	

2025/06/24 23:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.093ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:16:38.244' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.928ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:16:38.305'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.951ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:17:37.478'

2025/06/24 23:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.220ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:02:37.478' LIMIT 50

2025/06/24 23:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.201ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:02:37.488' LIMIT 50

2025/06/24 23:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.617ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:17:37.478'

2025/06/24 23:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.028ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:17:37.478'

2025/06/24 23:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.648ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:47:37.823'

2025/06/24 23:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.686ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:17:37.883' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:17:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.712ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.215ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.694ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:17:38.003' AND status != 'pending'
	

2025/06/24 23:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.765ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:47:38.003'

2025/06/24 23:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.877ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:17:38.063' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.884ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:17:38.063' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.079ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.301ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:17:38.124'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.079ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.116ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:17:38.184' AND status != 'pending'
	

2025/06/24 23:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.787ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:17:38.245' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.863ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:17:38.306'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.313ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:18:37.478'

2025/06/24 23:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.311ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:18:37.478'

2025/06/24 23:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.894ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:18:37.478'

2025/06/24 23:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.014ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:48:37.824'

2025/06/24 23:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.520ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:18:37.885' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:18:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.185ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.935ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.395ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:48:38.004'

2025/06/24 23:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.879ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:18:38.005' AND status != 'pending'
	

2025/06/24 23:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.295ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:18:38.065' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.788ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:18:38.065' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.235ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.296ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.155ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:18:38.126'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.478ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:18:38.188' AND status != 'pending'
	

2025/06/24 23:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.929ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:18:38.249' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.029ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:18:38.309'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.265ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:04:37.478' LIMIT 50

2025/06/24 23:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.169ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:19:37.478'

2025/06/24 23:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.255ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:04:37.489' LIMIT 50

2025/06/24 23:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.201ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:19:37.478'

2025/06/24 23:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.362ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:19:37.478'

2025/06/24 23:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.311ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:49:37.824'

2025/06/24 23:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.439ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:19:37.884' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:19:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.652ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.109ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.175ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:49:38.006'

2025/06/24 23:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.212ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:19:38.007' AND status != 'pending'
	

2025/06/24 23:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.192ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:19:38.065' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.539ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:19:38.067' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.879ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.760ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.435ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:19:38.128'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.552ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:19:38.185' AND status != 'pending'
	

2025/06/24 23:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.447ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:19:38.246' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.516ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:19:38.307'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.503ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:20:37.479'

2025/06/24 23:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.912ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:20:37.479'

2025/06/24 23:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.036ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:20:37.479'

2025/06/24 23:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.195ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:50:37.826'

2025/06/24 23:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.242ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:20:37.886' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.243ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.893ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.690ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:20:38.007' AND status != 'pending'
	

2025/06/24 23:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.877ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:50:38.005'

2025/06/24 23:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.772ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:20:38.066' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.751ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:20:38.066' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.940ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.958ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.470ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:20:38.125'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.813ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:20:38.189' AND status != 'pending'
	

2025/06/24 23:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.888ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:20:38.249' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:20:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.441ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:20:38.309'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.748ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:06:37.479' LIMIT 50

2025/06/24 23:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.044ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:06:37.489' LIMIT 50

2025/06/24 23:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.514ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:21:37.48'

2025/06/24 23:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.955ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:21:37.48'

2025/06/24 23:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.421ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:21:37.48'

2025/06/24 23:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.675ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:51:37.825'

2025/06/24 23:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.769ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:21:37.886' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:21:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.474ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.060ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.935ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:51:38.005'

2025/06/24 23:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.042ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:21:38.007' AND status != 'pending'
	

2025/06/24 23:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.466ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:21:38.064' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.071ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:21:38.067' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.272ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.428ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.665ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:21:38.128'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.189ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:21:38.183' AND status != 'pending'
	

2025/06/24 23:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.821ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:21:38.242' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:21:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.882ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:21:38.302'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.516ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:22:37.479'

2025/06/24 23:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.446ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:22:37.479'

2025/06/24 23:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.160ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:22:37.479'

2025/06/24 23:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.160ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:52:37.825'

2025/06/24 23:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.987ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:22:37.887' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.743ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.045ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.592ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:52:38.005'

2025/06/24 23:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.067ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:22:38.007' AND status != 'pending'
	

2025/06/24 23:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.218ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:22:38.066' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.693ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:22:38.066' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.189ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.455ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:22:38.128'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.628ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.215ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:22:38.188' AND status != 'pending'
	

2025/06/24 23:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.235ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:22:38.253' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:22:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.988ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:22:38.313'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.857ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:23:37.479'

2025/06/24 23:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.707ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:08:37.48' LIMIT 50

2025/06/24 23:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.505ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:08:37.49' LIMIT 50

2025/06/24 23:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.240ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:23:37.479'

2025/06/24 23:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.149ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:23:37.479'

2025/06/24 23:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.192ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:53:37.825'

2025/06/24 23:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.406ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:23:37.885' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:23:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.720ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.107ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.821ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:23:38.006' AND status != 'pending'
	

2025/06/24 23:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.075ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:53:38.005'

2025/06/24 23:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.922ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:23:38.066' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.353ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:23:38.066' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.830ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.880ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:23:38.125'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.235ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.910ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:23:38.185' AND status != 'pending'
	

2025/06/24 23:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.966ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:23:38.245' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:23:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.918ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:23:38.305'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.965ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:24:37.48'

2025/06/24 23:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.350ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:24:37.48'

2025/06/24 23:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.771ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:24:37.48'

2025/06/24 23:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.048ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:54:37.825'

2025/06/24 23:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.027ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:24:37.887' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.792ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.976ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.723ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:54:38.006'

2025/06/24 23:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.452ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:24:38.007' AND status != 'pending'
	

2025/06/24 23:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.828ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:24:38.065' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.985ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:24:38.066' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.666ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.899ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.165ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:24:38.127'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.940ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:24:38.184' AND status != 'pending'
	

2025/06/24 23:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.363ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:24:38.245' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:24:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.390ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:24:38.305'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.960ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:25:37.48'

2025/06/24 23:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.697ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:10:37.48' LIMIT 50

2025/06/24 23:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.623ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:10:37.49' LIMIT 50

2025/06/24 23:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.059ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:25:37.48'

2025/06/24 23:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.985ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:25:37.48'

2025/06/24 23:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.234ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:55:37.826'

2025/06/24 23:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.016ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:25:37.885' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:25:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.754ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.825ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.899ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:25:38.005' AND status != 'pending'
	

2025/06/24 23:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.869ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:55:38.005'

2025/06/24 23:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.859ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:25:38.065' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.903ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:25:38.065' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.231ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.712ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:25:38.126'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.908ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.056ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:25:38.188' AND status != 'pending'
	

2025/06/24 23:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.840ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:25:38.247' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:25:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.372ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:25:38.307'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.357ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:26:37.48'

2025/06/24 23:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.609ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:26:37.48'

2025/06/24 23:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.813ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:26:37.48'

2025/06/24 23:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.711ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:56:37.826'

2025/06/24 23:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.617ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:26:37.887' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:26:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.149ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.503ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.991ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:56:38.006'

2025/06/24 23:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.983ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:26:38.011' AND status != 'pending'
	

2025/06/24 23:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.614ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:26:38.069' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.588ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:26:38.071' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.637ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.318ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.335ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:26:38.13'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.349ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:26:38.19' AND status != 'pending'
	

2025/06/24 23:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.210ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:26:38.249' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:26:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.875ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:26:38.31'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.874ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:12:37.481' LIMIT 50

2025/06/24 23:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.352ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:27:37.481'

2025/06/24 23:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.227ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:12:37.491' LIMIT 50

2025/06/24 23:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.093ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:27:37.481'

2025/06/24 23:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.686ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:27:37.481'

2025/06/24 23:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.116ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:57:37.826'

2025/06/24 23:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.373ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:27:37.886' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:27:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.865ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.961ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.050ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:27:38.008' AND status != 'pending'
	

2025/06/24 23:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.199ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:57:38.007'

2025/06/24 23:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.673ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:27:38.067' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.030ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:27:38.067' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.912ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.889ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.042ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:27:38.129'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.324ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:27:38.192' AND status != 'pending'
	

2025/06/24 23:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.938ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:27:38.252' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:27:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.976ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:27:38.312'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.352ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:28:37.481'

2025/06/24 23:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.054ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:28:37.481'

2025/06/24 23:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.593ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:28:37.481'

2025/06/24 23:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.925ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:58:37.826'

2025/06/24 23:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.672ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:28:37.889' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:28:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.873ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.590ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.930ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:58:38.007'

2025/06/24 23:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.825ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:28:38.011' AND status != 'pending'
	

2025/06/24 23:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.945ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:28:38.067' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.361ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:28:38.07' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.284ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.501ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.921ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:28:38.131'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.534ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:28:38.189' AND status != 'pending'
	

2025/06/24 23:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.345ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:28:38.25' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:28:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.873ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:28:38.312'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.101ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:14:37.475' LIMIT 50

2025/06/24 23:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.589ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:29:37.476'

2025/06/24 23:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.383ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:14:37.486' LIMIT 50

2025/06/24 23:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.607ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:29:37.476'

2025/06/24 23:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.849ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:29:37.476'

2025/06/24 23:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.536ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:59:37.821'

2025/06/24 23:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.289ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:29:37.882' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:29:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.260ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.209ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.677ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 22:59:38.002'

2025/06/24 23:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.435ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:29:38.003' AND status != 'pending'
	

2025/06/24 23:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.686ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:29:38.062' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.199ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:29:38.063' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.193ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.305ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.809ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:29:38.122'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.411ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:29:38.18' AND status != 'pending'
	

2025/06/24 23:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.878ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:29:38.241' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:29:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.418ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:29:38.301'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.215ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:30:37.474'

2025/06/24 23:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.044ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:30:37.474'

2025/06/24 23:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.501ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:30:37.474'

2025/06/24 23:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.946ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:00:37.82'

2025/06/24 23:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.000ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:30:37.88' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:30:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.523ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.667ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.643ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:30:38' AND status != 'pending'
	

2025/06/24 23:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.753ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:00:38'

2025/06/24 23:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.346ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:30:38.06' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.845ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:30:38.06' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.615ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.591ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.810ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:30:38.122'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.052ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:30:38.181' AND status != 'pending'
	

2025/06/24 23:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.716ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:30:38.242' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:30:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.222ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:30:38.302'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.486ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:31:37.474'

2025/06/24 23:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.672ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:16:37.474' LIMIT 50

2025/06/24 23:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.465ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:16:37.484' LIMIT 50

2025/06/24 23:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.222ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:31:37.474'

2025/06/24 23:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.975ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:31:37.474'

2025/06/24 23:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.499ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:01:37.82'

2025/06/24 23:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.840ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:31:37.881' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:31:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.776ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.751ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.790ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:31:38.001' AND status != 'pending'
	

2025/06/24 23:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.051ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:01:38.001'

2025/06/24 23:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.355ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:31:38.061' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.385ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:31:38.061' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.002ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.051ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:31:38.122'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.203ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.559ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:31:38.184' AND status != 'pending'
	

2025/06/24 23:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.933ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:31:38.246' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:31:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.241ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:31:38.307'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.592ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:32:37.475'

2025/06/24 23:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.409ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:32:37.475'

2025/06/24 23:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.538ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:32:37.475'

2025/06/24 23:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.529ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:02:37.819'

2025/06/24 23:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.557ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:32:37.881' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:32:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.949ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.699ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.265ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:02:38.001'

2025/06/24 23:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.575ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:32:38.002' AND status != 'pending'
	

2025/06/24 23:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.503ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:32:38.06' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.420ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:32:38.062' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.444ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.825ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.423ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:32:38.121'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.012ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:32:38.18' AND status != 'pending'
	

2025/06/24 23:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.773ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:32:38.24' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:32:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.218ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:32:38.3'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.006ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:33:37.475'

2025/06/24 23:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.461ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:18:37.475' LIMIT 50

2025/06/24 23:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.072ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:18:37.485' LIMIT 50

2025/06/24 23:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.905ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:33:37.475'

2025/06/24 23:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.129ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:33:37.475'

2025/06/24 23:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.447ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:03:37.82'

2025/06/24 23:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.922ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:33:37.881' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.613ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.186ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.543ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:33:38.002' AND status != 'pending'
	

2025/06/24 23:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.650ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:03:38.001'

2025/06/24 23:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.128ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:33:38.062' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.904ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:33:38.061' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.403ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.681ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.365ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:33:38.122'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.731ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:33:38.183' AND status != 'pending'
	

2025/06/24 23:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.788ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:33:38.243' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:33:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.886ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:33:38.304'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:33:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.857ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:33:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.596ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.859ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:34:37.475'

2025/06/24 23:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.538ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:34:37.475'

2025/06/24 23:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.100ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:34:37.475'

2025/06/24 23:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.303ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:04:37.82'

2025/06/24 23:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.598ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:34:37.882' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.358ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.401ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.843ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:04:38.001'

2025/06/24 23:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.864ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:34:38.004' AND status != 'pending'
	

2025/06/24 23:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.270ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:34:38.061' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.969ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:34:38.064' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.524ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.364ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.242ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:34:38.124'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.283ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:34:38.182' AND status != 'pending'
	

2025/06/24 23:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.679ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:34:38.243' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.973ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:34:38.303'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:35:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.853ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:35:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.303ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.726ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:35:37.475'

2025/06/24 23:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.349ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:20:37.475' LIMIT 50

2025/06/24 23:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.727ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:20:37.485' LIMIT 50

2025/06/24 23:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.888ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:35:37.475'

2025/06/24 23:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.436ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:35:37.475'

2025/06/24 23:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.874ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:05:37.821'

2025/06/24 23:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.109ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:35:37.882' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:35:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.701ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.607ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.806ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:35:38.002' AND status != 'pending'
	

2025/06/24 23:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.988ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:05:38'

2025/06/24 23:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.410ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:35:38.062' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.515ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:35:38.062' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.226ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.683ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:35:38.124'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.250ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.259ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:35:38.188' AND status != 'pending'
	

2025/06/24 23:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.925ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:35:38.248' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:35:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.216ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:35:38.308'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.218ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:36:37.475'

2025/06/24 23:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.874ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:36:37.475'

2025/06/24 23:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.867ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:36:37.475'

2025/06/24 23:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.729ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:06:37.821'

2025/06/24 23:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.279ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:36:37.882' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:36:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.115ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.454ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.644ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:06:38.001'

2025/06/24 23:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.196ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:36:38.002' AND status != 'pending'
	

2025/06/24 23:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.189ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:36:38.061' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.210ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:36:38.062' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.594ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.054ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.652ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:36:38.123'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.345ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:36:38.185' AND status != 'pending'
	

2025/06/24 23:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.121ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:36:38.244' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:36:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.525ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:36:38.305'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.551ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:37:37.475'

2025/06/24 23:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.418ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:22:37.475' LIMIT 50

2025/06/24 23:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.402ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:22:37.485' LIMIT 50

2025/06/24 23:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.330ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:37:37.475'

2025/06/24 23:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.933ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:37:37.475'

2025/06/24 23:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.943ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:07:37.821'

2025/06/24 23:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.911ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:37:37.885' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:37:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.688ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.872ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.869ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:07:38.001'

2025/06/24 23:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.546ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:37:38.004' AND status != 'pending'
	

2025/06/24 23:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.230ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:37:38.061' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.004ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:37:38.063' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.526ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.766ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:37:38.122'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.699ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.047ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:37:38.18' AND status != 'pending'
	

2025/06/24 23:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.099ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:37:38.24' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:37:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.048ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:37:38.3'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:38:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.509ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:38:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.534ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.851ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:38:37.476'

2025/06/24 23:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.711ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:38:37.476'

2025/06/24 23:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.279ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:38:37.476'

2025/06/24 23:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.022ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:08:37.821'

2025/06/24 23:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.448ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:38:37.884' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.919ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.783ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.534ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:08:38.002'

2025/06/24 23:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.724ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:38:38.005' AND status != 'pending'
	

2025/06/24 23:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.271ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:38:38.062' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.894ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:38:38.066' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.567ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.122ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.163ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:38:38.126'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.755ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:38:38.181' AND status != 'pending'
	

2025/06/24 23:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.564ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:38:38.241' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:38:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.265ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:38:38.301'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:39:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.464ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:39:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.884ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.387ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:39:37.476'

2025/06/24 23:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.106ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:24:37.476' LIMIT 50

2025/06/24 23:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.946ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:24:37.486' LIMIT 50

2025/06/24 23:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.652ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:39:37.476'

2025/06/24 23:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.236ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:39:37.476'

2025/06/24 23:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.295ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:09:37.821'

2025/06/24 23:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.745ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:39:37.882' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:39:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.325ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.527ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.155ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:39:38.002' AND status != 'pending'
	

2025/06/24 23:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.645ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:09:38.002'

2025/06/24 23:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.298ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:39:38.062' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.791ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:39:38.063' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.096ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.847ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:39:38.122'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.449ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.725ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:39:38.184' AND status != 'pending'
	

2025/06/24 23:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.011ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:39:38.244' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:39:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.831ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:39:38.305'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.067ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:40:37.476'

2025/06/24 23:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.087ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:40:37.476'

2025/06/24 23:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.919ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:40:37.476'

2025/06/24 23:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.574ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:10:37.821'

2025/06/24 23:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.550ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:40:37.887' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:40:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.798ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.996ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.300ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:10:38.002'

2025/06/24 23:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.627ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:40:38.008' AND status != 'pending'
	

2025/06/24 23:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.023ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:40:38.064' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.787ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:40:38.068' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.121ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.812ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.793ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:40:38.127'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.247ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:40:38.183' AND status != 'pending'
	

2025/06/24 23:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.966ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:40:38.243' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.653ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:40:38.302'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:41:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.181ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:41:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.778ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.360ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:41:37.476'

2025/06/24 23:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.289ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:26:37.476' LIMIT 50

2025/06/24 23:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.759ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:26:37.486' LIMIT 50

2025/06/24 23:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.653ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:41:37.476'

2025/06/24 23:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.782ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:41:37.476'

2025/06/24 23:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.938ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:11:37.822'

2025/06/24 23:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.775ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:41:37.882' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:41:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.787ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.825ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.417ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:41:38.002' AND status != 'pending'
	

2025/06/24 23:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.490ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:11:38.003'

2025/06/24 23:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.313ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:41:38.062' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.433ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:41:38.063' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.958ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.768ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:41:38.124'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.603ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.430ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:41:38.187' AND status != 'pending'
	

2025/06/24 23:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.684ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:41:38.248' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:41:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.257ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:41:38.308'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.269ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:42:37.476'

2025/06/24 23:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.348ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:42:37.476'

2025/06/24 23:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.012ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:42:37.476'

2025/06/24 23:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.767ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:12:37.822'

2025/06/24 23:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.165ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:42:37.883' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:42:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.492ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.277ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.067ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:12:38.002'

2025/06/24 23:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.164ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:42:38.006' AND status != 'pending'
	

2025/06/24 23:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.627ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:42:38.062' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.201ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:42:38.066' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.799ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.848ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.914ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:42:38.126'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.919ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:42:38.183' AND status != 'pending'
	

2025/06/24 23:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.852ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:42:38.245' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:42:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.011ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:42:38.305'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:42:51 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.365ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:42:51 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.524ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:42:51 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.620ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:42:51 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.610ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:42:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.259ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:42:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.604ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:43:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.305ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:43:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.973ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:43:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.401ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:43:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.588ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:43:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.940ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:43:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.279ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:43:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.465ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:43:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.795ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:43:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.085ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:43:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.414ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:43:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.449ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:43:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.960ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.270ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:43:37.476'

2025/06/24 23:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.864ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:28:37.476' LIMIT 50

2025/06/24 23:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.195ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:28:37.487' LIMIT 50

2025/06/24 23:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.440ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:43:37.476'

2025/06/24 23:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.146ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:43:37.476'

2025/06/24 23:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.591ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:13:37.822'

2025/06/24 23:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.883ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:43:37.883' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:43:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.622ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.886ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.855ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:43:38.003' AND status != 'pending'
	

2025/06/24 23:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.022ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:13:38.003'

2025/06/24 23:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.774ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:43:38.063' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.758ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:43:38.063' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.076ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.182ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:43:38.125'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.799ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.911ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:43:38.185' AND status != 'pending'
	

2025/06/24 23:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.435ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:43:38.245' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:43:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.781ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:43:38.306'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.430ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:44:37.477'

2025/06/24 23:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.496ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:44:37.477'

2025/06/24 23:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.813ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:44:37.477'

2025/06/24 23:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.517ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:14:37.821'

2025/06/24 23:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.268ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:44:37.882' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:44:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.988ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.390ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.719ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:14:38.002'

2025/06/24 23:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.349ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:44:38.003' AND status != 'pending'
	

2025/06/24 23:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.455ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:44:38.062' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.659ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:44:38.063' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.268ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.412ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.589ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:44:38.124'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.206ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:44:38.185' AND status != 'pending'
	

2025/06/24 23:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.794ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:44:38.245' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:44:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.328ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:44:38.305'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:44:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.473ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:44:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.765ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:45:00 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.730ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:45:00 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.452ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:45:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.414ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:45:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.615ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:45:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.035ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:45:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.802ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.217ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:30:37.477' LIMIT 50

2025/06/24 23:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.735ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:45:37.477'

2025/06/24 23:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.303ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:30:37.487' LIMIT 50

2025/06/24 23:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.206ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:45:37.477'

2025/06/24 23:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.222ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:45:37.477'

2025/06/24 23:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.334ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:15:37.822'

2025/06/24 23:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.752ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:45:37.884' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:45:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.895ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.652ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.591ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:15:38.003'

2025/06/24 23:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.002ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:45:38.005' AND status != 'pending'
	

2025/06/24 23:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.908ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:45:38.065' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.657ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:45:38.064' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.412ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.915ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:45:38.125'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.227ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.205ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:45:38.187' AND status != 'pending'
	

2025/06/24 23:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.311ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:45:38.248' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:45:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.343ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:45:38.31'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:46:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.540ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:46:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.195ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.232ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:46:37.477'

2025/06/24 23:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.093ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:46:37.477'

2025/06/24 23:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.123ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:46:37.477'

2025/06/24 23:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.179ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:16:37.822'

2025/06/24 23:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.462ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:46:37.884' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:46:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.741ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.072ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.752ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:16:38.003'

2025/06/24 23:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.154ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:46:38.01' AND status != 'pending'
	

2025/06/24 23:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.775ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:46:38.064' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.702ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:46:38.07' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.213ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.758ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.566ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:46:38.13'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.403ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:46:38.185' AND status != 'pending'
	

2025/06/24 23:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.262ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:46:38.247' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:46:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.332ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:46:38.307'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:47:03 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.348ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:47:03 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.090ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:47:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.405ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:47:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.723ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:47:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.225ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:47:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.566ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.068ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:32:37.477' LIMIT 50

2025/06/24 23:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.882ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:47:37.477'

2025/06/24 23:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.017ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:32:37.487' LIMIT 50

2025/06/24 23:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.351ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:47:37.477'

2025/06/24 23:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.597ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:47:37.477'

2025/06/24 23:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.789ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:17:37.823'

2025/06/24 23:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.907ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:47:37.885' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:47:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.113ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.321ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.023ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:17:38.003'

2025/06/24 23:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.582ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:47:38.007' AND status != 'pending'
	

2025/06/24 23:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.824ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:47:38.066' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.748ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:47:38.066' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.283ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.191ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.731ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:47:38.126'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.161ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:47:38.188' AND status != 'pending'
	

2025/06/24 23:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.283ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:47:38.249' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:47:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.909ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:47:38.309'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.669ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:48:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.056ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:48:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.328ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:48:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.593ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:48:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.148ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:48:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.733ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:48:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.271ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:48:37.478'

2025/06/24 23:48:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.800ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:48:37.478'

2025/06/24 23:48:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.775ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:48:37.478'

2025/06/24 23:48:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.783ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:18:37.823'

2025/06/24 23:48:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.869ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:48:37.885' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:48:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.984ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.249ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.028ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:18:38.003'

2025/06/24 23:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.266ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:48:38.007' AND status != 'pending'
	

2025/06/24 23:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.823ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:48:38.064' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.788ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:48:38.067' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.726ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.947ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.933ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:48:38.127'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.810ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:48:38.184' AND status != 'pending'
	

2025/06/24 23:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.029ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:48:38.243' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.877ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:48:38.304'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:49:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.901ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:49:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.866ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:49:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.746ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:49:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.815ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:49:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[66.091ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:49:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[67.856ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.942ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:34:37.477' LIMIT 50

2025/06/24 23:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.624ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:49:37.478'

2025/06/24 23:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.557ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:34:37.488' LIMIT 50

2025/06/24 23:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.849ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:49:37.478'

2025/06/24 23:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.326ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:49:37.478'

2025/06/24 23:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.007ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:19:37.822'

2025/06/24 23:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.369ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:49:37.884' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:49:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.320ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.116ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.619ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:19:38.004'

2025/06/24 23:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.726ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:49:38.005' AND status != 'pending'
	

2025/06/24 23:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.138ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:49:38.065' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.275ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:49:38.064' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.340ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.408ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:49:38.126'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.067ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.402ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:49:38.189' AND status != 'pending'
	

2025/06/24 23:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.900ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:49:38.249' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:49:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.063ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:49:38.31'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:50:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.775ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:50:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[64.747ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:50:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.950ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:50:37.478'

2025/06/24 23:50:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.998ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:50:37.478'

2025/06/24 23:50:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.559ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:50:37.478'

2025/06/24 23:50:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.874ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:20:37.823'

2025/06/24 23:50:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.509ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:50:37.884' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:50:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.320ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.256ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.656ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:20:38.003'

2025/06/24 23:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.862ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:50:38.005' AND status != 'pending'
	

2025/06/24 23:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.796ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:50:38.064' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.565ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:50:38.065' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.638ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.347ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:50:38.124'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.014ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.570ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:50:38.187' AND status != 'pending'
	

2025/06/24 23:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.260ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:50:38.246' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:50:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.668ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:50:38.307'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:51:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.180ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:51:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.115ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.283ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:36:37.478' LIMIT 50

2025/06/24 23:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.371ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:51:37.478'

2025/06/24 23:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.922ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:36:37.488' LIMIT 50

2025/06/24 23:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.450ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:51:37.478'

2025/06/24 23:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.272ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:51:37.478'

2025/06/24 23:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.690ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:21:37.822'

2025/06/24 23:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.079ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:51:37.883' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:51:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.613ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.086ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.862ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:21:38.004'

2025/06/24 23:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.636ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:51:38.004' AND status != 'pending'
	

2025/06/24 23:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.662ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:51:38.064' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.723ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:51:38.064' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.715ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.684ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.896ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:51:38.126'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.378ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:51:38.186' AND status != 'pending'
	

2025/06/24 23:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.784ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:51:38.246' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:51:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.837ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:51:38.306'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:51:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.186ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:51:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.881ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:52:01 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.326ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:52:01 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.690ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:52:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[90.140ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:52:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[89.120ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:52:37.478'

2025/06/24 23:52:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[105.716ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:52:37.478'

2025/06/24 23:52:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[72.838ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:52:37.478'

2025/06/24 23:52:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[102.704ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:22:37.824'

2025/06/24 23:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[98.119ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:52:37.926' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[52.921ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[104.364ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:22:38.004'

2025/06/24 23:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[53.398ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[103.757ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:52:38.108' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[108.031ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:52:38.132' AND status != 'pending'
	

2025/06/24 23:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[51.744ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[52.292ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[106.978ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:52:38.24' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[106.011ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:52:38.316' AND status != 'pending'
	

2025/06/24 23:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[107.186ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:52:38.347'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[113.336ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:52:38.422' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:52:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[98.636ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:52:38.536'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:52:54 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[65.253ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:52:54 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.837ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:52:54 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.300ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:52:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.491ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:53:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[66.429ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:53:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.200ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:53:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.915ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:53:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.415ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:53:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.657ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:53:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.610ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:53:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.791ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.006ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:53:37.479'

2025/06/24 23:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.391ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:38:37.478' LIMIT 50

2025/06/24 23:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.309ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:38:37.488' LIMIT 50

2025/06/24 23:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.409ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:53:37.479'

2025/06/24 23:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.652ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:53:37.479'

2025/06/24 23:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.502ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:23:37.823'

2025/06/24 23:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.048ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:53:37.883' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:53:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.581ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.946ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.589ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:23:38.004'

2025/06/24 23:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.326ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:53:38.008' AND status != 'pending'
	

2025/06/24 23:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.885ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:53:38.064' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.102ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:53:38.067' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.447ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.958ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.360ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:53:38.127'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.931ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:53:38.185' AND status != 'pending'
	

2025/06/24 23:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.898ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:53:38.245' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:53:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.333ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:53:38.305'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:54:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[65.345ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:54:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[66.592ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:54:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[66.324ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/24 23:54:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.024ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:54:37.478'

2025/06/24 23:54:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.700ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:54:37.478'

2025/06/24 23:54:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.014ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:54:37.478'

2025/06/24 23:54:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.362ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:24:37.824'

2025/06/24 23:54:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.668ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:54:37.885' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:54:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.837ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.224ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.880ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:24:38.005'

2025/06/24 23:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.538ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:54:38.008' AND status != 'pending'
	

2025/06/24 23:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.453ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:54:38.066' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.175ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:54:38.067' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.757ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.573ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.530ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:54:38.127'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.942ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:54:38.185' AND status != 'pending'
	

2025/06/24 23:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.750ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:54:38.245' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:54:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.936ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:54:38.306'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.827ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-24 23:55:37.479'

2025/06/24 23:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.592ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:40:37.478' LIMIT 50

2025/06/24 23:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.114ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:40:37.488' LIMIT 50

2025/06/24 23:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.490ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-24 23:55:37.479'

2025/06/24 23:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.874ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-23 23:55:37.479'

2025/06/24 23:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.004ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:25:37.824'

2025/06/24 23:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.221ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:55:37.884' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.910ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.961ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.760ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:55:38.004' AND status != 'pending'
	

2025/06/24 23:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.029ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-24 23:25:38.005'

2025/06/24 23:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.644ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:55:38.065' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.585ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-24 22:55:38.066' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/24 23:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.000ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/24 23:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.377ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:55:38.125'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.416ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/24 23:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.138ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-24 22:55:38.187' AND status != 'pending'
	

2025/06/24 23:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.638ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:55:38.248' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/24 23:55:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.435ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-24 22:55:38.308'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/24 23:55:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.729ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/24 23:55:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[64.212ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1
