
2025/06/20 20:56:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.918ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:26:48.61'

2025/06/20 20:56:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.349ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 19:56:48.672' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 20:56:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.196ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 20:56:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.727ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 20:56:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.968ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 19:56:48.788' AND status != 'pending'
	

2025/06/20 20:56:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[228.980ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:26:48.647'

2025/06/20 20:56:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.512ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 19:56:48.846' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 20:56:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.999ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 19:56:48.876' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 20:56:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.555ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 19:56:48.905'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 20:56:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.152ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 20:56:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.149ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 20:56:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.051ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 19:56:49.001' AND status != 'pending'
	

2025/06/20 20:56:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.177ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 19:56:49.064' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 20:56:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.986ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 19:56:49.128'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 20:56:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[67.431ms] [rows:1] SELECT * FROM `user` WHERE (username = 'admin' OR phone = 'admin') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/20 20:56:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:481
[62.863ms] [rows:9] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 4

2025/06/20 20:56:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:493 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[31.507ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,3,4,5,6,7,8,23)

2025/06/20 20:56:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[63.905ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/20 20:56:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[31.211ms] [rows:18] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/20 20:56:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[31.390ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 20:56:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.679ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 20:56:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.248ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 20:56:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.965ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 20:56:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.408ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 20:56:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.793ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 20:56:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.100ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 20:56:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.621ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 20:56:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.248ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 20:56:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.382ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 20:56:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.057ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 20:56:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.315ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 20:56:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.738ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 20:56:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[63.246ms] [rows:1] SELECT * FROM `user` WHERE (username = 'admin' OR phone = 'admin') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/20 20:56:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:481
[63.440ms] [rows:9] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 4

2025/06/20 20:56:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:493 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[31.321ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,3,4,5,6,7,8,23)

2025/06/20 20:57:22 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[31.720ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 20:57:22 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.136ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 20:57:22 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.535ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 20:57:22 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.951ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 20:57:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.367ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 20:57:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.036ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 20:57:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.623ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 20:57:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.015ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 20:57:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.060ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 20:57:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.780ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 20:57:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.272ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 20:57:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.966ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 20:57:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.823ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 20:57:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:64
[63.226ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 1

2025/06/20 20:57:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:64
[63.020ms] [rows:1] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 1 ORDER BY create_time DESC LIMIT 10

2025/06/20 20:57:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:97
[67.452ms] [rows:1] SELECT * FROM `goods_list` WHERE id = 3 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/20 20:57:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.377ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 20:57:48.61'

2025/06/20 20:57:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.621ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 20:57:48.61'

2025/06/20 20:57:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.091ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 20:57:48.61'

2025/06/20 20:57:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[57.084ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 8 ORDER BY `user`.`user_type` LIMIT 1

2025/06/20 20:57:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:88
[58.383ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/20 20:57:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:104
[59.209ms] [rows:10] SELECT * FROM `permission_user` WHERE id IN (1,2,10,11,12,13,14,15,22,23) ORDER BY sort DESC

2025/06/20 20:57:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[28.371ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.181ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:27:48.964'

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.616ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.742ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 19:57:49.026' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.894ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.122ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.794ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.101ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.277ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 19:57:49.153' AND status != 'pending'
	

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.869ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.896ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 19:57:49.216' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.273ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.027ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.694ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 19:57:49.28'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[189.700ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:27:49.192'

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.065ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.817ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 19:57:49.382' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.735ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.603ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.120ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.189ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.949ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 19:57:49.507' AND status != 'pending'
	

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.448ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.700ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 19:57:49.569' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.547ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.776ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 20:57:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.681ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 19:57:49.631'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 20:57:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:64
[64.960ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 8

2025/06/20 20:57:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:64
[61.423ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 8 ORDER BY create_time DESC LIMIT 10

2025/06/20 20:58:01 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[68.110ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/20 20:58:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/secure_order_creator.go:96
[61.367ms] [rows:0] SELECT * FROM `goods_list` WHERE id = 12 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/20 20:58:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/secure_order_creator.go:96
[61.739ms] [rows:1] SELECT * FROM `goods_list` WHERE id = 2 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/20 20:58:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.267ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 20:58:48.61'

2025/06/20 20:58:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.904ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:43:48.61' LIMIT 50

2025/06/20 20:58:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.877ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:43:48.647' LIMIT 50

2025/06/20 20:58:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.035ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 20:58:48.61'

2025/06/20 20:58:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.995ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 20:58:48.61'

2025/06/20 20:58:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.907ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:28:48.964'

2025/06/20 20:58:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.046ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 19:58:49.023' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 20:58:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.000ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 20:58:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.496ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 20:58:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.633ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 19:58:49.141' AND status != 'pending'
	

2025/06/20 20:58:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.464ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:28:49.192'

2025/06/20 20:58:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.125ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 19:58:49.198' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 20:58:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.094ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 19:58:49.257'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 20:58:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.491ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 19:58:49.255' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 20:58:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.428ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 20:58:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.400ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 20:58:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.616ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 19:58:49.382' AND status != 'pending'
	

2025/06/20 20:58:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.932ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 19:58:49.445' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 20:58:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.502ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 19:58:49.508'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 20:58:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:98
[31.944ms] [rows:1] SELECT count(*) FROM `order`

2025/06/20 20:58:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:116
[64.492ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` ORDER BY create_time DESC LIMIT 10

2025/06/20 20:58:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods_optimized.go:127
[58.927ms] [rows:1] SELECT id, goods_name, content, price, stock, cover, status, category_id, create_time, update_time FROM `goods_list` WHERE id IN (1) AND isdelete != 1

2025/06/20 20:58:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:165
[62.276ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (6,108,109,116)

2025/06/20 20:58:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:98
[33.489ms] [rows:1] SELECT count(*) FROM `order`

2025/06/20 20:58:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:116
[63.588ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` ORDER BY create_time DESC LIMIT 10

2025/06/20 20:58:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:165
[62.896ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (6,108,109,116)

2025/06/20 20:58:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:38
[35.809ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/20 20:58:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:44
[63.540ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/20 20:59:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:98
[31.589ms] [rows:1] SELECT count(*) FROM `order`

2025/06/20 20:59:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:116
[63.704ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` ORDER BY create_time DESC LIMIT 10

2025/06/20 20:59:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:165
[62.926ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (6,108,109,116)

2025/06/20 20:59:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:98
[31.995ms] [rows:1] SELECT count(*) FROM `order`

2025/06/20 20:59:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:116
[62.626ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` ORDER BY create_time DESC LIMIT 10

2025/06/20 20:59:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:165
[62.280ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (6,108,109,116)

2025/06/20 20:59:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:38
[35.295ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/20 20:59:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:44
[63.203ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/20 20:59:19 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[63.434ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/20 20:59:19 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[30.880ms] [rows:1] SELECT count(*) FROM `user`

2025/06/20 20:59:19 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[62.463ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/20 20:59:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:139
[63.617ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/20 20:59:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[31.339ms] [rows:1] SELECT count(*) FROM `role`

2025/06/20 20:59:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[62.253ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/20 20:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[31.982ms] [rows:1] SELECT count(*) FROM `role`

2025/06/20 20:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[63.302ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/20 20:59:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:139
[63.697ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/20 20:59:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[30.638ms] [rows:1] SELECT count(*) FROM `role`

2025/06/20 20:59:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[63.518ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/20 20:59:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.732ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 20:59:48.61'

2025/06/20 20:59:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.990ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 20:59:48.61'

2025/06/20 20:59:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.569ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 20:59:48.61'

2025/06/20 20:59:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.148ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:29:48.964'

2025/06/20 20:59:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.848ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 19:59:49.027' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 20:59:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.377ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 20:59:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.319ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 20:59:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.187ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 19:59:49.153' AND status != 'pending'
	

2025/06/20 20:59:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.360ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:29:49.192'

2025/06/20 20:59:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.362ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 19:59:49.217' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 20:59:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.664ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 19:59:49.25' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 20:59:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.962ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 20:59:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.268ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 19:59:49.279'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 20:59:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.191ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 20:59:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.368ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 19:59:49.367' AND status != 'pending'
	

2025/06/20 20:59:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.814ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 19:59:49.426' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 20:59:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.211ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 19:59:49.485'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:00:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.952ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:45:48.609' LIMIT 50

2025/06/20 21:00:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.482ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:00:48.61'

2025/06/20 21:00:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.358ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:45:48.648' LIMIT 50

2025/06/20 21:00:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.134ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:00:48.61'

2025/06/20 21:00:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.865ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:00:48.61'

2025/06/20 21:00:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.991ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:30:48.965'

2025/06/20 21:00:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.685ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:00:49.029' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:00:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.941ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:00:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.561ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:00:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.040ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:00:49.155' AND status != 'pending'
	

2025/06/20 21:00:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.456ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:30:49.192'

2025/06/20 21:00:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.041ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:00:49.219' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:00:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.199ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:00:49.253' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:00:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.343ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:00:49.282'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:00:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.337ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:00:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.983ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:00:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.574ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:00:49.378' AND status != 'pending'
	

2025/06/20 21:00:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.032ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:00:49.439' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:00:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.738ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:00:49.501'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:01:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.410ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:01:48.61'

2025/06/20 21:01:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.981ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:01:48.61'

2025/06/20 21:01:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.666ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:01:48.61'

2025/06/20 21:01:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.215ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:31:48.965'

2025/06/20 21:01:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.531ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:01:49.028' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:01:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.541ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:01:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.435ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:01:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.060ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:01:49.151' AND status != 'pending'
	

2025/06/20 21:01:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.898ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:31:49.193'

2025/06/20 21:01:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.772ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:01:49.212' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:01:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.507ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:01:49.256' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:01:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.166ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:01:49.273'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:01:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.340ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:01:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.613ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:01:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.642ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:01:49.382' AND status != 'pending'
	

2025/06/20 21:01:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.677ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:01:49.445' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:01:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.614ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:01:49.508'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:02:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.982ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:02:48.611'

2025/06/20 21:02:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.404ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:47:48.61' LIMIT 50

2025/06/20 21:02:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.983ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:47:48.648' LIMIT 50

2025/06/20 21:02:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.002ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:02:48.611'

2025/06/20 21:02:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.244ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:02:48.611'

2025/06/20 21:02:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.934ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:32:48.965'

2025/06/20 21:02:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.863ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:02:49.028' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:02:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.813ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:02:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.584ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:02:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.493ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:02:49.152' AND status != 'pending'
	

2025/06/20 21:02:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.875ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:32:49.193'

2025/06/20 21:02:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.899ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:02:49.216' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:02:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.656ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:02:49.253' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:02:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.190ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:02:49.278'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:02:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.838ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:02:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.113ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:02:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.943ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:02:49.369' AND status != 'pending'
	

2025/06/20 21:02:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.175ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:02:49.429' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:02:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.257ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:02:49.487'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:03:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.250ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:03:48.611'

2025/06/20 21:03:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.563ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:03:48.611'

2025/06/20 21:03:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.125ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:03:48.611'

2025/06/20 21:03:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.603ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:33:48.965'

2025/06/20 21:03:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.659ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:03:49.026' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:03:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.179ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:03:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.115ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:03:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.408ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:03:49.145' AND status != 'pending'
	

2025/06/20 21:03:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.272ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:33:49.193'

2025/06/20 21:03:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.553ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:03:49.206' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:03:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.296ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:03:49.257' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:03:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.499ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:03:49.267'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:03:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.947ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:03:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.325ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:03:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.440ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:03:49.381' AND status != 'pending'
	

2025/06/20 21:03:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.078ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:03:49.442' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:03:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.560ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:03:49.506'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:04:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.021ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:04:48.611'

2025/06/20 21:04:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.523ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:49:48.61' LIMIT 50

2025/06/20 21:04:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.812ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:49:48.649' LIMIT 50

2025/06/20 21:04:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.811ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:04:48.611'

2025/06/20 21:04:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.516ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:04:48.611'

2025/06/20 21:04:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.720ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:34:48.966'

2025/06/20 21:04:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.547ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:04:49.026' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:04:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.514ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:04:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.163ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:04:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.967ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:04:49.143' AND status != 'pending'
	

2025/06/20 21:04:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.249ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:34:49.193'

2025/06/20 21:04:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.462ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:04:49.203' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:04:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.392ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:04:49.261'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:04:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.367ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:04:49.257' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:04:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.845ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:04:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.516ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:04:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.187ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:04:49.384' AND status != 'pending'
	

2025/06/20 21:04:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.037ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:04:49.447' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:04:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.992ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:04:49.511'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:05:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.042ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:05:48.611'

2025/06/20 21:05:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.026ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:05:48.611'

2025/06/20 21:05:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.858ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:05:48.611'

2025/06/20 21:05:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.484ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:35:48.966'

2025/06/20 21:05:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.778ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:05:49.028' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:05:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.188ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:05:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.392ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:05:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.796ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:05:49.154' AND status != 'pending'
	

2025/06/20 21:05:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.545ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:35:49.193'

2025/06/20 21:05:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.094ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:05:49.217' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:05:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.331ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:05:49.251' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:05:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.911ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:05:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.400ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:05:49.281'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:05:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.071ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:05:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.502ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:05:49.369' AND status != 'pending'
	

2025/06/20 21:05:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.646ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:05:49.428' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:05:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.382ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:05:49.487'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.345ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:36:37.341'

2025/06/20 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.428ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:06:37.409' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.058ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[178.528ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:36:37.352'

2025/06/20 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.915ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.798ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:06:37.53' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.016ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:06:37.533' AND status != 'pending'
	

2025/06/20 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.733ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.039ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.939ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:06:37.595' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.194ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:06:37.648' AND status != 'pending'
	

2025/06/20 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.036ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:06:37.657'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.283ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:06:37.707' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:06:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.929ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:06:37.765'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:07:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/setting.go:38
[29.276ms] [rows:1] SELECT count(*) FROM `config_setting`

2025/06/20 21:07:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/setting.go:38
[57.745ms] [rows:4] SELECT * FROM `config_setting` LIMIT 10

2025/06/20 21:07:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[63.173ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/20 21:07:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[28.448ms] [rows:1] SELECT count(*) FROM `user`

2025/06/20 21:07:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[57.774ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/20 21:07:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[29.315ms] [rows:1] SELECT count(*) FROM `role`

2025/06/20 21:07:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[57.788ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/20 21:07:22 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:139
[59.013ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/20 21:07:22 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[28.431ms] [rows:1] SELECT count(*) FROM `role`

2025/06/20 21:07:22 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[58.260ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/20 21:07:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:98
[30.621ms] [rows:1] SELECT count(*) FROM `order`

2025/06/20 21:07:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:116
[58.839ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` ORDER BY create_time DESC LIMIT 10

2025/06/20 21:07:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:165
[58.537ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (6,108,109,116)

2025/06/20 21:07:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:69
[59.194ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1

2025/06/20 21:07:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.716ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-20'

2025/06/20 21:07:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.637ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-20'

2025/06/20 21:07:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[90.617ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-20','2025-06-20','2025-06-20',0,0,0,0,'2025-06-20 21:07:34.646','2025-06-20 21:07:34.646')

2025/06/20 21:07:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.444ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-19'

2025/06/20 21:07:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.858ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-19'

2025/06/20 21:07:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.128ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-19','2025-06-19','2025-06-19',0,0,0,0,'2025-06-20 21:07:34.856','2025-06-20 21:07:34.856')

2025/06/20 21:07:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.872ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-18'

2025/06/20 21:07:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[59.210ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-18'

2025/06/20 21:07:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.625ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-18','2025-06-18','2025-06-18',0,0,0,0,'2025-06-20 21:07:35.061','2025-06-20 21:07:35.061')

2025/06/20 21:07:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.074ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-17'

2025/06/20 21:07:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.683ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-17'

2025/06/20 21:07:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[88.413ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-17','2025-06-17','2025-06-17',0,0,0,0,'2025-06-20 21:07:35.266','2025-06-20 21:07:35.266')

2025/06/20 21:07:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.565ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-16'

2025/06/20 21:07:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.567ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-16'

2025/06/20 21:07:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.117ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-16','2025-06-16','2025-06-16',0,0,0,0,'2025-06-20 21:07:35.471','2025-06-20 21:07:35.471')

2025/06/20 21:07:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.472ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-15'

2025/06/20 21:07:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.849ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-15'

2025/06/20 21:07:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.409ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-15','2025-06-15','2025-06-15',0,0,0,0,'2025-06-20 21:07:35.674','2025-06-20 21:07:35.674')

2025/06/20 21:07:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.801ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-14'

2025/06/20 21:07:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.234ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-14'

2025/06/20 21:07:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[89.718ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-14','2025-06-14','2025-06-14',0,0,0,0,'2025-06-20 21:07:35.876','2025-06-20 21:07:35.876')

2025/06/20 21:07:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.913ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-13'

2025/06/20 21:07:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.541ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-13'

2025/06/20 21:07:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.698ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-13','2025-06-13','2025-06-13',0,0,0,0,'2025-06-20 21:07:36.082','2025-06-20 21:07:36.082')

2025/06/20 21:07:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.265ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-12'

2025/06/20 21:07:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.429ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-12'

2025/06/20 21:07:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.791ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-12','2025-06-12','2025-06-12',0,0,0,0,'2025-06-20 21:07:36.286','2025-06-20 21:07:36.286')

2025/06/20 21:07:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.034ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-11'

2025/06/20 21:07:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.144ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-11'

2025/06/20 21:07:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.149ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-11','2025-06-11','2025-06-11',0,0,0,0,'2025-06-20 21:07:36.49','2025-06-20 21:07:36.49')

2025/06/20 21:07:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.932ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-10'

2025/06/20 21:07:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.179ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-10'

2025/06/20 21:07:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.558ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-10','2025-06-10','2025-06-10',0,0,0,0,'2025-06-20 21:07:36.693','2025-06-20 21:07:36.693')

2025/06/20 21:07:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.027ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-09'

2025/06/20 21:07:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.256ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-09'

2025/06/20 21:07:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[89.175ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-09','2025-06-09','2025-06-09',0,0,0,0,'2025-06-20 21:07:36.898','2025-06-20 21:07:36.898')

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.489ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-08'

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.831ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-08'

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.849ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-08','2025-06-08','2025-06-08',0,0,0,0,'2025-06-20 21:07:37.105','2025-06-20 21:07:37.105')

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.359ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-07'

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.473ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-07'

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.516ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-07','2025-06-07','2025-06-07',0,0,0,0,'2025-06-20 21:07:37.307','2025-06-20 21:07:37.307')

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.012ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:07:37.34'

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.982ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-06'

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.481ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:07:37.34'

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.990ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-06'

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.735ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:07:37.34'

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.529ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-06','2025-06-06','2025-06-06',0,0,0,0,'2025-06-20 21:07:37.511','2025-06-20 21:07:37.511')

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.528ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-05'

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.599ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-05'

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.016ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:37:37.72'

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.132ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-05','2025-06-05','2025-06-05',0,0,0,0,'2025-06-20 21:07:37.716','2025-06-20 21:07:37.716')

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.061ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:07:37.785' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.783ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-04'

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.569ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.747ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.719ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-04'

2025/06/20 21:07:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.913ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:07:37.908' AND status != 'pending'
	

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[85.939ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-04','2025-06-04','2025-06-04',0,0,0,0,'2025-06-20 21:07:37.92','2025-06-20 21:07:37.92')

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.876ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:07:37.97' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[221.845ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:37:37.826'

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.199ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-03'

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.362ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:07:38.032'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.468ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:07:38.048' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.709ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-03'

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.539ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.323ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.794ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-03','2025-06-03','2025-06-03',0,0,0,0,'2025-06-20 21:07:38.123','2025-06-20 21:07:38.123')

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.679ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:07:38.167' AND status != 'pending'
	

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.950ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-02'

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.158ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:07:38.227' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.736ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-02'

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.153ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:07:38.286'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.687ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-02','2025-06-02','2025-06-02',0,0,0,0,'2025-06-20 21:07:38.326','2025-06-20 21:07:38.326')

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.595ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-01'

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.386ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-01'

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.327ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-01','2025-06-01','2025-06-01',0,0,0,0,'2025-06-20 21:07:38.529','2025-06-20 21:07:38.529')

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.380ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-31'

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.592ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-31'

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.147ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-31','2025-05-31','2025-05-31',0,0,0,0,'2025-06-20 21:07:38.732','2025-06-20 21:07:38.732')

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.379ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-30'

2025/06/20 21:07:38 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[59.303ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-30'

2025/06/20 21:07:39 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.691ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-30','2025-05-30','2025-05-30',0,0,0,0,'2025-06-20 21:07:38.937','2025-06-20 21:07:38.937')

2025/06/20 21:07:39 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.235ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-29'

2025/06/20 21:07:39 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.025ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-29'

2025/06/20 21:07:39 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.459ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-29','2025-05-29','2025-05-29',0,0,0,0,'2025-06-20 21:07:39.141','2025-06-20 21:07:39.141')

2025/06/20 21:07:39 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.427ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-28'

2025/06/20 21:07:39 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.876ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-28'

2025/06/20 21:07:39 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.644ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-28','2025-05-28','2025-05-28',0,0,0,0,'2025-06-20 21:07:39.344','2025-06-20 21:07:39.344')

2025/06/20 21:07:39 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.002ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-27'

2025/06/20 21:07:39 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.144ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-27'

2025/06/20 21:07:39 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.629ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-27','2025-05-27','2025-05-27',0,0,0,0,'2025-06-20 21:07:39.547','2025-06-20 21:07:39.547')

2025/06/20 21:07:39 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.954ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-26'

2025/06/20 21:07:39 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.145ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-26'

2025/06/20 21:07:39 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.609ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-26','2025-05-26','2025-05-26',0,0,0,0,'2025-06-20 21:07:39.751','2025-06-20 21:07:39.751')

2025/06/20 21:07:39 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.949ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-25'

2025/06/20 21:07:39 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.000ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-25'

2025/06/20 21:07:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.906ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-25','2025-05-25','2025-05-25',0,0,0,0,'2025-06-20 21:07:39.953','2025-06-20 21:07:39.953')

2025/06/20 21:07:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.990ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-24'

2025/06/20 21:07:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.908ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-24'

2025/06/20 21:07:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.470ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-24','2025-05-24','2025-05-24',0,0,0,0,'2025-06-20 21:07:40.158','2025-06-20 21:07:40.158')

2025/06/20 21:07:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.053ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-23'

2025/06/20 21:07:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.453ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-23'

2025/06/20 21:07:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.145ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-23','2025-05-23','2025-05-23',0,0,0,0,'2025-06-20 21:07:40.361','2025-06-20 21:07:40.361')

2025/06/20 21:07:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.501ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-22'

2025/06/20 21:07:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.818ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-22'

2025/06/20 21:07:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.463ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-22','2025-05-22','2025-05-22',0,0,0,0,'2025-06-20 21:07:40.564','2025-06-20 21:07:40.564')

2025/06/20 21:07:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:46
[57.349ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1

2025/06/20 21:07:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:46
[57.822ms] [rows:0] SELECT * FROM `merchant_revenue_stats` WHERE tenants_id = 1 ORDER BY stat_date DESC LIMIT 10

2025/06/20 21:07:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:69
[59.069ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8

2025/06/20 21:07:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[59.118ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-20'

2025/06/20 21:07:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.681ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-20'

2025/06/20 21:07:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[88.189ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-20','2025-06-20','2025-06-20',0,0,0,0,'2025-06-20 21:07:49.438','2025-06-20 21:07:49.438')

2025/06/20 21:07:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.668ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-19'

2025/06/20 21:07:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.904ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-19'

2025/06/20 21:07:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.973ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-19','2025-06-19','2025-06-19',0,0,0,0,'2025-06-20 21:07:49.644','2025-06-20 21:07:49.644')

2025/06/20 21:07:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.528ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-18'

2025/06/20 21:07:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.362ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-18'

2025/06/20 21:07:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.526ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-18','2025-06-18','2025-06-18',0,0,0,0,'2025-06-20 21:07:49.849','2025-06-20 21:07:49.849')

2025/06/20 21:07:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.761ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-17'

2025/06/20 21:07:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.395ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-17'

2025/06/20 21:07:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.898ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-17','2025-06-17','2025-06-17',0,0,0,0,'2025-06-20 21:07:50.053','2025-06-20 21:07:50.053')

2025/06/20 21:07:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.971ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-16'

2025/06/20 21:07:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.222ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-16'

2025/06/20 21:07:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[88.297ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-16','2025-06-16','2025-06-16',0,0,0,0,'2025-06-20 21:07:50.257','2025-06-20 21:07:50.257')

2025/06/20 21:07:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.726ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-15'

2025/06/20 21:07:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.063ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-15'

2025/06/20 21:07:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.184ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-15','2025-06-15','2025-06-15',0,0,0,0,'2025-06-20 21:07:50.463','2025-06-20 21:07:50.463')

2025/06/20 21:07:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.247ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-14'

2025/06/20 21:07:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.702ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-14'

2025/06/20 21:07:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.090ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-14','2025-06-14','2025-06-14',0,0,0,0,'2025-06-20 21:07:50.668','2025-06-20 21:07:50.668')

2025/06/20 21:07:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.921ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-13'

2025/06/20 21:07:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.854ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-13'

2025/06/20 21:07:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.531ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-13','2025-06-13','2025-06-13',0,0,0,0,'2025-06-20 21:07:50.872','2025-06-20 21:07:50.872')

2025/06/20 21:07:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.791ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-12'

2025/06/20 21:07:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.915ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-12'

2025/06/20 21:07:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.621ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-12','2025-06-12','2025-06-12',0,0,0,0,'2025-06-20 21:07:51.076','2025-06-20 21:07:51.076')

2025/06/20 21:07:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.857ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-11'

2025/06/20 21:07:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.387ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-11'

2025/06/20 21:07:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.702ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-11','2025-06-11','2025-06-11',0,0,0,0,'2025-06-20 21:07:51.28','2025-06-20 21:07:51.28')

2025/06/20 21:07:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.906ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-10'

2025/06/20 21:07:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.963ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-10'

2025/06/20 21:07:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.277ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-10','2025-06-10','2025-06-10',0,0,0,0,'2025-06-20 21:07:51.483','2025-06-20 21:07:51.483')

2025/06/20 21:07:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.123ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-09'

2025/06/20 21:07:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.859ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-09'

2025/06/20 21:07:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.975ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-09','2025-06-09','2025-06-09',7,139.3,139.3,7,'2025-06-20 21:07:51.687','2025-06-20 21:07:51.687')

2025/06/20 21:07:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.738ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-08'

2025/06/20 21:07:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.719ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-08'

2025/06/20 21:07:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.302ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-08','2025-06-08','2025-06-08',11,19.9,19.9,1,'2025-06-20 21:07:51.892','2025-06-20 21:07:51.892')

2025/06/20 21:07:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.984ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-07'

2025/06/20 21:07:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.848ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-07'

2025/06/20 21:07:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.475ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-07','2025-06-07','2025-06-07',0,0,0,0,'2025-06-20 21:07:52.097','2025-06-20 21:07:52.097')

2025/06/20 21:07:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.463ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-06'

2025/06/20 21:07:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.855ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-06'

2025/06/20 21:07:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.945ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-06','2025-06-06','2025-06-06',0,0,0,0,'2025-06-20 21:07:52.3','2025-06-20 21:07:52.3')

2025/06/20 21:07:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.382ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-05'

2025/06/20 21:07:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.623ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-05'

2025/06/20 21:07:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.614ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-05','2025-06-05','2025-06-05',0,0,0,0,'2025-06-20 21:07:52.504','2025-06-20 21:07:52.504')

2025/06/20 21:07:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.902ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-04'

2025/06/20 21:07:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.885ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-04'

2025/06/20 21:07:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.471ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-04','2025-06-04','2025-06-04',0,0,0,0,'2025-06-20 21:07:52.707','2025-06-20 21:07:52.707')

2025/06/20 21:07:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.532ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-03'

2025/06/20 21:07:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.777ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-03'

2025/06/20 21:07:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.560ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-03','2025-06-03','2025-06-03',0,0,0,0,'2025-06-20 21:07:52.912','2025-06-20 21:07:52.912')

2025/06/20 21:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.015ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-02'

2025/06/20 21:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.591ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-02'

2025/06/20 21:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.613ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-02','2025-06-02','2025-06-02',0,0,0,0,'2025-06-20 21:07:53.115','2025-06-20 21:07:53.115')

2025/06/20 21:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.170ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-01'

2025/06/20 21:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.505ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-01'

2025/06/20 21:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.272ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-01','2025-06-01','2025-06-01',0,0,0,0,'2025-06-20 21:07:53.318','2025-06-20 21:07:53.318')

2025/06/20 21:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.478ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-31'

2025/06/20 21:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.196ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-31'

2025/06/20 21:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.580ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-31','2025-05-31','2025-05-31',0,0,0,0,'2025-06-20 21:07:53.522','2025-06-20 21:07:53.522')

2025/06/20 21:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.651ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-30'

2025/06/20 21:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.653ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-30'

2025/06/20 21:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.102ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-30','2025-05-30','2025-05-30',0,0,0,0,'2025-06-20 21:07:53.727','2025-06-20 21:07:53.727')

2025/06/20 21:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.344ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-29'

2025/06/20 21:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.403ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-29'

2025/06/20 21:07:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.262ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-29','2025-05-29','2025-05-29',0,0,0,0,'2025-06-20 21:07:53.931','2025-06-20 21:07:53.931')

2025/06/20 21:07:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.003ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-28'

2025/06/20 21:07:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.308ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-28'

2025/06/20 21:07:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.328ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-28','2025-05-28','2025-05-28',0,0,0,0,'2025-06-20 21:07:54.136','2025-06-20 21:07:54.136')

2025/06/20 21:07:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.367ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-27'

2025/06/20 21:07:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.509ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-27'

2025/06/20 21:07:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.426ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-27','2025-05-27','2025-05-27',0,0,0,0,'2025-06-20 21:07:54.341','2025-06-20 21:07:54.341')

2025/06/20 21:07:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.943ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-26'

2025/06/20 21:07:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.469ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-26'

2025/06/20 21:07:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.604ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-26','2025-05-26','2025-05-26',0,0,0,0,'2025-06-20 21:07:54.544','2025-06-20 21:07:54.544')

2025/06/20 21:07:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.846ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-25'

2025/06/20 21:07:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.757ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-25'

2025/06/20 21:07:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.601ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-25','2025-05-25','2025-05-25',0,0,0,0,'2025-06-20 21:07:54.747','2025-06-20 21:07:54.747')

2025/06/20 21:07:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.935ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-24'

2025/06/20 21:07:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.651ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-24'

2025/06/20 21:07:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.944ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-24','2025-05-24','2025-05-24',0,0,0,0,'2025-06-20 21:07:54.951','2025-06-20 21:07:54.951')

2025/06/20 21:07:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.852ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-23'

2025/06/20 21:07:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.451ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-23'

2025/06/20 21:07:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.409ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-23','2025-05-23','2025-05-23',0,0,0,0,'2025-06-20 21:07:55.155','2025-06-20 21:07:55.155')

2025/06/20 21:07:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.427ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-22'

2025/06/20 21:07:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.997ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-22'

2025/06/20 21:07:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.843ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-22','2025-05-22','2025-05-22',0,0,0,0,'2025-06-20 21:07:55.358','2025-06-20 21:07:55.358')

2025/06/20 21:07:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:46
[57.920ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8

2025/06/20 21:07:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:46
[58.282ms] [rows:0] SELECT * FROM `merchant_revenue_stats` WHERE tenants_id = 8 ORDER BY stat_date DESC LIMIT 10

2025/06/20 21:07:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:98
[58.238ms] [rows:1] SELECT count(*) FROM `order` WHERE tenants_id = 8

2025/06/20 21:07:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:116
[57.881ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` WHERE tenants_id = 8 ORDER BY create_time DESC LIMIT 10

2025/06/20 21:07:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:165
[57.879ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (6,108,109,116)

2025/06/20 21:08:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:98
[58.355ms] [rows:1] SELECT count(*) FROM `order` WHERE tenants_id = 8

2025/06/20 21:08:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:116
[58.342ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` WHERE tenants_id = 8 ORDER BY create_time DESC LIMIT 10

2025/06/20 21:08:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:165
[57.546ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (108,109,116,6)

2025/06/20 21:08:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:69
[62.124ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8

2025/06/20 21:08:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.753ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-20'

2025/06/20 21:08:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.558ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-20'

2025/06/20 21:08:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.760ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-20','2025-06-20','2025-06-20',0,0,0,0,'2025-06-20 21:08:02.688','2025-06-20 21:08:02.688')

2025/06/20 21:08:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.015ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-19'

2025/06/20 21:08:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.955ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-19'

2025/06/20 21:08:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.610ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-19','2025-06-19','2025-06-19',0,0,0,0,'2025-06-20 21:08:02.891','2025-06-20 21:08:02.891')

2025/06/20 21:08:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.951ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-18'

2025/06/20 21:08:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.756ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-18'

2025/06/20 21:08:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.501ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-18','2025-06-18','2025-06-18',0,0,0,0,'2025-06-20 21:08:03.094','2025-06-20 21:08:03.094')

2025/06/20 21:08:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.929ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-17'

2025/06/20 21:08:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.440ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-17'

2025/06/20 21:08:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[88.126ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-17','2025-06-17','2025-06-17',0,0,0,0,'2025-06-20 21:08:03.298','2025-06-20 21:08:03.298')

2025/06/20 21:08:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.462ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-16'

2025/06/20 21:08:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.782ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-16'

2025/06/20 21:08:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.548ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-16','2025-06-16','2025-06-16',0,0,0,0,'2025-06-20 21:08:03.502','2025-06-20 21:08:03.502')

2025/06/20 21:08:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.049ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-15'

2025/06/20 21:08:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.259ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-15'

2025/06/20 21:08:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.983ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-15','2025-06-15','2025-06-15',0,0,0,0,'2025-06-20 21:08:03.707','2025-06-20 21:08:03.707')

2025/06/20 21:08:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.505ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-14'

2025/06/20 21:08:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.723ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-14'

2025/06/20 21:08:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.040ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-14','2025-06-14','2025-06-14',0,0,0,0,'2025-06-20 21:08:03.91','2025-06-20 21:08:03.91')

2025/06/20 21:08:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.872ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-13'

2025/06/20 21:08:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.945ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-13'

2025/06/20 21:08:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.120ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-13','2025-06-13','2025-06-13',0,0,0,0,'2025-06-20 21:08:04.113','2025-06-20 21:08:04.113')

2025/06/20 21:08:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.990ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-12'

2025/06/20 21:08:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.569ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-12'

2025/06/20 21:08:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.254ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-12','2025-06-12','2025-06-12',0,0,0,0,'2025-06-20 21:08:04.317','2025-06-20 21:08:04.317')

2025/06/20 21:08:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.524ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-11'

2025/06/20 21:08:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.319ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-11'

2025/06/20 21:08:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.583ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-11','2025-06-11','2025-06-11',0,0,0,0,'2025-06-20 21:08:04.522','2025-06-20 21:08:04.522')

2025/06/20 21:08:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.711ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-10'

2025/06/20 21:08:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.323ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-10'

2025/06/20 21:08:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.721ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-10','2025-06-10','2025-06-10',0,0,0,0,'2025-06-20 21:08:04.725','2025-06-20 21:08:04.725')

2025/06/20 21:08:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.949ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-09'

2025/06/20 21:08:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.278ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-09'

2025/06/20 21:08:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.590ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-09','2025-06-09','2025-06-09',7,139.3,139.3,7,'2025-06-20 21:08:04.929','2025-06-20 21:08:04.929')

2025/06/20 21:08:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.880ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-08'

2025/06/20 21:08:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.724ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-08'

2025/06/20 21:08:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.029ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-08','2025-06-08','2025-06-08',11,19.9,19.9,1,'2025-06-20 21:08:05.132','2025-06-20 21:08:05.132')

2025/06/20 21:08:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.016ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-07'

2025/06/20 21:08:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.322ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-07'

2025/06/20 21:08:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.588ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-07','2025-06-07','2025-06-07',0,0,0,0,'2025-06-20 21:08:05.335','2025-06-20 21:08:05.335')

2025/06/20 21:08:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.984ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-06'

2025/06/20 21:08:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.857ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-06'

2025/06/20 21:08:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.460ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-06','2025-06-06','2025-06-06',0,0,0,0,'2025-06-20 21:08:05.538','2025-06-20 21:08:05.538')

2025/06/20 21:08:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.001ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-05'

2025/06/20 21:08:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.860ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-05'

2025/06/20 21:08:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.423ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-05','2025-06-05','2025-06-05',0,0,0,0,'2025-06-20 21:08:05.741','2025-06-20 21:08:05.741')

2025/06/20 21:08:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.130ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-04'

2025/06/20 21:08:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.089ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-04'

2025/06/20 21:08:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.237ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-04','2025-06-04','2025-06-04',0,0,0,0,'2025-06-20 21:08:05.945','2025-06-20 21:08:05.945')

2025/06/20 21:08:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.010ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-03'

2025/06/20 21:08:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.653ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-03'

2025/06/20 21:08:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.411ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-03','2025-06-03','2025-06-03',0,0,0,0,'2025-06-20 21:08:06.148','2025-06-20 21:08:06.148')

2025/06/20 21:08:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.881ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-02'

2025/06/20 21:08:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.877ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-02'

2025/06/20 21:08:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.195ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-02','2025-06-02','2025-06-02',0,0,0,0,'2025-06-20 21:08:06.351','2025-06-20 21:08:06.351')

2025/06/20 21:08:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.844ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-06-01'

2025/06/20 21:08:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.297ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-06-01'

2025/06/20 21:08:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[85.976ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-06-01','2025-06-01','2025-06-01',0,0,0,0,'2025-06-20 21:08:06.555','2025-06-20 21:08:06.555')

2025/06/20 21:08:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.933ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-31'

2025/06/20 21:08:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.105ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-31'

2025/06/20 21:08:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.751ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-31','2025-05-31','2025-05-31',0,0,0,0,'2025-06-20 21:08:06.758','2025-06-20 21:08:06.758')

2025/06/20 21:08:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.657ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-30'

2025/06/20 21:08:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.992ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-30'

2025/06/20 21:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[85.374ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-30','2025-05-30','2025-05-30',0,0,0,0,'2025-06-20 21:08:06.962','2025-06-20 21:08:06.962')

2025/06/20 21:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.114ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-29'

2025/06/20 21:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[64.616ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-29'

2025/06/20 21:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.876ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-29','2025-05-29','2025-05-29',0,0,0,0,'2025-06-20 21:08:07.171','2025-06-20 21:08:07.171')

2025/06/20 21:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.024ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-28'

2025/06/20 21:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.256ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-28'

2025/06/20 21:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.475ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-28','2025-05-28','2025-05-28',0,0,0,0,'2025-06-20 21:08:07.374','2025-06-20 21:08:07.374')

2025/06/20 21:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.725ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-27'

2025/06/20 21:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.212ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-27'

2025/06/20 21:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.451ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-27','2025-05-27','2025-05-27',0,0,0,0,'2025-06-20 21:08:07.577','2025-06-20 21:08:07.577')

2025/06/20 21:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.146ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-26'

2025/06/20 21:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.904ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-26'

2025/06/20 21:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[85.873ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-26','2025-05-26','2025-05-26',0,0,0,0,'2025-06-20 21:08:07.781','2025-06-20 21:08:07.781')

2025/06/20 21:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.052ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-25'

2025/06/20 21:08:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.747ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-25'

2025/06/20 21:08:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.699ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-25','2025-05-25','2025-05-25',0,0,0,0,'2025-06-20 21:08:07.983','2025-06-20 21:08:07.983')

2025/06/20 21:08:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.128ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-24'

2025/06/20 21:08:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.000ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-24'

2025/06/20 21:08:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.459ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-24','2025-05-24','2025-05-24',0,0,0,0,'2025-06-20 21:08:08.186','2025-06-20 21:08:08.186')

2025/06/20 21:08:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.104ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-23'

2025/06/20 21:08:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.897ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-23'

2025/06/20 21:08:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.672ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-23','2025-05-23','2025-05-23',0,0,0,0,'2025-06-20 21:08:08.391','2025-06-20 21:08:08.391')

2025/06/20 21:08:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.126ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8 AND stat_date = '2025-05-22'

2025/06/20 21:08:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.889ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 8 AND DATE(create_time) = '2025-05-22'

2025/06/20 21:08:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.786ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (8,'2025-05-22','2025-05-22','2025-05-22',0,0,0,0,'2025-06-20 21:08:08.595','2025-06-20 21:08:08.595')

2025/06/20 21:08:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:46
[57.641ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 8

2025/06/20 21:08:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:46
[58.351ms] [rows:0] SELECT * FROM `merchant_revenue_stats` WHERE tenants_id = 8 ORDER BY stat_date DESC LIMIT 10

2025/06/20 21:08:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[39.202ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:08:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.768ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:08:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.106ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:08:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.470ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:08:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.052ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:08:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.037ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:08:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.460ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:08:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.203ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:08:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.306ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:08:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.732ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:08:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.062ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:08:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.830ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:08:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.699ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:08:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:69
[58.054ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1

2025/06/20 21:08:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.208ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-20'

2025/06/20 21:08:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.806ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-20'

2025/06/20 21:08:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.372ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-20','2025-06-20','2025-06-20',0,0,0,0,'2025-06-20 21:08:10.392','2025-06-20 21:08:10.392')

2025/06/20 21:08:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.832ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-19'

2025/06/20 21:08:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.703ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-19'

2025/06/20 21:08:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.590ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-19','2025-06-19','2025-06-19',0,0,0,0,'2025-06-20 21:08:10.596','2025-06-20 21:08:10.596')

2025/06/20 21:08:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.397ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-18'

2025/06/20 21:08:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.071ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-18'

2025/06/20 21:08:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.156ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-18','2025-06-18','2025-06-18',0,0,0,0,'2025-06-20 21:08:10.801','2025-06-20 21:08:10.801')

2025/06/20 21:08:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.471ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-17'

2025/06/20 21:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.774ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-17'

2025/06/20 21:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.544ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-17','2025-06-17','2025-06-17',0,0,0,0,'2025-06-20 21:08:11.005','2025-06-20 21:08:11.005')

2025/06/20 21:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.077ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-16'

2025/06/20 21:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.809ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-16'

2025/06/20 21:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.076ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-16','2025-06-16','2025-06-16',0,0,0,0,'2025-06-20 21:08:11.208','2025-06-20 21:08:11.208')

2025/06/20 21:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.906ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-15'

2025/06/20 21:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.701ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-15'

2025/06/20 21:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.121ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-15','2025-06-15','2025-06-15',0,0,0,0,'2025-06-20 21:08:11.411','2025-06-20 21:08:11.411')

2025/06/20 21:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.877ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-14'

2025/06/20 21:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.978ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-14'

2025/06/20 21:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[93.202ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-14','2025-06-14','2025-06-14',0,0,0,0,'2025-06-20 21:08:11.614','2025-06-20 21:08:11.614')

2025/06/20 21:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[59.148ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-13'

2025/06/20 21:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.801ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-13'

2025/06/20 21:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.820ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-13','2025-06-13','2025-06-13',0,0,0,0,'2025-06-20 21:08:11.827','2025-06-20 21:08:11.827')

2025/06/20 21:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.617ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-12'

2025/06/20 21:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[72.896ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-12'

2025/06/20 21:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.181ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-12','2025-06-12','2025-06-12',0,0,0,0,'2025-06-20 21:08:12.046','2025-06-20 21:08:12.046')

2025/06/20 21:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.904ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-11'

2025/06/20 21:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[59.318ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-11'

2025/06/20 21:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.975ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-11','2025-06-11','2025-06-11',0,0,0,0,'2025-06-20 21:08:12.251','2025-06-20 21:08:12.251')

2025/06/20 21:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.672ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-10'

2025/06/20 21:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.998ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-10'

2025/06/20 21:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.665ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-10','2025-06-10','2025-06-10',0,0,0,0,'2025-06-20 21:08:12.454','2025-06-20 21:08:12.454')

2025/06/20 21:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.842ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-09'

2025/06/20 21:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.990ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-09'

2025/06/20 21:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.450ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-09','2025-06-09','2025-06-09',0,0,0,0,'2025-06-20 21:08:12.657','2025-06-20 21:08:12.657')

2025/06/20 21:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.034ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-08'

2025/06/20 21:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.900ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-08'

2025/06/20 21:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.903ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-08','2025-06-08','2025-06-08',0,0,0,0,'2025-06-20 21:08:12.86','2025-06-20 21:08:12.86')

2025/06/20 21:08:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.771ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-07'

2025/06/20 21:08:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.733ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-07'

2025/06/20 21:08:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.434ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-07','2025-06-07','2025-06-07',0,0,0,0,'2025-06-20 21:08:13.065','2025-06-20 21:08:13.065')

2025/06/20 21:08:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.056ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-06'

2025/06/20 21:08:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.142ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-06'

2025/06/20 21:08:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.687ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-06','2025-06-06','2025-06-06',0,0,0,0,'2025-06-20 21:08:13.269','2025-06-20 21:08:13.269')

2025/06/20 21:08:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.246ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-05'

2025/06/20 21:08:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.129ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-05'

2025/06/20 21:08:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.543ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-05','2025-06-05','2025-06-05',0,0,0,0,'2025-06-20 21:08:13.473','2025-06-20 21:08:13.473')

2025/06/20 21:08:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.759ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-04'

2025/06/20 21:08:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.840ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-04'

2025/06/20 21:08:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.108ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-04','2025-06-04','2025-06-04',0,0,0,0,'2025-06-20 21:08:13.676','2025-06-20 21:08:13.676')

2025/06/20 21:08:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[61.945ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-03'

2025/06/20 21:08:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.621ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-03'

2025/06/20 21:08:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.605ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-03','2025-06-03','2025-06-03',0,0,0,0,'2025-06-20 21:08:13.884','2025-06-20 21:08:13.884')

2025/06/20 21:08:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.902ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-02'

2025/06/20 21:08:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.840ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-02'

2025/06/20 21:08:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.613ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-02','2025-06-02','2025-06-02',0,0,0,0,'2025-06-20 21:08:14.087','2025-06-20 21:08:14.087')

2025/06/20 21:08:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[57.802ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-01'

2025/06/20 21:08:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.272ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-01'

2025/06/20 21:08:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.013ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-01','2025-06-01','2025-06-01',0,0,0,0,'2025-06-20 21:08:14.291','2025-06-20 21:08:14.291')

2025/06/20 21:08:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.832ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-31'

2025/06/20 21:08:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.152ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-31'

2025/06/20 21:08:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.723ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-31','2025-05-31','2025-05-31',0,0,0,0,'2025-06-20 21:08:14.496','2025-06-20 21:08:14.496')

2025/06/20 21:08:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.149ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-30'

2025/06/20 21:08:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.100ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-30'

2025/06/20 21:08:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.428ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-30','2025-05-30','2025-05-30',0,0,0,0,'2025-06-20 21:08:14.701','2025-06-20 21:08:14.701')

2025/06/20 21:08:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[61.643ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-29'

2025/06/20 21:08:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.708ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-29'

2025/06/20 21:08:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.648ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-29','2025-05-29','2025-05-29',0,0,0,0,'2025-06-20 21:08:14.909','2025-06-20 21:08:14.909')

2025/06/20 21:08:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.473ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-28'

2025/06/20 21:08:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.949ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-28'

2025/06/20 21:08:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[86.597ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-28','2025-05-28','2025-05-28',0,0,0,0,'2025-06-20 21:08:15.113','2025-06-20 21:08:15.113')

2025/06/20 21:08:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.392ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-27'

2025/06/20 21:08:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.117ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-27'

2025/06/20 21:08:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.693ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-27','2025-05-27','2025-05-27',0,0,0,0,'2025-06-20 21:08:15.317','2025-06-20 21:08:15.317')

2025/06/20 21:08:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.651ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-26'

2025/06/20 21:08:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.916ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-26'

2025/06/20 21:08:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.141ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-26','2025-05-26','2025-05-26',0,0,0,0,'2025-06-20 21:08:15.522','2025-06-20 21:08:15.522')

2025/06/20 21:08:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.252ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-25'

2025/06/20 21:08:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.283ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-25'

2025/06/20 21:08:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[88.176ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-25','2025-05-25','2025-05-25',0,0,0,0,'2025-06-20 21:08:15.726','2025-06-20 21:08:15.726')

2025/06/20 21:08:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.997ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-24'

2025/06/20 21:08:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[57.857ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-24'

2025/06/20 21:08:16 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[88.209ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-24','2025-05-24','2025-05-24',0,0,0,0,'2025-06-20 21:08:15.932','2025-06-20 21:08:15.932')

2025/06/20 21:08:16 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[60.254ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-23'

2025/06/20 21:08:16 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.547ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-23'

2025/06/20 21:08:16 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.191ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-23','2025-05-23','2025-05-23',0,0,0,0,'2025-06-20 21:08:16.14','2025-06-20 21:08:16.14')

2025/06/20 21:08:16 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[58.127ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-22'

2025/06/20 21:08:16 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[58.278ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-22'

2025/06/20 21:08:16 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139 Error 1054 (42S22): Unknown column 'total_order' in 'field list'
[87.042ms] [rows:0] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_order`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-22','2025-05-22','2025-05-22',0,0,0,0,'2025-06-20 21:08:16.344','2025-06-20 21:08:16.344')

2025/06/20 21:08:16 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:46
[57.848ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1

2025/06/20 21:08:16 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:46
[58.413ms] [rows:0] SELECT * FROM `merchant_revenue_stats` WHERE tenants_id = 1 ORDER BY stat_date DESC LIMIT 10

2025/06/20 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.642ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:08:37.341'

2025/06/20 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.849ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:53:37.341' LIMIT 50

2025/06/20 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.274ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:53:37.353' LIMIT 50

2025/06/20 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.224ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:08:37.341'

2025/06/20 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.376ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:08:37.341'

2025/06/20 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.308ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:38:37.72'

2025/06/20 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.202ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:08:37.779' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.201ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.941ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:38:37.825'

2025/06/20 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.961ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.409ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:08:37.887' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.015ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:08:37.897' AND status != 'pending'
	

2025/06/20 21:08:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.719ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.055ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.008ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:08:37.956' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.591ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:08:38.014'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.546ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:08:38.011' AND status != 'pending'
	

2025/06/20 21:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.729ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:08:38.073' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:08:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.945ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:08:38.135'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.953ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:09:37.34'

2025/06/20 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.253ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:09:37.34'

2025/06/20 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.814ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:09:37.34'

2025/06/20 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.890ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:39:37.72'

2025/06/20 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.768ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:09:37.783' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.397ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.315ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:39:37.826'

2025/06/20 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.727ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.882ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:09:37.885' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.940ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:09:37.908' AND status != 'pending'
	

2025/06/20 21:09:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.256ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.238ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.400ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:09:37.97' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.598ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:09:38.007' AND status != 'pending'
	

2025/06/20 21:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.698ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:09:38.036'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.051ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:09:38.066' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:09:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.114ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:09:38.125'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:09:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.085ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:39:45.562'

2025/06/20 21:09:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[70.693ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:09:45.627' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:09:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.886ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:09:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.384ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:09:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[229.574ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:39:45.571'

2025/06/20 21:09:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.074ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:09:45.762' AND status != 'pending'
	

2025/06/20 21:09:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.798ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:09:45.802' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:09:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.768ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:09:45.825' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:09:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.360ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:09:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.703ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:09:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.407ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:09:45.89'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:09:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.589ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:09:45.926' AND status != 'pending'
	

2025/06/20 21:09:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.787ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:09:45.987' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:09:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.867ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:09:46.049'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:09:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.203ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:39:48.044'

2025/06/20 21:09:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.719ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:09:48.11' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:09:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.868ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:09:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.865ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:09:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[189.262ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:39:48.062'

2025/06/20 21:09:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.363ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:09:48.234' AND status != 'pending'
	

2025/06/20 21:09:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.073ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:09:48.252' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:09:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.328ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:09:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.565ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:09:48.295' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:09:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.641ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:09:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.329ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:09:48.357'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:09:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.224ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:09:48.374' AND status != 'pending'
	

2025/06/20 21:09:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.468ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:09:48.436' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:09:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.029ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:09:48.498'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:09:54 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.945ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:39:54.706'

2025/06/20 21:09:54 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.566ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:09:54.777' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:09:54 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.194ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:09:54 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.590ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:09:54 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[192.074ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:39:54.718'

2025/06/20 21:09:54 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.912ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:09:54.899' AND status != 'pending'
	

2025/06/20 21:09:54 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.217ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:09:54.91' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:09:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.183ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:09:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.094ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:09:54.96' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:09:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.523ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:09:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.379ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:09:55.021'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:09:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.936ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:09:55.034' AND status != 'pending'
	

2025/06/20 21:09:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.680ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:09:55.097' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:09:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.585ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:09:55.159'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:10:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[71.020ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:40:03.943'

2025/06/20 21:10:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.881ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:10:04.014' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:10:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.762ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:10:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.132ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:10:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[189.560ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:40:03.956'

2025/06/20 21:10:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.758ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:10:04.141' AND status != 'pending'
	

2025/06/20 21:10:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.639ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:10:04.146' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:10:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.160ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:10:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.643ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:10:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.990ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:10:04.204' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:10:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.337ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:10:04.267' AND status != 'pending'
	

2025/06/20 21:10:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.765ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:10:04.268'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:10:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.807ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:10:04.329' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:10:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.882ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:10:04.391'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:10:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.863ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:40:59.499'

2025/06/20 21:10:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.487ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:10:59.56' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:10:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.252ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:10:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.727ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:10:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[200.362ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:40:59.509'

2025/06/20 21:10:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.411ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:10:59.68' AND status != 'pending'
	

2025/06/20 21:10:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.500ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:10:59.71' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:10:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.072ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:10:59.742' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:10:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.682ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:10:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.296ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:10:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.722ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:10:59.802'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:10:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.319ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:10:59.84' AND status != 'pending'
	

2025/06/20 21:10:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.502ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:10:59.905' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:11:00 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.988ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:10:59.971'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:11:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.055ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:41:04.739'

2025/06/20 21:11:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.233ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:11:04.807' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:11:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.828ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:11:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.994ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:11:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[192.854ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:41:04.749'

2025/06/20 21:11:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.187ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:11:04.926' AND status != 'pending'
	

2025/06/20 21:11:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.134ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:11:04.942' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:11:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.623ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:11:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.198ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:11:04.985' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:11:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.759ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:11:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.645ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:11:05.046'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:11:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.678ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:11:05.068' AND status != 'pending'
	

2025/06/20 21:11:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.974ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:11:05.131' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:11:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.047ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:11:05.194'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:11:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[76.744ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:41:32.54'

2025/06/20 21:11:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.845ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:11:32.617' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:11:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.591ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:11:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.914ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:11:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[197.181ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:41:32.562'

2025/06/20 21:11:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.517ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:11:32.75' AND status != 'pending'
	

2025/06/20 21:11:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.229ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:11:32.759' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:11:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.916ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:11:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.177ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:11:32.813' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:11:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.628ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:11:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.541ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:11:32.876'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:11:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.466ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:11:32.88' AND status != 'pending'
	

2025/06/20 21:11:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.298ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:11:32.944' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:11:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.933ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:11:33.005'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:11:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.023ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:41:36.502'

2025/06/20 21:11:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.442ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:11:36.571' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:11:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.486ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:11:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.429ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:11:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[193.192ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:41:36.527'

2025/06/20 21:11:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.726ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:11:36.686' AND status != 'pending'
	

2025/06/20 21:11:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.282ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:11:36.721' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:11:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.147ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:11:36.744' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:11:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.290ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:11:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.456ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:11:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.818ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:11:36.802'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:11:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.904ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:11:36.847' AND status != 'pending'
	

2025/06/20 21:11:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.445ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:11:36.911' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:11:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.757ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:11:36.973'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:12:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:69
[63.478ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1

2025/06/20 21:12:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.745ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-20'

2025/06/20 21:12:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[63.755ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-20'

2025/06/20 21:12:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[129.540ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-20','2025-06-20','2025-06-20',0,0,0,0,'2025-06-20 21:12:00.387','2025-06-20 21:12:00.387')

2025/06/20 21:12:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[64.771ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-19'

2025/06/20 21:12:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.993ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-19'

2025/06/20 21:12:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[127.480ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-19','2025-06-19','2025-06-19',0,0,0,0,'2025-06-20 21:12:00.646','2025-06-20 21:12:00.646')

2025/06/20 21:12:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.162ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-18'

2025/06/20 21:12:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.489ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-18'

2025/06/20 21:12:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[126.644ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-18','2025-06-18','2025-06-18',0,0,0,0,'2025-06-20 21:12:00.899','2025-06-20 21:12:00.899')

2025/06/20 21:12:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.675ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-17'

2025/06/20 21:12:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[65.418ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-17'

2025/06/20 21:12:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[127.397ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-17','2025-06-17','2025-06-17',0,0,0,0,'2025-06-20 21:12:01.154','2025-06-20 21:12:01.154')

2025/06/20 21:12:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[63.030ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-16'

2025/06/20 21:12:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[63.411ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-16'

2025/06/20 21:12:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[126.409ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-16','2025-06-16','2025-06-16',0,0,0,0,'2025-06-20 21:12:01.409','2025-06-20 21:12:01.409')

2025/06/20 21:12:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.438ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-15'

2025/06/20 21:12:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.711ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-15'

2025/06/20 21:12:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[126.860ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-15','2025-06-15','2025-06-15',0,0,0,0,'2025-06-20 21:12:01.661','2025-06-20 21:12:01.661')

2025/06/20 21:12:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[63.200ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-14'

2025/06/20 21:12:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.641ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-14'

2025/06/20 21:12:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[127.326ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-14','2025-06-14','2025-06-14',0,0,0,0,'2025-06-20 21:12:01.914','2025-06-20 21:12:01.914')

2025/06/20 21:12:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.277ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-13'

2025/06/20 21:12:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.489ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-13'

2025/06/20 21:12:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[127.149ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-13','2025-06-13','2025-06-13',0,0,0,0,'2025-06-20 21:12:02.167','2025-06-20 21:12:02.167')

2025/06/20 21:12:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.382ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-12'

2025/06/20 21:12:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.362ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-12'

2025/06/20 21:12:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[125.867ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-12','2025-06-12','2025-06-12',0,0,0,0,'2025-06-20 21:12:02.42','2025-06-20 21:12:02.42')

2025/06/20 21:12:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.750ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-11'

2025/06/20 21:12:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.230ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-11'

2025/06/20 21:12:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[127.251ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-11','2025-06-11','2025-06-11',0,0,0,0,'2025-06-20 21:12:02.672','2025-06-20 21:12:02.672')

2025/06/20 21:12:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.422ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-10'

2025/06/20 21:12:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.626ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-10'

2025/06/20 21:12:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[128.249ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-10','2025-06-10','2025-06-10',0,0,0,0,'2025-06-20 21:12:02.924','2025-06-20 21:12:02.924')

2025/06/20 21:12:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.640ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-09'

2025/06/20 21:12:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.103ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-09'

2025/06/20 21:12:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[127.508ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-09','2025-06-09','2025-06-09',0,0,0,0,'2025-06-20 21:12:03.178','2025-06-20 21:12:03.178')

2025/06/20 21:12:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.295ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-08'

2025/06/20 21:12:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.748ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-08'

2025/06/20 21:12:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[127.601ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-08','2025-06-08','2025-06-08',0,0,0,0,'2025-06-20 21:12:03.431','2025-06-20 21:12:03.431')

2025/06/20 21:12:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.415ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-07'

2025/06/20 21:12:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.637ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-07'

2025/06/20 21:12:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[125.722ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-07','2025-06-07','2025-06-07',0,0,0,0,'2025-06-20 21:12:03.685','2025-06-20 21:12:03.685')

2025/06/20 21:12:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.966ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-06'

2025/06/20 21:12:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[63.049ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-06'

2025/06/20 21:12:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[128.596ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-06','2025-06-06','2025-06-06',0,0,0,0,'2025-06-20 21:12:03.937','2025-06-20 21:12:03.937')

2025/06/20 21:12:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.227ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-05'

2025/06/20 21:12:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.841ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-05'

2025/06/20 21:12:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[126.448ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-05','2025-06-05','2025-06-05',0,0,0,0,'2025-06-20 21:12:04.191','2025-06-20 21:12:04.191')

2025/06/20 21:12:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[61.719ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-04'

2025/06/20 21:12:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[63.257ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-04'

2025/06/20 21:12:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[127.221ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-04','2025-06-04','2025-06-04',0,0,0,0,'2025-06-20 21:12:04.443','2025-06-20 21:12:04.443')

2025/06/20 21:12:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.656ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-03'

2025/06/20 21:12:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.275ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-03'

2025/06/20 21:12:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[127.514ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-03','2025-06-03','2025-06-03',0,0,0,0,'2025-06-20 21:12:04.696','2025-06-20 21:12:04.696')

2025/06/20 21:12:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[63.084ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-02'

2025/06/20 21:12:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.421ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-02'

2025/06/20 21:12:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[127.262ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-02','2025-06-02','2025-06-02',0,0,0,0,'2025-06-20 21:12:04.95','2025-06-20 21:12:04.95')

2025/06/20 21:12:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.033ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-06-01'

2025/06/20 21:12:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.359ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-06-01'

2025/06/20 21:12:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[127.792ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-06-01','2025-06-01','2025-06-01',0,0,0,0,'2025-06-20 21:12:05.202','2025-06-20 21:12:05.202')

2025/06/20 21:12:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.764ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-31'

2025/06/20 21:12:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.934ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-31'

2025/06/20 21:12:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[126.682ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-31','2025-05-31','2025-05-31',0,0,0,0,'2025-06-20 21:12:05.456','2025-06-20 21:12:05.456')

2025/06/20 21:12:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.746ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-30'

2025/06/20 21:12:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.879ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-30'

2025/06/20 21:12:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[126.727ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-30','2025-05-30','2025-05-30',0,0,0,0,'2025-06-20 21:12:05.709','2025-06-20 21:12:05.709')

2025/06/20 21:12:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.041ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-29'

2025/06/20 21:12:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[61.759ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-29'

2025/06/20 21:12:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[126.510ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-29','2025-05-29','2025-05-29',0,0,0,0,'2025-06-20 21:12:05.96','2025-06-20 21:12:05.96')

2025/06/20 21:12:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.813ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-28'

2025/06/20 21:12:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.297ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-28'

2025/06/20 21:12:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[127.101ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-28','2025-05-28','2025-05-28',0,0,0,0,'2025-06-20 21:12:06.212','2025-06-20 21:12:06.212')

2025/06/20 21:12:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.364ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-27'

2025/06/20 21:12:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[63.064ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-27'

2025/06/20 21:12:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[127.502ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-27','2025-05-27','2025-05-27',0,0,0,0,'2025-06-20 21:12:06.466','2025-06-20 21:12:06.466')

2025/06/20 21:12:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[61.768ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-26'

2025/06/20 21:12:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.760ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-26'

2025/06/20 21:12:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[127.069ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-26','2025-05-26','2025-05-26',0,0,0,0,'2025-06-20 21:12:06.718','2025-06-20 21:12:06.718')

2025/06/20 21:12:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[62.123ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-25'

2025/06/20 21:12:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.313ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-25'

2025/06/20 21:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[127.849ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-25','2025-05-25','2025-05-25',0,0,0,0,'2025-06-20 21:12:06.971','2025-06-20 21:12:06.971')

2025/06/20 21:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[61.975ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-24'

2025/06/20 21:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.658ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-24'

2025/06/20 21:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[126.183ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-24','2025-05-24','2025-05-24',0,0,0,0,'2025-06-20 21:12:07.224','2025-06-20 21:12:07.224')

2025/06/20 21:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[61.401ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-23'

2025/06/20 21:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[63.344ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-23'

2025/06/20 21:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[126.904ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-23','2025-05-23','2025-05-23',0,0,0,0,'2025-06-20 21:12:07.477','2025-06-20 21:12:07.477')

2025/06/20 21:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:96
[63.241ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND stat_date = '2025-05-22'

2025/06/20 21:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:119
[62.766ms] [rows:1] SELECT 
			COUNT(*) as total_orders,
			SUM(CASE WHEN status = 'paid' THEN 1 ELSE 0 END) as paid_orders,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as total_revenue,
			SUM(CASE WHEN status = 'paid' THEN amount ELSE 0 END) as actual_revenue
		 FROM `order` WHERE tenants_id = 1 AND DATE(create_time) = '2025-05-22'

2025/06/20 21:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:139
[126.670ms] [rows:1] INSERT INTO `merchant_revenue_stats` (`tenants_id`,`stat_date`,`period_start`,`period_end`,`total_orders`,`total_revenue`,`actual_revenue`,`paid_orders`,`create_time`,`update_time`) VALUES (1,'2025-05-22','2025-05-22','2025-05-22',0,0,0,0,'2025-06-20 21:12:07.73','2025-06-20 21:12:07.73')

2025/06/20 21:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:46
[61.975ms] [rows:1] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1

2025/06/20 21:12:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:46
[62.979ms] [rows:10] SELECT * FROM `merchant_revenue_stats` WHERE tenants_id = 1 ORDER BY stat_date DESC LIMIT 10

2025/06/20 21:12:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.997ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:12:36.497'

2025/06/20 21:12:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.527ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:12:36.497'

2025/06/20 21:12:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.734ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:12:36.497'

2025/06/20 21:12:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.161ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:42:36.86'

2025/06/20 21:12:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.830ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:12:36.924' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.663ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.397ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.219ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:42:37.038'

2025/06/20 21:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.831ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:12:37.05' AND status != 'pending'
	

2025/06/20 21:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.386ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:12:37.096' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.261ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:12:37.113' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.683ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.750ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.867ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:12:37.177'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.535ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:12:37.212' AND status != 'pending'
	

2025/06/20 21:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.377ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:12:37.268' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.684ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:12:37.325'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:13:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[57.975ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:13:36.497'

2025/06/20 21:13:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.715ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:58:36.499' LIMIT 50

2025/06/20 21:13:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.570ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:13:36.497'

2025/06/20 21:13:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.673ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:13:36.497'

2025/06/20 21:13:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[183.507ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:58:36.528' LIMIT 50

2025/06/20 21:13:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.526ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:43:36.86'

2025/06/20 21:13:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.718ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:13:36.92' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.486ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.593ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.758ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:43:37.039'

2025/06/20 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.690ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:13:37.04' AND status != 'pending'
	

2025/06/20 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.335ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:13:37.096' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.131ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:13:37.1' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.705ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.622ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.831ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:13:37.159'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.813ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:13:37.211' AND status != 'pending'
	

2025/06/20 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.119ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:13:37.268' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:13:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.123ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:13:37.335'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:14:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[109.950ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:14:36.498'

2025/06/20 21:14:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.658ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:14:36.498'

2025/06/20 21:14:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.561ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:14:36.498'

2025/06/20 21:14:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.027ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:44:36.86'

2025/06/20 21:14:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.967ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:14:36.918' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.783ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.737ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.987ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:14:37.033' AND status != 'pending'
	

2025/06/20 21:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.652ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:44:37.038'

2025/06/20 21:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.062ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:14:37.091' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.808ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:14:37.096' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.544ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.374ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:14:37.148'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.338ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.948ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:14:37.214' AND status != 'pending'
	

2025/06/20 21:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.097ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:14:37.273' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:14:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.215ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:14:37.333'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:15:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.318ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:00:36.5' LIMIT 50

2025/06/20 21:15:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.673ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:15:36.498'

2025/06/20 21:15:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.591ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:00:36.528' LIMIT 50

2025/06/20 21:15:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.118ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:15:36.498'

2025/06/20 21:15:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.606ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:15:36.498'

2025/06/20 21:15:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.201ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:45:36.861'

2025/06/20 21:15:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.783ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:15:36.921' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.642ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.508ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.313ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:15:37.041' AND status != 'pending'
	

2025/06/20 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.589ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:45:37.04'

2025/06/20 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.007ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:15:37.102' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.903ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:15:37.102' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.395ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.188ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:15:37.162'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.269ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.771ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:15:37.229' AND status != 'pending'
	

2025/06/20 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.810ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:15:37.291' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:15:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.664ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:15:37.354'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[72.050ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:46:38.235'

2025/06/20 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.983ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:16:38.308' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.222ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.878ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[192.789ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:46:38.247'

2025/06/20 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.724ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:16:38.439' AND status != 'pending'
	

2025/06/20 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.686ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:16:38.44' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.523ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.402ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:16:38.502' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.809ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.208ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:16:38.565' AND status != 'pending'
	

2025/06/20 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.948ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:16:38.565'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.824ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:16:38.631' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:16:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.153ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:16:38.694'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.435ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:17:38.235'

2025/06/20 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.304ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:17:38.235'

2025/06/20 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.236ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:17:38.235'

2025/06/20 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.674ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:47:38.632'

2025/06/20 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.523ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:17:38.694' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.887ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.320ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.853ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:47:38.757'

2025/06/20 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.522ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:17:38.82' AND status != 'pending'
	

2025/06/20 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.345ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:17:38.82' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.271ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.418ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:17:38.882' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:17:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.083ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:17:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.621ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:17:38.946'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:17:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.894ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:17:38.946' AND status != 'pending'
	

2025/06/20 21:17:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.182ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:17:39.009' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:17:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.314ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:17:39.072'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:18:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[63.535ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/20 21:18:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[31.606ms] [rows:18] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/20 21:18:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[31.532ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:18:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.273ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:18:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.304ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:18:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.972ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:18:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.278ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:18:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.581ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:18:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.627ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:18:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.510ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:18:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.653ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:18:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.229ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:18:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.733ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:18:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.768ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:18:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.821ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:18:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:81
[65.603ms] [rows:10] SELECT SQL_CALC_FOUND_ROWS * FROM `merchant_revenue_stats` WHERE tenants_id = 1 ORDER BY stat_date DESC LIMIT 10

2025/06/20 21:18:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:88
[42.473ms] [rows:1] SELECT FOUND_ROWS()

2025/06/20 21:18:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[35.835ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:18:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.934ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:18:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.159ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:18:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.528ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:18:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.594ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:18:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.841ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:18:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.893ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:18:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.461ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:18:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.017ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:18:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.562ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:18:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.831ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:18:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.069ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:18:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.294ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.676ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:03:38.235' LIMIT 50

2025/06/20 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.756ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:18:38.234'

2025/06/20 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.028ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:18:38.234'

2025/06/20 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.292ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:18:38.234'

2025/06/20 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[184.962ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:03:38.248' LIMIT 50

2025/06/20 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.213ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:48:38.632'

2025/06/20 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.793ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:18:38.692' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.774ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.748ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.542ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:48:38.757'

2025/06/20 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.752ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:18:38.812' AND status != 'pending'
	

2025/06/20 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.395ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:18:38.819' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.505ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.021ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:18:38.872' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.415ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:18:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.592ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:18:38.935'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:18:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.996ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:18:38.945' AND status != 'pending'
	

2025/06/20 21:18:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.391ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:18:39.008' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:18:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.493ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:18:39.071'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.914ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:19:38.235'

2025/06/20 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.395ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:19:38.235'

2025/06/20 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.727ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:19:38.235'

2025/06/20 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.305ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:49:38.633'

2025/06/20 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.472ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:19:38.696' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.626ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.103ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:49:38.758'

2025/06/20 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.120ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.186ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:19:38.818' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.367ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:19:38.826' AND status != 'pending'
	

2025/06/20 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.908ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.887ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.983ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:19:38.89' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:19:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.827ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:19:38.937' AND status != 'pending'
	

2025/06/20 21:19:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.766ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:19:38.953'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:19:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.781ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:19:38.998' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:19:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.864ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:19:39.058'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:20:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.896ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:50:36.899'

2025/06/20 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.936ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:20:36.968' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.308ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[174.919ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:50:36.912'

2025/06/20 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.182ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[55.680ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:20:37.087' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.243ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:20:37.095' AND status != 'pending'
	

2025/06/20 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.608ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.426ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.168ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:20:37.159' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.501ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:20:37.198' AND status != 'pending'
	

2025/06/20 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.730ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:20:37.224'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[55.823ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:20:37.255' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:20:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[55.669ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:20:37.311'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:21:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[69.689ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:51:25.802'

2025/06/20 21:21:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[73.006ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:21:25.872' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:21:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.545ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:21:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[192.075ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:51:25.815'

2025/06/20 21:21:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.718ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:21:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.906ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:21:26.008' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:21:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.720ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:21:26.01' AND status != 'pending'
	

2025/06/20 21:21:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.069ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:21:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.303ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:21:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.441ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:21:26.075' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:21:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.221ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:21:26.129' AND status != 'pending'
	

2025/06/20 21:21:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.635ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:21:26.139'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:21:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.787ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:21:26.189' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:21:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.615ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:21:26.25'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:21:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[31.556ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:21:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.670ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:21:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.714ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:21:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.737ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:21:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.343ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:21:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.893ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:21:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.443ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:21:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.471ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:21:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.076ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:21:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.774ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:21:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.174ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:21:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.800ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:21:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.807ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:21:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:80 Error 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FORCE INDEX(idx_merchant_revenue_tenant_date)' at line 1
[34.033ms] [rows:0] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND FORCE INDEX(idx_merchant_revenue_tenant_date)

2025/06/20 21:22:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:80 Error 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FORCE INDEX(idx_merchant_revenue_tenant_date)' at line 1
[34.955ms] [rows:0] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND FORCE INDEX(idx_merchant_revenue_tenant_date)

2025/06/20 21:22:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.442ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:22:25.801'

2025/06/20 21:22:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.290ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:22:25.801'

2025/06/20 21:22:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.283ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:22:25.801'

2025/06/20 21:22:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.679ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:52:26.204'

2025/06/20 21:22:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.654ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:22:26.266' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:22:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.061ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:22:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.858ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:52:26.312'

2025/06/20 21:22:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.796ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:22:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.238ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:22:26.377' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:22:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.143ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:22:26.387' AND status != 'pending'
	

2025/06/20 21:22:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.873ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:22:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.125ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:22:26.448' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:22:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.142ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:22:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.450ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:22:26.508'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:22:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.375ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:22:26.508' AND status != 'pending'
	

2025/06/20 21:22:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.712ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:22:26.572' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:22:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.241ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:22:26.637'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:22:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[69.070ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:52:33.777'

2025/06/20 21:22:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.463ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:22:33.847' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:22:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.403ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:22:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.567ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:22:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[195.027ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:52:33.791'

2025/06/20 21:22:34 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.178ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:22:33.966' AND status != 'pending'
	

2025/06/20 21:22:34 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.705ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:22:33.986' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:22:34 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.507ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:22:34 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.861ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:22:34.025' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:22:34 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.736ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:22:34 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.966ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:22:34.084'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:22:34 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.039ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:22:34.114' AND status != 'pending'
	

2025/06/20 21:22:34 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.005ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:22:34.177' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:22:34 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.975ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:22:34.24'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:22:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.664ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:52:46.369'

2025/06/20 21:22:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.167ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:22:46.434' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:22:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.548ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:22:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.875ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:22:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[193.050ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:52:46.38'

2025/06/20 21:22:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.489ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:22:46.558' AND status != 'pending'
	

2025/06/20 21:22:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.015ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:22:46.573' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:22:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.459ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:22:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.332ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:22:46.621' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:22:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.688ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:22:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.895ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:22:46.683'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:22:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.735ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:22:46.7' AND status != 'pending'
	

2025/06/20 21:22:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.123ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:22:46.764' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:22:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.036ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:22:46.827'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:22:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.516ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:52:58.653'

2025/06/20 21:22:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.511ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:22:58.72' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:22:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.139ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:22:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.750ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:22:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[191.593ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:52:58.669'

2025/06/20 21:22:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.180ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:22:58.848' AND status != 'pending'
	

2025/06/20 21:22:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.809ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:22:58.862' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:22:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.893ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:22:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.388ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:22:58.913' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:22:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.078ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:22:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.381ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:22:58.978'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:22:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.467ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:22:58.986' AND status != 'pending'
	

2025/06/20 21:22:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.709ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:22:59.047' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:22:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.281ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:22:59.109'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[35.097ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.736ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.963ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.546ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.582ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.327ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.841ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.454ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.845ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.720ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.787ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.384ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:23:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.425ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:23:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:80 Error 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FORCE INDEX(idx_merchant_revenue_tenant_date)' at line 1
[31.449ms] [rows:0] SELECT count(*) FROM `merchant_revenue_stats` WHERE tenants_id = 1 AND FORCE INDEX(idx_merchant_revenue_tenant_date)

2025/06/20 21:24:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[69.291ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:54:16.927'

2025/06/20 21:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.152ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:24:16.996' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.901ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.912ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[191.043ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:54:16.938'

2025/06/20 21:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.631ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:24:17.129' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.710ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:24:17.126' AND status != 'pending'
	

2025/06/20 21:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.101ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.075ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.176ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:24:17.191' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.786ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:24:17.253' AND status != 'pending'
	

2025/06/20 21:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.110ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:24:17.258'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.911ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:24:17.316' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.136ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:24:17.378'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:24:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[73.312ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:54:31.325'

2025/06/20 21:24:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.279ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:24:31.399' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:24:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.417ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:24:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.636ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:24:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[192.681ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:54:31.344'

2025/06/20 21:24:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.795ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:24:31.527' AND status != 'pending'
	

2025/06/20 21:24:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.022ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:24:31.538' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:24:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.992ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:24:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.859ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:24:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.901ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:24:31.595' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:24:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.800ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:24:31.671'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:24:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.274ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:24:31.669' AND status != 'pending'
	

2025/06/20 21:24:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.780ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:24:31.731' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:24:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.056ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:24:31.795'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:24:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[68.010ms] [rows:0] SELECT * FROM `user` WHERE (username = 'admin' OR phone = 'admin') AND password = 'dd2388844dec290834afa2dcb257fb85' ORDER BY `user`.`id` LIMIT 1

2025/06/20 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[64.052ms] [rows:1] SELECT * FROM `user` WHERE (username = 'admin' OR phone = 'admin') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/20 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:481
[62.641ms] [rows:9] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 4

2025/06/20 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:493 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[31.238ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,3,4,5,6,7,8,23)

2025/06/20 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[31.625ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[75.247ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.271ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:24:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.115ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:24:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.841ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:24:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.288ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:24:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.114ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:24:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.812ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:24:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.106ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:24:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.450ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:24:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.834ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:24:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.402ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:24:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.463ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:24:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:79 Error 1146 (42S02): Table 'naive_admin.revenues' doesn't exist
[32.088ms] [rows:0] SELECT count(*) FROM revenues FORCE INDEX (idx_merchant_revenue_tenant_date) WHERE tenants_id = 1

2025/06/20 21:25:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[70.906ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:55:28.045'

2025/06/20 21:25:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.617ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:25:28.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:25:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.075ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:25:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.362ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:25:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[181.549ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:55:28.061'

2025/06/20 21:25:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.038ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:25:28.24' AND status != 'pending'
	

2025/06/20 21:25:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.843ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:25:28.244' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:25:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.670ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:25:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.200ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:25:28.301' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:25:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.067ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:25:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.323ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:25:28.363' AND status != 'pending'
	

2025/06/20 21:25:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.105ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:25:28.362'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:25:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.349ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:25:28.421' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:25:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.963ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:25:28.481'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:25:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[70.481ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:55:31.022'

2025/06/20 21:25:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.784ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:25:31.093' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:25:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.134ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:25:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[194.226ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:55:31.031'

2025/06/20 21:25:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.792ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:25:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.462ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:25:31.226' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:25:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.615ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:25:31.226' AND status != 'pending'
	

2025/06/20 21:25:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.690ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:25:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.880ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:25:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.064ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:25:31.293' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:25:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.862ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:25:31.354' AND status != 'pending'
	

2025/06/20 21:25:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.683ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:25:31.358'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:25:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.014ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:25:31.418' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:25:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.201ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:25:31.481'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:25:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[31.966ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:25:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.174ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:25:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.316ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:25:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.567ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:25:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.584ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:25:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.562ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:25:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.744ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:25:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.880ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:25:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.648ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:25:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.523ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:25:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.651ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:25:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.526ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:25:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.047ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:25:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:79 Error 1146 (42S02): Table 'naive_admin.merchant_revenues' doesn't exist
[31.536ms] [rows:0] SELECT count(*) FROM merchant_revenues FORCE INDEX (idx_merchant_revenue_tenant_date) WHERE tenants_id = 1

2025/06/20 21:26:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.923ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:56:09.82'

2025/06/20 21:26:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.284ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:26:09.896' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:26:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.664ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:26:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[190.944ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:56:09.834'

2025/06/20 21:26:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.610ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:26:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.333ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:26:10.025' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:26:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.451ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:26:10.027' AND status != 'pending'
	

2025/06/20 21:26:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.262ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:26:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.537ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:26:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.737ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:26:10.094' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:26:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.541ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:26:10.148' AND status != 'pending'
	

2025/06/20 21:26:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.333ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:26:10.16'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:26:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.947ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:26:10.208' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:26:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.708ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:26:10.27'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:26:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.417ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:56:13.083'

2025/06/20 21:26:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.796ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:26:13.149' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:26:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.103ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:26:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.784ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:26:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[184.433ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:56:13.102'

2025/06/20 21:26:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.343ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:26:13.275' AND status != 'pending'
	

2025/06/20 21:26:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.598ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:26:13.286' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:26:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.273ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:26:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.678ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:26:13.338' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:26:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.222ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:26:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.131ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:26:13.4'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:26:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.367ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:26:13.405' AND status != 'pending'
	

2025/06/20 21:26:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.294ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:26:13.463' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:26:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.476ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:26:13.526'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:26:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[30.735ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:26:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.763ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:26:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.811ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:26:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.353ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:26:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.944ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:26:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.980ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:26:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.280ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:26:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.939ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:26:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.019ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:26:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.714ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:26:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.275ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:26:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.872ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:26:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.896ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:26:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:79 Error 1176 (42000): Key 'idx_merchant_revenue_tenant_date' doesn't exist in table 'merchant_revenue_stats'
[33.700ms] [rows:0] SELECT count(*) FROM merchant_revenue_stats FORCE INDEX (idx_merchant_revenue_tenant_date) WHERE tenants_id = 1

2025/06/20 21:26:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.205ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:56:52.085'

2025/06/20 21:26:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.295ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:26:52.149' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:26:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.304ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:26:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.310ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:26:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[199.029ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:56:52.095'

2025/06/20 21:26:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.771ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:26:52.264' AND status != 'pending'
	

2025/06/20 21:26:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.554ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:26:52.294' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:26:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.945ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:26:52.323' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:26:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.205ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:26:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.062ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:26:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.227ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:26:52.382'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:26:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[73.892ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:26:52.428' AND status != 'pending'
	

2025/06/20 21:26:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.769ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:26:52.502' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:26:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.499ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:26:52.567'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:26:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[70.919ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:56:55.961'

2025/06/20 21:26:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.094ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:26:56.032' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:26:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.929ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:26:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[190.958ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:56:55.971'

2025/06/20 21:26:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.053ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:26:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.258ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:26:56.162' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:26:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.917ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:26:56.162' AND status != 'pending'
	

2025/06/20 21:26:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.082ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:26:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.835ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:26:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.076ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:26:56.226' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:26:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.634ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:26:56.287' AND status != 'pending'
	

2025/06/20 21:26:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.177ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:26:56.291'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:26:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.769ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:26:56.35' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:26:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.441ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:26:56.413'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[31.424ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.860ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.074ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:27:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.653ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:27:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.163ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:27:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.569ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:27:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.910ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:27:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.397ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:27:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.873ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:27:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.816ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:27:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.834ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:27:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.731ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:27:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.852ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:27:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:79 Error 1176 (42000): Key 'idx_revenue_tenants_date' doesn't exist in table 'merchant_revenue_stats'
[31.364ms] [rows:0] SELECT count(*) FROM merchant_revenue_stats FORCE INDEX (idx_revenue_tenants_date) WHERE tenants_id = 1

2025/06/20 21:27:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.515ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:27:55.953'

2025/06/20 21:27:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.842ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:27:55.953'

2025/06/20 21:27:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.732ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:27:55.953'

2025/06/20 21:27:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.034ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:57:56.357'

2025/06/20 21:27:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.554ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:27:56.421' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:27:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.871ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:27:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.156ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:57:56.477'

2025/06/20 21:27:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.909ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:27:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.112ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:27:56.542' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:27:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.189ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:27:56.551' AND status != 'pending'
	

2025/06/20 21:27:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.959ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:27:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.431ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:27:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.837ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:27:56.614' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:27:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.730ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:27:56.672' AND status != 'pending'
	

2025/06/20 21:27:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.689ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:27:56.676'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:27:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.270ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:27:56.737' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:27:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.884ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:27:56.802'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:28:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[70.570ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:58:16.159'

2025/06/20 21:28:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.428ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:28:16.231' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:28:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[35.743ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:28:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[178.356ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:58:16.173'

2025/06/20 21:28:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.082ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:28:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.086ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:28:16.352' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:28:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.650ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:28:16.363' AND status != 'pending'
	

2025/06/20 21:28:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.938ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:28:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.061ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:28:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.129ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:28:16.426' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:28:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.181ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:28:16.47' AND status != 'pending'
	

2025/06/20 21:28:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.497ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:28:16.489'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:28:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.380ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:28:16.528' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:28:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.429ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:28:16.586'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:28:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[32.912ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:28:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.978ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:28:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.299ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:28:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.753ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:28:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.013ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:28:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.357ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:28:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.569ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:28:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.746ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:28:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.495ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:28:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.133ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:28:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.033ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:28:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.936ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:28:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.114ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:28:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:79
[58.903ms] [rows:1] SELECT count(*) FROM merchant_revenue_stats FORCE INDEX (idx_stat_date) WHERE tenants_id = 1

2025/06/20 21:28:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:82
[57.544ms] [rows:10] SELECT id, tenants_id, stat_date, total_orders, total_revenue, actual_revenue, paid_orders FROM merchant_revenue_stats FORCE INDEX (idx_stat_date) WHERE tenants_id = 1 ORDER BY stat_date DESC LIMIT 10 OFFSET 10

2025/06/20 21:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:79
[57.284ms] [rows:1] SELECT count(*) FROM merchant_revenue_stats FORCE INDEX (idx_stat_date) WHERE tenants_id = 1

2025/06/20 21:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:82
[58.431ms] [rows:10] SELECT id, tenants_id, stat_date, total_orders, total_revenue, actual_revenue, paid_orders FROM merchant_revenue_stats FORCE INDEX (idx_stat_date) WHERE tenants_id = 1 ORDER BY stat_date DESC LIMIT 10 OFFSET 20

2025/06/20 21:28:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[60.174ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 8 ORDER BY `user`.`user_type` LIMIT 1

2025/06/20 21:28:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:88
[57.560ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/20 21:28:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:104
[58.415ms] [rows:10] SELECT * FROM `permission_user` WHERE id IN (1,2,10,11,12,13,14,15,22,23) ORDER BY sort DESC

2025/06/20 21:28:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[28.472ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:28:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.714ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:28:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.787ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:28:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.637ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:28:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.773ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:28:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.198ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:28:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.297ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:28:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.994ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:28:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.656ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:28:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.689ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:28:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.703ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:28:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.062ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:28:44 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.961ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:28:44 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:79
[57.853ms] [rows:1] SELECT count(*) FROM merchant_revenue_stats FORCE INDEX (idx_stat_date) WHERE tenants_id = 8

2025/06/20 21:28:44 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:82
[58.290ms] [rows:0] SELECT id, tenants_id, stat_date, total_orders, total_revenue, actual_revenue, paid_orders FROM merchant_revenue_stats FORCE INDEX (idx_stat_date) WHERE tenants_id = 8 ORDER BY stat_date DESC LIMIT 10

2025/06/20 21:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[29.635ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.120ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.900ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.304ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.014ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.139ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.807ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.933ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.234ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.189ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.227ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.491ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.376ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:29:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[32.950ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:29:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.342ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:29:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.335ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:29:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.439ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:29:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.619ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:29:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.659ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:29:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.886ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:29:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.532ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:29:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.642ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:29:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.981ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:29:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.614ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:29:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.270ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:29:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.855ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:29:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:64
[57.857ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 8

2025/06/20 21:29:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:64
[58.033ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 8 ORDER BY create_time DESC LIMIT 10

2025/06/20 21:29:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.676ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:29:16.157'

2025/06/20 21:29:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.425ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:29:16.157'

2025/06/20 21:29:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.373ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:29:16.157'

2025/06/20 21:29:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.411ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:59:16.552'

2025/06/20 21:29:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.274ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:29:16.611' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:29:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.254ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:29:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.960ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 20:59:16.646'

2025/06/20 21:29:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.357ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:29:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.589ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:29:16.708' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:29:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.306ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:29:16.729' AND status != 'pending'
	

2025/06/20 21:29:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.709ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:29:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.522ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:29:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.806ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:29:16.787' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:29:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.197ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:29:16.834' AND status != 'pending'
	

2025/06/20 21:29:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.646ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:29:16.845'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:29:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.655ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:29:16.898' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:29:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.260ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:29:16.96'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:29:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[65.772ms] [rows:1] SELECT * FROM `user` WHERE (username = '16620436582' OR phone = '16620436582') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/20 21:29:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:481
[67.071ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/20 21:29:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:493 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[48.962ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,10,11,12,13,14,15,22,23)

2025/06/20 21:29:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[74.203ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:29:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.023ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:29:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.185ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:29:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.251ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:29:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.934ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:29:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.750ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:29:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.697ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:29:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.197ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:29:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.597ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:29:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.877ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:29:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.502ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:29:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.275ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:29:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.938ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:30:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[63.801ms] [rows:1] SELECT * FROM `user` WHERE (username = '16620436582' OR phone = '16620436582') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/20 21:30:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:481
[62.701ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/20 21:30:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:493 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[31.481ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,10,11,12,13,14,15,22,23)

2025/06/20 21:30:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[31.484ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:30:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.670ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:30:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.064ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:30:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.641ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:30:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.865ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:30:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.248ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:30:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.173ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:30:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.028ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:30:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.569ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:30:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.393ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:30:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.162ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:30:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.994ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:30:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.947ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[57.663ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:30:16.157'

2025/06/20 21:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.801ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:15:16.157' LIMIT 50

2025/06/20 21:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.967ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:30:16.157'

2025/06/20 21:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.577ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:30:16.157'

2025/06/20 21:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[188.675ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:15:16.175' LIMIT 50

2025/06/20 21:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.611ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:00:16.553'

2025/06/20 21:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.861ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:30:16.616' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.390ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:00:16.646'

2025/06/20 21:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.539ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.509ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.916ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:30:16.705' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.960ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.617ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:30:16.738' AND status != 'pending'
	

2025/06/20 21:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.873ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.549ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:30:16.799' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.843ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:30:16.822' AND status != 'pending'
	

2025/06/20 21:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.892ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:30:16.861'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.899ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:30:16.881' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.671ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:30:16.939'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:30:25 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[29.107ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:30:25 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.749ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:30:25 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.818ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:30:25 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.842ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:30:25 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.548ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:30:25 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.808ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:30:25 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.801ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:30:25 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.937ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:30:25 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.541ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:30:25 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.344ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:30:25 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.393ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:30:25 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.446ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:30:26 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.755ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:31:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.900ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:31:16.157'

2025/06/20 21:31:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.223ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:31:16.157'

2025/06/20 21:31:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.889ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:31:16.157'

2025/06/20 21:31:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.267ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:01:16.553'

2025/06/20 21:31:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.645ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:31:16.613' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:31:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.870ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:31:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.396ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:01:16.646'

2025/06/20 21:31:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.081ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:31:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.173ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:31:16.707' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:31:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.922ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:31:16.73' AND status != 'pending'
	

2025/06/20 21:31:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.022ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:31:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.430ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:31:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.736ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:31:16.788' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:31:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.031ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:31:16.829' AND status != 'pending'
	

2025/06/20 21:31:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.837ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:31:16.847'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:31:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.559ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:31:16.89' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:31:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.256ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:31:16.951'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:31:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[72.052ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:01:49.904'

2025/06/20 21:31:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.693ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:31:49.976' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:31:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.086ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:31:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.628ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:31:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[187.073ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:01:49.921'

2025/06/20 21:31:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.228ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:31:50.109' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:31:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.537ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:31:50.106' AND status != 'pending'
	

2025/06/20 21:31:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.668ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:31:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.603ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:31:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.882ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:31:50.171' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:31:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.584ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:31:50.229' AND status != 'pending'
	

2025/06/20 21:31:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.988ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:31:50.237'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:31:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.236ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:31:50.288' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:31:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.459ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:31:50.349'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:31:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[41.752ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:31:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.556ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:31:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.758ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:31:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.341ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:31:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.220ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:31:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.407ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:31:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.931ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:31:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.284ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:31:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.633ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:31:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.900ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:31:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.465ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:31:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.604ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:31:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.857ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:32:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.030ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:02:40.09'

2025/06/20 21:32:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.628ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:32:40.158' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:32:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.217ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:32:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.572ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:32:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[199.482ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:02:40.108'

2025/06/20 21:32:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.287ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:32:40.288' AND status != 'pending'
	

2025/06/20 21:32:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.889ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:32:40.307' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[69.574ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:02:42.167'

2025/06/20 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.160ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:32:42.237' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.505ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.913ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[215.517ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:02:42.181'

2025/06/20 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.493ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:32:42.361' AND status != 'pending'
	

2025/06/20 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.610ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:32:42.396' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.240ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:32:42.425' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.617ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.639ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.448ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:32:42.487'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[71.882ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:32:42.53' AND status != 'pending'
	

2025/06/20 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[68.175ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:32:42.602' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:32:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.637ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:32:42.67'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:32:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[34.135ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:32:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.202ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:32:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.916ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:32:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.029ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:32:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.167ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:32:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[68.179ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:32:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.702ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:32:47 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.527ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:32:47 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.895ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:32:47 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.671ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:32:47 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.527ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:32:47 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.324ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:32:47 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[74.612ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:33:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[33.476ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:33:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.741ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:33:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.266ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:33:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.734ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:33:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.842ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:33:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.409ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:33:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.778ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:33:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.845ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:33:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.081ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:33:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.325ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:33:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.915ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:33:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.846ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:33:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.423ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.908ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:03:37.145'

2025/06/20 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.775ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:33:37.207' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.564ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[39.327ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[216.470ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:03:37.156'

2025/06/20 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.787ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:33:37.341' AND status != 'pending'
	

2025/06/20 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.495ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:33:37.373' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.717ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:33:37.402' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.550ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.101ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.238ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:33:37.464'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.696ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:33:37.5' AND status != 'pending'
	

2025/06/20 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.628ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:33:37.564' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:33:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.244ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:33:37.628'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[32.638ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.813ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.116ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.569ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.909ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.122ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.615ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.757ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.253ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:33:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.132ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:33:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.607ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:33:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.541ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:33:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.754ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:33:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[65.020ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/20 21:33:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:208
[64.385ms] [rows:1] SELECT count(*) FROM `user` WHERE parent_id = 8

2025/06/20 21:33:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:216
[63.562ms] [rows:1] SELECT * FROM `user` WHERE parent_id = 8 LIMIT 10

2025/06/20 21:33:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:38
[32.015ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/20 21:33:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:44
[63.911ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/20 21:34:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:64
[64.357ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 8

2025/06/20 21:34:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:64
[63.432ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 8 ORDER BY create_time DESC LIMIT 10

2025/06/20 21:34:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:98
[64.084ms] [rows:1] SELECT count(*) FROM `order` WHERE tenants_id = 8

2025/06/20 21:34:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:116
[64.188ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` WHERE tenants_id = 8 ORDER BY create_time DESC LIMIT 10

2025/06/20 21:34:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods_optimized.go:127
[63.279ms] [rows:1] SELECT id, goods_name, content, price, stock, cover, status, category_id, create_time, update_time FROM `goods_list` WHERE id IN (1) AND isdelete != 1

2025/06/20 21:34:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:165
[65.554ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (6,108,109,116)

2025/06/20 21:34:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:98
[61.067ms] [rows:1] SELECT count(*) FROM `order` WHERE tenants_id = 8

2025/06/20 21:34:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:116
[61.830ms] [rows:8] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` WHERE tenants_id = 8 ORDER BY create_time DESC LIMIT 10 OFFSET 10

2025/06/20 21:34:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:165
[61.955ms] [rows:8] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (137,6,120,126,129,130,131,132)

2025/06/20 21:34:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:98
[61.684ms] [rows:1] SELECT count(*) FROM `order` WHERE tenants_id = 8

2025/06/20 21:34:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:116
[62.308ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` WHERE tenants_id = 8 ORDER BY create_time DESC LIMIT 10

2025/06/20 21:34:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:165
[62.900ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (109,116,6,108)

2025/06/20 21:34:22 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[63.360ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/20 21:34:22 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:208
[61.562ms] [rows:1] SELECT count(*) FROM `user` WHERE parent_id = 8

2025/06/20 21:34:22 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:216
[61.655ms] [rows:1] SELECT * FROM `user` WHERE parent_id = 8 LIMIT 10

2025/06/20 21:34:25 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:38
[30.855ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/20 21:34:25 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:44
[61.391ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/20 21:34:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:64
[62.478ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 8

2025/06/20 21:34:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:64
[62.572ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 8 ORDER BY create_time DESC LIMIT 10

2025/06/20 21:34:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:98
[61.367ms] [rows:1] SELECT count(*) FROM `order` WHERE tenants_id = 8

2025/06/20 21:34:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:116
[62.599ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` WHERE tenants_id = 8 ORDER BY create_time DESC LIMIT 10

2025/06/20 21:34:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:165
[60.652ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (108,109,116,6)

2025/06/20 21:34:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:98
[61.318ms] [rows:1] SELECT count(*) FROM `order` WHERE tenants_id = 8

2025/06/20 21:34:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:116
[62.159ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` WHERE tenants_id = 8 ORDER BY create_time DESC LIMIT 10

2025/06/20 21:34:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:165
[62.779ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (6,108,109,116)

2025/06/20 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.550ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:34:37.143'

2025/06/20 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.704ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:34:37.143'

2025/06/20 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.835ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:34:37.143'

2025/06/20 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.182ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:04:37.525'

2025/06/20 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.626ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:34:37.588' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.959ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.756ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.145ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:04:37.694'

2025/06/20 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.021ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:34:37.712' AND status != 'pending'
	

2025/06/20 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.935ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:34:37.757' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.889ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:34:37.774' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.816ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.639ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.968ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:34:37.836'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:34:37 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.999ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:34:37.885' AND status != 'pending'
	

2025/06/20 21:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.344ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:34:37.949' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:34:38 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.942ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:34:38.014'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:34:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:64
[64.019ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 8

2025/06/20 21:34:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:64
[62.459ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 8 ORDER BY create_time DESC LIMIT 10

2025/06/20 21:35:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.883ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:05:11.789'

2025/06/20 21:35:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.871ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:35:11.858' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:35:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.592ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:35:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.680ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:35:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[182.835ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:05:11.807'

2025/06/20 21:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.515ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:35:11.983' AND status != 'pending'
	

2025/06/20 21:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.343ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:35:11.99' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.713ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.670ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.079ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:35:12.046' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.203ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:35:12.106' AND status != 'pending'
	

2025/06/20 21:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.735ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:35:12.108'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.004ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:35:12.164' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.297ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:35:12.221'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:35:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[62.253ms] [rows:0] SELECT * FROM `user` WHERE (username = 'admin' OR phone = 'admin') AND password = 'dd2388844dec290834afa2dcb257fb85' ORDER BY `user`.`id` LIMIT 1

2025/06/20 21:35:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[60.503ms] [rows:1] SELECT * FROM `user` WHERE (username = 'admin' OR phone = 'admin') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/20 21:35:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:481
[56.106ms] [rows:9] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 4

2025/06/20 21:35:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:493 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[29.195ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,3,4,5,6,7,8,23)

2025/06/20 21:35:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[58.584ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/20 21:35:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[33.358ms] [rows:18] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/20 21:35:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[28.571ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:35:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.255ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:35:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.856ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:35:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.418ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:35:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.450ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:35:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.622ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:35:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.271ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:35:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.314ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:35:41 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[56.741ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:35:41 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[56.746ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:35:41 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.096ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:35:41 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.330ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:35:41 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.039ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:35:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[62.965ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/20 21:35:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[27.933ms] [rows:1] SELECT count(*) FROM `user`

2025/06/20 21:35:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[56.941ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/20 21:36:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[33.261ms] [rows:1] SELECT count(*) FROM `role`

2025/06/20 21:36:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[57.565ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/20 21:36:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:64
[61.845ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 1

2025/06/20 21:36:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:64
[58.576ms] [rows:1] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 1 ORDER BY create_time DESC LIMIT 10

2025/06/20 21:36:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.696ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:36:11.79'

2025/06/20 21:36:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.393ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:36:11.79'

2025/06/20 21:36:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.153ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:36:11.79'

2025/06/20 21:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.913ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:06:12.17'

2025/06/20 21:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.548ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:36:12.228' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.735ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.810ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:06:12.28'

2025/06/20 21:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.276ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.934ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:36:12.343' AND status != 'pending'
	

2025/06/20 21:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.094ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:36:12.342' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.889ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.237ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:36:12.402' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.836ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.997ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:36:12.459'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.863ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:36:12.464' AND status != 'pending'
	

2025/06/20 21:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.444ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:36:12.526' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.890ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:36:12.588'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:36:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:98
[30.694ms] [rows:1] SELECT count(*) FROM `order`

2025/06/20 21:36:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:116
[62.419ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` ORDER BY create_time DESC LIMIT 10

2025/06/20 21:36:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:165
[62.625ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (108,109,116,6)

2025/06/20 21:36:19 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:98
[30.887ms] [rows:1] SELECT count(*) FROM `order`

2025/06/20 21:36:19 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:116
[61.578ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` ORDER BY create_time DESC LIMIT 10

2025/06/20 21:36:19 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:165
[61.644ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (6,108,109,116)

2025/06/20 21:37:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:38
[31.650ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/20 21:37:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:44
[61.039ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/20 21:37:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[57.397ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:37:11.79'

2025/06/20 21:37:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.910ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:22:11.788' LIMIT 50

2025/06/20 21:37:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.777ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:37:11.79'

2025/06/20 21:37:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.897ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:37:11.79'

2025/06/20 21:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[191.575ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:22:11.808' LIMIT 50

2025/06/20 21:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.297ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:07:12.171'

2025/06/20 21:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.602ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:37:12.232' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.449ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.621ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:07:12.28'

2025/06/20 21:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.019ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.575ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:37:12.338' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.993ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:37:12.352' AND status != 'pending'
	

2025/06/20 21:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.516ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.962ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.521ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:37:12.412' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.775ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:37:12.454' AND status != 'pending'
	

2025/06/20 21:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.668ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:37:12.473'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.447ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:37:12.511' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.850ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:37:12.568'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:38:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.242ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:38:11.79'

2025/06/20 21:38:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.256ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:38:11.79'

2025/06/20 21:38:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.489ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:38:11.79'

2025/06/20 21:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.888ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:08:12.171'

2025/06/20 21:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.907ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:38:12.23' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.295ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.074ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:08:12.28'

2025/06/20 21:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.342ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.518ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:38:12.341' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.777ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:38:12.346' AND status != 'pending'
	

2025/06/20 21:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.563ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.506ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:38:12.404' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.817ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.211ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:38:12.461'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.370ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:38:12.463' AND status != 'pending'
	

2025/06/20 21:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.636ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:38:12.524' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.359ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:38:12.585'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:39:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.653ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:39:11.79'

2025/06/20 21:39:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.814ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:24:11.788' LIMIT 50

2025/06/20 21:39:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.821ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:24:11.809' LIMIT 50

2025/06/20 21:39:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.836ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:39:11.79'

2025/06/20 21:39:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.298ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:39:11.79'

2025/06/20 21:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.179ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:09:12.172'

2025/06/20 21:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.697ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:39:12.23' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.228ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.245ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:09:12.28'

2025/06/20 21:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.321ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.579ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:39:12.346' AND status != 'pending'
	

2025/06/20 21:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.282ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:39:12.343' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.675ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.917ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:39:12.403' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.818ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.767ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:39:12.46'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.653ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:39:12.465' AND status != 'pending'
	

2025/06/20 21:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.966ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:39:12.527' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.669ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:39:12.59'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:39:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[31.706ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 21:39:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.022ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 21:39:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.265ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 21:39:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.748ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 21:39:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.859ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 21:39:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.543ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 21:39:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.301ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 21:39:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.942ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 21:39:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.013ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 21:39:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.662ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 21:39:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.748ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 21:39:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.590ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 21:39:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.852ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 21:40:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:38
[31.249ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/20 21:40:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:44
[61.579ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/20 21:40:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.164ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:40:11.79'

2025/06/20 21:40:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.090ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:40:11.79'

2025/06/20 21:40:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.536ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:40:11.79'

2025/06/20 21:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.448ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:10:12.171'

2025/06/20 21:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.093ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:40:12.234' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.547ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.223ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:10:12.28'

2025/06/20 21:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.041ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.224ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:40:12.338' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.785ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:40:12.357' AND status != 'pending'
	

2025/06/20 21:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.151ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.341ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.548ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:40:12.419' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.825ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:40:12.452' AND status != 'pending'
	

2025/06/20 21:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.253ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:40:12.481'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.460ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:40:12.51' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.170ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:40:12.568'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:40:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:98
[28.437ms] [rows:1] SELECT count(*) FROM `order`

2025/06/20 21:40:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:116
[58.032ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` ORDER BY create_time DESC LIMIT 10

2025/06/20 21:40:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:165
[56.785ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (116,6,108,109)

2025/06/20 21:40:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:98
[30.137ms] [rows:1] SELECT count(*) FROM `order`

2025/06/20 21:40:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:116
[57.372ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` ORDER BY create_time DESC LIMIT 10

2025/06/20 21:40:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:165
[57.538ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (108,109,116,6)

2025/06/20 21:40:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:98
[33.088ms] [rows:1] SELECT count(*) FROM `order`

2025/06/20 21:40:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:116
[57.915ms] [rows:10] SELECT id, no, goods_id, amount, status, num, user_id, create_time, update_time, coupon_id FROM `order` ORDER BY create_time DESC LIMIT 10

2025/06/20 21:40:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/order.go:165
[57.322ms] [rows:4] SELECT id, username, avatar, phone FROM `app_user` WHERE id IN (6,108,109,116)

2025/06/20 21:40:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:38
[33.740ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/20 21:40:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:44
[58.342ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/20 21:41:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.773ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:26:11.789' LIMIT 50

2025/06/20 21:41:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.652ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:41:11.791'

2025/06/20 21:41:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.675ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:26:11.809' LIMIT 50

2025/06/20 21:41:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.178ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:41:11.791'

2025/06/20 21:41:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.101ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:41:11.791'

2025/06/20 21:41:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.975ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:11:12.172'

2025/06/20 21:41:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.126ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:41:12.235' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:41:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.648ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:41:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.292ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:11:12.281'

2025/06/20 21:41:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.062ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:41:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.544ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:41:12.341' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:41:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.894ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:41:12.36' AND status != 'pending'
	

2025/06/20 21:41:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.111ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:41:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.525ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:41:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.007ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:41:12.422' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:41:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.164ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:41:12.463' AND status != 'pending'
	

2025/06/20 21:41:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.616ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:41:12.484'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:41:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.419ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:41:12.523' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:41:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.720ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:41:12.584'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:42:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.210ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:42:11.791'

2025/06/20 21:42:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.087ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:42:11.791'

2025/06/20 21:42:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.782ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:42:11.791'

2025/06/20 21:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.122ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:12:12.172'

2025/06/20 21:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.345ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:42:12.234' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.763ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.797ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:12:12.28'

2025/06/20 21:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.729ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.570ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:42:12.342' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.005ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:42:12.354' AND status != 'pending'
	

2025/06/20 21:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.236ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.066ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.613ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:42:12.415' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.704ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:42:12.467' AND status != 'pending'
	

2025/06/20 21:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.686ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:42:12.474'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.454ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:42:12.529' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.340ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:42:12.592'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:43:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.796ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:28:11.789' LIMIT 50

2025/06/20 21:43:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.407ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:43:11.791'

2025/06/20 21:43:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[56.447ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:28:11.809' LIMIT 50

2025/06/20 21:43:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.798ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:43:11.791'

2025/06/20 21:43:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.369ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:43:11.791'

2025/06/20 21:43:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.422ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:13:12.172'

2025/06/20 21:43:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.887ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:43:12.231' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:43:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.896ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:43:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.547ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:13:12.281'

2025/06/20 21:43:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.616ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:43:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.258ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:43:12.338' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:43:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.021ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:43:12.351' AND status != 'pending'
	

2025/06/20 21:43:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.344ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:43:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.002ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:43:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.830ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:43:12.411' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:43:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.243ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:43:12.453' AND status != 'pending'
	

2025/06/20 21:43:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.718ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:43:12.472'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:43:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.510ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:43:12.511' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:43:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.702ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:43:12.568'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:44:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.515ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:44:11.757'

2025/06/20 21:44:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.880ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:44:11.757'

2025/06/20 21:44:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.286ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:44:11.757'

2025/06/20 21:44:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.396ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:14:12.138'

2025/06/20 21:44:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.961ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:44:12.198' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:44:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.014ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:44:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.972ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:14:12.247'

2025/06/20 21:44:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.419ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:44:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.500ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:44:12.308' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:44:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.202ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:44:12.312' AND status != 'pending'
	

2025/06/20 21:44:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.444ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:44:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.641ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:44:12.37' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:44:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.628ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:44:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.361ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:44:12.428'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:44:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.117ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:44:12.429' AND status != 'pending'
	

2025/06/20 21:44:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.687ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:44:12.489' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:44:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.854ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:44:12.55'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:45:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[57.997ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:45:11.75'

2025/06/20 21:45:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.135ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:30:11.748' LIMIT 50

2025/06/20 21:45:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.510ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:30:11.769' LIMIT 50

2025/06/20 21:45:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.492ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:45:11.75'

2025/06/20 21:45:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.518ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:45:11.75'

2025/06/20 21:45:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.281ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:15:12.131'

2025/06/20 21:45:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.325ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:45:12.19' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:45:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.665ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:45:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.888ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:15:12.241'

2025/06/20 21:45:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.223ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:45:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.441ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:45:12.305' AND status != 'pending'
	

2025/06/20 21:45:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.410ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:45:12.303' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:45:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.410ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:45:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.031ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:45:12.363' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:45:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.749ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:45:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.071ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:45:12.42'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:45:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.812ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:45:12.427' AND status != 'pending'
	

2025/06/20 21:45:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.867ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:45:12.489' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:45:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.877ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:45:12.551'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:46:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.570ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:46:11.75'

2025/06/20 21:46:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.562ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:46:11.75'

2025/06/20 21:46:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.919ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:46:11.75'

2025/06/20 21:46:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.334ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:16:12.131'

2025/06/20 21:46:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[72.872ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:46:12.196' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:46:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.154ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:16:12.24'

2025/06/20 21:46:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.197ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:46:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.416ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:46:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.191ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:46:12.298' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:46:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.353ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:46:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.208ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:46:12.331' AND status != 'pending'
	

2025/06/20 21:46:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.743ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:46:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.500ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:46:12.393' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:46:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.873ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:46:12.413' AND status != 'pending'
	

2025/06/20 21:46:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.799ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:46:12.455'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:46:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.338ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:46:12.47' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:46:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.322ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:46:12.529'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:47:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.729ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:47:11.773'

2025/06/20 21:47:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.815ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:32:11.788' LIMIT 50

2025/06/20 21:47:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.341ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:32:11.793' LIMIT 50

2025/06/20 21:47:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.385ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:47:11.773'

2025/06/20 21:47:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.458ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:47:11.773'

2025/06/20 21:47:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.121ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:17:12.132'

2025/06/20 21:47:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.519ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:47:12.189' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:47:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.157ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:47:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.745ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:17:12.24'

2025/06/20 21:47:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.915ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:47:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[55.976ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:47:12.303' AND status != 'pending'
	

2025/06/20 21:47:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.820ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:47:12.3' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:47:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.316ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:47:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.051ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:47:12.359' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:47:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.242ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:47:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.840ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:47:12.416'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:47:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.729ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:47:12.422' AND status != 'pending'
	

2025/06/20 21:47:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.461ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:47:12.482' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:47:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.265ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:47:12.543'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:48:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.258ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:48:11.749'

2025/06/20 21:48:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.107ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:48:11.749'

2025/06/20 21:48:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.219ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:48:11.749'

2025/06/20 21:48:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.456ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:18:12.131'

2025/06/20 21:48:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.059ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:48:12.192' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:48:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.961ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:48:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.385ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:18:12.239'

2025/06/20 21:48:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.492ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:48:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.452ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:48:12.297' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:48:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.568ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:48:12.314' AND status != 'pending'
	

2025/06/20 21:48:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.698ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:48:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.696ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:48:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.749ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:48:12.373' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:48:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.218ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:48:12.412' AND status != 'pending'
	

2025/06/20 21:48:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.159ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:48:12.434'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:48:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.691ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:48:12.47' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:48:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.665ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:48:12.527'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:49:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.293ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:34:11.747' LIMIT 50

2025/06/20 21:49:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.753ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:49:11.749'

2025/06/20 21:49:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.166ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:34:11.767' LIMIT 50

2025/06/20 21:49:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.990ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:49:11.749'

2025/06/20 21:49:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.820ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:49:11.749'

2025/06/20 21:49:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.391ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:19:12.13'

2025/06/20 21:49:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.915ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:49:12.192' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:49:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.939ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:49:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.733ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:19:12.239'

2025/06/20 21:49:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.738ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:49:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.971ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:49:12.301' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:49:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.055ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:49:12.313' AND status != 'pending'
	

2025/06/20 21:49:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.709ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:49:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.138ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:49:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.333ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:49:12.374' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:49:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.013ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:49:12.425' AND status != 'pending'
	

2025/06/20 21:49:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.273ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:49:12.434'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:49:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.819ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:49:12.488' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:49:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.517ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:49:12.55'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:50:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.336ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:50:11.748'

2025/06/20 21:50:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.421ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:50:11.748'

2025/06/20 21:50:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.797ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:50:11.748'

2025/06/20 21:50:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.895ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:20:12.13'

2025/06/20 21:50:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.696ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:50:12.194' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:50:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.691ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:50:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.542ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:20:12.24'

2025/06/20 21:50:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.526ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:50:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.456ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:50:12.301' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:50:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.036ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:50:12.317' AND status != 'pending'
	

2025/06/20 21:50:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.091ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:50:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.283ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:50:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.449ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:50:12.381' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:50:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.260ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:50:12.423' AND status != 'pending'
	

2025/06/20 21:50:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.017ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:50:12.442'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:50:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.603ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:50:12.484' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:50:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.806ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:50:12.544'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:51:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.352ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:36:11.746' LIMIT 50

2025/06/20 21:51:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.385ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:51:11.748'

2025/06/20 21:51:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.282ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:36:11.767' LIMIT 50

2025/06/20 21:51:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.071ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:51:11.748'

2025/06/20 21:51:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.585ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:51:11.748'

2025/06/20 21:51:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.760ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:21:12.129'

2025/06/20 21:51:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.618ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:51:12.196' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:51:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.630ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:51:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.205ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:21:12.238'

2025/06/20 21:51:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.849ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:51:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.972ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:51:12.296' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:51:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.259ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:51:12.32' AND status != 'pending'
	

2025/06/20 21:51:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.458ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:51:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.344ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:51:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.247ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:51:12.382' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:51:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.810ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:51:12.411' AND status != 'pending'
	

2025/06/20 21:51:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.811ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:51:12.444'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:51:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.854ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:51:12.469' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:51:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.428ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:51:12.527'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:52:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.404ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:52:11.748'

2025/06/20 21:52:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.185ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:52:11.748'

2025/06/20 21:52:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.475ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:52:11.748'

2025/06/20 21:52:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.298ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:22:12.128'

2025/06/20 21:52:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.822ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:52:12.187' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:52:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.779ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:52:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.418ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:22:12.238'

2025/06/20 21:52:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.191ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:52:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.716ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:52:12.303' AND status != 'pending'
	

2025/06/20 21:52:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.163ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:52:12.299' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:52:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.852ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:52:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.782ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:52:12.36' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:52:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.684ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:52:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.894ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:52:12.417'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:52:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.913ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:52:12.424' AND status != 'pending'
	

2025/06/20 21:52:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.834ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:52:12.486' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:52:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.459ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:52:12.548'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:53:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.548ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:38:11.745' LIMIT 50

2025/06/20 21:53:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.735ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:53:11.748'

2025/06/20 21:53:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.313ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:38:11.766' LIMIT 50

2025/06/20 21:53:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.825ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:53:11.748'

2025/06/20 21:53:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.149ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:53:11.748'

2025/06/20 21:53:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.325ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:23:12.129'

2025/06/20 21:53:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.613ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:53:12.192' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:53:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.793ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:53:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.678ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:23:12.236'

2025/06/20 21:53:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.688ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:53:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.180ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:53:12.297' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:53:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.948ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:53:12.316' AND status != 'pending'
	

2025/06/20 21:53:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.014ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:53:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.228ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:53:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.560ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:53:12.379' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:53:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.849ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:53:12.418' AND status != 'pending'
	

2025/06/20 21:53:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.290ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:53:12.442'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:53:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.144ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:53:12.478' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:53:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.535ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:53:12.539'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:54:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.989ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:54:11.747'

2025/06/20 21:54:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.950ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:54:11.747'

2025/06/20 21:54:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.671ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:54:11.747'

2025/06/20 21:54:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.832ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:24:12.128'

2025/06/20 21:54:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.669ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:54:12.189' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:54:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.013ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:54:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.196ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:24:12.236'

2025/06/20 21:54:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.786ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:54:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.877ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:54:12.3' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:54:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.393ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:54:12.31' AND status != 'pending'
	

2025/06/20 21:54:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.819ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:54:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.934ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:54:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.106ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:54:12.371' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:54:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.645ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:54:12.424' AND status != 'pending'
	

2025/06/20 21:54:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.191ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:54:12.431'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:54:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.203ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:54:12.486' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:54:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.484ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:54:12.548'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:55:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.741ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:40:11.744' LIMIT 50

2025/06/20 21:55:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.784ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:55:11.747'

2025/06/20 21:55:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[56.989ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:40:11.765' LIMIT 50

2025/06/20 21:55:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.599ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:55:11.747'

2025/06/20 21:55:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.885ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:55:11.747'

2025/06/20 21:55:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.184ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:25:12.127'

2025/06/20 21:55:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.833ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:55:12.19' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:55:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.559ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:55:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.672ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:25:12.236'

2025/06/20 21:55:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.660ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:55:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.388ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:55:12.293' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:55:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.166ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:55:12.315' AND status != 'pending'
	

2025/06/20 21:55:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.348ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:55:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.100ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:55:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.606ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:55:12.376' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:55:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.173ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:55:12.407' AND status != 'pending'
	

2025/06/20 21:55:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.350ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:55:12.438'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:55:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.798ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:55:12.465' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:55:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.511ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:55:12.522'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:56:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.218ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:56:11.746'

2025/06/20 21:56:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.587ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:56:11.746'

2025/06/20 21:56:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.563ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:56:11.746'

2025/06/20 21:56:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.455ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:26:12.127'

2025/06/20 21:56:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.497ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:56:12.185' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:56:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.665ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:56:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.005ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:26:12.235'

2025/06/20 21:56:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.401ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:56:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.920ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:56:12.3' AND status != 'pending'
	

2025/06/20 21:56:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.072ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:56:12.298' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:56:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.222ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:56:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.888ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:56:12.358' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:56:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.742ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:56:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.264ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:56:12.415'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:56:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.406ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:56:12.422' AND status != 'pending'
	

2025/06/20 21:56:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.967ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:56:12.485' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:56:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.694ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:56:12.547'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:57:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.650ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:42:11.744' LIMIT 50

2025/06/20 21:57:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.016ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:57:11.746'

2025/06/20 21:57:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.867ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:42:11.764' LIMIT 50

2025/06/20 21:57:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.953ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:57:11.746'

2025/06/20 21:57:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.180ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:57:11.746'

2025/06/20 21:57:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.083ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:27:12.127'

2025/06/20 21:57:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.479ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:57:12.19' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:57:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.620ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:57:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.713ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:27:12.236'

2025/06/20 21:57:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.873ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:57:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.092ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:57:12.298' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:57:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.250ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:57:12.314' AND status != 'pending'
	

2025/06/20 21:57:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.302ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:57:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.456ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:57:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.038ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:57:12.377' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:57:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.076ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:57:12.419' AND status != 'pending'
	

2025/06/20 21:57:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.655ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:57:12.439'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:57:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.064ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:57:12.48' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:57:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.278ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:57:12.54'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:58:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.312ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:58:11.746'

2025/06/20 21:58:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.639ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:58:11.746'

2025/06/20 21:58:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.354ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:58:11.746'

2025/06/20 21:58:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.093ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:28:12.127'

2025/06/20 21:58:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.459ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:58:12.188' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:58:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.591ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:58:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.912ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:28:12.236'

2025/06/20 21:58:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.962ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:58:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.280ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:58:12.3' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:58:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.028ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:58:12.311' AND status != 'pending'
	

2025/06/20 21:58:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.779ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:58:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.421ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:58:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.230ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:58:12.372' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:58:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.588ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:58:12.426' AND status != 'pending'
	

2025/06/20 21:58:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.773ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:58:12.432'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:58:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.650ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:58:12.489' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:58:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.963ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:58:12.551'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:59:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.066ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:44:11.743' LIMIT 50

2025/06/20 21:59:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.041ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 21:59:11.745'

2025/06/20 21:59:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.574ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:44:11.764' LIMIT 50

2025/06/20 21:59:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.769ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 21:59:11.745'

2025/06/20 21:59:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.416ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 21:59:11.745'

2025/06/20 21:59:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.317ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:29:12.126'

2025/06/20 21:59:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.308ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:59:12.189' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:59:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.068ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:59:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.512ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:29:12.235'

2025/06/20 21:59:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.748ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:59:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.831ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 20:59:12.293' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 21:59:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.979ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:59:12.315' AND status != 'pending'
	

2025/06/20 21:59:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.493ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 21:59:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.800ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 21:59:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.629ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:59:12.377' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:59:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.593ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 20:59:12.408' AND status != 'pending'
	

2025/06/20 21:59:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.098ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:59:12.44'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 21:59:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.200ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 20:59:12.466' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 21:59:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.158ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 20:59:12.526'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:00:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.280ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:00:11.745'

2025/06/20 22:00:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.896ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:00:11.745'

2025/06/20 22:00:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.261ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:00:11.745'

2025/06/20 22:00:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.238ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:30:12.126'

2025/06/20 22:00:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.553ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:00:12.184' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:00:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.670ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:00:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.327ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:30:12.235'

2025/06/20 22:00:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.637ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:00:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.325ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:00:12.3' AND status != 'pending'
	

2025/06/20 22:00:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.272ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:00:12.298' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:00:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.555ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:00:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.075ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:00:12.357' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:00:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.606ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:00:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.836ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:00:12.416'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:00:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.417ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:00:12.42' AND status != 'pending'
	

2025/06/20 22:00:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.005ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:00:12.482' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:00:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.966ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:00:12.544'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:01:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.392ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:46:11.742' LIMIT 50

2025/06/20 22:01:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.317ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:01:11.744'

2025/06/20 22:01:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.055ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:46:11.763' LIMIT 50

2025/06/20 22:01:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.056ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:01:11.744'

2025/06/20 22:01:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.762ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:01:11.744'

2025/06/20 22:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.852ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:31:12.126'

2025/06/20 22:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.292ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:01:12.188' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.240ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.358ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:31:12.234'

2025/06/20 22:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.929ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.193ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:01:12.295' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.205ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:01:12.312' AND status != 'pending'
	

2025/06/20 22:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.564ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.196ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.434ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:01:12.374' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.986ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:01:12.422' AND status != 'pending'
	

2025/06/20 22:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.518ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:01:12.436'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.034ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:01:12.482' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.864ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:01:12.543'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:02:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.140ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:02:11.744'

2025/06/20 22:02:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.317ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:02:11.744'

2025/06/20 22:02:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.309ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:02:11.744'

2025/06/20 22:02:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.622ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:32:12.125'

2025/06/20 22:02:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.395ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:02:12.186' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:02:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.107ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:02:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.883ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:32:12.234'

2025/06/20 22:02:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.058ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:02:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.380ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:02:12.296' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:02:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.931ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:02:12.307' AND status != 'pending'
	

2025/06/20 22:02:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.613ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:02:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.099ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:02:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.984ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:02:12.367' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:02:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.119ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:02:12.42' AND status != 'pending'
	

2025/06/20 22:02:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.644ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:02:12.427'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:02:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.142ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:02:12.482' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:02:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.194ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:02:12.545'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:03:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.669ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:03:11.744'

2025/06/20 22:03:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.969ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:48:11.741' LIMIT 50

2025/06/20 22:03:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[56.163ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:48:11.762' LIMIT 50

2025/06/20 22:03:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.454ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:03:11.744'

2025/06/20 22:03:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.125ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:03:11.744'

2025/06/20 22:03:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.771ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:33:12.124'

2025/06/20 22:03:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.958ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:03:12.187' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:03:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.932ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:03:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.895ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:33:12.234'

2025/06/20 22:03:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.705ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:03:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.211ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:03:12.292' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:03:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.205ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:03:12.308' AND status != 'pending'
	

2025/06/20 22:03:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.298ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:03:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.662ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:03:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.395ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:03:12.37' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:03:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.307ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:03:12.407' AND status != 'pending'
	

2025/06/20 22:03:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.865ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:03:12.431'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:03:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.952ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:03:12.463' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:03:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.034ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:03:12.52'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:04:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.152ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:04:11.743'

2025/06/20 22:04:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.827ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:04:11.743'

2025/06/20 22:04:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[56.829ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:04:11.743'

2025/06/20 22:04:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.051ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:34:12.124'

2025/06/20 22:04:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.616ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:04:12.182' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:04:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.508ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:04:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.958ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:34:12.232'

2025/06/20 22:04:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.426ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:04:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.790ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:04:12.296' AND status != 'pending'
	

2025/06/20 22:04:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.731ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:04:12.293' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:04:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.720ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:04:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.093ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:04:12.354' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:04:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.773ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:04:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.299ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:04:12.413'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:04:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.702ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:04:12.414' AND status != 'pending'
	

2025/06/20 22:04:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.465ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:04:12.474' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:04:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.901ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:04:12.539'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:05:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.268ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:05:11.743'

2025/06/20 22:05:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.742ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:50:11.741' LIMIT 50

2025/06/20 22:05:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.832ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:50:11.761' LIMIT 50

2025/06/20 22:05:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.124ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:05:11.743'

2025/06/20 22:05:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.846ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:05:11.743'

2025/06/20 22:05:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.786ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:35:12.124'

2025/06/20 22:05:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.396ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:05:12.183' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:05:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.710ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:05:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.080ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:35:12.233'

2025/06/20 22:05:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.403ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:05:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.400ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:05:12.298' AND status != 'pending'
	

2025/06/20 22:05:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.652ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:05:12.296' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:05:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.980ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:05:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.563ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:05:12.357' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:05:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.523ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:05:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.826ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:05:12.415'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:05:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.092ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:05:12.419' AND status != 'pending'
	

2025/06/20 22:05:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.524ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:05:12.482' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:05:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.801ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:05:12.544'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:06:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.551ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:06:11.742'

2025/06/20 22:06:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.103ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:06:11.742'

2025/06/20 22:06:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.111ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:06:11.742'

2025/06/20 22:06:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.917ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:36:12.124'

2025/06/20 22:06:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.567ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:06:12.186' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:06:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.906ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:06:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.711ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:36:12.232'

2025/06/20 22:06:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.080ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:06:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.659ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:06:12.29' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:06:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.512ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:06:12.31' AND status != 'pending'
	

2025/06/20 22:06:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.692ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:06:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.077ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:06:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.998ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:06:12.372' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:06:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.580ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:06:12.406' AND status != 'pending'
	

2025/06/20 22:06:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.217ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:06:12.434'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:06:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.446ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:06:12.463' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:06:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.109ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:06:12.52'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:07:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.068ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:52:11.74' LIMIT 50

2025/06/20 22:07:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.908ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:07:11.742'

2025/06/20 22:07:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.250ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:52:11.761' LIMIT 50

2025/06/20 22:07:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.587ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:07:11.742'

2025/06/20 22:07:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.258ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:07:11.742'

2025/06/20 22:07:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.147ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:37:12.123'

2025/06/20 22:07:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.401ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:07:12.187' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:07:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.805ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:07:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.165ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:37:12.232'

2025/06/20 22:07:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.016ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:07:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.044ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:07:12.294' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:07:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.213ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:07:12.311' AND status != 'pending'
	

2025/06/20 22:07:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.670ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:07:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.907ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:07:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.385ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:07:12.374' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:07:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.367ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:07:12.414' AND status != 'pending'
	

2025/06/20 22:07:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.929ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:07:12.437'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:07:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.434ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:07:12.473' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:07:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.914ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:07:12.534'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.991ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:08:11.742'

2025/06/20 22:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.934ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:08:11.742'

2025/06/20 22:08:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.188ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:08:11.742'

2025/06/20 22:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.575ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:38:12.123'

2025/06/20 22:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.675ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:08:12.185' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.674ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.807ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:38:12.231'

2025/06/20 22:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.864ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.165ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:08:12.295' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.671ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:08:12.306' AND status != 'pending'
	

2025/06/20 22:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.207ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.065ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.504ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:08:12.367' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.794ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:08:12.42' AND status != 'pending'
	

2025/06/20 22:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.454ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:08:12.428'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.939ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:08:12.482' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:08:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.353ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:08:12.544'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:09:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.997ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:54:11.739' LIMIT 50

2025/06/20 22:09:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.871ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:09:11.741'

2025/06/20 22:09:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[56.476ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:54:11.76' LIMIT 50

2025/06/20 22:09:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.919ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:09:11.741'

2025/06/20 22:09:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.516ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:09:11.741'

2025/06/20 22:09:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.721ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:39:12.122'

2025/06/20 22:09:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.708ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:09:12.183' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:09:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.403ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:09:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.818ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:39:12.231'

2025/06/20 22:09:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.761ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:09:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.882ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:09:12.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:09:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.498ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:09:12.305' AND status != 'pending'
	

2025/06/20 22:09:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.923ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:09:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.287ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:09:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.242ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:09:12.365' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:09:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.841ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:09:12.403' AND status != 'pending'
	

2025/06/20 22:09:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.555ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:09:12.425'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:09:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.964ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:09:12.46' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:09:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.340ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:09:12.517'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:10:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.925ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:10:11.741'

2025/06/20 22:10:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.786ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:10:11.741'

2025/06/20 22:10:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.761ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:10:11.741'

2025/06/20 22:10:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.763ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:40:12.123'

2025/06/20 22:10:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.356ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:10:12.181' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:10:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.608ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:10:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.037ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:40:12.231'

2025/06/20 22:10:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.710ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:10:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.304ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:10:12.292' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:10:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.615ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:10:12.296' AND status != 'pending'
	

2025/06/20 22:10:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.433ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:10:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.894ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:10:12.354' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:10:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.524ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:10:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.609ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:10:12.413'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:10:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.906ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:10:12.417' AND status != 'pending'
	

2025/06/20 22:10:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.042ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:10:12.478' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:10:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.294ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:10:12.538'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:11:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.038ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:11:11.741'

2025/06/20 22:11:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.555ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:56:11.739' LIMIT 50

2025/06/20 22:11:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.451ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:56:11.759' LIMIT 50

2025/06/20 22:11:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.276ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:11:11.741'

2025/06/20 22:11:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.120ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:11:11.741'

2025/06/20 22:11:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.283ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:41:12.122'

2025/06/20 22:11:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.726ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:11:12.18' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:11:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.041ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:11:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.055ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:41:12.231'

2025/06/20 22:11:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.190ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:11:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.621ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:11:12.297' AND status != 'pending'
	

2025/06/20 22:11:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.774ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:11:12.292' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:11:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.451ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:11:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.266ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:11:12.354' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:11:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.183ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:11:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.214ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:11:12.413'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:11:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.470ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:11:12.416' AND status != 'pending'
	

2025/06/20 22:11:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.263ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:11:12.477' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:11:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.158ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:11:12.54'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:12:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.139ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:12:11.74'

2025/06/20 22:12:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.281ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:12:11.74'

2025/06/20 22:12:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.467ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:12:11.74'

2025/06/20 22:12:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.969ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:42:12.121'

2025/06/20 22:12:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.737ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:12:12.184' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:12:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.516ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:12:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.903ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:42:12.23'

2025/06/20 22:12:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.210ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:12:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.057ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:12:12.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:12:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.989ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:12:12.307' AND status != 'pending'
	

2025/06/20 22:12:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.278ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:12:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.380ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:12:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.776ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:12:12.37' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:12:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.086ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:12:12.401' AND status != 'pending'
	

2025/06/20 22:12:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.222ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:12:12.433'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:12:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.010ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:12:12.458' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:12:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.862ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:12:12.515'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:13:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[57.936ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:13:11.74'

2025/06/20 22:13:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.017ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:58:11.738' LIMIT 50

2025/06/20 22:13:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.530ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:58:11.758' LIMIT 50

2025/06/20 22:13:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.550ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:13:11.74'

2025/06/20 22:13:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.786ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:13:11.74'

2025/06/20 22:13:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.797ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:43:12.121'

2025/06/20 22:13:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.431ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:13:12.183' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:13:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.635ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:13:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.739ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:43:12.23'

2025/06/20 22:13:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.972ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:13:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.937ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:13:12.292' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:13:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.171ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:13:12.298' AND status != 'pending'
	

2025/06/20 22:13:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.210ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:13:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.098ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:13:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.728ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:13:12.355' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:13:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.130ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:13:12.414'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:13:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.763ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:13:12.413' AND status != 'pending'
	

2025/06/20 22:13:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.908ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:13:12.473' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:13:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.872ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:13:12.535'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:14:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.083ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:14:11.74'

2025/06/20 22:14:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.432ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:14:11.74'

2025/06/20 22:14:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.153ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:14:11.74'

2025/06/20 22:14:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.225ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:44:12.122'

2025/06/20 22:14:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.818ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:14:12.184' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:14:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.353ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:14:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.424ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:44:12.23'

2025/06/20 22:14:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.693ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:14:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.281ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:14:12.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:14:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.734ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:14:12.306' AND status != 'pending'
	

2025/06/20 22:14:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.635ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:14:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.521ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:14:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.376ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:14:12.369' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:14:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.144ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:14:12.402' AND status != 'pending'
	

2025/06/20 22:14:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.001ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:14:12.431'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:14:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.642ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:14:12.46' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:14:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.572ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:14:12.518'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:15:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.114ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:00:11.737' LIMIT 50

2025/06/20 22:15:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.955ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:15:11.739'

2025/06/20 22:15:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.901ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:00:11.758' LIMIT 50

2025/06/20 22:15:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.281ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:15:11.739'

2025/06/20 22:15:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.032ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:15:11.739'

2025/06/20 22:15:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.305ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:45:12.12'

2025/06/20 22:15:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.703ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:15:12.182' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:15:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.579ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:15:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.439ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:45:12.229'

2025/06/20 22:15:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.125ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:15:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.614ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:15:12.291' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:15:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.176ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:15:12.304' AND status != 'pending'
	

2025/06/20 22:15:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.795ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:15:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.716ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:15:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.465ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:15:12.364' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:15:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.165ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:15:12.415' AND status != 'pending'
	

2025/06/20 22:15:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.902ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:15:12.425'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:15:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.878ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:15:12.477' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:15:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.688ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:15:12.539'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:16:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.663ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:16:11.739'

2025/06/20 22:16:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.127ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:16:11.739'

2025/06/20 22:16:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.960ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:16:11.739'

2025/06/20 22:16:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.127ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:46:12.12'

2025/06/20 22:16:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.739ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:16:12.182' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:16:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.939ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:16:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.545ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:46:12.229'

2025/06/20 22:16:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.003ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:16:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.885ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:16:12.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:16:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.074ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:16:12.306' AND status != 'pending'
	

2025/06/20 22:16:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.489ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:16:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.697ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:16:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.361ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:16:12.368' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:16:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.265ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:16:12.409' AND status != 'pending'
	

2025/06/20 22:16:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.130ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:16:12.43'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:16:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.826ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:16:12.476' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:16:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.164ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:16:12.536'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:17:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.817ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:02:11.736' LIMIT 50

2025/06/20 22:17:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.135ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:17:11.738'

2025/06/20 22:17:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.101ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:02:11.757' LIMIT 50

2025/06/20 22:17:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.512ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:17:11.738'

2025/06/20 22:17:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.369ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:17:11.738'

2025/06/20 22:17:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.787ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:47:12.12'

2025/06/20 22:17:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.528ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:17:12.182' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:17:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.103ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:17:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.947ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:47:12.228'

2025/06/20 22:17:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.054ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:17:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.405ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:17:12.289' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:17:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.925ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:17:12.307' AND status != 'pending'
	

2025/06/20 22:17:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.808ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:17:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.273ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:17:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.100ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:17:12.369' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:17:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.757ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:17:12.404' AND status != 'pending'
	

2025/06/20 22:17:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.219ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:17:12.431'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:17:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.683ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:17:12.461' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:17:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.871ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:17:12.519'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:18:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.565ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:18:11.738'

2025/06/20 22:18:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.277ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:18:11.738'

2025/06/20 22:18:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.896ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:18:11.738'

2025/06/20 22:18:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.881ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:48:12.119'

2025/06/20 22:18:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.565ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:18:12.177' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:18:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.795ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:18:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.428ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:48:12.228'

2025/06/20 22:18:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.361ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:18:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.969ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:18:12.294' AND status != 'pending'
	

2025/06/20 22:18:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.351ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:18:12.29' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:18:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.336ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:18:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.617ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:18:12.352' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:18:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.411ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:18:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.310ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:18:12.41'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:18:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.836ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:18:12.413' AND status != 'pending'
	

2025/06/20 22:18:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.875ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:18:12.475' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:18:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.929ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:18:12.537'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:19:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[57.036ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:19:11.737'

2025/06/20 22:19:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.435ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:04:11.735' LIMIT 50

2025/06/20 22:19:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.366ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:04:11.756' LIMIT 50

2025/06/20 22:19:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.081ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:19:11.737'

2025/06/20 22:19:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.066ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:19:11.737'

2025/06/20 22:19:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.331ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:49:12.119'

2025/06/20 22:19:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.038ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:19:12.182' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:19:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.418ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:19:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.973ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:49:12.228'

2025/06/20 22:19:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.969ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:19:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.779ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:19:12.29' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:19:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.798ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:19:12.297' AND status != 'pending'
	

2025/06/20 22:19:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.072ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:19:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.257ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:19:12.354' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:19:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.608ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:19:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.910ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:19:12.41'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:19:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.874ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:19:12.411' AND status != 'pending'
	

2025/06/20 22:19:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.861ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:19:12.471' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:19:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.079ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:19:12.532'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:20:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.820ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:20:11.738'

2025/06/20 22:20:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.047ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:20:11.738'

2025/06/20 22:20:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.656ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:20:11.738'

2025/06/20 22:20:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.314ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:50:12.119'

2025/06/20 22:20:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.213ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:20:12.182' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:20:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.824ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:20:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.290ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:50:12.227'

2025/06/20 22:20:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.147ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:20:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.743ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:20:12.285' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:20:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.163ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:20:12.305' AND status != 'pending'
	

2025/06/20 22:20:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.815ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:20:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[27.601ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:20:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.812ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:20:12.368' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:20:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.166ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:20:12.4' AND status != 'pending'
	

2025/06/20 22:20:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.176ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:20:12.428'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:20:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.900ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:20:12.457' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:20:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.347ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:20:12.515'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:21:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.704ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:06:11.735' LIMIT 50

2025/06/20 22:21:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.376ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:21:11.737'

2025/06/20 22:21:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.798ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:06:11.755' LIMIT 50

2025/06/20 22:21:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.118ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:21:11.737'

2025/06/20 22:21:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.027ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:21:11.737'

2025/06/20 22:21:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.028ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:51:12.118'

2025/06/20 22:21:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.345ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:21:12.181' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:21:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.731ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:21:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.333ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:51:12.227'

2025/06/20 22:21:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.624ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:21:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.663ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:21:12.289' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:21:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.505ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:21:12.301' AND status != 'pending'
	

2025/06/20 22:21:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.820ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:21:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.754ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:21:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.410ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:21:12.36' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:21:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.899ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:21:12.414' AND status != 'pending'
	

2025/06/20 22:21:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.955ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:21:12.421'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:21:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.027ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:21:12.476' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:21:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.537ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:21:12.538'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:22:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.502ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:22:11.736'

2025/06/20 22:22:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.389ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:22:11.736'

2025/06/20 22:22:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[68.004ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:22:11.736'

2025/06/20 22:22:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.106ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:52:12.118'

2025/06/20 22:22:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.937ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:22:12.181' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:22:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.271ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:22:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.725ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:52:12.226'

2025/06/20 22:22:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.609ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:22:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.815ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:22:12.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:22:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.029ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:22:12.305' AND status != 'pending'
	

2025/06/20 22:22:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.607ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:22:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.962ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:22:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.669ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:22:12.368' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:22:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.227ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:22:12.408' AND status != 'pending'
	

2025/06/20 22:22:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.234ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:22:12.431'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:22:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.832ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:22:12.469' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:22:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.371ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:22:12.53'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:23:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.662ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:08:11.734' LIMIT 50

2025/06/20 22:23:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.450ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:23:11.736'

2025/06/20 22:23:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.642ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:08:11.754' LIMIT 50

2025/06/20 22:23:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.859ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:23:11.736'

2025/06/20 22:23:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.342ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:23:11.736'

2025/06/20 22:23:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.713ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:53:12.117'

2025/06/20 22:23:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.120ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:23:12.18' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:23:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.766ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:23:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.777ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:53:12.226'

2025/06/20 22:23:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.616ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:23:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.919ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:23:12.285' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:23:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.140ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:23:12.305' AND status != 'pending'
	

2025/06/20 22:23:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.721ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:23:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.056ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:23:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.573ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:23:12.368' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:23:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.526ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:23:12.4' AND status != 'pending'
	

2025/06/20 22:23:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[73.466ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:23:12.432'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:23:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.221ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:23:12.458' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:23:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.741ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:23:12.517'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:24:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.470ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:24:11.737'

2025/06/20 22:24:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.795ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:24:11.737'

2025/06/20 22:24:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.203ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:24:11.737'

2025/06/20 22:24:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.484ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:54:12.116'

2025/06/20 22:24:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.053ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:24:12.174' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:24:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.375ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:24:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.855ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:54:12.226'

2025/06/20 22:24:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.512ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:24:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.714ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:24:12.291' AND status != 'pending'
	

2025/06/20 22:24:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.062ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:24:12.289' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:24:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.452ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:24:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.868ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:24:12.353' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:24:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.645ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:24:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.762ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:24:12.411'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:24:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.548ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:24:12.415' AND status != 'pending'
	

2025/06/20 22:24:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.510ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:24:12.476' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:24:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.927ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:24:12.539'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:25:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.617ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:10:11.733' LIMIT 50

2025/06/20 22:25:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.666ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:25:11.735'

2025/06/20 22:25:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.101ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:10:11.754' LIMIT 50

2025/06/20 22:25:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.755ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:25:11.735'

2025/06/20 22:25:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.545ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:25:11.735'

2025/06/20 22:25:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.275ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:55:12.116'

2025/06/20 22:25:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.589ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:25:12.18' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:25:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.602ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:25:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.926ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:55:12.225'

2025/06/20 22:25:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.064ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:25:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.048ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:25:12.286' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:25:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.919ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:25:12.305' AND status != 'pending'
	

2025/06/20 22:25:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.233ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:25:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.599ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:25:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.307ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:25:12.369' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:25:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.809ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:25:12.409' AND status != 'pending'
	

2025/06/20 22:25:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.677ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:25:12.434'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:25:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.147ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:25:12.469' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:25:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.585ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:25:12.531'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:26:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.258ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:26:11.735'

2025/06/20 22:26:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.438ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:26:11.735'

2025/06/20 22:26:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.293ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:26:11.735'

2025/06/20 22:26:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.962ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:56:12.119'

2025/06/20 22:26:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.712ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:26:12.181' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:26:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.685ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:26:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.177ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:56:12.225'

2025/06/20 22:26:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.840ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:26:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.355ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:26:12.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:26:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.812ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:26:12.301' AND status != 'pending'
	

2025/06/20 22:26:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.811ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:26:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.862ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:26:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.893ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:26:12.363' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:26:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.290ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:26:12.414' AND status != 'pending'
	

2025/06/20 22:26:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.617ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:26:12.424'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:26:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.656ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:26:12.476' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:26:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.589ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:26:12.538'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:27:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.413ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:27:11.734'

2025/06/20 22:27:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[70.296ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:12:11.732' LIMIT 50

2025/06/20 22:27:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.053ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:12:11.753' LIMIT 50

2025/06/20 22:27:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.936ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:27:11.734'

2025/06/20 22:27:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.642ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:27:11.734'

2025/06/20 22:27:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.623ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:57:12.116'

2025/06/20 22:27:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.158ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:27:12.178' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:27:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.124ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:27:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.590ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:57:12.225'

2025/06/20 22:27:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.065ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:27:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.555ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:27:12.284' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:27:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.226ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:27:12.299' AND status != 'pending'
	

2025/06/20 22:27:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.747ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:27:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.165ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:27:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.844ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:27:12.36' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:27:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.381ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:27:12.399' AND status != 'pending'
	

2025/06/20 22:27:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.776ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:27:12.421'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:27:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.832ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:27:12.456' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:27:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.358ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:27:12.513'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:28:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.233ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:28:11.734'

2025/06/20 22:28:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.037ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:28:11.734'

2025/06/20 22:28:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.238ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:28:11.734'

2025/06/20 22:28:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.931ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:58:12.116'

2025/06/20 22:28:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.855ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:28:12.176' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:28:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.566ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:28:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.362ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:58:12.224'

2025/06/20 22:28:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.772ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:28:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.572ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:28:12.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:28:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.993ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:28:12.292' AND status != 'pending'
	

2025/06/20 22:28:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.741ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:28:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.705ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:28:12.349' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:28:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.763ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:28:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.416ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:28:12.408'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:28:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.690ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:28:12.409' AND status != 'pending'
	

2025/06/20 22:28:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.599ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:28:12.469' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:28:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.119ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:28:12.53'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:29:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[57.908ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:29:11.734'

2025/06/20 22:29:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.815ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:14:11.732' LIMIT 50

2025/06/20 22:29:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.927ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:14:11.752' LIMIT 50

2025/06/20 22:29:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.828ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:29:11.734'

2025/06/20 22:29:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.672ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:29:11.734'

2025/06/20 22:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.753ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:59:12.115'

2025/06/20 22:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.179ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:29:12.174' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.562ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.210ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 21:59:12.224'

2025/06/20 22:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.315ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.377ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:29:12.289' AND status != 'pending'
	

2025/06/20 22:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.339ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:29:12.286' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.458ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.394ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:29:12.346' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.560ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.060ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:29:12.404'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.930ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:29:12.41' AND status != 'pending'
	

2025/06/20 22:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.788ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:29:12.472' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.116ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:29:12.535'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:30:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.664ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:30:11.733'

2025/06/20 22:30:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.336ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:30:11.733'

2025/06/20 22:30:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.123ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:30:11.733'

2025/06/20 22:30:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.579ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:00:12.115'

2025/06/20 22:30:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.452ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:30:12.178' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:30:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.026ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:30:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.324ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:00:12.224'

2025/06/20 22:30:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.788ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:30:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.409ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:30:12.281' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:30:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.758ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:30:12.301' AND status != 'pending'
	

2025/06/20 22:30:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.735ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:30:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.295ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:30:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.512ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:30:12.363' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:30:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.065ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:30:12.396' AND status != 'pending'
	

2025/06/20 22:30:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.581ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:30:12.425'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:30:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.964ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:30:12.454' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:30:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.575ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:30:12.512'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:31:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.418ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:16:11.731' LIMIT 50

2025/06/20 22:31:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.125ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:31:11.733'

2025/06/20 22:31:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.639ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:16:11.751' LIMIT 50

2025/06/20 22:31:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.463ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:31:11.733'

2025/06/20 22:31:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.451ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:31:11.733'

2025/06/20 22:31:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.590ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:01:12.114'

2025/06/20 22:31:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.209ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:31:12.177' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:31:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.772ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:31:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.808ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:01:12.223'

2025/06/20 22:31:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.728ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:31:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.705ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:31:12.283' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:31:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.450ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:31:12.3' AND status != 'pending'
	

2025/06/20 22:31:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.847ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:31:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.721ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:31:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.331ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:31:12.363' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:31:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.971ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:31:12.402' AND status != 'pending'
	

2025/06/20 22:31:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.310ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:31:12.425'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:31:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.703ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:31:12.463' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:31:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.744ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:31:12.524'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:32:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.383ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:32:11.733'

2025/06/20 22:32:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.159ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:32:11.733'

2025/06/20 22:32:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.898ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:32:11.733'

2025/06/20 22:32:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.972ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:02:12.114'

2025/06/20 22:32:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.181ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:32:12.175' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:32:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.403ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:32:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.017ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:02:12.222'

2025/06/20 22:32:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.619ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:32:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.646ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:32:12.285' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:32:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.488ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:32:12.296' AND status != 'pending'
	

2025/06/20 22:32:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.874ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:32:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.027ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:32:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.747ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:32:12.357' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:32:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.830ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:32:12.409' AND status != 'pending'
	

2025/06/20 22:32:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.538ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:32:12.418'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:32:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.800ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:32:12.472' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:32:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.906ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:32:12.534'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:33:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.691ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:33:11.732'

2025/06/20 22:33:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.591ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:18:11.73' LIMIT 50

2025/06/20 22:33:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.294ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:18:11.751' LIMIT 50

2025/06/20 22:33:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.228ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:33:11.732'

2025/06/20 22:33:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.532ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:33:11.732'

2025/06/20 22:33:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.310ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:03:12.114'

2025/06/20 22:33:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.612ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:33:12.177' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:33:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.560ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:33:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.149ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:03:12.222'

2025/06/20 22:33:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.837ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:33:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.807ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:33:12.281' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:33:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.096ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:33:12.298' AND status != 'pending'
	

2025/06/20 22:33:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.719ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:33:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.810ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:33:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.397ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:33:12.359' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:33:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.243ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:33:12.395' AND status != 'pending'
	

2025/06/20 22:33:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.996ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:33:12.42'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:33:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.929ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:33:12.453' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:33:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.615ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:33:12.511'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:34:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.746ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:34:11.732'

2025/06/20 22:34:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.144ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:34:11.732'

2025/06/20 22:34:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.660ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:34:11.732'

2025/06/20 22:34:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.260ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:04:12.114'

2025/06/20 22:34:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.330ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:34:12.172' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:34:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.502ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:34:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.749ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:04:12.222'

2025/06/20 22:34:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.934ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:34:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.446ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:34:12.283' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:34:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.137ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:34:12.288' AND status != 'pending'
	

2025/06/20 22:34:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.677ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:34:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.830ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:34:12.345' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:34:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.169ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:34:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.446ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:34:12.404'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:34:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.590ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:34:12.406' AND status != 'pending'
	

2025/06/20 22:34:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[69.060ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:34:12.466' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:34:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.475ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:34:12.536'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:35:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.621ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:20:11.729' LIMIT 50

2025/06/20 22:35:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.633ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:35:11.732'

2025/06/20 22:35:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.492ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:35:11.732'

2025/06/20 22:35:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.009ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:35:11.732'

2025/06/20 22:35:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[194.025ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:35:11.73' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/20 22:35:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[192.000ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:35:11.75' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/20 22:35:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[205.455ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:20:11.75' LIMIT 50

2025/06/20 22:35:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[30.082ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-13 22:35:11.926'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/20 22:35:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[30.864ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-13 22:35:11.943'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/20 22:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[70.453ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:05:12.113'

2025/06/20 22:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.047ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:35:12.184' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.164ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.186ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:05:12.221'

2025/06/20 22:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.710ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.667ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:35:12.283' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.825ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:35:12.304' AND status != 'pending'
	

2025/06/20 22:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.094ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.418ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.925ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:35:12.366' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.515ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:35:12.407' AND status != 'pending'
	

2025/06/20 22:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.845ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:35:12.428'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.812ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:35:12.468' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:35:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.357ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:35:12.53'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:36:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.151ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:36:11.732'

2025/06/20 22:36:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.383ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:36:11.732'

2025/06/20 22:36:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.215ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:36:11.732'

2025/06/20 22:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.280ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:06:12.113'

2025/06/20 22:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.368ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:36:12.175' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.459ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.459ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:06:12.221'

2025/06/20 22:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.999ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.630ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:36:12.281' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.264ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:36:12.298' AND status != 'pending'
	

2025/06/20 22:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.455ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.753ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.265ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:36:12.36' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.881ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:36:12.406' AND status != 'pending'
	

2025/06/20 22:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.115ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:36:12.423'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.609ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:36:12.47' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:36:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.375ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:36:12.532'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:37:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.204ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:22:11.729' LIMIT 50

2025/06/20 22:37:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.583ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:37:11.731'

2025/06/20 22:37:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.043ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:22:11.75' LIMIT 50

2025/06/20 22:37:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.453ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:37:11.731'

2025/06/20 22:37:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.064ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:37:11.731'

2025/06/20 22:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.136ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:07:12.112'

2025/06/20 22:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.571ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:37:12.173' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.806ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.781ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:07:12.221'

2025/06/20 22:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.073ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.341ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:37:12.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.343ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:37:12.301' AND status != 'pending'
	

2025/06/20 22:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.802ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.678ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.719ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:37:12.363' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.655ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:37:12.42' AND status != 'pending'
	

2025/06/20 22:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.097ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:37:12.425'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.719ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:37:12.486' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:37:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.058ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:37:12.552'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:38:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[69.110ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:38:11.73'

2025/06/20 22:38:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.747ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:38:11.73'

2025/06/20 22:38:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.735ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:38:11.73'

2025/06/20 22:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.006ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:08:12.112'

2025/06/20 22:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.569ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:38:12.179' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.396ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.718ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:08:12.22'

2025/06/20 22:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.203ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.814ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:38:12.281' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.211ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.038ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:38:12.312' AND status != 'pending'
	

2025/06/20 22:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.436ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.367ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:38:12.378' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.609ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:38:12.405' AND status != 'pending'
	

2025/06/20 22:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.337ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:38:12.447'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.951ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:38:12.469' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:38:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.603ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:38:12.531'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:38:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[65.515ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/20 22:38:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[34.775ms] [rows:18] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/20 22:39:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.356ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:24:11.728' LIMIT 50

2025/06/20 22:39:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.217ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:39:11.73'

2025/06/20 22:39:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.470ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:24:11.749' LIMIT 50

2025/06/20 22:39:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.720ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:39:11.73'

2025/06/20 22:39:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.456ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:39:11.73'

2025/06/20 22:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.078ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:09:12.111'

2025/06/20 22:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.983ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:39:12.178' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.720ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.452ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:09:12.22'

2025/06/20 22:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.006ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.592ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:39:12.282' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.710ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.679ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:39:12.31' AND status != 'pending'
	

2025/06/20 22:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.121ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.522ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:39:12.376' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.542ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:39:12.405' AND status != 'pending'
	

2025/06/20 22:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.023ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:39:12.443'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.621ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:39:12.466' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:39:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.921ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:39:12.528'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:316
[64.414ms] [rows:0] SELECT * FROM `permission_user` WHERE ((rule = 'CatMall' AND rule != '')) ORDER BY `permission_user`.`id` LIMIT 1

2025/06/20 22:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:326
[132.064ms] [rows:1] INSERT INTO `permission_user` (`label`,`icon`,`rule`,`key`,`path`,`layout`,`show`,`enable`,`order`,`title`,`type`,`is_link`,`keepAlive`,`parent_id`,`create_time`,`update_time`,`sort`) VALUES ('宠物平台','DocumentCopy','CatMall','','CatMall','',1,1,0,'宠物平台','TITLE',0,0,NULL,'2025-06-20 22:39:42.334','2025-06-20 22:39:42.334',500)

2025/06/20 22:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:344
[61.340ms] [rows:1] INSERT INTO `staff_permissions` (`permission_id`,`tenant_id`,`role_id`) VALUES (24,1,4)

2025/06/20 22:39:42 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:372
[61.124ms] [rows:1] INSERT INTO `role_permissions_permission` (`roleId`,`permissionId`) VALUES (4,24)

2025/06/20 22:39:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[31.875ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 22:39:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.822ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 22:39:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.970ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 22:39:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.714ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 22:39:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.313ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 22:39:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.871ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 22:39:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.587ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 22:39:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.936ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 22:39:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.430ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 22:39:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.819ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 22:39:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.763ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 22:39:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.168ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 22:39:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.526ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 22:40:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.069ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:40:11.73'

2025/06/20 22:40:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.955ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:40:11.73'

2025/06/20 22:40:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.932ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:40:11.73'

2025/06/20 22:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.988ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:10:12.111'

2025/06/20 22:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.549ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:40:12.173' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.524ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.726ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:10:12.219'

2025/06/20 22:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.753ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.044ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:40:12.285' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.148ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:40:12.297' AND status != 'pending'
	

2025/06/20 22:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.178ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.558ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.037ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:40:12.358' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.424ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:40:12.419'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.744ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:40:12.419' AND status != 'pending'
	

2025/06/20 22:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.897ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:40:12.484' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:40:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.654ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:40:12.553'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:40:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.683ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:10:39.226'

2025/06/20 22:40:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.843ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:40:39.294' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:40:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.815ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:40:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.734ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:40:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[193.533ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:10:39.239'

2025/06/20 22:40:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.721ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:40:39.428' AND status != 'pending'
	

2025/06/20 22:40:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.831ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:40:39.433' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:40:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.553ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:40:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.795ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:40:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.455ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:40:39.494' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:40:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.641ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:40:39.559' AND status != 'pending'
	

2025/06/20 22:40:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.499ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:40:39.559'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:40:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.472ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:40:39.621' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:40:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.564ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:40:39.684'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:41:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.578ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:41:39.227'

2025/06/20 22:41:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.354ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:41:39.227'

2025/06/20 22:41:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.487ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:41:39.227'

2025/06/20 22:41:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.552ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:11:39.626'

2025/06/20 22:41:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.631ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:41:39.691' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:41:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.636ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:41:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.171ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:11:39.747'

2025/06/20 22:41:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.075ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:41:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.709ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:41:39.812' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:41:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.912ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:41:39.816' AND status != 'pending'
	

2025/06/20 22:41:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.408ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:41:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.125ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:41:39.878' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:41:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.383ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:41:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.217ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:41:39.941'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:41:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.538ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:41:39.943' AND status != 'pending'
	

2025/06/20 22:41:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.958ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:41:40.009' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:41:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.839ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:41:40.075'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:41:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[33.130ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 22:41:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.582ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 22:41:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.878ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 22:41:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.061ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 22:41:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.606ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 22:41:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.374ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 22:41:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.389ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 22:41:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.208ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 22:41:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.543ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 22:41:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.064ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 22:41:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.961ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 22:41:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.321ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 22:41:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.900ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 22:42:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.174ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:42:39.227'

2025/06/20 22:42:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.397ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:27:39.225' LIMIT 50

2025/06/20 22:42:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.394ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:42:39.227'

2025/06/20 22:42:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.397ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:42:39.227'

2025/06/20 22:42:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[206.891ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:27:39.239' LIMIT 50

2025/06/20 22:42:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.406ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:12:39.625'

2025/06/20 22:42:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.294ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:42:39.693' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:42:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.635ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:42:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.583ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:12:39.747'

2025/06/20 22:42:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.043ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:42:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.853ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:42:39.811' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:42:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.150ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:42:39.829' AND status != 'pending'
	

2025/06/20 22:42:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.168ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:42:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.695ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:42:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.139ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:42:39.896' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:42:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.319ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:42:39.937' AND status != 'pending'
	

2025/06/20 22:42:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.869ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:42:39.964'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:42:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.935ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:42:40' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:42:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.970ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:42:40.062'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:42:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[35.396ms] [rows:1] SELECT count(*) FROM `role`

2025/06/20 22:42:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[62.879ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/20 22:42:44 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:309
[62.358ms] [rows:1] SELECT * FROM `role` WHERE id = 4 ORDER BY `role`.`id` LIMIT 1

2025/06/20 22:42:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:320
[63.208ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 4

2025/06/20 22:42:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/setting.go:38
[36.190ms] [rows:1] SELECT count(*) FROM `config_setting`

2025/06/20 22:42:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/setting.go:38
[62.723ms] [rows:4] SELECT * FROM `config_setting` LIMIT 10

2025/06/20 22:42:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:336
[35.155ms] [rows:1] SELECT count(*) FROM `sys_dict_type`

2025/06/20 22:42:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:336
[62.365ms] [rows:10] SELECT * FROM `sys_dict_type` ORDER BY create_time DESC LIMIT 10

2025/06/20 22:43:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.084ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:43:39.226'

2025/06/20 22:43:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.325ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:43:39.226'

2025/06/20 22:43:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.779ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:43:39.226'

2025/06/20 22:43:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.707ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:13:39.625'

2025/06/20 22:43:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.029ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:43:39.689' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:43:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.589ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:43:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.700ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:13:39.747'

2025/06/20 22:43:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.766ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:43:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.309ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:43:39.815' AND status != 'pending'
	

2025/06/20 22:43:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.355ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:43:39.814' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:43:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.991ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:43:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.442ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:43:39.879' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:43:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.358ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:43:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.206ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:43:39.941'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:43:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.750ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:43:39.947' AND status != 'pending'
	

2025/06/20 22:43:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.069ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:43:40.014' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:43:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[68.022ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:43:40.081'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:43:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[37.140ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 22:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.697ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 22:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.723ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 22:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.318ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 22:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.852ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 22:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.755ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 22:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.504ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 22:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.915ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 22:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.979ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 22:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.620ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 22:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.023ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 22:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.392ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 22:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.935ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 22:44:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[68.958ms] [rows:1] SELECT * FROM `user` WHERE (username = 'admin' OR phone = 'admin') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/20 22:44:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:481
[66.488ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 4

2025/06/20 22:44:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:493 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[33.477ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,3,4,5,6,7,8,23,24)

2025/06/20 22:44:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[33.840ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 22:44:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.599ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 22:44:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.647ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 22:44:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.423ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 22:44:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.042ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 22:44:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.384ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 22:44:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.298ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 22:44:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.789ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 22:44:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.147ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 22:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.677ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 22:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.777ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 22:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.121ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 22:44:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[68.085ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 22:44:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/setting.go:38
[33.455ms] [rows:1] SELECT count(*) FROM `config_setting`

2025/06/20 22:44:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/setting.go:38
[67.359ms] [rows:4] SELECT * FROM `config_setting` LIMIT 10

2025/06/20 22:44:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:336
[37.055ms] [rows:1] SELECT count(*) FROM `sys_dict_type`

2025/06/20 22:44:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:336
[67.172ms] [rows:10] SELECT * FROM `sys_dict_type` ORDER BY create_time DESC LIMIT 10

2025/06/20 22:44:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.271ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:44:39.226'

2025/06/20 22:44:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.270ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:29:39.224' LIMIT 50

2025/06/20 22:44:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.580ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:29:39.238' LIMIT 50

2025/06/20 22:44:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.960ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:44:39.226'

2025/06/20 22:44:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.336ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:44:39.226'

2025/06/20 22:44:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.141ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:14:39.625'

2025/06/20 22:44:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.324ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:44:39.688' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:44:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.961ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:44:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.138ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:14:39.746'

2025/06/20 22:44:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.788ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:44:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.338ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:44:39.812' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:44:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.722ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:44:39.816' AND status != 'pending'
	

2025/06/20 22:44:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.407ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:44:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.949ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:44:39.877' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:44:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.344ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:44:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.487ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:44:39.939'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:44:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.701ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:44:39.942' AND status != 'pending'
	

2025/06/20 22:44:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.416ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:44:40.008' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:44:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.707ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:44:40.074'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:44:56 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[67.623ms] [rows:1] SELECT * FROM `user` WHERE (username = 'admin' OR phone = 'admin') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/20 22:44:56 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:481
[64.121ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 4

2025/06/20 22:44:56 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:493 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[32.821ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,3,4,5,6,7,8,23,24)

2025/06/20 22:45:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:38
[33.122ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/20 22:45:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:44
[65.562ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/20 22:45:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:336
[32.765ms] [rows:1] SELECT count(*) FROM `sys_dict_type`

2025/06/20 22:45:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:336
[65.583ms] [rows:10] SELECT * FROM `sys_dict_type` ORDER BY create_time DESC LIMIT 10

2025/06/20 22:45:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.606ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:45:39.225'

2025/06/20 22:45:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.734ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:45:39.225'

2025/06/20 22:45:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.310ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:45:39.225'

2025/06/20 22:45:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.571ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:15:39.624'

2025/06/20 22:45:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.100ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:45:39.69' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:45:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.751ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:45:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.781ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:15:39.746'

2025/06/20 22:45:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.231ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:45:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.673ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:45:39.809' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:45:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.395ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:45:39.821' AND status != 'pending'
	

2025/06/20 22:45:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.219ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:45:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.505ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:45:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.777ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:45:39.886' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:45:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.290ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:45:39.935' AND status != 'pending'
	

2025/06/20 22:45:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.845ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:45:39.951'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:45:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.848ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:45:39.999' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:45:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.165ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:45:40.062'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:46:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.161ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:31:39.223' LIMIT 50

2025/06/20 22:46:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.992ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:46:39.225'

2025/06/20 22:46:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.682ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:31:39.238' LIMIT 50

2025/06/20 22:46:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.396ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:46:39.225'

2025/06/20 22:46:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.778ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:46:39.225'

2025/06/20 22:46:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.928ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:16:39.624'

2025/06/20 22:46:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.799ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:46:39.691' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:46:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.597ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:46:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.021ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:16:39.746'

2025/06/20 22:46:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.673ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:46:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.619ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:46:39.813' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:46:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.957ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:46:39.823' AND status != 'pending'
	

2025/06/20 22:46:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[35.065ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:46:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.738ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:46:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.394ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:46:39.888' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:46:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.940ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:46:39.952'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:46:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.595ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:46:39.95' AND status != 'pending'
	

2025/06/20 22:46:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.911ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:46:40.017' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:46:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.253ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:46:40.084'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:46:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[37.577ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 22:46:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.756ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 22:46:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.560ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 22:46:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.931ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 22:46:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[68.393ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 22:46:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.582ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 22:46:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.254ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 22:46:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.449ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 22:46:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[68.121ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 22:46:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.181ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 22:46:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.679ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 22:46:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.782ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 22:46:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.711ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 22:47:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[69.277ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:47:39.225'

2025/06/20 22:47:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[67.320ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:47:39.225'

2025/06/20 22:47:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[68.034ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:47:39.225'

2025/06/20 22:47:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.596ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:17:39.624'

2025/06/20 22:47:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.674ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:47:39.692' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:47:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.239ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:47:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.510ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:17:39.745'

2025/06/20 22:47:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.907ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:47:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.507ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:47:39.812' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:47:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.985ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:47:39.829' AND status != 'pending'
	

2025/06/20 22:47:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.239ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:47:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.409ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:47:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.593ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:47:39.898' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:47:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.071ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:47:39.946' AND status != 'pending'
	

2025/06/20 22:47:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.181ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:47:39.965'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:47:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.553ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:47:40.011' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:47:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[68.534ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:47:40.078'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:47:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[37.406ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 22:47:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.747ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 22:47:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.035ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 22:47:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.620ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 22:47:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.235ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 22:47:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.744ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 22:47:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.082ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 22:47:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.003ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 22:47:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.702ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 22:48:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[68.509ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 22:48:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.845ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 22:48:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[68.432ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 22:48:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.936ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 22:48:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[34.658ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 22:48:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.386ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 22:48:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.882ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 22:48:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.373ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 22:48:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.084ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 22:48:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.601ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 22:48:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[70.402ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 22:48:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.976ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 22:48:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.030ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 22:48:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.445ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 22:48:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.936ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 22:48:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.746ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 22:48:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.159ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 22:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[33.237ms] [rows:1] SELECT count(*) FROM `role`

2025/06/20 22:48:38 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[70.466ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/20 22:48:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.450ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:33:39.222' LIMIT 50

2025/06/20 22:48:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.644ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:48:39.224'

2025/06/20 22:48:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.445ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:33:39.236' LIMIT 50

2025/06/20 22:48:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[69.199ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:48:39.224'

2025/06/20 22:48:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[68.172ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:48:39.224'

2025/06/20 22:48:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.115ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:18:39.623'

2025/06/20 22:48:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.360ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:48:39.692' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:48:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.081ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:48:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.455ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:18:39.745'

2025/06/20 22:48:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.062ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:48:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.252ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:48:39.809' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:48:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[68.952ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:48:39.827' AND status != 'pending'
	

2025/06/20 22:48:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.598ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:48:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.317ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:48:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.866ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:48:39.896' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:48:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.427ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:48:39.935' AND status != 'pending'
	

2025/06/20 22:48:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[68.456ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:48:39.963'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:48:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.004ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:48:39.998' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:48:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.749ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:48:40.061'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:48:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:309
[63.744ms] [rows:1] SELECT * FROM `role` WHERE id = 4 ORDER BY `role`.`id` LIMIT 1

2025/06/20 22:48:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:320
[63.097ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 4

2025/06/20 22:49:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[63.031ms] [rows:1] SELECT * FROM `user` WHERE (username = '16620436582' OR phone = '16620436582') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/20 22:49:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:481
[62.263ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/20 22:49:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:493 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[30.946ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,10,11,12,13,14,15,22,23)

2025/06/20 22:49:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[62.359ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 8 ORDER BY `user`.`user_type` LIMIT 1

2025/06/20 22:49:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:88
[63.296ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/20 22:49:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:104
[62.964ms] [rows:10] SELECT * FROM `permission_user` WHERE id IN (1,2,10,11,12,13,14,15,22,23) ORDER BY sort DESC

2025/06/20 22:49:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[31.310ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 22:49:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.578ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 22:49:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.220ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 22:49:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.323ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 22:49:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.397ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 22:49:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.053ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 22:49:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.332ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 22:49:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.693ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 22:49:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.222ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 22:49:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.299ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 22:49:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.854ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 22:49:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.874ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 22:49:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.395ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 22:49:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.292ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:49:39.224'

2025/06/20 22:49:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.785ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:49:39.224'

2025/06/20 22:49:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.401ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:49:39.224'

2025/06/20 22:49:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.182ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:19:39.623'

2025/06/20 22:49:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.792ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:49:39.687' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:49:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.095ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:49:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[35.311ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:49:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[69.114ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:19:39.747'

2025/06/20 22:49:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.937ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:49:39.816' AND status != 'pending'
	

2025/06/20 22:49:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.879ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:49:39.816' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:49:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.275ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:49:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.870ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:49:39.878' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:49:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.305ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:49:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.125ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:49:39.94'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:49:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.254ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:49:39.95' AND status != 'pending'
	

2025/06/20 22:49:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.592ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:49:40.018' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:49:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.758ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:49:40.085'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[69.399ms] [rows:1] SELECT * FROM `user` WHERE (username = 'admin' OR phone = 'admin') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/20 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:481
[66.798ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 4

2025/06/20 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:493 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[32.558ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,3,4,5,6,7,8,23,24)

2025/06/20 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[33.508ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.683ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.883ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.146ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.278ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.197ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.633ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[69.057ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.098ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.137ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.619ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.587ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.424ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 22:50:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.115ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:35:39.222' LIMIT 50

2025/06/20 22:50:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.396ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:50:39.224'

2025/06/20 22:50:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.327ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:35:39.236' LIMIT 50

2025/06/20 22:50:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[67.558ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:50:39.224'

2025/06/20 22:50:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.433ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:50:39.224'

2025/06/20 22:50:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.211ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:20:39.622'

2025/06/20 22:50:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.380ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:50:39.69' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:50:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.730ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:50:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.808ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:20:39.744'

2025/06/20 22:50:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.064ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:50:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.809ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:50:39.809' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:50:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.918ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:50:39.828' AND status != 'pending'
	

2025/06/20 22:50:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.654ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:50:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.459ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:50:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.838ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:50:39.895' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:50:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.997ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:50:39.94' AND status != 'pending'
	

2025/06/20 22:50:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.687ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:50:39.962'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:50:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.359ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:50:40.005' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:50:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.404ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:50:40.07'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:50:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:38
[32.896ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/20 22:50:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:44
[65.438ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/20 22:51:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[71.096ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:51:39.223'

2025/06/20 22:51:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.515ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:51:39.223'

2025/06/20 22:51:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.904ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:51:39.223'

2025/06/20 22:51:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.846ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:21:39.622'

2025/06/20 22:51:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.122ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:51:39.687' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:51:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.718ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:51:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.579ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:21:39.744'

2025/06/20 22:51:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.015ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:51:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.256ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:51:39.812' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:51:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.063ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:51:39.817' AND status != 'pending'
	

2025/06/20 22:51:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.866ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:51:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.732ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:51:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.166ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:51:39.882' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:51:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.315ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:51:39.948'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:51:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.018ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:51:39.947' AND status != 'pending'
	

2025/06/20 22:51:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.322ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:51:40.014' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:51:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.625ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:51:40.082'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:52:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[69.245ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:52:39.223'

2025/06/20 22:52:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[70.860ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:37:39.221' LIMIT 50

2025/06/20 22:52:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.687ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:37:39.235' LIMIT 50

2025/06/20 22:52:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.910ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:52:39.223'

2025/06/20 22:52:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.677ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:52:39.223'

2025/06/20 22:52:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.867ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:22:39.621'

2025/06/20 22:52:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.371ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:52:39.687' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:52:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.490ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:52:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.344ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:22:39.743'

2025/06/20 22:52:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.328ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:52:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.673ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:52:39.806' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:52:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.939ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:52:39.818' AND status != 'pending'
	

2025/06/20 22:52:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.065ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:52:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.913ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:52:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[69.638ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:52:39.883' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:52:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.139ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:52:39.932' AND status != 'pending'
	

2025/06/20 22:52:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.126ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:52:39.954'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:52:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.833ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:52:39.995' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:52:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.507ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:52:40.058'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:53:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[31.320ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 22:53:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.805ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 22:53:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.030ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 22:53:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.939ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 22:53:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.210ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 22:53:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.792ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 22:53:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.292ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 22:53:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.972ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 22:53:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[68.797ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 22:53:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.118ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 22:53:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.461ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 22:53:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.363ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 22:53:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.243ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 22:53:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:38
[30.838ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/20 22:53:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:44
[61.926ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/20 22:53:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:336
[34.747ms] [rows:1] SELECT count(*) FROM `sys_dict_type`

2025/06/20 22:53:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:336
[63.478ms] [rows:10] SELECT * FROM `sys_dict_type` ORDER BY create_time DESC LIMIT 10

2025/06/20 22:53:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/setting.go:38
[35.728ms] [rows:1] SELECT count(*) FROM `config_setting`

2025/06/20 22:53:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/setting.go:38
[62.729ms] [rows:4] SELECT * FROM `config_setting` LIMIT 10

2025/06/20 22:53:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.730ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:53:39.223'

2025/06/20 22:53:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.047ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:53:39.223'

2025/06/20 22:53:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.604ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:53:39.223'

2025/06/20 22:53:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.885ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:23:39.621'

2025/06/20 22:53:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.391ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:53:39.685' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:53:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.607ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:53:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.599ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:23:39.743'

2025/06/20 22:53:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.845ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:53:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.464ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:53:39.809' AND status != 'pending'
	

2025/06/20 22:53:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.133ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:53:39.809' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:53:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.869ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:53:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.239ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:53:39.872' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:53:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.635ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:53:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.492ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:53:39.935'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:53:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.894ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:53:39.94' AND status != 'pending'
	

2025/06/20 22:53:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.460ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:53:40.005' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:53:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.480ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:53:40.071'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:53:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[32.619ms] [rows:1] SELECT count(*) FROM `role`

2025/06/20 22:53:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[66.000ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/20 22:53:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[68.941ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/20 22:53:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[33.424ms] [rows:20] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/20 22:54:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[36.897ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 22:54:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.161ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 22:54:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.490ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 22:54:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.595ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 22:54:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.281ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 22:54:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.687ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 22:54:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.963ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 22:54:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.331ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 22:54:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.813ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 22:54:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.844ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 22:54:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.276ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 22:54:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.042ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 22:54:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.812ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 22:54:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[72.068ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:54:39.222'

2025/06/20 22:54:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[83.866ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:39:39.237' LIMIT 50

2025/06/20 22:54:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[107.667ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:39:39.221' LIMIT 50

2025/06/20 22:54:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.662ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:54:39.222'

2025/06/20 22:54:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.440ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:54:39.222'

2025/06/20 22:54:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.997ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:24:39.621'

2025/06/20 22:54:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.514ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:54:39.686' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:54:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.474ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:54:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.562ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:24:39.743'

2025/06/20 22:54:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.067ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:54:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.645ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:54:39.809' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:54:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.297ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:54:39.818' AND status != 'pending'
	

2025/06/20 22:54:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.591ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:54:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.444ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:54:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.103ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:54:39.882' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:54:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.713ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:54:39.943' AND status != 'pending'
	

2025/06/20 22:54:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.083ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:54:39.947'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:54:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.214ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:54:40.01' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:54:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.155ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:54:40.078'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[37.732ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.441ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.616ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.090ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[31.535ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.013ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.550ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.317ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.351ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.931ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.811ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.494ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.791ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.858ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.801ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.868ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.257ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.720ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.882ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.126ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.187ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.254ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[68.662ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 22:55:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.977ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 22:55:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.600ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 22:55:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.351ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 22:55:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:79
[66.460ms] [rows:1] SELECT count(*) FROM merchant_revenue_stats FORCE INDEX (idx_stat_date) WHERE tenants_id = 8

2025/06/20 22:55:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/revenue.go:82
[65.764ms] [rows:0] SELECT id, tenants_id, stat_date, total_orders, total_revenue, actual_revenue, paid_orders FROM merchant_revenue_stats FORCE INDEX (idx_stat_date) WHERE tenants_id = 8 ORDER BY stat_date DESC LIMIT 10

2025/06/20 22:55:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[33.979ms] [rows:1] SELECT count(*) FROM `role`

2025/06/20 22:55:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[66.862ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/20 22:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[67.966ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/20 22:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[33.028ms] [rows:1] SELECT count(*) FROM `user`

2025/06/20 22:55:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[66.672ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/20 22:55:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[70.903ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:55:39.222'

2025/06/20 22:55:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.856ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:55:39.222'

2025/06/20 22:55:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[67.674ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:55:39.222'

2025/06/20 22:55:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.572ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:25:39.621'

2025/06/20 22:55:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.472ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:55:39.689' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:55:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.147ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:55:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.899ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:25:39.741'

2025/06/20 22:55:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[35.417ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:55:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.347ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:55:39.808' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:55:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.480ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:55:39.825' AND status != 'pending'
	

2025/06/20 22:55:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.299ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:55:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.711ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:55:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.847ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:55:39.892' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:55:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.966ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:55:39.94' AND status != 'pending'
	

2025/06/20 22:55:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.962ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:55:39.959'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:55:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.891ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:55:40.005' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:55:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.713ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:55:40.072'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:55:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[36.413ms] [rows:1] SELECT count(*) FROM `role`

2025/06/20 22:55:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[65.343ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/20 22:55:44 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[36.714ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/20 22:55:44 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.402ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/20 22:55:44 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.033ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/20 22:55:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.252ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/20 22:55:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.636ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/20 22:55:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.259ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/20 22:55:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.851ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/20 22:55:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.155ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/20 22:55:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.120ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/20 22:55:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.519ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/20 22:55:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.653ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/20 22:55:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.346ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/20 22:55:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.592ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/20 22:55:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[32.355ms] [rows:1] SELECT count(*) FROM `role`

2025/06/20 22:55:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[65.079ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/20 22:56:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.290ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:41:39.219' LIMIT 50

2025/06/20 22:56:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.455ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:56:39.221'

2025/06/20 22:56:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.662ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:41:39.234' LIMIT 50

2025/06/20 22:56:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[68.334ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:56:39.221'

2025/06/20 22:56:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[67.805ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:56:39.221'

2025/06/20 22:56:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.462ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:26:39.62'

2025/06/20 22:56:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[68.623ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:56:39.688' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:56:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.940ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:56:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.575ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:26:39.742'

2025/06/20 22:56:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.281ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:56:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.749ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:56:39.805' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:56:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.689ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:56:39.824' AND status != 'pending'
	

2025/06/20 22:56:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.986ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:56:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.466ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:56:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.187ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:56:39.892' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:56:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.162ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:56:39.931' AND status != 'pending'
	

2025/06/20 22:56:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.529ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:56:39.959'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:56:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.592ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:56:39.994' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:56:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.708ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:56:40.056'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:56:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[31.376ms] [rows:1] SELECT count(*) FROM `role`

2025/06/20 22:56:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[63.226ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/20 22:56:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[63.074ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/20 22:56:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[30.956ms] [rows:1] SELECT count(*) FROM `user`

2025/06/20 22:56:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[63.586ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/20 22:57:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.209ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:57:39.221'

2025/06/20 22:57:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.906ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:57:39.221'

2025/06/20 22:57:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.562ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:57:39.221'

2025/06/20 22:57:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.443ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:27:39.62'

2025/06/20 22:57:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.288ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:57:39.684' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:57:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.883ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:57:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.180ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:27:39.741'

2025/06/20 22:57:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.118ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:57:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.487ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:57:39.809' AND status != 'pending'
	

2025/06/20 22:57:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.114ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:57:39.808' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:57:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.703ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:57:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.179ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:57:39.872' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:57:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.244ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:57:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.366ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:57:39.936'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:57:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.895ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:57:39.943' AND status != 'pending'
	

2025/06/20 22:57:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.490ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:57:40.01' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:57:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.602ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:57:40.077'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:58:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.781ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:58:39.221'

2025/06/20 22:58:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.121ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:43:39.219' LIMIT 50

2025/06/20 22:58:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.077ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:43:39.233' LIMIT 50

2025/06/20 22:58:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.148ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:58:39.221'

2025/06/20 22:58:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.722ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:58:39.221'

2025/06/20 22:58:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.672ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:28:39.619'

2025/06/20 22:58:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.387ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:58:39.683' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:58:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.823ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:58:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.122ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:28:39.74'

2025/06/20 22:58:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.924ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:58:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.680ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:58:39.808' AND status != 'pending'
	

2025/06/20 22:58:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.579ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:58:39.808' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:58:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.044ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:58:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.249ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:58:39.872' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:58:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.980ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:58:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.592ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:58:39.934'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:58:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.550ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:58:39.938' AND status != 'pending'
	

2025/06/20 22:58:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.996ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:58:40.004' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:58:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.401ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:58:40.07'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:59:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.441ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 22:59:39.22'

2025/06/20 22:59:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[67.393ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 22:59:39.22'

2025/06/20 22:59:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.817ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 22:59:39.22'

2025/06/20 22:59:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.713ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:29:39.619'

2025/06/20 22:59:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.009ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:59:39.685' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:59:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.448ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:59:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.037ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:29:39.741'

2025/06/20 22:59:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.709ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:59:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.308ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 21:59:39.804' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 22:59:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.227ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:59:39.815' AND status != 'pending'
	

2025/06/20 22:59:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.616ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 22:59:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.722ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 22:59:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.785ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:59:39.881' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:59:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.799ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 21:59:39.931' AND status != 'pending'
	

2025/06/20 22:59:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.604ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:59:39.946'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 22:59:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.654ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 21:59:39.994' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 22:59:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.694ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 21:59:40.061'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:00:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.145ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:45:39.218' LIMIT 50

2025/06/20 23:00:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.661ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:00:39.22'

2025/06/20 23:00:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.331ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:45:39.232' LIMIT 50

2025/06/20 23:00:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.877ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:00:39.22'

2025/06/20 23:00:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.295ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:00:39.22'

2025/06/20 23:00:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.920ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:30:39.619'

2025/06/20 23:00:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[72.515ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:00:39.685' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:00:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.290ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:00:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.948ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:30:39.74'

2025/06/20 23:00:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.123ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:00:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.324ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:00:39.808' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:00:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.966ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:00:39.823' AND status != 'pending'
	

2025/06/20 23:00:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.021ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:00:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.194ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:00:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.489ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:00:39.889' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:00:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.778ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:00:39.943' AND status != 'pending'
	

2025/06/20 23:00:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.723ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:00:39.953'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:00:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.116ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:00:40.01' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:00:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.278ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:00:40.077'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:01:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.140ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:31:04.771'

2025/06/20 23:01:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.836ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:01:04.834' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:01:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.914ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:01:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.602ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:01:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[186.031ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:31:04.779'

2025/06/20 23:01:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.218ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:01:04.965' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:01:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.922ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:01:04.963' AND status != 'pending'
	

2025/06/20 23:01:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.211ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:01:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.821ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:01:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.786ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:01:05.027' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:01:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.095ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:01:05.085' AND status != 'pending'
	

2025/06/20 23:01:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.172ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:01:05.092'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:01:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.189ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:01:05.145' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:01:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.665ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:01:05.206'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[69.973ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:31:12.707'

2025/06/20 23:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.649ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:01:12.777' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.935ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.009ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[185.482ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:31:12.72'

2025/06/20 23:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.333ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:01:12.893' AND status != 'pending'
	

2025/06/20 23:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.459ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:01:12.906' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:01:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.512ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:01:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.106ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:01:12.952' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:01:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.965ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:01:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.743ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:01:13.009'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:01:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.624ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:01:13.028' AND status != 'pending'
	

2025/06/20 23:01:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.405ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:01:13.087' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:01:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.233ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:01:13.148'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:01:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[72.300ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:31:16.51'

2025/06/20 23:01:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.908ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:01:16.583' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:01:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.756ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:01:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.017ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:01:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[194.969ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:31:16.522'

2025/06/20 23:01:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.919ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:01:16.707' AND status != 'pending'
	

2025/06/20 23:01:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.831ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:01:16.717' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:01:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.285ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:01:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.812ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:01:16.77' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:01:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.352ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:01:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.525ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:01:16.835'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:01:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.874ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:01:16.843' AND status != 'pending'
	

2025/06/20 23:01:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.358ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:01:16.907' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:01:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.656ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:01:16.971'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:01:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.874ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:31:40.583'

2025/06/20 23:01:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.079ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:01:40.644' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:01:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.349ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:01:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.720ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:01:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[203.666ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:31:40.594'

2025/06/20 23:01:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.361ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:01:40.762' AND status != 'pending'
	

2025/06/20 23:01:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.844ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:01:40.798' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:01:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.051ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:01:40.82' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:01:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.702ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:01:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.791ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:01:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.002ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:01:40.878'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:01:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.761ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:01:40.931' AND status != 'pending'
	

2025/06/20 23:01:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.593ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:01:40.998' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:01:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.411ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:01:41.064'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:02:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.196ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:32:05.188'

2025/06/20 23:02:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.066ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:02:05.254' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:02:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.275ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:02:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.915ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:02:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[195.805ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:32:05.2'

2025/06/20 23:02:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.076ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:02:05.379' AND status != 'pending'
	

2025/06/20 23:02:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.633ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:02:05.396' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:02:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.735ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:02:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.101ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:02:05.444' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:02:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.950ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:02:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.651ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:02:05.508'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:02:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.232ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:02:05.521' AND status != 'pending'
	

2025/06/20 23:02:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.660ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:02:05.583' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:02:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.188ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:02:05.645'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:02:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.249ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:32:18.147'

2025/06/20 23:02:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.401ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:02:18.216' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:02:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.965ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:02:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.948ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:02:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[199.787ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:32:18.159'

2025/06/20 23:02:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.926ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:02:18.347' AND status != 'pending'
	

2025/06/20 23:02:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.561ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:02:18.36' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:02:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.595ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:02:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.496ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:02:18.411' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:02:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.671ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:02:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.228ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:02:18.476'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:02:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.468ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:02:18.488' AND status != 'pending'
	

2025/06/20 23:02:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.631ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:02:18.551' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:02:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.519ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:02:18.615'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:02:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[80.524ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:32:52.575'

2025/06/20 23:02:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[73.149ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:02:52.656' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:02:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[38.349ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:02:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[41.321ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:02:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[222.453ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:32:52.588'

2025/06/20 23:02:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[69.530ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:02:52.81' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:02:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[72.659ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:02:52.811' AND status != 'pending'
	

2025/06/20 23:02:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.040ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:02:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[37.612ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:02:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[69.996ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:02:52.884' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:02:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[75.331ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:02:52.948' AND status != 'pending'
	

2025/06/20 23:02:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[69.576ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:02:52.954'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:02:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[74.211ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:02:53.024' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:02:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.231ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:02:53.098'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:03:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.404ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:03:52.573'

2025/06/20 23:03:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.537ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:03:52.573'

2025/06/20 23:03:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.952ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:03:52.573'

2025/06/20 23:03:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.470ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:33:53.026'

2025/06/20 23:03:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.252ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:03:53.088' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:03:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.761ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:03:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.805ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:03:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.889ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:33:53.165'

2025/06/20 23:03:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.169ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:03:53.212' AND status != 'pending'
	

2025/06/20 23:03:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.688ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:03:53.229' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:03:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.815ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:03:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.700ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:03:53.276' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:03:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.591ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:03:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.120ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:03:53.337'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:03:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.157ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:03:53.356' AND status != 'pending'
	

2025/06/20 23:03:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.269ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:03:53.419' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:03:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.397ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:03:53.483'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:04:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.407ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:49:52.574' LIMIT 50

2025/06/20 23:04:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.884ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:04:52.574'

2025/06/20 23:04:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.045ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:04:52.574'

2025/06/20 23:04:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.692ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:04:52.574'

2025/06/20 23:04:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[192.762ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:49:52.59' LIMIT 50

2025/06/20 23:04:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.512ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:34:53.027'

2025/06/20 23:04:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.853ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:04:53.09' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:04:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.601ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:04:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.808ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:04:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.484ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:34:53.167'

2025/06/20 23:04:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.039ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:04:53.214' AND status != 'pending'
	

2025/06/20 23:04:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.755ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:04:53.23' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:04:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.123ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:04:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.991ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:04:53.276' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:04:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.209ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:04:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.257ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:04:53.338'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:04:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.943ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:04:53.355' AND status != 'pending'
	

2025/06/20 23:04:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.711ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:04:53.418' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:04:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.190ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:04:53.481'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:05:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.603ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:05:52.574'

2025/06/20 23:05:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.604ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:05:52.574'

2025/06/20 23:05:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.228ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:05:52.574'

2025/06/20 23:05:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.420ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:35:53.027'

2025/06/20 23:05:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.079ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:05:53.091' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:05:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.958ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:05:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.374ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:05:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.499ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:35:53.167'

2025/06/20 23:05:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.854ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:05:53.218' AND status != 'pending'
	

2025/06/20 23:05:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.374ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:05:53.229' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:05:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.020ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:05:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.923ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:05:53.281' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:05:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.474ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:05:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.532ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:05:53.344'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:05:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.850ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:05:53.351' AND status != 'pending'
	

2025/06/20 23:05:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.063ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:05:53.413' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:05:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.005ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:05:53.476'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:06:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.631ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:06:52.575'

2025/06/20 23:06:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[68.351ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:51:52.575' LIMIT 50

2025/06/20 23:06:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.307ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:51:52.591' LIMIT 50

2025/06/20 23:06:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.815ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:06:52.575'

2025/06/20 23:06:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.557ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:06:52.575'

2025/06/20 23:06:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.772ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:36:53.028'

2025/06/20 23:06:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.276ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:06:53.093' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:06:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.841ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:06:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.028ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:06:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.509ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:36:53.167'

2025/06/20 23:06:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.890ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:06:53.215' AND status != 'pending'
	

2025/06/20 23:06:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.584ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:06:53.228' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:06:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.203ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:06:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.839ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:06:53.277' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:06:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.264ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:06:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.672ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:06:53.339'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:06:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.763ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:06:53.348' AND status != 'pending'
	

2025/06/20 23:06:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.521ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:06:53.407' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:06:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.856ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:06:53.467'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:07:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.875ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:07:52.576'

2025/06/20 23:07:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.207ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:07:52.576'

2025/06/20 23:07:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.314ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:07:52.576'

2025/06/20 23:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.424ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:37:53.029'

2025/06/20 23:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.860ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:07:53.09' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.011ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.463ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.137ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:37:53.167'

2025/06/20 23:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.052ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:07:53.212' AND status != 'pending'
	

2025/06/20 23:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.513ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:07:53.229' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.580ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.861ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:07:53.272' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.999ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.735ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:07:53.332'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.021ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:07:53.354' AND status != 'pending'
	

2025/06/20 23:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.789ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:07:53.416' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:07:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.268ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:07:53.478'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:08:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.725ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:08:52.577'

2025/06/20 23:08:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.723ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:53:52.577' LIMIT 50

2025/06/20 23:08:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.797ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:53:52.593' LIMIT 50

2025/06/20 23:08:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.637ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:08:52.577'

2025/06/20 23:08:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.917ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:08:52.577'

2025/06/20 23:08:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.201ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:38:53.03'

2025/06/20 23:08:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.453ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:08:53.091' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:08:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.901ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:08:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.779ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:08:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.021ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:38:53.168'

2025/06/20 23:08:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.657ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:08:53.212' AND status != 'pending'
	

2025/06/20 23:08:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.972ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:08:53.231' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:08:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.146ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:08:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.878ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:08:53.272' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:08:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.940ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:08:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.486ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:08:53.332'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:08:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.403ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:08:53.358' AND status != 'pending'
	

2025/06/20 23:08:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.894ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:08:53.421' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:08:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.042ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:08:53.484'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:09:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.479ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:09:52.577'

2025/06/20 23:09:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.042ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:09:52.577'

2025/06/20 23:09:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.665ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:09:52.577'

2025/06/20 23:09:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.425ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:39:53.03'

2025/06/20 23:09:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.055ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:09:53.094' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:09:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.123ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:09:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.245ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:09:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.706ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:39:53.17'

2025/06/20 23:09:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.581ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:09:53.22' AND status != 'pending'
	

2025/06/20 23:09:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.688ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:09:53.23' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:09:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.921ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:09:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.348ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:09:53.284' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:09:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.748ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:09:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.935ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:09:53.347'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:09:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.336ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:09:53.35' AND status != 'pending'
	

2025/06/20 23:09:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.771ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:09:53.411' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:09:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.019ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:09:53.471'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:10:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.818ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:10:52.578'

2025/06/20 23:10:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.347ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:55:52.578' LIMIT 50

2025/06/20 23:10:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.684ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:55:52.594' LIMIT 50

2025/06/20 23:10:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.025ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:10:52.578'

2025/06/20 23:10:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.340ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:10:52.578'

2025/06/20 23:10:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.241ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:40:53.03'

2025/06/20 23:10:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.179ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:10:53.092' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:10:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.672ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:10:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.772ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:10:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.227ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:40:53.169'

2025/06/20 23:10:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.776ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:10:53.212' AND status != 'pending'
	

2025/06/20 23:10:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.886ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:10:53.231' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:10:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.399ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:10:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.007ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:10:53.272' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:10:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.815ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:10:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.648ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:10:53.332'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:10:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.254ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:10:53.354' AND status != 'pending'
	

2025/06/20 23:10:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.983ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:10:53.417' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:10:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.904ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:10:53.479'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:11:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.251ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:11:52.581'

2025/06/20 23:11:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.967ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:11:52.581'

2025/06/20 23:11:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.170ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:11:52.581'

2025/06/20 23:11:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.697ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:41:53.032'

2025/06/20 23:11:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.932ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:11:53.095' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:11:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.623ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:11:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.106ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:11:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.773ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:41:53.17'

2025/06/20 23:11:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.764ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:11:53.219' AND status != 'pending'
	

2025/06/20 23:11:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.799ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:11:53.231' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:11:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.839ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:11:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.948ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:11:53.281' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:11:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.675ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:11:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.151ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:11:53.343'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:11:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.468ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:11:53.351' AND status != 'pending'
	

2025/06/20 23:11:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.936ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:11:53.41' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:11:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.859ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:11:53.47'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:12:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.685ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:12:52.579'

2025/06/20 23:12:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.884ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:57:52.58' LIMIT 50

2025/06/20 23:12:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.253ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:57:52.596' LIMIT 50

2025/06/20 23:12:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.126ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:12:52.579'

2025/06/20 23:12:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.365ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:12:52.579'

2025/06/20 23:12:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.964ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:42:53.034'

2025/06/20 23:12:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.617ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:12:53.095' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:12:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.220ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:12:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.675ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:12:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.332ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:42:53.173'

2025/06/20 23:12:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.050ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:12:53.215' AND status != 'pending'
	

2025/06/20 23:12:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.132ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:12:53.236' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:12:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.958ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:12:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.442ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:12:53.275' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:12:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.467ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:12:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.805ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:12:53.335'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:12:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.264ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:12:53.362' AND status != 'pending'
	

2025/06/20 23:12:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.076ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:12:53.425' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:12:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.022ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:12:53.488'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:13:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.062ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:13:52.58'

2025/06/20 23:13:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.607ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:13:52.58'

2025/06/20 23:13:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.486ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:13:52.58'

2025/06/20 23:13:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.366ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:43:53.033'

2025/06/20 23:13:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.771ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:13:53.096' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:13:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.844ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:13:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.490ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:13:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.055ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:43:53.173'

2025/06/20 23:13:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.045ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:13:53.222' AND status != 'pending'
	

2025/06/20 23:13:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.338ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:13:53.234' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:13:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.783ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:13:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.595ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:13:53.285' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:13:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.721ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:13:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.922ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:13:53.348'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:13:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.099ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:13:53.354' AND status != 'pending'
	

2025/06/20 23:13:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.674ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:13:53.414' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:13:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.483ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:13:53.475'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:14:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.731ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:59:52.582' LIMIT 50

2025/06/20 23:14:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.604ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:14:52.582'

2025/06/20 23:14:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.078ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:59:52.597' LIMIT 50

2025/06/20 23:14:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.745ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:14:52.582'

2025/06/20 23:14:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.311ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:14:52.582'

2025/06/20 23:14:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.246ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:44:53.035'

2025/06/20 23:14:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.368ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:14:53.099' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:14:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.681ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:14:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.284ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:14:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.405ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:44:53.174'

2025/06/20 23:14:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.837ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:14:53.226' AND status != 'pending'
	

2025/06/20 23:14:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.462ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:14:53.237' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:14:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.848ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:14:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.965ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:14:53.289' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:14:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.683ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:14:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.808ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:14:53.352'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:14:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.280ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:14:53.362' AND status != 'pending'
	

2025/06/20 23:14:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.719ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:14:53.424' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:14:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.913ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:14:53.487'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:15:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.098ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:15:52.582'

2025/06/20 23:15:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.304ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:15:52.582'

2025/06/20 23:15:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.288ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:15:52.582'

2025/06/20 23:15:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.090ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:45:53.036'

2025/06/20 23:15:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.631ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:15:53.099' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:15:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.923ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:15:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.947ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:15:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.614ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:45:53.174'

2025/06/20 23:15:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.721ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:15:53.224' AND status != 'pending'
	

2025/06/20 23:15:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.054ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:15:53.237' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:15:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.418ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:15:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.718ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:15:53.286' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:15:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.888ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:15:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.673ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:15:53.349'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:15:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.775ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:15:53.364' AND status != 'pending'
	

2025/06/20 23:15:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.710ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:15:53.427' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:15:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.600ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:15:53.491'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:16:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.256ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:01:52.583' LIMIT 50

2025/06/20 23:16:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.330ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:16:52.584'

2025/06/20 23:16:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.391ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:01:52.6' LIMIT 50

2025/06/20 23:16:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.134ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:16:52.584'

2025/06/20 23:16:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.912ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:16:52.584'

2025/06/20 23:16:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.748ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:46:53.037'

2025/06/20 23:16:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.941ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:16:53.101' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:16:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.456ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:16:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.326ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:16:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.509ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:46:53.174'

2025/06/20 23:16:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.019ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:16:53.227' AND status != 'pending'
	

2025/06/20 23:16:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.531ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:16:53.235' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:16:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.312ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:16:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.393ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:16:53.29' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:16:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.907ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:16:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.385ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:16:53.355' AND status != 'pending'
	

2025/06/20 23:16:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.890ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:16:53.354'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:16:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.006ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:16:53.415' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:16:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.153ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:16:53.476'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:17:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.229ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:17:52.583'

2025/06/20 23:17:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.503ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:17:52.583'

2025/06/20 23:17:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.853ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:17:52.583'

2025/06/20 23:17:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.787ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:47:53.036'

2025/06/20 23:17:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.410ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:17:53.098' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:17:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.245ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:17:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.483ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:17:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.845ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:47:53.175'

2025/06/20 23:17:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.919ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:17:53.219' AND status != 'pending'
	

2025/06/20 23:17:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.766ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:17:53.238' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:17:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.314ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:17:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.005ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:17:53.28' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:17:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.875ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:17:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.945ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:17:53.342'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:17:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.108ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:17:53.366' AND status != 'pending'
	

2025/06/20 23:17:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.252ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:17:53.432' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:17:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.092ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:17:53.496'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:18:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.081ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:03:52.584' LIMIT 50

2025/06/20 23:18:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.396ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:18:52.584'

2025/06/20 23:18:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.786ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:03:52.6' LIMIT 50

2025/06/20 23:18:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.705ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:18:52.584'

2025/06/20 23:18:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.046ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:18:52.584'

2025/06/20 23:18:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.611ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:48:53.037'

2025/06/20 23:18:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.896ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:18:53.102' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:18:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.623ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:18:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[35.889ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:18:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.412ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:48:53.176'

2025/06/20 23:18:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.891ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:18:53.235' AND status != 'pending'
	

2025/06/20 23:18:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.520ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:18:53.238' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:18:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.324ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:18:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.159ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:18:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.451ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:18:53.3' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:18:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.573ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:18:53.366' AND status != 'pending'
	

2025/06/20 23:18:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.615ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:18:53.366'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:18:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.037ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:18:53.431' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:18:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.030ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:18:53.497'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:19:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.325ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:19:52.584'

2025/06/20 23:19:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.074ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:19:52.584'

2025/06/20 23:19:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.762ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:19:52.584'

2025/06/20 23:19:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.245ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:49:53.038'

2025/06/20 23:19:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.680ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:19:53.102' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:19:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.626ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:19:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.822ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:19:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.931ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:49:53.177'

2025/06/20 23:19:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.090ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:19:53.226' AND status != 'pending'
	

2025/06/20 23:19:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.650ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:19:53.241' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:19:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.522ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:19:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.168ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:19:53.287' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:19:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.153ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:19:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.416ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:19:53.35'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:19:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.675ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:19:53.367' AND status != 'pending'
	

2025/06/20 23:19:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.745ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:19:53.43' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:19:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.996ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:19:53.493'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:20:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[69.104ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:05:52.586' LIMIT 50

2025/06/20 23:20:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[69.400ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:20:52.585'

2025/06/20 23:20:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[70.961ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:05:52.601' LIMIT 50

2025/06/20 23:20:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.329ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:20:52.585'

2025/06/20 23:20:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.111ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:20:52.585'

2025/06/20 23:20:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[73.675ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:50:53.039'

2025/06/20 23:20:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.540ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:20:53.113' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:20:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.595ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:20:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.854ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:50:53.178'

2025/06/20 23:20:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.288ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:20:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.517ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:20:53.243' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:20:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.878ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:20:53.244' AND status != 'pending'
	

2025/06/20 23:20:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.955ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:20:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.147ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:20:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.041ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:20:53.306' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:20:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.519ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:20:53.364' AND status != 'pending'
	

2025/06/20 23:20:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[71.721ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:20:53.372'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:20:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.669ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:20:53.43' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:20:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.792ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:20:53.491'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:21:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.304ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:21:52.586'

2025/06/20 23:21:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.371ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:21:52.586'

2025/06/20 23:21:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.840ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:21:52.586'

2025/06/20 23:21:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.935ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:51:53.039'

2025/06/20 23:21:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.923ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:21:53.101' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:21:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.222ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:21:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.252ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:21:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.303ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:51:53.178'

2025/06/20 23:21:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.549ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:21:53.222' AND status != 'pending'
	

2025/06/20 23:21:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.877ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:21:53.242' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:21:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.568ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:21:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.667ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:21:53.282' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:21:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.384ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:21:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.132ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:21:53.343'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:21:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.304ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:21:53.368' AND status != 'pending'
	

2025/06/20 23:21:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.774ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:21:53.432' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:21:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.406ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:21:53.495'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:22:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.059ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:22:52.587'

2025/06/20 23:22:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[68.290ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:07:52.587' LIMIT 50

2025/06/20 23:22:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.479ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:07:52.603' LIMIT 50

2025/06/20 23:22:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.377ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:22:52.587'

2025/06/20 23:22:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.066ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:22:52.587'

2025/06/20 23:22:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.962ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:52:53.039'

2025/06/20 23:22:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.556ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:22:53.1' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:22:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.362ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:22:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.783ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:22:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.794ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:52:53.179'

2025/06/20 23:22:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.689ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:22:53.222' AND status != 'pending'
	

2025/06/20 23:22:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.780ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:22:53.243' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:22:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.627ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:22:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.785ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:22:53.281' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:22:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.963ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:22:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.084ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:22:53.341'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:22:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.829ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:22:53.367' AND status != 'pending'
	

2025/06/20 23:22:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.804ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:22:53.429' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:22:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.785ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:22:53.491'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:23:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.554ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:23:52.587'

2025/06/20 23:23:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.846ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:23:52.587'

2025/06/20 23:23:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.879ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:23:52.587'

2025/06/20 23:23:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.451ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:53:53.041'

2025/06/20 23:23:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.855ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:23:53.102' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:23:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.703ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:23:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.758ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:23:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.659ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:53:53.18'

2025/06/20 23:23:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.785ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:23:53.226' AND status != 'pending'
	

2025/06/20 23:23:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.402ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:23:53.242' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:23:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.972ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:23:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.793ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:23:53.288' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:23:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.703ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:23:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.793ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:23:53.351'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:23:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.040ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:23:53.361' AND status != 'pending'
	

2025/06/20 23:23:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.029ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:23:53.42' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:23:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.293ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:23:53.481'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:24:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.306ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:09:52.589' LIMIT 50

2025/06/20 23:24:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.932ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:24:52.588'

2025/06/20 23:24:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.483ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:09:52.605' LIMIT 50

2025/06/20 23:24:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.056ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:24:52.588'

2025/06/20 23:24:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.242ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:24:52.588'

2025/06/20 23:24:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.361ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:54:53.041'

2025/06/20 23:24:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.683ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:24:53.103' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:24:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.703ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:24:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.731ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:24:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.381ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:54:53.18'

2025/06/20 23:24:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.382ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:24:53.227' AND status != 'pending'
	

2025/06/20 23:24:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.849ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:24:53.244' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:24:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.195ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:24:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.809ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:24:53.289' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:24:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.133ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:24:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.434ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:24:53.351'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:24:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.763ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:24:53.37' AND status != 'pending'
	

2025/06/20 23:24:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.127ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:24:53.433' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:24:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.959ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:24:53.496'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:25:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.969ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:25:52.589'

2025/06/20 23:25:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.535ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:25:52.589'

2025/06/20 23:25:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.594ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:25:52.589'

2025/06/20 23:25:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.580ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:55:53.041'

2025/06/20 23:25:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.526ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:25:53.105' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:25:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.099ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:25:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.424ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:25:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.978ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:55:53.181'

2025/06/20 23:25:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.937ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:25:53.231' AND status != 'pending'
	

2025/06/20 23:25:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.621ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:25:53.243' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:25:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.642ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:25:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.674ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:25:53.294' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:25:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.003ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:25:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.859ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:25:53.357'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:25:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.180ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:25:53.367' AND status != 'pending'
	

2025/06/20 23:25:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.058ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:25:53.433' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:25:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.403ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:25:53.495'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:26:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[71.376ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:26:52.59'

2025/06/20 23:26:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[71.926ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:11:52.59' LIMIT 50

2025/06/20 23:26:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[68.359ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:11:52.607' LIMIT 50

2025/06/20 23:26:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.256ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:26:52.59'

2025/06/20 23:26:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[77.776ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:26:52.59'

2025/06/20 23:26:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.224ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:56:53.044'

2025/06/20 23:26:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.213ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:26:53.112' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:26:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[35.046ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:26:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[69.307ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:56:53.181'

2025/06/20 23:26:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[35.351ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:26:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.393ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:26:53.25' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:26:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[71.434ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:26:53.251' AND status != 'pending'
	

2025/06/20 23:26:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.643ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:26:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.993ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:26:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.499ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:26:53.322' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:26:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.680ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:26:53.378' AND status != 'pending'
	

2025/06/20 23:26:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[69.709ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:26:53.386'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:26:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.420ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:26:53.443' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:26:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.895ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:26:53.507'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:27:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.545ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:27:52.59'

2025/06/20 23:27:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.697ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:27:52.59'

2025/06/20 23:27:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.696ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:27:52.59'

2025/06/20 23:27:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.055ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:57:53.044'

2025/06/20 23:27:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.483ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:27:53.105' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:27:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.771ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:27:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.932ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:27:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.543ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:57:53.183'

2025/06/20 23:27:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.000ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:27:53.225' AND status != 'pending'
	

2025/06/20 23:27:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.540ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:27:53.244' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:27:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.074ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:27:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.011ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:27:53.285' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:27:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.459ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:27:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.096ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:27:53.345'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:27:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.812ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:27:53.369' AND status != 'pending'
	

2025/06/20 23:27:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.652ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:27:53.431' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:27:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.916ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:27:53.493'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:28:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.358ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:13:52.591' LIMIT 50

2025/06/20 23:28:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.641ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:28:52.591'

2025/06/20 23:28:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.236ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:13:52.608' LIMIT 50

2025/06/20 23:28:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.201ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:28:52.591'

2025/06/20 23:28:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.289ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:28:52.591'

2025/06/20 23:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.653ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:58:53.044'

2025/06/20 23:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.535ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:28:53.107' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.428ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.612ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.099ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:58:53.183'

2025/06/20 23:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.036ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:28:53.231' AND status != 'pending'
	

2025/06/20 23:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.594ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:28:53.247' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.315ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.391ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:28:53.294' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.414ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.300ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:28:53.357'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.465ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:28:53.373' AND status != 'pending'
	

2025/06/20 23:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.100ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:28:53.435' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:28:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.920ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:28:53.499'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:29:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.583ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:29:52.592'

2025/06/20 23:29:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[69.626ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:29:52.592'

2025/06/20 23:29:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[71.977ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:29:52.592'

2025/06/20 23:29:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.713ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:59:53.045'

2025/06/20 23:29:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[69.709ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:29:53.121' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:29:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.631ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:29:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.993ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 22:59:53.184'

2025/06/20 23:29:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.549ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:29:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.351ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:29:53.251' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:29:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.571ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:29:53.255' AND status != 'pending'
	

2025/06/20 23:29:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.924ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:29:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.231ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:29:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.659ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:29:53.318' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:29:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.243ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:29:53.377' AND status != 'pending'
	

2025/06/20 23:29:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.039ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:29:53.381'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:29:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.919ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:29:53.441' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:29:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[68.780ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:29:53.505'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:30:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.476ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:30:52.592'

2025/06/20 23:30:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.179ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:15:52.593' LIMIT 50

2025/06/20 23:30:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.622ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:15:52.609' LIMIT 50

2025/06/20 23:30:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.818ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:30:52.592'

2025/06/20 23:30:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.640ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:30:52.592'

2025/06/20 23:30:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.327ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:00:53.046'

2025/06/20 23:30:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.609ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:30:53.108' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:30:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.755ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:30:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.051ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:30:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.609ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:00:53.184'

2025/06/20 23:30:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.037ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:30:53.232' AND status != 'pending'
	

2025/06/20 23:30:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.615ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:30:53.244' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:30:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.300ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:30:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.606ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:30:53.294' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:30:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.038ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:30:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.760ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:30:53.356'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:30:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.861ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:30:53.364' AND status != 'pending'
	

2025/06/20 23:30:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.364ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:30:53.424' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:30:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.077ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:30:53.485'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:31:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.348ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:31:52.593'

2025/06/20 23:31:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.806ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:31:52.593'

2025/06/20 23:31:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.172ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:31:52.593'

2025/06/20 23:31:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.765ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:01:53.047'

2025/06/20 23:31:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.676ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:31:53.108' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:31:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.172ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:31:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.114ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:31:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.623ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:01:53.186'

2025/06/20 23:31:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.987ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:31:53.227' AND status != 'pending'
	

2025/06/20 23:31:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.794ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:31:53.247' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:31:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.824ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:31:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.337ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:31:53.287' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:31:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.605ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:31:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.122ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:31:53.348'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:31:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.705ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:31:53.371' AND status != 'pending'
	

2025/06/20 23:31:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.263ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:31:53.433' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:31:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.240ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:31:53.496'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:32:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.253ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:17:52.594' LIMIT 50

2025/06/20 23:32:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.592ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:32:52.594'

2025/06/20 23:32:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.847ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:17:52.61' LIMIT 50

2025/06/20 23:32:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.922ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:32:52.594'

2025/06/20 23:32:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.603ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:32:52.594'

2025/06/20 23:32:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.441ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:02:53.047'

2025/06/20 23:32:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.277ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:32:53.111' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:32:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.993ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:32:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.006ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:32:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.675ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:02:53.186'

2025/06/20 23:32:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.365ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:32:53.236' AND status != 'pending'
	

2025/06/20 23:32:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[68.648ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:32:53.249' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:32:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.963ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:32:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.554ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:32:53.298' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:32:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.154ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:32:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.532ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:32:53.359'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:32:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.858ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:32:53.38' AND status != 'pending'
	

2025/06/20 23:32:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.969ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:32:53.443' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:32:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.864ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:32:53.507'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:33:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.380ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:33:52.595'

2025/06/20 23:33:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.496ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:33:52.595'

2025/06/20 23:33:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.374ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:33:52.595'

2025/06/20 23:33:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[69.270ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:03:53.047'

2025/06/20 23:33:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.416ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:33:53.116' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:33:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.489ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:33:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.315ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:33:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.226ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:03:53.187'

2025/06/20 23:33:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.802ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:33:53.247' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:33:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.411ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:33:53.246' AND status != 'pending'
	

2025/06/20 23:33:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.797ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:33:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.694ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:33:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.688ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:33:53.31' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:33:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.664ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:33:53.371' AND status != 'pending'
	

2025/06/20 23:33:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.733ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:33:53.371'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:33:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.067ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:33:53.433' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:33:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.707ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:33:53.495'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:34:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.569ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:34:52.595'

2025/06/20 23:34:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.739ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:19:52.596' LIMIT 50

2025/06/20 23:34:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.008ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:19:52.612' LIMIT 50

2025/06/20 23:34:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.480ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:34:52.595'

2025/06/20 23:34:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.626ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:34:52.595'

2025/06/20 23:34:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.213ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:04:53.049'

2025/06/20 23:34:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.196ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:34:53.112' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:34:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.467ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:34:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.715ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:34:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.173ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:04:53.188'

2025/06/20 23:34:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.869ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:34:53.235' AND status != 'pending'
	

2025/06/20 23:34:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.150ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:34:53.248' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:34:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.784ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:34:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.993ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:34:53.297' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:34:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.040ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:34:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.423ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:34:53.359'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:34:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.554ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:34:53.369' AND status != 'pending'
	

2025/06/20 23:34:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.579ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:34:53.428' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:34:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.802ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:34:53.489'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:35:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.035ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:35:52.596'

2025/06/20 23:35:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.742ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:35:52.596'

2025/06/20 23:35:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.738ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:35:52.596'

2025/06/20 23:35:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.527ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:05:53.049'

2025/06/20 23:35:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.731ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:35:53.109' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:35:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.073ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:35:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.143ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:35:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.917ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:05:53.188'

2025/06/20 23:35:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.437ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:35:53.23' AND status != 'pending'
	

2025/06/20 23:35:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.625ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:35:53.251' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:35:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.410ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:35:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.270ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:35:53.289' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:35:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.106ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:35:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.120ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:35:53.35'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:35:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.007ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:35:53.377' AND status != 'pending'
	

2025/06/20 23:35:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.815ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:35:53.439' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:35:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.678ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:35:53.504'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:36:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.137ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:36:52.597'

2025/06/20 23:36:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.852ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:21:52.597' LIMIT 50

2025/06/20 23:36:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.653ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:21:52.613' LIMIT 50

2025/06/20 23:36:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.601ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:36:52.597'

2025/06/20 23:36:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.888ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:36:52.597'

2025/06/20 23:36:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.346ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:06:53.049'

2025/06/20 23:36:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.589ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:36:53.111' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:36:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.006ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:36:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.993ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:36:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.823ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:06:53.189'

2025/06/20 23:36:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.533ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:36:53.232' AND status != 'pending'
	

2025/06/20 23:36:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.195ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:36:53.252' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:36:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.087ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:36:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.882ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:36:53.292' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:36:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.083ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:36:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.962ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:36:53.353'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:36:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.765ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:36:53.378' AND status != 'pending'
	

2025/06/20 23:36:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.008ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:36:53.441' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:36:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.737ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:36:53.504'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:37:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.028ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:37:52.598'

2025/06/20 23:37:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.731ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:37:52.598'

2025/06/20 23:37:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.585ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:37:52.598'

2025/06/20 23:37:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.675ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:07:53.051'

2025/06/20 23:37:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.714ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:37:53.115' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:37:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.306ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:37:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.290ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:37:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.172ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:07:53.19'

2025/06/20 23:37:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.328ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:37:53.241' AND status != 'pending'
	

2025/06/20 23:37:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.133ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:37:53.251' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:37:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.685ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:37:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.536ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:37:53.303' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:37:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.496ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:37:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.977ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:37:53.367'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:37:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.868ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:37:53.373' AND status != 'pending'
	

2025/06/20 23:37:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.941ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:37:53.433' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:37:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.531ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:37:53.493'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:38:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.720ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:23:52.599' LIMIT 50

2025/06/20 23:38:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.536ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:38:52.598'

2025/06/20 23:38:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.668ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:23:52.615' LIMIT 50

2025/06/20 23:38:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.080ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:38:52.598'

2025/06/20 23:38:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.250ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:38:52.598'

2025/06/20 23:38:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.289ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:08:53.051'

2025/06/20 23:38:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.477ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:38:53.115' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:38:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.993ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:38:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.543ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:38:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.677ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:08:53.191'

2025/06/20 23:38:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.877ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:38:53.24' AND status != 'pending'
	

2025/06/20 23:38:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.994ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:38:53.252' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:38:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.023ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:38:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.809ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:38:53.303' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:38:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.373ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:38:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.013ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:38:53.366'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:38:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.031ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:38:53.376' AND status != 'pending'
	

2025/06/20 23:38:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.968ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:38:53.439' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:38:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.443ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:38:53.501'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:39:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.804ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:39:52.599'

2025/06/20 23:39:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.583ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:39:52.599'

2025/06/20 23:39:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.283ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:39:52.599'

2025/06/20 23:39:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.238ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:09:53.052'

2025/06/20 23:39:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.586ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:39:53.114' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:39:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.765ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:39:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.598ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:39:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.318ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:09:53.191'

2025/06/20 23:39:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.275ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:39:53.238' AND status != 'pending'
	

2025/06/20 23:39:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.585ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:39:53.255' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:39:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.423ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:39:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.768ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:39:53.3' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:39:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.255ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:39:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.102ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:39:53.362'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:39:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.691ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:39:53.38' AND status != 'pending'
	

2025/06/20 23:39:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.958ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:39:53.443' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:39:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.011ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:39:53.506'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:40:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[68.314ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:25:52.6' LIMIT 50

2025/06/20 23:40:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.547ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:40:52.6'

2025/06/20 23:40:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.831ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:25:52.616' LIMIT 50

2025/06/20 23:40:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.921ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:40:52.6'

2025/06/20 23:40:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.381ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:40:52.6'

2025/06/20 23:40:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.835ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:10:53.053'

2025/06/20 23:40:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.159ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:40:53.115' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:40:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.559ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:40:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.021ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:40:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.231ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:10:53.191'

2025/06/20 23:40:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.534ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:40:53.238' AND status != 'pending'
	

2025/06/20 23:40:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.810ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:40:53.251' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:40:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.669ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:40:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.330ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:40:53.3' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:40:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.774ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:40:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.849ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:40:53.361'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:40:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.013ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:40:53.371' AND status != 'pending'
	

2025/06/20 23:40:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.850ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:40:53.433' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:40:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.791ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:40:53.493'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:41:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.468ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:41:52.601'

2025/06/20 23:41:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.986ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:41:52.601'

2025/06/20 23:41:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.643ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:41:52.601'

2025/06/20 23:41:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.294ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:11:53.053'

2025/06/20 23:41:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.038ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:41:53.114' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:41:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.541ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:41:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.563ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:41:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.179ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:11:53.192'

2025/06/20 23:41:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.194ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:41:53.234' AND status != 'pending'
	

2025/06/20 23:41:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.036ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:41:53.254' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:41:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.757ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:41:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.269ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:41:53.293' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:41:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.688ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:41:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.347ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:41:53.354'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:41:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.988ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:41:53.379' AND status != 'pending'
	

2025/06/20 23:41:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.034ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:41:53.442' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:41:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.535ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:41:53.504'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:42:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.977ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:27:52.601' LIMIT 50

2025/06/20 23:42:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.497ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:42:52.601'

2025/06/20 23:42:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.169ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:27:52.617' LIMIT 50

2025/06/20 23:42:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.504ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:42:52.601'

2025/06/20 23:42:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.378ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:42:52.601'

2025/06/20 23:42:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.238ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:12:53.055'

2025/06/20 23:42:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.458ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:42:53.12' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:42:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.395ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:42:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.705ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:42:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.907ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:12:53.193'

2025/06/20 23:42:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.000ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:42:53.247' AND status != 'pending'
	

2025/06/20 23:42:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.411ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:42:53.26' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:42:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.557ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:42:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.860ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:42:53.31' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:42:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.350ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:42:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.664ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:42:53.373'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:42:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.992ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:42:53.389' AND status != 'pending'
	

2025/06/20 23:42:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.820ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:42:53.453' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:42:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.099ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:42:53.515'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:43:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.537ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:43:52.602'

2025/06/20 23:43:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.347ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:43:52.602'

2025/06/20 23:43:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.801ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:43:52.602'

2025/06/20 23:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.127ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:13:53.055'

2025/06/20 23:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.219ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:43:53.119' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.169ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.321ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.513ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:13:53.194'

2025/06/20 23:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.763ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:43:53.244' AND status != 'pending'
	

2025/06/20 23:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.057ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:43:53.256' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.519ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.851ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:43:53.307' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.737ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.788ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:43:53.37'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.407ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:43:53.38' AND status != 'pending'
	

2025/06/20 23:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.050ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:43:53.441' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.494ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:43:53.504'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:44:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.709ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:44:52.603'

2025/06/20 23:44:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.458ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:29:52.603' LIMIT 50

2025/06/20 23:44:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.102ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:29:52.619' LIMIT 50

2025/06/20 23:44:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.273ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:44:52.603'

2025/06/20 23:44:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.409ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:44:52.603'

2025/06/20 23:44:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.038ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:14:53.056'

2025/06/20 23:44:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.977ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:44:53.117' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:44:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.488ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:44:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.957ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:44:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.559ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:14:53.195'

2025/06/20 23:44:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.762ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:44:53.241' AND status != 'pending'
	

2025/06/20 23:44:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.797ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:44:53.255' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:44:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.031ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:44:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.693ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:44:53.303' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:44:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.045ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:44:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.024ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:44:53.365'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:44:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.104ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:44:53.376' AND status != 'pending'
	

2025/06/20 23:44:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.946ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:44:53.436' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:44:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.792ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:44:53.497'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:45:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.827ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:15:19.949'

2025/06/20 23:45:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.180ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:45:20.018' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:45:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.822ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:45:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.028ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:45:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[191.385ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:15:19.955'

2025/06/20 23:45:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.704ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:45:20.137' AND status != 'pending'
	

2025/06/20 23:45:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.337ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:45:20.146' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:45:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.735ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:45:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.922ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:45:20.198' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:45:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.078ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:45:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.136ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:45:20.259'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:45:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.971ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:45:20.269' AND status != 'pending'
	

2025/06/20 23:45:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.576ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:45:20.33' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:45:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.450ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:45:20.391'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:45:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[70.150ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:15:28.948'

2025/06/20 23:45:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.386ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:45:29.019' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:45:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.605ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:45:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.530ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:45:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[189.606ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:15:28.961'

2025/06/20 23:45:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.083ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:45:29.144' AND status != 'pending'
	

2025/06/20 23:45:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.217ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:45:29.15' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:45:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.808ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:45:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.280ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:45:29.206' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:45:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.197ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:45:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.117ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:45:29.269'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:45:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.948ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:45:29.273' AND status != 'pending'
	

2025/06/20 23:45:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.380ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:45:29.334' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:45:29 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.033ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:45:29.396'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:46:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.856ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:16:18.242'

2025/06/20 23:46:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.396ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:46:18.319' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:46:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.346ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:46:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[186.926ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:16:18.256'

2025/06/20 23:46:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.018ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:46:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.208ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:46:18.443' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:46:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.769ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:46:18.451' AND status != 'pending'
	

2025/06/20 23:46:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.300ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:46:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.146ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:46:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.546ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:46:18.516' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:46:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.843ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:46:18.567' AND status != 'pending'
	

2025/06/20 23:46:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.040ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:46:18.582'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:46:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.303ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:46:18.628' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:46:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.142ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:46:18.691'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:47:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.649ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:47:18.244'

2025/06/20 23:47:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.691ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:47:18.244'

2025/06/20 23:47:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.463ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:47:18.244'

2025/06/20 23:47:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.499ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:17:18.65'

2025/06/20 23:47:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.004ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:47:18.712' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:47:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.849ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:47:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.184ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:17:18.754'

2025/06/20 23:47:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.435ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:47:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.000ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:47:18.819' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:47:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.015ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:47:18.833' AND status != 'pending'
	

2025/06/20 23:47:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.287ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:47:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.628ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:47:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.435ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:47:18.894' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:47:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.479ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:47:18.954'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:47:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.981ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:47:18.949' AND status != 'pending'
	

2025/06/20 23:47:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.629ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:47:19.014' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:47:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.714ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:47:19.079'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:48:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.903ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:33:18.244' LIMIT 50

2025/06/20 23:48:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.801ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:48:18.243'

2025/06/20 23:48:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.583ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:48:18.243'

2025/06/20 23:48:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.524ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:48:18.243'

2025/06/20 23:48:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[184.692ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:33:18.258' LIMIT 50

2025/06/20 23:48:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.798ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:18:18.65'

2025/06/20 23:48:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.016ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:48:18.711' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:48:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.548ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:48:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.600ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:18:18.754'

2025/06/20 23:48:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.045ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:48:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.845ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:48:18.82' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:48:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.549ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:48:18.832' AND status != 'pending'
	

2025/06/20 23:48:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.487ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:48:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.642ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:48:18 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.000ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:48:18.891' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:48:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.361ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:48:18.952'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:48:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.136ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:48:18.951' AND status != 'pending'
	

2025/06/20 23:48:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.434ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:48:19.018' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:48:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.135ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:48:19.083'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.085ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:18:57.569'

2025/06/20 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.353ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:48:57.634' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.819ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.871ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[187.936ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:18:57.583'

2025/06/20 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.344ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:48:57.763' AND status != 'pending'
	

2025/06/20 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.861ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:48:57.771' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.186ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.316ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:48:57.829' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.273ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.339ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:48:57.893' AND status != 'pending'
	

2025/06/20 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.335ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:48:57.892'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:48:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.063ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:48:57.954' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:48:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.787ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:48:58.016'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:49:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.908ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:19:09.549'

2025/06/20 23:49:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.748ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:49:09.618' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:49:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.610ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:49:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.051ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:49:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[199.780ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:19:09.56'

2025/06/20 23:49:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.534ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:49:09.734' AND status != 'pending'
	

2025/06/20 23:49:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.320ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:49:09.76' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:49:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.787ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:49:09.792' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:49:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.202ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:49:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.743ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:49:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.402ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:49:09.852'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:49:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.411ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:49:09.889' AND status != 'pending'
	

2025/06/20 23:49:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.419ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:49:09.956' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:49:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.292ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:49:10.02'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:49:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[70.413ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:19:19.744'

2025/06/20 23:49:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.821ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:49:19.816' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:49:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.884ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:49:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.158ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:49:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[208.615ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:19:19.758'

2025/06/20 23:49:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.943ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:49:19.938' AND status != 'pending'
	

2025/06/20 23:49:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.785ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:49:19.967' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:49:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.672ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:49:19.997' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:49:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.212ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:49:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.274ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:49:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.760ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:49:20.058'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:49:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.791ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:49:20.101' AND status != 'pending'
	

2025/06/20 23:49:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.480ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:49:20.168' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:49:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.464ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:49:20.236'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:50:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[74.186ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:50:19.744'

2025/06/20 23:50:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.941ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:50:19.744'

2025/06/20 23:50:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[68.025ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:50:19.744'

2025/06/20 23:50:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[69.294ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:20:20.12'

2025/06/20 23:50:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[68.645ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:50:20.189' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:50:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.711ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:50:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.571ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:50:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.597ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:20:20.306'

2025/06/20 23:50:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[69.021ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:50:20.326' AND status != 'pending'
	

2025/06/20 23:50:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.139ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:50:20.366' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:50:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.376ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:50:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.123ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:50:20.395' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:50:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.655ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:50:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.515ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:50:20.462'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:50:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.718ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:50:20.486' AND status != 'pending'
	

2025/06/20 23:50:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.776ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:50:20.547' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:50:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.989ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:50:20.607'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:51:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.988ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:51:19.744'

2025/06/20 23:51:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[69.680ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:36:19.744' LIMIT 50

2025/06/20 23:51:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.224ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:51:19.744'

2025/06/20 23:51:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.853ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:51:19.744'

2025/06/20 23:51:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[201.171ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:36:19.76' LIMIT 50

2025/06/20 23:51:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.605ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:21:20.12'

2025/06/20 23:51:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.627ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:51:20.185' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:51:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.441ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:51:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.314ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:51:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.050ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:21:20.306'

2025/06/20 23:51:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.237ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:51:20.312' AND status != 'pending'
	

2025/06/20 23:51:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.729ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:51:20.367' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:51:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.535ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:51:20.376' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:51:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.170ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:51:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.652ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:51:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.750ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:51:20.439'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:51:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.761ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:51:20.49' AND status != 'pending'
	

2025/06/20 23:51:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.564ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:51:20.55' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:51:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.196ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:51:20.609'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:52:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.348ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:52:19.745'

2025/06/20 23:52:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.711ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:52:19.745'

2025/06/20 23:52:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.059ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:52:19.745'

2025/06/20 23:52:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.314ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:22:20.121'

2025/06/20 23:52:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.358ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:52:20.182' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:52:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.209ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:52:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.212ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:52:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.696ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:52:20.303' AND status != 'pending'
	

2025/06/20 23:52:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.295ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:22:20.306'

2025/06/20 23:52:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.283ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:52:20.364' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:52:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.794ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:52:20.37' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:52:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.097ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:52:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.268ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:52:20.425'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:52:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.508ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:52:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.958ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:52:20.498' AND status != 'pending'
	

2025/06/20 23:52:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.882ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:52:20.562' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:52:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.614ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:52:20.626'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:53:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.595ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:38:19.745' LIMIT 50

2025/06/20 23:53:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.058ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:53:19.745'

2025/06/20 23:53:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.123ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:38:19.761' LIMIT 50

2025/06/20 23:53:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.664ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:53:19.745'

2025/06/20 23:53:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.767ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:53:19.745'

2025/06/20 23:53:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.514ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:23:20.122'

2025/06/20 23:53:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.560ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:53:20.187' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:53:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.725ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:53:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.862ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:53:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.487ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:23:20.307'

2025/06/20 23:53:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.653ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:53:20.315' AND status != 'pending'
	

2025/06/20 23:53:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.729ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:53:20.377' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:53:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[68.283ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:53:20.375' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:53:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.932ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:53:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.311ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:53:20.442'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:53:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.281ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:53:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.402ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:53:20.51' AND status != 'pending'
	

2025/06/20 23:53:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.931ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:53:20.578' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:53:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.986ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:53:20.645'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:54:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.126ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:54:19.746'

2025/06/20 23:54:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[67.784ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:54:19.746'

2025/06/20 23:54:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[67.148ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:54:19.746'

2025/06/20 23:54:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.091ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:24:20.123'

2025/06/20 23:54:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.613ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:54:20.191' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:54:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.436ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:54:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.734ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:54:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.063ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:24:20.308'

2025/06/20 23:54:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[68.016ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:54:20.326' AND status != 'pending'
	

2025/06/20 23:54:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.754ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:54:20.371' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:54:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[68.749ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:54:20.395' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:54:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.390ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:54:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.366ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:54:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.312ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:54:20.463'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:54:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.982ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:54:20.498' AND status != 'pending'
	

2025/06/20 23:54:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.449ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:54:20.562' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:54:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.918ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:54:20.626'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:55:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.343ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:55:19.747'

2025/06/20 23:55:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.918ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:40:19.747' LIMIT 50

2025/06/20 23:55:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.154ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:40:19.763' LIMIT 50

2025/06/20 23:55:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.504ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:55:19.747'

2025/06/20 23:55:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.238ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:55:19.747'

2025/06/20 23:55:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.275ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:25:20.123'

2025/06/20 23:55:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.442ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:55:20.188' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:55:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.452ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:55:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.774ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:55:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.097ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:25:20.309'

2025/06/20 23:55:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.274ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:55:20.315' AND status != 'pending'
	

2025/06/20 23:55:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.756ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:55:20.37' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:55:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.834ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:55:20.378' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:55:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.493ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:55:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.556ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:55:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.607ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:55:20.442'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:55:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.189ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:55:20.493' AND status != 'pending'
	

2025/06/20 23:55:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.439ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:55:20.552' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:55:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.970ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:55:20.612'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:56:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.648ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:56:19.748'

2025/06/20 23:56:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.497ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:56:19.748'

2025/06/20 23:56:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.400ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:56:19.748'

2025/06/20 23:56:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.754ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:26:20.124'

2025/06/20 23:56:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.335ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:56:20.186' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:56:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.108ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:56:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.679ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:56:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.860ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:56:20.307' AND status != 'pending'
	

2025/06/20 23:56:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.588ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:26:20.309'

2025/06/20 23:56:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.382ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:56:20.367' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:56:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.418ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:56:20.372' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:56:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.461ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:56:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.841ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:56:20.428'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:56:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.638ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:56:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.904ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:56:20.499' AND status != 'pending'
	

2025/06/20 23:56:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.850ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:56:20.563' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:56:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.838ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:56:20.627'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:57:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.772ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:42:19.748' LIMIT 50

2025/06/20 23:57:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.163ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:57:19.748'

2025/06/20 23:57:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.561ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:42:19.764' LIMIT 50

2025/06/20 23:57:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.448ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:57:19.748'

2025/06/20 23:57:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.917ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:57:19.748'

2025/06/20 23:57:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.393ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:27:20.125'

2025/06/20 23:57:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.360ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:57:20.189' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:57:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.800ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:57:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.528ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:57:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.613ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:27:20.311'

2025/06/20 23:57:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.993ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:57:20.318' AND status != 'pending'
	

2025/06/20 23:57:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.024ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:57:20.381' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:57:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[68.814ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:57:20.379' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:57:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.742ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:57:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.886ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:57:20.447'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:57:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.957ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:57:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.755ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:57:20.516' AND status != 'pending'
	

2025/06/20 23:57:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.480ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:57:20.583' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:57:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[70.065ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:57:20.65'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:58:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.783ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:58:19.75'

2025/06/20 23:58:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[67.606ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:58:19.75'

2025/06/20 23:58:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[67.647ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:58:19.75'

2025/06/20 23:58:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.777ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:28:20.128'

2025/06/20 23:58:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.772ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:58:20.197' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:58:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.754ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:58:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.489ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:58:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.214ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:28:20.311'

2025/06/20 23:58:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.494ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:58:20.332' AND status != 'pending'
	

2025/06/20 23:58:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.507ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:58:20.375' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:58:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.333ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:58:20.4' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:58:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.691ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:58:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.835ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:58:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.600ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:58:20.467'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:58:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.696ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:58:20.504' AND status != 'pending'
	

2025/06/20 23:58:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.692ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:58:20.568' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:58:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.636ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:58:20.632'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:59:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.294ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:44:19.749' LIMIT 50

2025/06/20 23:59:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.257ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 23:59:19.75'

2025/06/20 23:59:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.427ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:44:19.766' LIMIT 50

2025/06/20 23:59:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[67.894ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 23:59:19.75'

2025/06/20 23:59:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[67.382ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 23:59:19.75'

2025/06/20 23:59:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.486ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:29:20.127'

2025/06/20 23:59:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.642ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:59:20.196' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:59:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.773ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:59:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.779ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:59:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.179ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:29:20.313'

2025/06/20 23:59:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.213ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:59:20.332' AND status != 'pending'
	

2025/06/20 23:59:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.416ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 22:59:20.374' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 23:59:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.917ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 23:59:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.736ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:59:20.399' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:59:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.611ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 23:59:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.699ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:59:20.466'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 23:59:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.739ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 22:59:20.494' AND status != 'pending'
	

2025/06/20 23:59:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.117ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 22:59:20.557' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 23:59:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.642ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 22:59:20.618'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/21 00:00:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.207ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-21 00:00:19.751'

2025/06/21 00:00:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.858ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-21 00:00:19.751'

2025/06/21 00:00:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.577ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-20 00:00:19.751'

2025/06/21 00:00:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.129ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:30:20.127'

2025/06/21 00:00:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.149ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 23:00:20.187' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/21 00:00:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.096ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/21 00:00:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.420ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/21 00:00:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.981ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 23:00:20.309' AND status != 'pending'
	

2025/06/21 00:00:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.497ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:30:20.312'

2025/06/21 00:00:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.223ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 23:00:20.37' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/21 00:00:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.146ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 23:00:20.379' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/21 00:00:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.437ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/21 00:00:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.806ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 23:00:20.43'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/21 00:00:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.574ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/21 00:00:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.940ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 23:00:20.515' AND status != 'pending'
	

2025/06/21 00:00:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.573ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 23:00:20.582' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/21 00:00:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.325ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 23:00:20.65'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/21 00:01:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.711ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-21 00:01:19.751'

2025/06/21 00:01:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.903ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:46:19.751' LIMIT 50

2025/06/21 00:01:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.625ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:46:19.767' LIMIT 50

2025/06/21 00:01:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.678ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-21 00:01:19.751'

2025/06/21 00:01:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.079ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-20 00:01:19.751'

2025/06/21 00:01:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.586ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:31:20.128'

2025/06/21 00:01:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.289ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 23:01:20.191' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/21 00:01:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.089ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/21 00:01:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.551ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/21 00:01:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.796ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 23:01:20.312' AND status != 'pending'
	

2025/06/21 00:01:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.603ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:31:20.313'

2025/06/21 00:01:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.353ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 23:01:20.372' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/21 00:01:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.188ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 23:01:20.375' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/21 00:01:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.224ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/21 00:01:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.719ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 23:01:20.433'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/21 00:01:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.453ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/21 00:01:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.516ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 23:01:20.502' AND status != 'pending'
	

2025/06/21 00:01:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.328ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 23:01:20.566' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/21 00:01:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.783ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 23:01:20.631'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/21 00:02:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.000ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-21 00:02:19.752'

2025/06/21 00:02:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.699ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-21 00:02:19.752'

2025/06/21 00:02:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.777ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-20 00:02:19.752'

2025/06/21 00:02:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.317ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:32:20.128'

2025/06/21 00:02:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.729ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 23:02:20.194' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/21 00:02:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.734ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/21 00:02:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.655ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/21 00:02:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.477ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:32:20.314'

2025/06/21 00:02:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.548ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 23:02:20.321' AND status != 'pending'
	

2025/06/21 00:02:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.584ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 23:02:20.376' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/21 00:02:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.098ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 23:02:20.385' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/21 00:02:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.794ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/21 00:02:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.831ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/21 00:02:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.939ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 23:02:20.449'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/21 00:02:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.645ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 23:02:20.496' AND status != 'pending'
	

2025/06/21 00:02:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.972ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 23:02:20.556' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/21 00:02:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.089ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 23:02:20.616'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/21 00:03:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.866ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:48:19.752' LIMIT 50

2025/06/21 00:03:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.676ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-21 00:03:19.753'

2025/06/21 00:03:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.085ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:48:19.768' LIMIT 50

2025/06/21 00:03:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.897ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-21 00:03:19.753'

2025/06/21 00:03:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.220ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-20 00:03:19.753'

2025/06/21 00:03:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.298ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:33:20.128'

2025/06/21 00:03:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.675ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 23:03:20.194' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/21 00:03:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.819ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/21 00:03:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.951ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/21 00:03:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.531ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:33:20.315'

2025/06/21 00:03:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.431ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 23:03:20.324' AND status != 'pending'
	

2025/06/21 00:03:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.732ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 23:03:20.383' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/21 00:03:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.714ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 23:03:20.388' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/21 00:03:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.292ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/21 00:03:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.350ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 23:03:20.451'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/21 00:03:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.227ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/21 00:03:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.445ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 23:03:20.518' AND status != 'pending'
	

2025/06/21 00:03:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.645ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 23:03:20.585' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/21 00:03:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.487ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 23:03:20.653'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/21 00:04:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.756ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-21 00:04:19.753'

2025/06/21 00:04:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.975ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-21 00:04:19.753'

2025/06/21 00:04:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[69.140ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-20 00:04:19.753'

2025/06/21 00:04:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.788ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:34:20.13'

2025/06/21 00:04:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.571ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 23:04:20.198' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/21 00:04:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.864ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/21 00:04:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.678ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/21 00:04:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.855ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:34:20.316'

2025/06/21 00:04:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.341ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 23:04:20.334' AND status != 'pending'
	

2025/06/21 00:04:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.597ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 23:04:20.38' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/21 00:04:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.861ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 23:04:20.401' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/21 00:04:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.698ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/21 00:04:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.961ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/21 00:04:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.744ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 23:04:20.469'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/21 00:04:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.504ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 23:04:20.508' AND status != 'pending'
	

2025/06/21 00:04:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.705ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 23:04:20.571' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/21 00:04:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.117ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 23:04:20.635'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/21 00:05:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.978ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-21 00:05:19.755'

2025/06/21 00:05:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[70.073ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:50:19.755' LIMIT 50

2025/06/21 00:05:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.874ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:50:19.771' LIMIT 50

2025/06/21 00:05:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.704ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-21 00:05:19.755'

2025/06/21 00:05:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.274ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-20 00:05:19.755'

2025/06/21 00:05:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.655ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:35:20.132'

2025/06/21 00:05:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.651ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 23:05:20.196' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/21 00:05:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.284ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/21 00:05:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.837ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/21 00:05:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.788ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:35:20.318'

2025/06/21 00:05:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.696ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 23:05:20.326' AND status != 'pending'
	

2025/06/21 00:05:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.545ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 23:05:20.379' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/21 00:05:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.580ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 23:05:20.39' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/21 00:05:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.885ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/21 00:05:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.264ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/21 00:05:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.372ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 23:05:20.455'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/21 00:05:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.469ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 23:05:20.5' AND status != 'pending'
	

2025/06/21 00:05:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.028ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 23:05:20.563' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/21 00:05:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.922ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 23:05:20.625'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/21 00:06:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.671ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-21 00:06:19.755'

2025/06/21 00:06:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.939ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-21 00:06:19.755'

2025/06/21 00:06:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.776ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-20 00:06:19.755'

2025/06/21 00:06:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.884ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:36:20.131'

2025/06/21 00:06:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.790ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 23:06:20.192' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/21 00:06:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.064ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/21 00:06:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.812ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/21 00:06:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.271ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 23:06:20.312' AND status != 'pending'
	

2025/06/21 00:06:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.975ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:36:20.317'

2025/06/21 00:06:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.764ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 23:06:20.375' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/21 00:06:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.852ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 23:06:20.38' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/21 00:06:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.792ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/21 00:06:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.239ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 23:06:20.435'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/21 00:06:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.017ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/21 00:06:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.130ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 23:06:20.508' AND status != 'pending'
	

2025/06/21 00:06:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.787ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 23:06:20.573' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/21 00:06:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.225ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 23:06:20.638'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/21 00:07:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.058ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:52:19.756' LIMIT 50

2025/06/21 00:07:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.924ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-21 00:07:19.756'

2025/06/21 00:07:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.878ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:52:19.772' LIMIT 50

2025/06/21 00:07:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.307ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-21 00:07:19.756'

2025/06/21 00:07:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.904ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-20 00:07:19.756'

2025/06/21 00:07:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.360ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:37:20.132'

2025/06/21 00:07:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.571ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 23:07:20.196' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/21 00:07:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.789ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/21 00:07:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.882ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/21 00:07:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.382ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:37:20.318'

2025/06/21 00:07:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.945ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 23:07:20.325' AND status != 'pending'
	

2025/06/21 00:07:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.525ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 23:07:20.388' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/21 00:07:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[68.776ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 23:07:20.386' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/21 00:07:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.825ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/21 00:07:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.924ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 23:07:20.454'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/21 00:07:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.086ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/21 00:07:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[69.227ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 23:07:20.521' AND status != 'pending'
	

2025/06/21 00:07:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.108ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 23:07:20.591' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/21 00:07:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[68.107ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 23:07:20.658'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/21 00:08:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.967ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-21 00:08:19.757'

2025/06/21 00:08:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.691ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-21 00:08:19.757'

2025/06/21 00:08:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[67.931ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-20 00:08:19.757'

2025/06/21 00:08:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[69.254ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:38:20.134'

2025/06/21 00:08:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.357ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 23:08:20.203' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/21 00:08:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.089ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/21 00:08:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.901ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/21 00:08:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.484ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-20 23:38:20.319'

2025/06/21 00:08:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.657ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 23:08:20.339' AND status != 'pending'
	

2025/06/21 00:08:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.751ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-20 23:08:20.383' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/21 00:08:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.845ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 23:08:20.407' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/21 00:08:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.514ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/21 00:08:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.727ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/21 00:08:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.622ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 23:08:20.475'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/21 00:08:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.070ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-20 23:08:20.511' AND status != 'pending'
	

2025/06/21 00:08:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.530ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-20 23:08:20.575' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/21 00:08:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.704ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-20 23:08:20.639'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	
