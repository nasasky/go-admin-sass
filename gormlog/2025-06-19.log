
2025/06/19 22:17:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.449ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:47:32.537'

2025/06/19 22:17:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.654ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:17:32.599' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:17:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.839ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:17:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.317ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:17:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.019ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:17:32.722' AND status != 'pending'
	

2025/06/19 22:17:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[190.574ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:47:32.606'

2025/06/19 22:17:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.688ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:17:32.783' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:17:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.138ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:17:32.797' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:17:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.284ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:17:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.724ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:17:32.845'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:17:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.488ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:17:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.890ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:17:32.919' AND status != 'pending'
	

2025/06/19 22:17:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.651ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:17:32.98' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:17:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.085ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:17:33.041'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:18:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[69.189ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:18:32.534'

2025/06/19 22:18:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.054ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:18:32.534'

2025/06/19 22:18:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.308ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:18:32.534'

2025/06/19 22:18:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.580ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:48:32.905'

2025/06/19 22:18:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.717ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:18:32.967' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:18:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.920ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:18:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.148ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:18:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.902ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:18:33.091' AND status != 'pending'
	

2025/06/19 22:18:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.139ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:48:33.1'

2025/06/19 22:18:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.526ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:18:33.152' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:18:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.435ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:18:33.161' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:18:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.135ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:18:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.457ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:18:33.214'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:18:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.299ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:18:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.459ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:18:33.287' AND status != 'pending'
	

2025/06/19 22:18:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.686ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:18:33.348' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:18:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.836ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:18:33.411'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:18:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[62.902ms] [rows:1] SELECT * FROM `user` WHERE (username = 'admin' OR phone = 'admin') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:18:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:480
[61.425ms] [rows:9] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 4

2025/06/19 22:18:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:492 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[30.826ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,3,4,5,6,7,8,23)

2025/06/19 22:18:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[62.122ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/19 22:18:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[32.830ms] [rows:18] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/19 22:18:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[30.717ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 22:18:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.008ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 22:18:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.056ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 22:18:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.068ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 22:18:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.984ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 22:18:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.090ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 22:18:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.977ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 22:18:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.310ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 22:18:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.535ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 22:18:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.818ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 22:18:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.400ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 22:18:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.326ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 22:18:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.586ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 22:19:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.673ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:04:32.53' LIMIT 50

2025/06/19 22:19:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.612ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:19:32.531'

2025/06/19 22:19:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.901ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:04:32.6' LIMIT 50

2025/06/19 22:19:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[73.698ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:19:32.531'

2025/06/19 22:19:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.153ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:19:32.531'

2025/06/19 22:19:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.265ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:49:32.902'

2025/06/19 22:19:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.546ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:19:32.963' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:19:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.678ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:19:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.854ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:19:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.034ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:19:33.087' AND status != 'pending'
	

2025/06/19 22:19:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.623ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:49:33.096'

2025/06/19 22:19:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.851ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:19:33.149' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:19:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.312ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:19:33.158' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:19:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.009ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:19:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.331ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:19:33.211'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:19:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.691ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:19:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.636ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:19:33.282' AND status != 'pending'
	

2025/06/19 22:19:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.958ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:19:33.344' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:19:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.073ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:19:33.406'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:19:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[61.898ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1

2025/06/19 22:19:48 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[61.855ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 22:20:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[62.462ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:20:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[30.017ms] [rows:1] SELECT count(*) FROM `user`

2025/06/19 22:20:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[62.477ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/19 22:20:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:139
[61.790ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:20:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[30.632ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 22:20:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[61.361ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/19 22:20:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.704ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:20:32.527'

2025/06/19 22:20:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.745ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:20:32.527'

2025/06/19 22:20:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.818ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:20:32.527'

2025/06/19 22:20:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.952ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:50:32.899'

2025/06/19 22:20:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.228ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:20:32.962' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:20:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.932ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:20:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.507ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:20:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.248ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:20:33.088' AND status != 'pending'
	

2025/06/19 22:20:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.670ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:50:33.094'

2025/06/19 22:20:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.713ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:20:33.15' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:20:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.043ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:20:33.155' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:20:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.233ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:20:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.996ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:20:33.212'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:20:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.945ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:20:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.427ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:20:33.277' AND status != 'pending'
	

2025/06/19 22:20:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.846ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:20:33.339' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:20:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.040ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:20:33.401'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:20:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[61.975ms] [rows:1] SELECT * FROM `user` WHERE (username = '16620436582' OR phone = '16620436582') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:20:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:480
[61.325ms] [rows:9] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/19 22:20:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:492 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[30.650ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,10,11,12,13,14,15,22)

2025/06/19 22:20:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[60.463ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 8 ORDER BY `user`.`user_type` LIMIT 1

2025/06/19 22:20:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:88
[61.647ms] [rows:9] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/19 22:20:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:104
[63.224ms] [rows:9] SELECT * FROM `permission_user` WHERE id IN (1,2,10,11,12,13,14,15,22) ORDER BY sort DESC

2025/06/19 22:20:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[30.866ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 22:20:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.792ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 22:20:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.831ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 22:20:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.299ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 22:20:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.393ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 22:20:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.678ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 22:20:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.896ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 22:20:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.747ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 22:20:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.550ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 22:20:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.017ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 22:20:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.306ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 22:20:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.908ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 22:20:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.318ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 22:21:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[61.404ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:21:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:208
[61.397ms] [rows:1] SELECT count(*) FROM `user` WHERE parent_id = 8

2025/06/19 22:21:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:216
[61.333ms] [rows:1] SELECT * FROM `user` WHERE parent_id = 8 LIMIT 10

2025/06/19 22:21:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[30.896ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 22:21:03 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[60.836ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/19 22:21:18 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[30.033ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 22:21:18 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.501ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 22:21:18 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.765ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 22:21:18 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.219ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 22:21:18 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.618ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 22:21:18 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.968ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 22:21:18 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.198ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 22:21:18 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.666ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 22:21:18 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.996ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 22:21:19 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.192ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 22:21:19 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.967ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 22:21:19 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.822ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 22:21:19 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.984ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 22:21:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[60.889ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:21:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:208
[61.832ms] [rows:1] SELECT count(*) FROM `user` WHERE parent_id = 8

2025/06/19 22:21:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:216
[61.311ms] [rows:1] SELECT * FROM `user` WHERE parent_id = 8 LIMIT 10

2025/06/19 22:21:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.353ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:21:32.524'

2025/06/19 22:21:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.599ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:06:32.524' LIMIT 50

2025/06/19 22:21:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.946ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:21:32.524'

2025/06/19 22:21:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.651ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:06:32.595' LIMIT 50

2025/06/19 22:21:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.789ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:21:32.524'

2025/06/19 22:21:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.829ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:51:32.896'

2025/06/19 22:21:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.610ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:21:32.958' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:21:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.065ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:21:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.921ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:21:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.016ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:21:33.082' AND status != 'pending'
	

2025/06/19 22:21:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.493ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:51:33.091'

2025/06/19 22:21:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.975ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:21:33.142' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:21:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.486ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:21:33.152' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:21:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.830ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:21:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.243ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:21:33.203'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:21:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.942ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:21:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.283ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:21:33.275' AND status != 'pending'
	

2025/06/19 22:21:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.682ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:21:33.336' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:21:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.566ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:21:33.398'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:22:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:139
[61.787ms] [rows:1] SELECT * FROM `user` WHERE id = 12 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:22:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[30.861ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 22:22:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[62.398ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/19 22:22:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.593ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:22:32.521'

2025/06/19 22:22:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.742ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:22:32.521'

2025/06/19 22:22:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.333ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:22:32.521'

2025/06/19 22:22:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.454ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:52:32.894'

2025/06/19 22:22:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.895ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:22:32.956' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:22:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.478ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:22:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.152ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:22:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.095ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:22:33.083' AND status != 'pending'
	

2025/06/19 22:22:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.164ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:52:33.088'

2025/06/19 22:22:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.694ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:22:33.145' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:22:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.401ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:22:33.149' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:22:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.304ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:22:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.304ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:22:33.208'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:22:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.431ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:22:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.662ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:22:33.27' AND status != 'pending'
	

2025/06/19 22:22:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.340ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:22:33.332' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:22:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.203ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:22:33.394'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:22:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:139
[61.198ms] [rows:1] SELECT * FROM `user` WHERE id = 12 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:22:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[30.154ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 22:22:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[61.622ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/19 22:23:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.051ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:23:32.518'

2025/06/19 22:23:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.118ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:08:32.518' LIMIT 50

2025/06/19 22:23:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.334ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:23:32.518'

2025/06/19 22:23:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.692ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:08:32.588' LIMIT 50

2025/06/19 22:23:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.834ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:23:32.518'

2025/06/19 22:23:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.869ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:53:32.891'

2025/06/19 22:23:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.486ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:23:32.954' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:23:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.872ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:23:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.273ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:23:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.206ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:23:33.079' AND status != 'pending'
	

2025/06/19 22:23:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.442ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:53:33.085'

2025/06/19 22:23:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.787ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:23:33.141' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:23:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.394ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:23:33.146' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:23:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.417ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:23:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[68.052ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:23:33.203'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:23:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.798ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:23:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.430ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:23:33.272' AND status != 'pending'
	

2025/06/19 22:23:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.109ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:23:33.333' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:23:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.598ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:23:33.395'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:23:44 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[30.843ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 22:23:44 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.072ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 22:23:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.892ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 22:23:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.427ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 22:23:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.259ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 22:23:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.794ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 22:23:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.941ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 22:23:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.927ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 22:23:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.098ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 22:23:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.017ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 22:23:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.774ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 22:23:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.529ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 22:23:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.494ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 22:23:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[61.057ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:23:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:208
[60.329ms] [rows:1] SELECT count(*) FROM `user` WHERE parent_id = 8

2025/06/19 22:23:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:216
[61.417ms] [rows:1] SELECT * FROM `user` WHERE parent_id = 8 LIMIT 10

2025/06/19 22:23:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:139
[62.276ms] [rows:1] SELECT * FROM `user` WHERE id = 12 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:23:47 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[29.478ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 22:23:47 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[61.339ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/19 22:23:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:139
[61.896ms] [rows:1] SELECT * FROM `user` WHERE id = 12 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:23:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[30.044ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 22:23:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[61.397ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/19 22:24:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[35.217ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 22:24:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[63.163ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/19 22:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[30.768ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 22:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.276ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 22:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.638ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 22:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.007ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 22:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.161ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 22:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.463ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 22:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.886ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 22:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.259ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 22:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.906ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 22:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.572ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 22:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.572ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 22:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.886ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 22:24:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.631ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 22:24:18 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[61.488ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:24:18 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:208
[61.399ms] [rows:1] SELECT count(*) FROM `user` WHERE parent_id = 8

2025/06/19 22:24:18 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:216
[61.040ms] [rows:1] SELECT * FROM `user` WHERE parent_id = 8 LIMIT 10

2025/06/19 22:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[30.441ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 22:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[60.745ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/19 22:24:25 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[31.810ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 22:24:25 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.976ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 22:24:25 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.630ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 22:24:26 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.952ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 22:24:26 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.287ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 22:24:26 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.826ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 22:24:26 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.024ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 22:24:26 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.245ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 22:24:26 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.845ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 22:24:26 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.548ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 22:24:26 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.622ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 22:24:26 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.913ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 22:24:26 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.389ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 22:24:27 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[61.188ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:24:27 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:208
[61.320ms] [rows:1] SELECT count(*) FROM `user` WHERE parent_id = 8

2025/06/19 22:24:27 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:216
[60.925ms] [rows:1] SELECT * FROM `user` WHERE parent_id = 8 LIMIT 10

2025/06/19 22:24:27 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[31.521ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 22:24:27 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[61.266ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/19 22:24:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.356ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:24:32.515'

2025/06/19 22:24:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.939ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:24:32.515'

2025/06/19 22:24:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.229ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:24:32.515'

2025/06/19 22:24:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.445ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:54:32.888'

2025/06/19 22:24:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.391ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:24:32.95' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:24:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.541ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:24:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.887ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:24:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.453ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:24:33.074' AND status != 'pending'
	

2025/06/19 22:24:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.840ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:54:33.082'

2025/06/19 22:24:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.036ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:24:33.136' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:24:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.539ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:24:33.144' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:24:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.882ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:24:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.141ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:24:33.199'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:24:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.321ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:24:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.842ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:24:33.267' AND status != 'pending'
	

2025/06/19 22:24:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.069ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:24:33.331' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:24:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.418ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:24:33.394'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:25:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[62.964ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1

2025/06/19 22:25:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[62.510ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 22:25:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[61.882ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:25:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:208
[62.171ms] [rows:1] SELECT count(*) FROM `user` WHERE parent_id = 8

2025/06/19 22:25:21 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:216
[61.379ms] [rows:1] SELECT * FROM `user` WHERE parent_id = 8 LIMIT 10

2025/06/19 22:25:22 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:139
[61.703ms] [rows:1] SELECT * FROM `user` WHERE id = 12 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:25:22 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[31.365ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 22:25:22 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[61.113ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/19 22:25:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.583ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:25:32.512'

2025/06/19 22:25:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.890ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:10:32.512' LIMIT 50

2025/06/19 22:25:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.843ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:25:32.512'

2025/06/19 22:25:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.198ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:10:32.582' LIMIT 50

2025/06/19 22:25:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.810ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:25:32.512'

2025/06/19 22:25:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.482ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:55:32.885'

2025/06/19 22:25:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.534ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:25:32.948' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:25:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.422ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:25:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.328ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:25:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.253ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:25:33.072' AND status != 'pending'
	

2025/06/19 22:25:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.023ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:55:33.08'

2025/06/19 22:25:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.868ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:25:33.133' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:25:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.183ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:25:33.141' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:25:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.431ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:25:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.690ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:25:33.195'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:25:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.875ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:25:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.079ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:25:33.264' AND status != 'pending'
	

2025/06/19 22:25:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.150ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:25:33.326' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:25:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.016ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:25:33.39'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:26:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[74.358ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:26:32.509'

2025/06/19 22:26:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.046ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:26:32.509'

2025/06/19 22:26:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.692ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:26:32.509'

2025/06/19 22:26:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.966ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:56:32.882'

2025/06/19 22:26:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.074ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:26:32.943' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:26:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.009ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:26:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.869ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:26:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.218ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:26:33.068' AND status != 'pending'
	

2025/06/19 22:26:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.223ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:56:33.077'

2025/06/19 22:26:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.267ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:26:33.129' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:26:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.078ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:26:33.139' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:26:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.045ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:26:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.187ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:26:33.19'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:26:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.298ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:26:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.010ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:26:33.263' AND status != 'pending'
	

2025/06/19 22:26:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.024ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:26:33.324' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:26:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.557ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:26:33.386'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:27:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.108ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:12:32.506' LIMIT 50

2025/06/19 22:27:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.585ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:27:32.506'

2025/06/19 22:27:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.325ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:27:32.506'

2025/06/19 22:27:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.547ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:12:32.577' LIMIT 50

2025/06/19 22:27:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.000ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:27:32.506'

2025/06/19 22:27:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.229ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:57:32.879'

2025/06/19 22:27:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.682ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:27:32.942' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:27:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.810ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:27:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.615ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:27:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.896ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:27:33.067' AND status != 'pending'
	

2025/06/19 22:27:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.570ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:57:33.074'

2025/06/19 22:27:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.515ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:27:33.128' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:27:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.930ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:27:33.135' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:27:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.351ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:27:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.414ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:27:33.19'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:27:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.891ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:27:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.663ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:27:33.259' AND status != 'pending'
	

2025/06/19 22:27:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.790ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:27:33.321' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:27:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.758ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:27:33.386'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:27:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[61.948ms] [rows:1] SELECT * FROM `user` WHERE (username = 'admin' OR phone = 'admin') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:27:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:480
[60.901ms] [rows:9] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 4

2025/06/19 22:27:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:492 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[30.745ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,3,4,5,6,7,8,23)

2025/06/19 22:27:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[31.638ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 22:27:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.463ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 22:27:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.011ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 22:27:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.210ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 22:27:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.479ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 22:27:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.243ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 22:27:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.639ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 22:27:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.093ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 22:27:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.102ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 22:27:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.007ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 22:27:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.610ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 22:27:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.169ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 22:27:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.256ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 22:27:41 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[63.227ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:27:41 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[30.352ms] [rows:1] SELECT count(*) FROM `user`

2025/06/19 22:27:41 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[61.564ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/19 22:27:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:139
[62.973ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:27:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[30.794ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 22:27:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[60.823ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/19 22:27:44 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:74
[61.646ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:27:44 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:91
[130.058ms] [rows:1] UPDATE `user` SET `avatar`='https://ark-auto-2102366935-cn-beijing-default.tos-cn-beijing.volces.com/uploads/20250526223614000.jpg',`enable`='active',`phone`='admin',`role_id`=4,`sex`=1,`update_time`='2025-06-19 22:27:44.552',`user_type`=1,`username`='admin' WHERE `id` = 1

2025/06/19 22:27:44 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[61.830ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:27:44 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[30.814ms] [rows:1] SELECT count(*) FROM `user`

2025/06/19 22:27:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[61.823ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/19 22:27:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:139
[62.449ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:27:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[31.334ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 22:27:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[62.710ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/19 22:28:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.754ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:28:32.503'

2025/06/19 22:28:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.431ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:28:32.503'

2025/06/19 22:28:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.700ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:28:32.503'

2025/06/19 22:28:32 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.150ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:58:32.876'

2025/06/19 22:28:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.479ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:28:32.938' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:28:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.046ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:28:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.398ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:28:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.712ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:28:33.065' AND status != 'pending'
	

2025/06/19 22:28:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.690ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:58:33.07'

2025/06/19 22:28:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.516ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:28:33.127' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:28:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.995ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:28:33.133' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:28:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.126ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:28:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.587ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:28:33.189'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:28:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.273ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:28:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.650ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:28:33.257' AND status != 'pending'
	

2025/06/19 22:28:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.139ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:28:33.319' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:28:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.203ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:28:33.381'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:29:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.165ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:59:28.013'

2025/06/19 22:29:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.724ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:29:28.075' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:29:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.778ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:29:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.306ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:29:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.251ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:29:28.196' AND status != 'pending'
	

2025/06/19 22:29:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[236.175ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 21:59:28.028'

2025/06/19 22:29:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.146ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:29:28.256' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:29:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.420ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:29:28.265' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:29:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.873ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:29:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.901ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:29:28.317'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:29:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.403ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:29:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.064ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:29:28.392' AND status != 'pending'
	

2025/06/19 22:29:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.923ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:29:28.456' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:29:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.070ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:29:28.52'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:30:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[64.397ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:30:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[31.123ms] [rows:1] SELECT count(*) FROM `user`

2025/06/19 22:30:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[64.243ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/19 22:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[64.860ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[31.700ms] [rows:1] SELECT count(*) FROM `user`

2025/06/19 22:30:07 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[64.095ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/19 22:30:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[31.811ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 22:30:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.886ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 22:30:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.712ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 22:30:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.335ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 22:30:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.908ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 22:30:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.750ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 22:30:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.785ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 22:30:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.419ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 22:30:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.862ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 22:30:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.891ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 22:30:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.954ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 22:30:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[61.992ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 22:30:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.874ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 22:30:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[62.760ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:30:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[31.233ms] [rows:1] SELECT count(*) FROM `user`

2025/06/19 22:30:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[62.927ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/19 22:30:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:336
[31.485ms] [rows:1] SELECT count(*) FROM `sys_dict_type`

2025/06/19 22:30:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:336
[62.549ms] [rows:10] SELECT * FROM `sys_dict_type` ORDER BY create_time DESC LIMIT 10

2025/06/19 22:30:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/setting.go:38
[31.487ms] [rows:1] SELECT count(*) FROM `config_setting`

2025/06/19 22:30:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/setting.go:38
[63.358ms] [rows:4] SELECT * FROM `config_setting` LIMIT 10

2025/06/19 22:30:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[69.000ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:30:28.012'

2025/06/19 22:30:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.804ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:30:28.012'

2025/06/19 22:30:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.429ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:30:28.012'

2025/06/19 22:30:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.052ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:00:28.378'

2025/06/19 22:30:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.851ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:30:28.442' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:30:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.876ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:30:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.537ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:30:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.775ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:30:28.571' AND status != 'pending'
	

2025/06/19 22:30:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.487ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:00:28.585'

2025/06/19 22:30:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.260ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:30:28.634' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:30:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.917ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:30:28.645' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:30:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.441ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:30:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.242ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:30:28.698'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:30:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.442ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:30:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.322ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:30:28.767' AND status != 'pending'
	

2025/06/19 22:30:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.437ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:30:28.827' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:30:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.377ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:30:28.888'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:31:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.961ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:16:28.012' LIMIT 50

2025/06/19 22:31:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.998ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:31:28.011'

2025/06/19 22:31:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.331ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:31:28.011'

2025/06/19 22:31:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[68.883ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:31:28.011'

2025/06/19 22:31:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[192.754ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:16:28.028' LIMIT 50

2025/06/19 22:31:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.143ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:01:28.378'

2025/06/19 22:31:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.686ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:31:28.437' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:31:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.154ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:31:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.015ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:31:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.664ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:31:28.555' AND status != 'pending'
	

2025/06/19 22:31:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.811ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:01:28.584'

2025/06/19 22:31:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.310ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:31:28.612' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:31:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.317ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:31:28.647' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:31:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.458ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:31:28.668'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:31:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.389ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:31:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.574ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:31:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.869ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:31:28.774' AND status != 'pending'
	

2025/06/19 22:31:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.422ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:31:28.837' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:31:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.668ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:31:28.9'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:31:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:336
[31.988ms] [rows:1] SELECT count(*) FROM `sys_dict_type`

2025/06/19 22:31:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:336
[63.621ms] [rows:10] SELECT * FROM `sys_dict_type` ORDER BY create_time DESC LIMIT 10

2025/06/19 22:31:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:369
[63.198ms] [rows:1] SELECT count(*) FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 22:31:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:369
[62.896ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010 LIMIT 10

2025/06/19 22:32:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.822ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:32:28.011'

2025/06/19 22:32:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.705ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:32:28.011'

2025/06/19 22:32:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.636ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:32:28.011'

2025/06/19 22:32:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.334ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:02:28.378'

2025/06/19 22:32:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.329ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:32:28.443' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:32:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.560ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:32:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.164ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:32:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.126ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:32:28.57' AND status != 'pending'
	

2025/06/19 22:32:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.591ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:02:28.585'

2025/06/19 22:32:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.835ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:32:28.634' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:32:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.215ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:32:28.644' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:32:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.905ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:32:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.032ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:32:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.913ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:32:28.697'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:32:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.366ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:32:28.76' AND status != 'pending'
	

2025/06/19 22:32:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.368ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:32:28.819' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:32:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.142ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:32:28.877'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:33:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.316ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:33:28.011'

2025/06/19 22:33:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.442ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:18:28.011' LIMIT 50

2025/06/19 22:33:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.745ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:18:28.028' LIMIT 50

2025/06/19 22:33:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.870ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:33:28.011'

2025/06/19 22:33:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.719ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:33:28.011'

2025/06/19 22:33:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.093ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:03:28.378'

2025/06/19 22:33:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.000ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:33:28.437' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:33:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.811ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:33:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.835ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:33:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.078ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:33:28.554' AND status != 'pending'
	

2025/06/19 22:33:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.182ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:03:28.584'

2025/06/19 22:33:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.064ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:33:28.614' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:33:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.479ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:33:28.645' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:33:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.274ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:33:28.672'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:33:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.744ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:33:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.874ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:33:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.599ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:33:28.766' AND status != 'pending'
	

2025/06/19 22:33:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[68.142ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:33:28.827' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:33:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.290ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:33:28.895'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:34:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.427ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:34:28.01'

2025/06/19 22:34:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.423ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:34:28.01'

2025/06/19 22:34:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.030ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:34:28.01'

2025/06/19 22:34:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.125ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:04:28.378'

2025/06/19 22:34:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.210ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:34:28.439' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:34:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.762ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:34:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.044ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:34:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.125ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:34:28.56' AND status != 'pending'
	

2025/06/19 22:34:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.260ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:04:28.585'

2025/06/19 22:34:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.154ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:34:28.62' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:34:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[56.445ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:34:28.647' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:34:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.760ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:34:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.245ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:34:28.68'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:34:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.832ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:34:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.718ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:34:28.761' AND status != 'pending'
	

2025/06/19 22:34:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.550ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:34:28.819' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:34:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.362ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:34:28.877'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.833ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:20:28.012' LIMIT 50

2025/06/19 22:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.665ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:35:28.012'

2025/06/19 22:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.183ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:20:28.03' LIMIT 50

2025/06/19 22:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.387ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:35:28.012'

2025/06/19 22:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.450ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:35:28.012'

2025/06/19 22:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.116ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:05:28.38'

2025/06/19 22:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.952ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:35:28.441' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.079ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.187ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.765ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:35:28.563' AND status != 'pending'
	

2025/06/19 22:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.744ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:05:28.587'

2025/06/19 22:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.797ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:35:28.625' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.054ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:35:28.651' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.653ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.120ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:35:28.686'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.826ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.874ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:35:28.778' AND status != 'pending'
	

2025/06/19 22:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.238ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:35:28.841' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:35:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.623ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:35:28.905'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:35:39 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/setting.go:38
[32.185ms] [rows:1] SELECT count(*) FROM `config_setting`

2025/06/19 22:35:39 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/setting.go:38
[62.664ms] [rows:4] SELECT * FROM `config_setting` LIMIT 10

2025/06/19 22:36:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.149ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:36:28.014'

2025/06/19 22:36:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.170ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:36:28.014'

2025/06/19 22:36:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.773ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:36:28.014'

2025/06/19 22:36:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.461ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:06:28.381'

2025/06/19 22:36:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.111ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:36:28.456' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:36:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.153ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:36:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.414ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:36:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.645ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:06:28.587'

2025/06/19 22:36:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.692ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:36:28.585' AND status != 'pending'
	

2025/06/19 22:36:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.292ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:36:28.648' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:36:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.965ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:36:28.65' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:36:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.272ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:36:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.822ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:36:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.170ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:36:28.714'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:36:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.022ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:36:28.769' AND status != 'pending'
	

2025/06/19 22:36:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.860ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:36:28.829' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:36:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.683ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:36:28.89'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:37:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.506ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:37:28.014'

2025/06/19 22:37:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.101ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:22:28.014' LIMIT 50

2025/06/19 22:37:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.831ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:22:28.031' LIMIT 50

2025/06/19 22:37:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.228ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:37:28.014'

2025/06/19 22:37:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.744ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:37:28.014'

2025/06/19 22:37:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.511ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:07:28.381'

2025/06/19 22:37:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.225ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:37:28.442' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:37:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.864ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:37:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.867ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:37:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.263ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:37:28.562' AND status != 'pending'
	

2025/06/19 22:37:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.148ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:07:28.587'

2025/06/19 22:37:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.859ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:37:28.623' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:37:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.618ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:37:28.645' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:37:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.450ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:37:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.978ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:37:28.684'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:37:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.361ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:37:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.934ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:37:28.761' AND status != 'pending'
	

2025/06/19 22:37:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.162ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:37:28.819' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:37:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.370ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:37:28.876'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:38:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:336
[28.884ms] [rows:1] SELECT count(*) FROM `sys_dict_type`

2025/06/19 22:38:10 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:336
[57.905ms] [rows:10] SELECT * FROM `sys_dict_type` ORDER BY create_time DESC LIMIT 10

2025/06/19 22:38:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:369
[57.715ms] [rows:1] SELECT count(*) FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 22:38:11 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:369
[57.445ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010 LIMIT 10

2025/06/19 22:38:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.217ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:38:28.013'

2025/06/19 22:38:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.175ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:38:28.013'

2025/06/19 22:38:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.471ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:38:28.013'

2025/06/19 22:38:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[56.875ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:08:28.381'

2025/06/19 22:38:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.375ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:38:28.438' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:38:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.528ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:38:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.872ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:38:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.189ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:38:28.553' AND status != 'pending'
	

2025/06/19 22:38:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.475ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:08:28.587'

2025/06/19 22:38:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.486ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:38:28.61' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:38:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.170ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:38:28.647' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:38:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.278ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:38:28.668'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:38:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.504ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:38:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.399ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:38:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.217ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:38:28.77' AND status != 'pending'
	

2025/06/19 22:38:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.510ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:38:28.83' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:38:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.920ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:38:28.89'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.211ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:09:46.168'

2025/06/19 22:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.634ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:39:46.238' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.928ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.639ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[215.838ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:09:46.179'

2025/06/19 22:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.502ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:39:46.363' AND status != 'pending'
	

2025/06/19 22:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.934ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:39:46.395' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.787ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.016ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:39:46.425' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.267ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.945ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:39:46.486'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.693ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:39:46.513' AND status != 'pending'
	

2025/06/19 22:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.849ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:39:46.571' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.564ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:39:46.629'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.875ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:40:46.166'

2025/06/19 22:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.957ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:40:46.166'

2025/06/19 22:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.555ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:40:46.166'

2025/06/19 22:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.788ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:10:46.55'

2025/06/19 22:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.334ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:40:46.608' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.013ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.952ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.215ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:10:46.688'

2025/06/19 22:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.197ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:40:46.725' AND status != 'pending'
	

2025/06/19 22:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.483ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:40:46.751' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.129ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:40:46.783' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.906ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.137ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.491ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:40:46.84'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.312ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:40:46.876' AND status != 'pending'
	

2025/06/19 22:40:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.474ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:40:46.94' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:40:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.361ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:40:47.002'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.848ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:26:46.166' LIMIT 50

2025/06/19 22:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.149ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:41:46.166'

2025/06/19 22:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[75.451ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:41:46.166'

2025/06/19 22:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.859ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:41:46.166'

2025/06/19 22:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[205.053ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:26:46.179' LIMIT 50

2025/06/19 22:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.568ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:11:46.55'

2025/06/19 22:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.564ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:41:46.618' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.547ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.705ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:11:46.687'

2025/06/19 22:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.112ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.867ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:41:46.749' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.889ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:41:46.75' AND status != 'pending'
	

2025/06/19 22:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.680ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.159ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.352ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:41:46.815' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.399ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:41:46.874' AND status != 'pending'
	

2025/06/19 22:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.529ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:41:46.881'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.153ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:41:46.935' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:41:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.124ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:41:46.997'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:42:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.217ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:12:11.758'

2025/06/19 22:42:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.194ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:42:11.826' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:42:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.207ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:42:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.604ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:42:11 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[198.044ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:12:11.772'

2025/06/19 22:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.991ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:42:11.948' AND status != 'pending'
	

2025/06/19 22:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.779ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:42:11.97' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.371ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:42:12.009' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.387ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.064ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.079ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:42:12.068'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.374ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:42:12.1' AND status != 'pending'
	

2025/06/19 22:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.515ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:42:12.164' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:42:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.069ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:42:12.226'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[74.955ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:12:24.645'

2025/06/19 22:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[68.542ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:42:24.72' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.480ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[193.379ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:12:24.662'

2025/06/19 22:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[36.214ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.720ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:42:24.857' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.239ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:42:24.858' AND status != 'pending'
	

2025/06/19 22:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.317ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.559ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.018ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:42:24.922' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:42:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.248ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:42:24.981' AND status != 'pending'
	

2025/06/19 22:42:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.040ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:42:24.988'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:42:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.729ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:42:25.047' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:42:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.348ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:42:25.11'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:43:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.466ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:43:24.642'

2025/06/19 22:43:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.046ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:43:24.642'

2025/06/19 22:43:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.778ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:43:24.642'

2025/06/19 22:43:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.943ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:13:25.052'

2025/06/19 22:43:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.695ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:43:25.115' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:43:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.773ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:43:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.992ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:13:25.175'

2025/06/19 22:43:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.144ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:43:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.179ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:43:25.24' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:43:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.797ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:43:25.243' AND status != 'pending'
	

2025/06/19 22:43:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.358ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:43:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.172ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:43:25.305' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:43:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.867ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:43:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.998ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:43:25.369'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:43:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.852ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:43:25.37' AND status != 'pending'
	

2025/06/19 22:43:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.228ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:43:25.434' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:43:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.161ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:43:25.498'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[65.154ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1

2025/06/19 22:43:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[64.349ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 22:43:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[34.724ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 22:43:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[63.297ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/19 22:44:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[64.871ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/19 22:44:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[31.176ms] [rows:1] SELECT count(*) FROM `user`

2025/06/19 22:44:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[64.338ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/19 22:44:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[32.070ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 22:44:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[63.976ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/19 22:44:06 /Users/wensiyuan/go/go-admin-sass-github/controllers/admin/upload.go:39
[64.831ms] [rows:1] SELECT * FROM `config_setting` WHERE type = 'oss_code'

2025/06/19 22:44:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.360ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:29:24.642' LIMIT 50

2025/06/19 22:44:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.817ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:44:24.642'

2025/06/19 22:44:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.813ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:44:24.642'

2025/06/19 22:44:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.233ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:44:24.642'

2025/06/19 22:44:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[183.378ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:29:24.662' LIMIT 50

2025/06/19 22:44:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.473ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:14:25.053'

2025/06/19 22:44:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.164ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:44:25.112' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:44:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.589ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:44:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.177ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:44:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.680ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:14:25.172'

2025/06/19 22:44:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.053ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:44:25.231' AND status != 'pending'
	

2025/06/19 22:44:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.917ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:44:25.236' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:44:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.925ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:44:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.290ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:44:25.29' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:44:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.671ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:44:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.686ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:44:25.349'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:44:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.171ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:44:25.364' AND status != 'pending'
	

2025/06/19 22:44:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[72.209ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:44:25.428' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:44:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.833ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:44:25.501'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:45:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.789ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:45:24.641'

2025/06/19 22:45:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.340ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:45:24.641'

2025/06/19 22:45:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.206ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:45:24.641'

2025/06/19 22:45:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.716ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:15:25.057'

2025/06/19 22:45:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.506ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:45:25.122' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:45:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.981ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:45:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.107ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:15:25.173'

2025/06/19 22:45:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.203ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:45:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.056ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:45:25.231' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:45:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.502ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:45:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.032ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:45:25.253' AND status != 'pending'
	

2025/06/19 22:45:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.006ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:45:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.895ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:45:25.321' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:45:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.056ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:45:25.349' AND status != 'pending'
	

2025/06/19 22:45:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.586ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:45:25.385'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:45:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.459ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:45:25.411' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:45:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.818ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:45:25.469'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:46:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.027ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:46:24.641'

2025/06/19 22:46:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.226ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:31:24.641' LIMIT 50

2025/06/19 22:46:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.249ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:31:24.662' LIMIT 50

2025/06/19 22:46:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.002ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:46:24.641'

2025/06/19 22:46:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.896ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:46:24.641'

2025/06/19 22:46:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.062ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:16:25.052'

2025/06/19 22:46:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.652ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:46:25.111' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:46:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.368ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:46:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.639ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:46:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.011ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:16:25.172'

2025/06/19 22:46:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.080ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:46:25.228' AND status != 'pending'
	

2025/06/19 22:46:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.562ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:46:25.234' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:46:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.006ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:46:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.326ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:46:25.286' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:46:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.959ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:46:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.613ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:46:25.344'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:46:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.864ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:46:25.358' AND status != 'pending'
	

2025/06/19 22:46:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.408ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:46:25.42' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:46:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.282ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:46:25.483'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:46:31 /Users/wensiyuan/go/go-admin-sass-github/controllers/admin/upload.go:39
[62.271ms] [rows:1] SELECT * FROM `config_setting` WHERE type = 'oss_code'

2025/06/19 22:46:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[71.863ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:16:44.177'

2025/06/19 22:46:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.767ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:46:44.249' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:46:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.339ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:46:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[191.508ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:16:44.188'

2025/06/19 22:46:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.318ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:46:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.852ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:46:44.38' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:46:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.825ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:46:44.38' AND status != 'pending'
	

2025/06/19 22:46:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.342ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:46:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.528ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:46:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.322ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:46:44.446' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:46:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.640ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:46:44.503' AND status != 'pending'
	

2025/06/19 22:46:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.435ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:46:44.511'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:46:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.123ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:46:44.564' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:46:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.471ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:46:44.625'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:46:50 /Users/wensiyuan/go/go-admin-sass-github/controllers/admin/upload.go:39
[62.603ms] [rows:1] SELECT * FROM `config_setting` WHERE type = 'oss_code'

2025/06/19 22:47:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.800ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:47:44.177'

2025/06/19 22:47:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.203ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:47:44.177'

2025/06/19 22:47:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.034ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:47:44.177'

2025/06/19 22:47:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.015ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:17:44.577'

2025/06/19 22:47:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.766ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:47:44.64' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:47:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.841ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:47:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.639ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:17:44.686'

2025/06/19 22:47:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.665ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:47:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[68.700ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:47:44.752' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:47:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.118ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:47:44.764' AND status != 'pending'
	

2025/06/19 22:47:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[35.703ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:47:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.501ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:47:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.046ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:47:44.826' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:47:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.310ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:47:44.889' AND status != 'pending'
	

2025/06/19 22:47:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.383ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:47:44.893'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:47:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.284ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:47:44.956' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:47:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.344ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:47:45.021'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:48:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.598ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:33:44.177' LIMIT 50

2025/06/19 22:48:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.115ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:48:44.176'

2025/06/19 22:48:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.712ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:48:44.176'

2025/06/19 22:48:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.942ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:48:44.176'

2025/06/19 22:48:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[195.244ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:33:44.188' LIMIT 50

2025/06/19 22:48:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.042ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:18:44.576'

2025/06/19 22:48:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.437ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:48:44.64' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:48:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.635ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:48:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.051ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:18:44.687'

2025/06/19 22:48:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.283ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:48:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.436ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:48:44.753' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:48:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.525ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:48:44.768' AND status != 'pending'
	

2025/06/19 22:48:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.546ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:48:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.308ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:48:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.414ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:48:44.831' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:48:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.041ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:48:44.883' AND status != 'pending'
	

2025/06/19 22:48:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.492ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:48:44.894'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:48:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.400ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:48:44.948' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:48:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.310ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:48:45.014'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:49:13 /Users/wensiyuan/go/go-admin-sass-github/controllers/admin/upload.go:39
[65.188ms] [rows:1] SELECT * FROM `config_setting` WHERE type = 'oss_code'

2025/06/19 22:49:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.233ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:49:44.176'

2025/06/19 22:49:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[68.451ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:49:44.176'

2025/06/19 22:49:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.827ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:49:44.176'

2025/06/19 22:49:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.721ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:19:44.576'

2025/06/19 22:49:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.722ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:49:44.642' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:49:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.038ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:49:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.156ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:19:44.686'

2025/06/19 22:49:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.180ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:49:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.065ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:49:44.751' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:49:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.723ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:49:44.773' AND status != 'pending'
	

2025/06/19 22:49:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.131ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:49:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.264ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:49:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.222ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:49:44.838' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:49:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.014ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:49:44.875' AND status != 'pending'
	

2025/06/19 22:49:44 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.146ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:49:44.903'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:49:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.039ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:49:44.938' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:49:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.599ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:49:45.001'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[72.746ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:19:48.149'

2025/06/19 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.416ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:49:48.222' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.901ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.109ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[197.112ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:19:48.163'

2025/06/19 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.190ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:49:48.348' AND status != 'pending'
	

2025/06/19 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.060ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:49:48.36' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.569ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.938ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:49:48.41' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.011ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.988ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:49:48.471'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.842ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:49:48.484' AND status != 'pending'
	

2025/06/19 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.088ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:49:48.546' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:49:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.209ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:49:48.608'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:49:55 /Users/wensiyuan/go/go-admin-sass-github/controllers/admin/upload.go:40
[63.641ms] [rows:1] SELECT * FROM `config_setting` WHERE type = 'oss_code'

2025/06/19 22:50:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.583ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:20:49.638'

2025/06/19 22:50:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.266ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:50:49.706' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:50:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.614ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:50:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[188.060ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:20:49.645'

2025/06/19 22:50:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.373ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:50:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.917ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:50:49.833' AND status != 'pending'
	

2025/06/19 22:50:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.846ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:50:49.833' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:50:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.891ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:50:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.007ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:50:49.894' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:50:49 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.535ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:50:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.561ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:50:49.955'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:50:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.214ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:50:49.961' AND status != 'pending'
	

2025/06/19 22:50:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.646ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:50:50.025' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:50:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.099ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:50:50.089'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:50:56 /Users/wensiyuan/go/go-admin-sass-github/controllers/admin/upload.go:40
[65.412ms] [rows:1] SELECT * FROM `config_setting` WHERE type = 'oss_code'

2025/06/19 22:51:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.363ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:21:50.499'

2025/06/19 22:51:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.603ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:51:50.562' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:51:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.591ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:51:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.393ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:51:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[199.296ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:21:50.508'

2025/06/19 22:51:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.122ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:51:50.677' AND status != 'pending'
	

2025/06/19 22:51:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.053ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:51:50.708' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:51:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.008ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:51:50.735' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:51:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.389ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:51:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.538ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:51:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.939ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:51:50.793'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:51:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.332ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:51:50.838' AND status != 'pending'
	

2025/06/19 22:51:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.803ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:51:50.901' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:51:51 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.371ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:51:50.966'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:52:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.750ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:22:21.418'

2025/06/19 22:52:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.086ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:52:21.481' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:52:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.905ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:52:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.704ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:52:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[207.361ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:22:21.424'

2025/06/19 22:52:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.347ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:52:21.602' AND status != 'pending'
	

2025/06/19 22:52:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.152ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:52:21.632' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:52:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.686ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:52:21.662' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:52:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.080ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:52:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.347ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:52:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.519ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:52:21.722'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:52:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.696ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:52:21.765' AND status != 'pending'
	

2025/06/19 22:52:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.121ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:52:21.832' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:52:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.432ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:52:21.899'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:52:28 /Users/wensiyuan/go/go-admin-sass-github/controllers/admin/upload.go:40
[67.131ms] [rows:1] SELECT * FROM `config_setting` WHERE type = 'oss_code'

2025/06/19 22:53:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[70.820ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:53:21.42'

2025/06/19 22:53:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.564ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:53:21.42'

2025/06/19 22:53:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[67.322ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:53:21.42'

2025/06/19 22:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[71.672ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:23:24.663'

2025/06/19 22:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.849ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:53:24.735' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.136ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.048ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[200.265ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:23:24.677'

2025/06/19 22:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.425ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:53:24.862' AND status != 'pending'
	

2025/06/19 22:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.170ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:53:24.878' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.525ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.221ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:53:24.925' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:53:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.327ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:53:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.663ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:53:24.988'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:53:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.158ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:53:25.007' AND status != 'pending'
	

2025/06/19 22:53:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.142ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:53:25.072' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:53:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.845ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:53:25.137'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:53:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[70.033ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:23:31.413'

2025/06/19 22:53:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.964ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:53:31.483' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:53:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.951ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:53:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.436ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:53:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[191.025ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:23:31.424'

2025/06/19 22:53:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.439ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:53:31.61' AND status != 'pending'
	

2025/06/19 22:53:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.044ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:53:31.615' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:53:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.990ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:53:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.257ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:53:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.905ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:53:31.674' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:53:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.255ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:53:31.74' AND status != 'pending'
	

2025/06/19 22:53:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.559ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:53:31.741'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:53:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.825ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:53:31.802' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:53:31 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.035ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:53:31.863'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:53:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.786ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:23:52.055'

2025/06/19 22:53:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.478ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:53:52.121' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:53:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.271ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:53:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.519ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:53:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[193.025ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:23:52.064'

2025/06/19 22:53:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.952ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:53:52.238' AND status != 'pending'
	

2025/06/19 22:53:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.802ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:53:52.258' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:53:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.874ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:53:52.295' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:53:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.745ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:53:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.023ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:53:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.482ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:53:52.353'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:53:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.703ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:53:52.385' AND status != 'pending'
	

2025/06/19 22:53:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.247ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:53:52.446' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:53:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.969ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:53:52.509'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:54:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.702ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:54:52.052'

2025/06/19 22:54:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.048ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:54:52.052'

2025/06/19 22:54:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.889ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:54:52.052'

2025/06/19 22:54:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.111ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:24:52.412'

2025/06/19 22:54:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.740ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:54:52.476' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:54:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.267ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:54:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.764ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:54:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.793ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:24:52.572'

2025/06/19 22:54:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.032ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:54:52.602' AND status != 'pending'
	

2025/06/19 22:54:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.615ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:54:52.63' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:54:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.563ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:54:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.718ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:54:52.663' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:54:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.129ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:54:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.974ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:54:52.725'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:54:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.625ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:54:52.746' AND status != 'pending'
	

2025/06/19 22:54:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.475ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:54:52.804' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:54:52 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.136ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:54:52.861'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[70.371ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:25:07.771'

2025/06/19 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.583ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:55:07.842' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.536ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.377ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:55:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[195.674ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:25:07.782'

2025/06/19 22:55:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.012ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:55:07.978' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:55:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.440ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:55:07.977' AND status != 'pending'
	

2025/06/19 22:55:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.068ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:55:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.444ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:55:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.456ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:55:08.04' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:55:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.633ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:55:08.101' AND status != 'pending'
	

2025/06/19 22:55:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.207ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:55:08.103'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:55:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.763ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:55:08.163' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:55:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.053ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:55:08.225'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:55:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.895ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:25:13.472'

2025/06/19 22:55:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.761ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:55:13.539' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:55:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.221ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:55:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.315ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:55:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[193.244ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:25:13.48'

2025/06/19 22:55:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.286ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:55:13.66' AND status != 'pending'
	

2025/06/19 22:55:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.176ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:55:13.673' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:55:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.296ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:55:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.323ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:55:13.719' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:55:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.409ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:55:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.756ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:55:13.781'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:55:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[95.864ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:55:13.799' AND status != 'pending'
	

2025/06/19 22:55:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.165ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:55:13.895' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:55:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.324ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:55:13.958'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:55:18 /Users/wensiyuan/go/go-admin-sass-github/controllers/admin/upload.go:40
[62.806ms] [rows:1] SELECT * FROM `config_setting` WHERE type = 'oss_code'

2025/06/19 22:56:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.525ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 22:56:13.472'

2025/06/19 22:56:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.814ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 22:56:13.472'

2025/06/19 22:56:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.821ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 22:56:13.472'

2025/06/19 22:56:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.263ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:26:13.844'

2025/06/19 22:56:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.763ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:56:13.907' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:56:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.503ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:56:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.725ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:56:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.574ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:26:14.023'

2025/06/19 22:56:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.971ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:56:14.033' AND status != 'pending'
	

2025/06/19 22:56:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.769ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:56:14.084' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:56:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.738ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:56:14.095' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:56:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.766ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:56:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.227ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:56:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.323ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:56:14.158'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:56:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.391ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:56:14.209' AND status != 'pending'
	

2025/06/19 22:56:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.121ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:56:14.268' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:56:14 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.266ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:56:14.328'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:56:58 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.793ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:26:58.932'

2025/06/19 22:56:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.596ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:56:58.997' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:56:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.908ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:56:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.691ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:56:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[200.150ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:26:58.943'

2025/06/19 22:56:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.066ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:56:59.124' AND status != 'pending'
	

2025/06/19 22:56:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.585ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:56:59.144' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:56:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.597ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:56:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.851ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:56:59.186' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:56:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.207ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:56:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.176ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:56:59.247'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:56:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.641ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:56:59.273' AND status != 'pending'
	

2025/06/19 22:56:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.069ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:56:59.337' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:56:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.769ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:56:59.4'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[75.748ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:27:07.733'

2025/06/19 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.193ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:57:07.809' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.887ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.629ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:57:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[198.909ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:27:07.749'

2025/06/19 22:57:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.272ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:57:07.938' AND status != 'pending'
	

2025/06/19 22:57:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.944ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:57:07.948' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:57:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.027ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:57:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.798ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:57:08.003' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:57:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.169ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:57:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.244ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:57:08.069'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:57:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.677ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:57:08.077' AND status != 'pending'
	

2025/06/19 22:57:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.826ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:57:08.142' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:57:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.897ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:57:08.207'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:58:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[69.577ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:28:23.772'

2025/06/19 22:58:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.186ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:58:23.842' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:58:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.657ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:58:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.470ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:58:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[199.877ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:28:23.784'

2025/06/19 22:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.581ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:58:23.978' AND status != 'pending'
	

2025/06/19 22:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.749ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:58:23.984' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.340ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.552ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:58:24.042' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.473ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.358ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:58:24.105'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.843ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:58:24.113' AND status != 'pending'
	

2025/06/19 22:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.414ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:58:24.178' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.403ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:58:24.242'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:58:31 /Users/wensiyuan/go/go-admin-sass-github/controllers/admin/upload.go:40
[65.229ms] [rows:1] SELECT * FROM `config_setting` WHERE type = 'oss_code'

2025/06/19 22:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.187ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:29:24.521'

2025/06/19 22:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.985ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:59:24.588' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.524ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.886ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[202.012ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:29:24.534'

2025/06/19 22:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.651ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:59:24.71' AND status != 'pending'
	

2025/06/19 22:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.987ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:59:24.737' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.436ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:59:24.77' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.937ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.765ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.386ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:59:24.832'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.278ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:59:24.865' AND status != 'pending'
	

2025/06/19 22:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.339ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:59:24.928' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:59:25 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.854ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:59:24.994'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:59:30 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.040ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:29:30.062'

2025/06/19 22:59:30 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.545ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:59:30.128' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:59:30 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.177ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:59:30 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.805ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:59:30 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[195.451ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:29:30.075'

2025/06/19 22:59:30 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.221ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:59:30.257' AND status != 'pending'
	

2025/06/19 22:59:30 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.472ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:59:30.271' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:59:30 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.819ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:59:30 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.725ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:59:30.322' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:59:30 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.527ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:59:30 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.482ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:59:30.386'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:59:30 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.978ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:59:30.398' AND status != 'pending'
	

2025/06/19 22:59:30 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.705ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:59:30.462' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:59:30 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.326ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:59:30.524'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:59:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[72.359ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:29:40.837'

2025/06/19 22:59:40 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.124ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:59:40.91' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.496ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.160ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[198.587ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:29:40.85'

2025/06/19 22:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.971ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:59:41.036' AND status != 'pending'
	

2025/06/19 22:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.173ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:59:41.05' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.754ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.306ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:59:41.099' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.221ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.806ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:59:41.163'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.795ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:59:41.182' AND status != 'pending'
	

2025/06/19 22:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.206ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:59:41.247' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:59:41 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.782ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:59:41.311'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:59:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.191ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:29:55.886'

2025/06/19 22:59:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.994ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:59:55.946' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:59:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.332ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:59:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.350ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:59:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[199.199ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:29:55.895'

2025/06/19 22:59:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.045ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:59:56.064' AND status != 'pending'
	

2025/06/19 22:59:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.810ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 21:59:56.094' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 22:59:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.173ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:59:56.124' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:59:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.904ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 22:59:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.309ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 22:59:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.436ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:59:56.183'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 22:59:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.026ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 21:59:56.224' AND status != 'pending'
	

2025/06/19 22:59:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.961ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 21:59:56.288' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 22:59:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.694ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 21:59:56.352'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:00:02 /Users/wensiyuan/go/go-admin-sass-github/controllers/admin/upload.go:40
[64.678ms] [rows:1] SELECT * FROM `config_setting` WHERE type = 'oss_code'

2025/06/19 23:00:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[69.389ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:00:55.884'

2025/06/19 23:00:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.361ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:00:55.884'

2025/06/19 23:00:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.249ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:00:55.884'

2025/06/19 23:00:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.199ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:30:56.242'

2025/06/19 23:00:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.278ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:00:56.308' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:00:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.135ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:00:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.078ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:00:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.510ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:30:56.419'

2025/06/19 23:00:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.927ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:00:56.437' AND status != 'pending'
	

2025/06/19 23:00:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.515ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:00:56.48' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:00:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.491ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:00:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.125ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:00:56.502' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:00:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.139ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:00:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.454ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:00:56.568'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:00:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.325ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:00:56.597' AND status != 'pending'
	

2025/06/19 23:00:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.022ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:00:56.656' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:00:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.723ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:00:56.717'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[59.329ms] [rows:1] SELECT * FROM `user` WHERE (username = '16620436582' OR phone = '16620436582') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:480
[58.451ms] [rows:9] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/19 23:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:492 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[28.278ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,10,11,12,13,14,15,22)

2025/06/19 23:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[58.762ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 8 ORDER BY `user`.`user_type` LIMIT 1

2025/06/19 23:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:88
[58.612ms] [rows:9] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/19 23:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:104
[58.679ms] [rows:9] SELECT * FROM `permission_user` WHERE id IN (1,2,10,11,12,13,14,15,22) ORDER BY sort DESC

2025/06/19 23:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[33.379ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 23:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.271ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 23:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.860ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 23:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.963ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 23:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.721ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 23:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.911ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 23:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.133ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 23:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.356ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 23:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.979ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 23:01:24 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.711ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 23:01:24 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.707ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 23:01:24 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.261ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 23:01:24 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.681ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 23:01:27 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[57.870ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:01:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:208
[57.145ms] [rows:1] SELECT count(*) FROM `user` WHERE parent_id = 8

2025/06/19 23:01:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:216
[58.281ms] [rows:1] SELECT * FROM `user` WHERE parent_id = 8 LIMIT 10

2025/06/19 23:01:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:139
[58.029ms] [rows:1] SELECT * FROM `user` WHERE id = 12 ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:01:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[28.334ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 23:01:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[56.368ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/19 23:01:33 /Users/wensiyuan/go/go-admin-sass-github/controllers/admin/upload.go:40
[58.993ms] [rows:1] SELECT * FROM `config_setting` WHERE type = 'oss_code'

2025/06/19 23:01:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:74
[57.672ms] [rows:1] SELECT * FROM `user` WHERE id = 12 ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:01:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:91
[119.720ms] [rows:1] UPDATE `user` SET `avatar`='https://ark-auto-2102366935-cn-beijing-default.tos-cn-beijing.volces.com/uploads/20250619230133000.jpg',`enable`='active',`phone`='16620436581',`role_id`=5,`sex`=0,`update_time`='2025-06-19 23:01:36.365',`user_type`=3,`username`='松鼠上架员' WHERE `id` = 12

2025/06/19 23:01:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[57.007ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:01:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:208
[56.923ms] [rows:1] SELECT count(*) FROM `user` WHERE parent_id = 8

2025/06/19 23:01:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:216
[58.213ms] [rows:1] SELECT * FROM `user` WHERE parent_id = 8 LIMIT 10

2025/06/19 23:01:41 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[58.491ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:01:41 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:208
[57.418ms] [rows:1] SELECT count(*) FROM `user` WHERE parent_id = 8

2025/06/19 23:01:41 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:216
[58.286ms] [rows:1] SELECT * FROM `user` WHERE parent_id = 8 LIMIT 10

2025/06/19 23:01:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[58.151ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:01:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:208
[57.754ms] [rows:1] SELECT count(*) FROM `user` WHERE parent_id = 8

2025/06/19 23:01:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:216
[58.243ms] [rows:1] SELECT * FROM `user` WHERE parent_id = 8 LIMIT 10

2025/06/19 23:01:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[30.092ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 23:01:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.722ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 23:01:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.143ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 23:01:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.678ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 23:01:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.199ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 23:01:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.812ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 23:01:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.329ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 23:01:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.200ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 23:01:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.938ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 23:01:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.606ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 23:01:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.153ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 23:01:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.224ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 23:01:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.694ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 23:01:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[58.577ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:01:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:208
[58.211ms] [rows:1] SELECT count(*) FROM `user` WHERE parent_id = 8

2025/06/19 23:01:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:216
[58.875ms] [rows:1] SELECT * FROM `user` WHERE parent_id = 8 LIMIT 10

2025/06/19 23:01:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[57.881ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:01:55.884'

2025/06/19 23:01:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.669ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:46:55.885' LIMIT 50

2025/06/19 23:01:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.007ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:01:55.884'

2025/06/19 23:01:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.535ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:01:55.884'

2025/06/19 23:01:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[182.039ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:46:55.895' LIMIT 50

2025/06/19 23:01:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.921ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:31:56.243'

2025/06/19 23:01:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.253ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:01:56.304' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:01:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.476ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:01:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.798ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:01:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.262ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:31:56.419'

2025/06/19 23:01:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.977ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:01:56.421' AND status != 'pending'
	

2025/06/19 23:01:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.613ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:01:56.476' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:01:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.726ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:01:56.479' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:01:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.577ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:01:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.941ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:01:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.491ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:01:56.537'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:01:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.044ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:01:56.593' AND status != 'pending'
	

2025/06/19 23:01:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.211ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:01:56.651' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:01:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.904ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:01:56.709'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:02:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[68.418ms] [rows:1] SELECT * FROM `user` WHERE (username = 'admin' OR phone = 'admin') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:02:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:480
[57.210ms] [rows:9] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 4

2025/06/19 23:02:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:492 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[28.860ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,3,4,5,6,7,8,23)

2025/06/19 23:02:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[57.214ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/19 23:02:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[29.653ms] [rows:18] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/19 23:02:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[28.473ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 23:02:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.683ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 23:02:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.454ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 23:02:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.829ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 23:02:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.923ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 23:02:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.833ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 23:02:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.629ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 23:02:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.139ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 23:02:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.498ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 23:02:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.864ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 23:02:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.600ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 23:02:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.649ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 23:02:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.379ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 23:02:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[29.519ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 23:02:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[58.935ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/19 23:02:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:309
[60.273ms] [rows:1] SELECT * FROM `role` WHERE id = 5 ORDER BY `role`.`id` LIMIT 1

2025/06/19 23:02:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:320
[57.886ms] [rows:9] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/19 23:02:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:205
[58.099ms] [rows:9] DELETE FROM `role_permissions_permission` WHERE roleId = 5

2025/06/19 23:02:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:243
[59.708ms] [rows:10] INSERT INTO `role_permissions_permission` (`roleId`,`permissionId`) VALUES (5,2),(5,22),(5,23),(5,10),(5,15),(5,11),(5,12),(5,13),(5,14),(5,1)

2025/06/19 23:02:27 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[58.751ms] [rows:1] SELECT * FROM `user` WHERE (username = '16620436582' OR phone = '16620436582') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:02:27 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:480
[57.100ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/19 23:02:27 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:492 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[28.840ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,10,11,12,13,14,15,22,23)

2025/06/19 23:02:27 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[28.569ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 23:02:27 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.258ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 23:02:27 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.549ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 23:02:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.479ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 23:02:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.535ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 23:02:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.193ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 23:02:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.478ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 23:02:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.810ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 23:02:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.691ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 23:02:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.130ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 23:02:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.446ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 23:02:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.420ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 23:02:28 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.093ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 23:02:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[28.473ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 23:02:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[56.926ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 23:02:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.576ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 23:02:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.990ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 23:02:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.252ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 23:02:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[56.638ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 23:02:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.839ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 23:02:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[56.533ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 23:02:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.386ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 23:02:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.875ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 23:02:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.462ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 23:02:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.776ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 23:02:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.974ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 23:02:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[58.249ms] [rows:1] SELECT * FROM `user` WHERE (username = 'admin' OR phone = 'admin') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:02:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:480
[59.260ms] [rows:9] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 4

2025/06/19 23:02:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:492 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[28.820ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,3,4,5,6,7,8,23)

2025/06/19 23:02:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[29.708ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 23:02:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.257ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 23:02:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.888ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 23:02:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.829ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 23:02:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.983ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 23:02:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.690ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 23:02:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.811ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 23:02:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.610ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 23:02:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.714ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 23:02:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.180ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 23:02:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.310ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 23:02:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.738ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 23:02:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.967ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 23:02:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[28.758ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 23:02:49 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[58.019ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/19 23:02:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:309
[58.469ms] [rows:1] SELECT * FROM `role` WHERE id = 3 ORDER BY `role`.`id` LIMIT 1

2025/06/19 23:02:51 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:320
[57.838ms] [rows:0] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 3

2025/06/19 23:02:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:309
[57.919ms] [rows:1] SELECT * FROM `role` WHERE id = 4 ORDER BY `role`.`id` LIMIT 1

2025/06/19 23:02:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:320
[57.115ms] [rows:9] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 4

2025/06/19 23:02:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.156ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:02:55.884'

2025/06/19 23:02:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.054ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:02:55.884'

2025/06/19 23:02:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.609ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:02:55.884'

2025/06/19 23:02:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.521ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:32:56.243'

2025/06/19 23:02:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.667ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:02:56.302' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:02:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.798ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:02:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.770ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:02:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.719ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:02:56.418' AND status != 'pending'
	

2025/06/19 23:02:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.057ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:32:56.418'

2025/06/19 23:02:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.432ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:02:56.476' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:02:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.499ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:02:56.477' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:02:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.595ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:02:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.235ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:02:56.535'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:02:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.161ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:02:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.519ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:02:56.593' AND status != 'pending'
	

2025/06/19 23:02:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.815ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:02:56.65' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:02:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.849ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:02:56.708'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:03:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[58.474ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:03:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[28.343ms] [rows:1] SELECT count(*) FROM `user`

2025/06/19 23:03:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[57.651ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/19 23:03:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:139
[57.442ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:03:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[28.807ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 23:03:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[57.797ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/19 23:03:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:74
[57.832ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:03:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:91
[116.023ms] [rows:1] UPDATE `user` SET `avatar`='',`enable`='active',`phone`='16620436582',`role_id`=5,`sex`=0,`update_time`='2025-06-19 23:03:08.637',`user_type`=2,`username`='松鼠商店' WHERE `id` = 8

2025/06/19 23:03:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[57.786ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:03:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[28.655ms] [rows:1] SELECT count(*) FROM `user`

2025/06/19 23:03:09 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[57.653ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/19 23:03:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[59.522ms] [rows:1] SELECT * FROM `user` WHERE (username = '16620436582' OR phone = '16620436582') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:03:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:480
[57.697ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/19 23:03:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:492 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[28.895ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,10,11,12,13,14,15,22,23)

2025/06/19 23:03:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[28.889ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 23:03:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.341ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 23:03:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.050ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 23:03:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.391ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 23:03:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.916ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 23:03:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.393ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 23:03:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.535ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 23:03:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.452ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 23:03:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.272ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 23:03:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.114ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 23:03:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[57.761ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 23:03:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.071ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 23:03:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.162ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 23:03:44 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[28.866ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 23:03:44 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[58.827ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/19 23:03:47 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:309
[59.094ms] [rows:1] SELECT * FROM `role` WHERE id = 6 ORDER BY `role`.`id` LIMIT 1

2025/06/19 23:03:47 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:320
[58.809ms] [rows:4] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 6

2025/06/19 23:03:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:309
[58.614ms] [rows:1] SELECT * FROM `role` WHERE id = 7 ORDER BY `role`.`id` LIMIT 1

2025/06/19 23:03:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:320
[58.379ms] [rows:0] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 7

2025/06/19 23:03:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.164ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:48:55.884' LIMIT 50

2025/06/19 23:03:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.630ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:03:55.884'

2025/06/19 23:03:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.935ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:48:55.895' LIMIT 50

2025/06/19 23:03:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.754ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:03:55.884'

2025/06/19 23:03:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.942ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:03:55.884'

2025/06/19 23:03:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.926ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:33:56.243'

2025/06/19 23:03:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.044ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:03:56.304' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:03:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.956ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:03:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.769ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:03:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.546ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:03:56.42' AND status != 'pending'
	

2025/06/19 23:03:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.885ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:33:56.419'

2025/06/19 23:03:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.802ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:03:56.478' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:03:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.379ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:03:56.483' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:03:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.302ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:03:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.787ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:03:56.536'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:03:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.094ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:03:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.450ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:03:56.613' AND status != 'pending'
	

2025/06/19 23:03:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.579ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:03:56.679' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:03:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.985ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:03:56.743'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:03:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:309
[65.546ms] [rows:1] SELECT * FROM `role` WHERE id = 5 ORDER BY `role`.`id` LIMIT 1

2025/06/19 23:03:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:320
[64.666ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/19 23:04:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[64.566ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:04:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:208
[64.264ms] [rows:1] SELECT count(*) FROM `user` WHERE parent_id = 8

2025/06/19 23:04:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:216
[65.349ms] [rows:1] SELECT * FROM `user` WHERE parent_id = 8 LIMIT 10

2025/06/19 23:04:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[66.934ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:04:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[32.473ms] [rows:1] SELECT count(*) FROM `user`

2025/06/19 23:04:15 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[65.222ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/19 23:04:27 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:139
[65.215ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:04:27 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[31.277ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 23:04:27 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[64.571ms] [rows:5] SELECT * FROM `role` LIMIT 1000

2025/06/19 23:04:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:74
[65.059ms] [rows:1] SELECT * FROM `user` WHERE id = 8 ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:04:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:91
[131.731ms] [rows:1] UPDATE `user` SET `avatar`='',`enable`='active',`phone`='16620436582',`role_id`=5,`sex`=0,`update_time`='2025-06-19 23:04:31.376',`user_type`=2,`username`='松鼠商店' WHERE `id` = 8

2025/06/19 23:04:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:190
[65.154ms] [rows:1] SELECT * FROM `user` WHERE id = 1 ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:04:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[31.742ms] [rows:1] SELECT count(*) FROM `user`

2025/06/19 23:04:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/employee.go:236
[69.589ms] [rows:3] SELECT * FROM `user` LIMIT 10

2025/06/19 23:04:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[69.077ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:04:55.883'

2025/06/19 23:04:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.478ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:04:55.883'

2025/06/19 23:04:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.617ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:04:55.883'

2025/06/19 23:04:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.706ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:34:56.242'

2025/06/19 23:04:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.945ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:04:56.309' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:04:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.357ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:04:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.098ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:04:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.725ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:34:56.418'

2025/06/19 23:04:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.692ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:04:56.44' AND status != 'pending'
	

2025/06/19 23:04:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.033ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:04:56.478' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:04:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.935ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:04:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.101ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:04:56.506' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:04:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.914ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:04:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.914ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:04:56.57'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:04:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.365ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:04:56.597' AND status != 'pending'
	

2025/06/19 23:04:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.682ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:04:56.658' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:04:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.124ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:04:56.721'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:05:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.985ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:50:55.883' LIMIT 50

2025/06/19 23:05:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[77.261ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:05:55.883'

2025/06/19 23:05:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.321ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:50:55.894' LIMIT 50

2025/06/19 23:05:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[93.705ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:05:55.883'

2025/06/19 23:05:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[78.069ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:05:55.883'

2025/06/19 23:05:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.228ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:35:56.242'

2025/06/19 23:05:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.052ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:05:56.308' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:05:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.718ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:05:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.740ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:05:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.876ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:35:56.418'

2025/06/19 23:05:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.828ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:05:56.448' AND status != 'pending'
	

2025/06/19 23:05:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.875ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:05:56.478' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:05:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.298ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:05:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.331ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:05:56.512' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:05:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.652ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:05:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.536ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:05:56.576'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:05:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.657ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:05:56.597' AND status != 'pending'
	

2025/06/19 23:05:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.815ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:05:56.657' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:05:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.087ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:05:56.717'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:06:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.504ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:06:55.883'

2025/06/19 23:06:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.468ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:06:55.883'

2025/06/19 23:06:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.843ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:06:55.883'

2025/06/19 23:06:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.201ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:36:56.242'

2025/06/19 23:06:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.892ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:06:56.302' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:06:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.974ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:06:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.462ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:06:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.644ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:06:56.421' AND status != 'pending'
	

2025/06/19 23:06:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.407ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:36:56.418'

2025/06/19 23:06:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[84.801ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:06:56.483' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:06:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[91.591ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:06:56.484' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:06:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.943ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:06:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[81.267ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:06:56.568'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:06:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[35.520ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:06:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[91.407ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:06:56.65' AND status != 'pending'
	

2025/06/19 23:06:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[77.213ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:06:56.741' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:06:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[85.631ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:06:56.819'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:07:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.135ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:52:55.883' LIMIT 50

2025/06/19 23:07:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.258ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:07:55.883'

2025/06/19 23:07:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.120ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:52:55.894' LIMIT 50

2025/06/19 23:07:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.355ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:07:55.883'

2025/06/19 23:07:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.603ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:07:55.883'

2025/06/19 23:07:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[79.902ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:37:56.241'

2025/06/19 23:07:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.580ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:07:56.321' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:07:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[37.991ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:07:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.435ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:07:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.704ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:37:56.418'

2025/06/19 23:07:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.967ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:07:56.46' AND status != 'pending'
	

2025/06/19 23:07:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.120ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:07:56.477' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:07:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.659ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:07:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.847ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:07:56.524' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:07:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.468ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:07:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.823ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:07:56.595' AND status != 'pending'
	

2025/06/19 23:07:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.145ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:07:56.589'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:07:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.177ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:07:56.654' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:07:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.273ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:07:56.712'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:08:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.209ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:08:55.883'

2025/06/19 23:08:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.411ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:08:55.883'

2025/06/19 23:08:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.490ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:08:55.883'

2025/06/19 23:08:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.433ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:38:56.242'

2025/06/19 23:08:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.906ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:08:56.302' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:08:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.311ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:08:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.352ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:08:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.083ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:08:56.419' AND status != 'pending'
	

2025/06/19 23:08:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.983ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:38:56.418'

2025/06/19 23:08:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.602ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:08:56.478' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:08:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.897ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:08:56.483' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:08:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.663ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:08:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.809ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:08:56.536'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:08:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.172ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:08:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.175ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:08:56.613' AND status != 'pending'
	

2025/06/19 23:08:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.480ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:08:56.679' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:08:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.372ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:08:56.744'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:09:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.475ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:09:55.882'

2025/06/19 23:09:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.164ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:54:55.883' LIMIT 50

2025/06/19 23:09:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.823ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:54:55.894' LIMIT 50

2025/06/19 23:09:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.702ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:09:55.882'

2025/06/19 23:09:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[74.337ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:09:55.882'

2025/06/19 23:09:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.653ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:39:56.243'

2025/06/19 23:09:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.337ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:09:56.303' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:09:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.703ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:09:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.875ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:09:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.213ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:09:56.419' AND status != 'pending'
	

2025/06/19 23:09:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.413ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:39:56.418'

2025/06/19 23:09:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.127ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:09:56.48' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:09:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.265ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:09:56.481' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:09:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.376ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:09:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.020ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:09:56.54'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:09:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.656ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:09:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.379ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:09:56.601' AND status != 'pending'
	

2025/06/19 23:09:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.695ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:09:56.659' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:09:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.634ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:09:56.719'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:10:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.466ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:10:55.884'

2025/06/19 23:10:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.521ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:10:55.884'

2025/06/19 23:10:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.897ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:10:55.884'

2025/06/19 23:10:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.956ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:40:56.243'

2025/06/19 23:10:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.177ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:10:56.304' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:10:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.756ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:10:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.273ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:10:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.079ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:40:56.418'

2025/06/19 23:10:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.130ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:10:56.441' AND status != 'pending'
	

2025/06/19 23:10:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.170ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:10:56.477' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:10:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.265ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:10:56.5' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:10:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.877ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:10:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.553ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:10:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.503ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:10:56.562'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:10:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.567ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:10:56.603' AND status != 'pending'
	

2025/06/19 23:10:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.253ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:10:56.662' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:10:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.243ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:10:56.727'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:11:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.146ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:56:55.882' LIMIT 50

2025/06/19 23:11:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.571ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:11:55.882'

2025/06/19 23:11:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.187ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:56:55.894' LIMIT 50

2025/06/19 23:11:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.077ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:11:55.882'

2025/06/19 23:11:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.425ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:11:55.882'

2025/06/19 23:11:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.869ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:41:56.241'

2025/06/19 23:11:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.902ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:11:56.301' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:11:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.847ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:11:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.909ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:11:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.884ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:11:56.417' AND status != 'pending'
	

2025/06/19 23:11:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.455ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:41:56.417'

2025/06/19 23:11:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.501ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:11:56.475' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:11:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.965ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:11:56.481' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:11:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.575ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:11:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.827ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:11:56.533'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:11:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.396ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:11:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.975ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:11:56.611' AND status != 'pending'
	

2025/06/19 23:11:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.166ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:11:56.676' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:11:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.751ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:11:56.74'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:11:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:158
[65.039ms] [rows:1] SELECT * FROM `user` WHERE (username = '16620436582' OR phone = '16620436582') AND password = 'e10adc3949ba59abbe56e057f20f883e' ORDER BY `user`.`id` LIMIT 1

2025/06/19 23:11:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:480
[63.920ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/19 23:11:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/user.go:492 Error 1054 (42S22): Unknown column 'permiss_rule' in 'field list'
[31.831ms] [rows:0] SELECT rule, permiss_rule FROM `permission_user` WHERE id IN (1,2,10,11,12,13,14,15,22,23)

2025/06/19 23:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[32.611ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 23:12:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[63.430ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/19 23:12:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:309
[64.929ms] [rows:1] SELECT * FROM `role` WHERE id = 5 ORDER BY `role`.`id` LIMIT 1

2025/06/19 23:12:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:320
[64.759ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/19 23:12:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.133ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:12:55.883'

2025/06/19 23:12:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.809ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:12:55.883'

2025/06/19 23:12:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.535ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:12:55.883'

2025/06/19 23:12:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.230ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:42:56.241'

2025/06/19 23:12:56 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:38
[28.678ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/19 23:12:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.736ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:12:56.307' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:12:56 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:44
[57.365ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/19 23:12:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.832ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:12:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.182ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:12:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.210ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:42:56.417'

2025/06/19 23:12:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.822ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:12:56.435' AND status != 'pending'
	

2025/06/19 23:12:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.096ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:12:56.474' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:12:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.353ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:12:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.505ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:12:56.499' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:12:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.497ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:12:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.318ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:12:56.563'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:12:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.510ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:12:56.591' AND status != 'pending'
	

2025/06/19 23:12:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.507ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:12:56.649' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:12:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.049ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:12:56.707'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:13:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.638ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:13:55.882'

2025/06/19 23:13:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.534ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:58:55.882' LIMIT 50

2025/06/19 23:13:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.282ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:58:55.893' LIMIT 50

2025/06/19 23:13:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.409ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:13:55.882'

2025/06/19 23:13:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.884ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:13:55.882'

2025/06/19 23:13:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.187ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:43:56.241'

2025/06/19 23:13:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.452ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:13:56.3' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:13:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.366ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:13:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.281ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:13:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.366ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:13:56.417' AND status != 'pending'
	

2025/06/19 23:13:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.292ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:43:56.417'

2025/06/19 23:13:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.848ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:13:56.475' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:13:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.932ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:13:56.476' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:13:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.383ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:13:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.364ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:13:56.533'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:13:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.660ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:13:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.821ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:13:56.593' AND status != 'pending'
	

2025/06/19 23:13:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.698ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:13:56.652' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:13:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.647ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:13:56.711'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:14:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.638ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:14:55.882'

2025/06/19 23:14:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.687ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:14:55.882'

2025/06/19 23:14:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.534ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:14:55.882'

2025/06/19 23:14:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.995ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:44:56.241'

2025/06/19 23:14:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.771ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:14:56.301' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:14:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.645ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:14:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.946ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:14:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.250ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:44:56.417'

2025/06/19 23:14:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.615ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:14:56.42' AND status != 'pending'
	

2025/06/19 23:14:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.317ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:14:56.475' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:14:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.546ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:14:56.478' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:14:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.411ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:14:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.064ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:14:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.363ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:14:56.54'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:14:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.906ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:14:56.594' AND status != 'pending'
	

2025/06/19 23:14:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.269ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:14:56.652' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:14:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.862ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:14:56.71'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:15:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.914ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:00:55.882' LIMIT 50

2025/06/19 23:15:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.161ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:15:55.882'

2025/06/19 23:15:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.607ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:00:55.893' LIMIT 50

2025/06/19 23:15:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.080ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:15:55.882'

2025/06/19 23:15:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.053ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:15:55.882'

2025/06/19 23:15:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.437ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:45:56.241'

2025/06/19 23:15:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.276ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:15:56.3' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:15:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.484ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:15:56 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[31.658ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 23:15:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.048ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:15:56 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[64.530ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/19 23:15:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.986ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:45:56.417'

2025/06/19 23:15:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.114ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:15:56.418' AND status != 'pending'
	

2025/06/19 23:15:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.104ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:15:56.475' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:15:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.639ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:15:56.475' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:15:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.153ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:15:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.140ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:15:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.076ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:15:56.534'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:15:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.915ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:15:56.594' AND status != 'pending'
	

2025/06/19 23:15:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.620ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:15:56.653' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:15:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.407ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:15:56.71'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:15:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[28.846ms] [rows:1] SELECT count(*) FROM `role`

2025/06/19 23:15:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:150
[58.141ms] [rows:5] SELECT * FROM `role` LIMIT 10

2025/06/19 23:16:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:309
[58.026ms] [rows:1] SELECT * FROM `role` WHERE id = 5 ORDER BY `role`.`id` LIMIT 1

2025/06/19 23:16:04 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:320
[58.550ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/19 23:16:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:309
[58.298ms] [rows:1] SELECT * FROM `role` WHERE id = 5 ORDER BY `role`.`id` LIMIT 1

2025/06/19 23:16:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/role.go:320
[57.888ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/19 23:16:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.549ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:16:55.882'

2025/06/19 23:16:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.859ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:16:55.882'

2025/06/19 23:16:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.939ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:16:55.882'

2025/06/19 23:16:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.236ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:46:56.241'

2025/06/19 23:16:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.462ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:16:56.3' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:16:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.363ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:16:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.378ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:16:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.525ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:46:56.417'

2025/06/19 23:16:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.037ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:16:56.419' AND status != 'pending'
	

2025/06/19 23:16:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.861ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:16:56.476' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:16:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.941ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:16:56.475' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:16:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.143ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:16:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.820ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:16:56.535'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:16:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.609ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:16:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.721ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:16:56.596' AND status != 'pending'
	

2025/06/19 23:16:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.583ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:16:56.654' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:16:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.770ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:16:56.712'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:17:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[58.515ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 8 ORDER BY `user`.`user_type` LIMIT 1

2025/06/19 23:17:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:88
[58.308ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/19 23:17:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:104
[59.108ms] [rows:10] SELECT * FROM `permission_user` WHERE id IN (1,2,10,11,12,13,14,15,22,23) ORDER BY sort DESC

2025/06/19 23:17:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.775ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:17:55.882'

2025/06/19 23:17:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.735ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:02:55.882' LIMIT 50

2025/06/19 23:17:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.246ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:02:55.893' LIMIT 50

2025/06/19 23:17:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.464ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:17:55.882'

2025/06/19 23:17:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.218ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:17:55.882'

2025/06/19 23:17:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.050ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:47:56.24'

2025/06/19 23:17:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.561ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:17:56.3' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:17:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.431ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:17:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.041ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:17:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.655ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:17:56.417' AND status != 'pending'
	

2025/06/19 23:17:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.193ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:47:56.416'

2025/06/19 23:17:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.930ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:17:56.475' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:17:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.104ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:17:56.48' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:17:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.148ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:17:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.318ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:17:56.533'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:17:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.506ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:17:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.650ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:17:56.609' AND status != 'pending'
	

2025/06/19 23:17:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.462ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:17:56.674' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:17:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.659ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:17:56.738'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:18:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.367ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:18:55.881'

2025/06/19 23:18:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.828ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:18:55.881'

2025/06/19 23:18:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.434ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:18:55.881'

2025/06/19 23:18:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.825ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:48:56.24'

2025/06/19 23:18:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.124ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:18:56.307' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:18:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.933ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:18:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.768ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:18:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.932ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:48:56.416'

2025/06/19 23:18:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.184ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:18:56.439' AND status != 'pending'
	

2025/06/19 23:18:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.867ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:18:56.474' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:18:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.627ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:18:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.425ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:18:56.504' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:18:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.148ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:18:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.098ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:18:56.568'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:18:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.725ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:18:56.591' AND status != 'pending'
	

2025/06/19 23:18:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.171ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:18:56.65' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:18:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.818ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:18:56.709'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:19:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.872ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:19:55.882'

2025/06/19 23:19:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.123ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:04:55.892' LIMIT 50

2025/06/19 23:19:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.805ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:04:55.882' LIMIT 50

2025/06/19 23:19:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.062ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:19:55.882'

2025/06/19 23:19:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.364ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:19:55.882'

2025/06/19 23:19:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.365ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:49:56.24'

2025/06/19 23:19:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.400ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:19:56.301' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:19:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.252ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:19:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.322ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:19:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.156ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:19:56.418' AND status != 'pending'
	

2025/06/19 23:19:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.352ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:49:56.416'

2025/06/19 23:19:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.888ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:19:56.477' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:19:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.830ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:19:56.481' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:19:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.452ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:19:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.724ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:19:56.535'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:19:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.547ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:19:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.725ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:19:56.611' AND status != 'pending'
	

2025/06/19 23:19:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.843ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:19:56.676' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:19:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.828ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:19:56.741'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:20:55 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[70.457ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:20:55.881'

2025/06/19 23:20:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.091ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:20:55.881'

2025/06/19 23:20:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.749ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:20:55.881'

2025/06/19 23:20:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.912ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:50:56.24'

2025/06/19 23:20:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.979ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:20:56.306' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:20:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.163ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:20:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.179ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:20:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.848ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:50:56.416'

2025/06/19 23:20:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.354ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:20:56.436' AND status != 'pending'
	

2025/06/19 23:20:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.106ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:20:56.475' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:20:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.613ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:20:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.238ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:20:56.502' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:20:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.045ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:20:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.269ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:20:56.567'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:20:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.688ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:20:56.594' AND status != 'pending'
	

2025/06/19 23:20:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.414ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:20:56.653' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:20:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.071ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:20:56.712'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:21:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[71.390ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:51:46.48'

2025/06/19 23:21:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.325ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:21:46.551' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:21:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.328ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:21:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.639ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:21:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[201.373ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:51:46.49'

2025/06/19 23:21:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.708ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:21:46.68' AND status != 'pending'
	

2025/06/19 23:21:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.485ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:21:46.692' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:21:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.482ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:21:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.127ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:21:46.744' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:21:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.116ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:21:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.104ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:21:46.808'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:21:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.172ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:21:46.821' AND status != 'pending'
	

2025/06/19 23:21:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.401ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:21:46.886' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:21:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.947ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:21:46.951'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:22:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[32.720ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 23:22:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.152ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 23:22:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.741ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 23:22:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.602ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 23:22:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.306ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 23:22:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.930ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 23:22:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.562ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 23:22:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.814ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 23:22:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.656ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 23:22:40 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.373ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 23:22:41 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.677ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 23:22:41 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.795ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 23:22:41 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.803ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 23:22:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:38
[34.245ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/19 23:22:45 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:44
[63.668ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/19 23:22:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.589ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:22:46.476'

2025/06/19 23:22:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.151ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:22:46.476'

2025/06/19 23:22:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.461ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:22:46.476'

2025/06/19 23:22:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.535ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:52:46.87'

2025/06/19 23:22:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.698ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:22:46.935' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:22:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.034ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:22:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.485ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:22:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.819ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:52:47.015'

2025/06/19 23:22:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.151ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:22:47.064' AND status != 'pending'
	

2025/06/19 23:22:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.689ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:22:47.079' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:22:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.730ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:22:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.392ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:22:47.128' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:22:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.993ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:22:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.233ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:22:47.193'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:22:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.815ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:22:47.207' AND status != 'pending'
	

2025/06/19 23:22:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.389ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:22:47.271' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:22:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.341ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:22:47.335'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:23:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:38
[31.733ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/19 23:23:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:44
[63.871ms] [rows:10] SELECT * FROM `app_user` LIMIT 10 OFFSET 10

2025/06/19 23:23:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:38
[32.312ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/19 23:23:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:44
[63.886ms] [rows:10] SELECT * FROM `app_user` LIMIT 10 OFFSET 20

2025/06/19 23:23:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:38
[31.868ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/19 23:23:31 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:44
[63.775ms] [rows:10] SELECT * FROM `app_user` LIMIT 10 OFFSET 30

2025/06/19 23:23:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:38
[32.527ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/19 23:23:32 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:44
[64.072ms] [rows:10] SELECT * FROM `app_user` LIMIT 10 OFFSET 10

2025/06/19 23:23:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:38
[35.452ms] [rows:1] SELECT count(*) FROM `app_user`

2025/06/19 23:23:36 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/member.go:44
[63.587ms] [rows:10] SELECT * FROM `app_user` LIMIT 10

2025/06/19 23:23:44 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[67.805ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1

2025/06/19 23:23:44 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[63.485ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 23:23:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[69.652ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:23:46.475'

2025/06/19 23:23:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[69.198ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:08:46.476' LIMIT 50

2025/06/19 23:23:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.848ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:23:46.475'

2025/06/19 23:23:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.297ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:23:46.475'

2025/06/19 23:23:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[188.973ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:08:46.487' LIMIT 50

2025/06/19 23:23:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.497ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:53:46.87'

2025/06/19 23:23:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.161ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:23:46.931' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:23:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.669ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:23:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.266ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:23:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.711ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:53:47.014'

2025/06/19 23:23:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.104ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:23:47.053' AND status != 'pending'
	

2025/06/19 23:23:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.441ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:23:47.08' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:23:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.209ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:23:47.114' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:23:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.128ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:23:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.967ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:23:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.914ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:23:47.174'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:23:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.615ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:23:47.207' AND status != 'pending'
	

2025/06/19 23:23:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.460ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:23:47.271' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:23:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.225ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:23:47.334'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:24:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[67.667ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1

2025/06/19 23:24:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[64.297ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 23:24:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[71.325ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:24:46.475'

2025/06/19 23:24:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.261ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:24:46.475'

2025/06/19 23:24:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.554ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:24:46.475'

2025/06/19 23:24:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.279ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:54:46.869'

2025/06/19 23:24:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.359ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:24:46.934' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:24:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.943ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:24:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.087ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:24:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.061ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:54:47.014'

2025/06/19 23:24:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.414ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:24:47.063' AND status != 'pending'
	

2025/06/19 23:24:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.356ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:24:47.075' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:24:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.976ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:24:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.367ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:24:47.127' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:24:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.520ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:24:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.194ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:24:47.19'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:24:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.852ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:24:47.196' AND status != 'pending'
	

2025/06/19 23:24:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.202ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:24:47.257' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:24:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.023ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:24:47.317'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:25:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.898ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:25:46.474'

2025/06/19 23:25:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.577ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:10:46.474' LIMIT 50

2025/06/19 23:25:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.817ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:10:46.486' LIMIT 50

2025/06/19 23:25:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.752ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:25:46.474'

2025/06/19 23:25:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.279ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:25:46.474'

2025/06/19 23:25:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.460ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:55:46.869'

2025/06/19 23:25:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.514ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:25:46.929' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:25:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.676ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:25:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.532ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:25:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.290ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:55:47.013'

2025/06/19 23:25:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.772ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:25:47.049' AND status != 'pending'
	

2025/06/19 23:25:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.358ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:25:47.077' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:25:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.588ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:25:47.107' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:25:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.327ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:25:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.795ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:25:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.495ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:25:47.167'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:25:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.209ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:25:47.206' AND status != 'pending'
	

2025/06/19 23:25:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.097ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:25:47.27' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:25:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.998ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:25:47.334'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:26:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.429ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:26:46.474'

2025/06/19 23:26:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[68.244ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:26:46.474'

2025/06/19 23:26:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[67.529ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:26:46.474'

2025/06/19 23:26:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.364ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:56:46.869'

2025/06/19 23:26:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.908ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:26:46.935' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:26:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.728ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:26:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.712ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:26:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.055ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:56:47.013'

2025/06/19 23:26:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.163ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:26:47.064' AND status != 'pending'
	

2025/06/19 23:26:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.442ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:26:47.073' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:26:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.719ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:26:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.655ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:26:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.435ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:26:47.128' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:26:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.173ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:26:47.196' AND status != 'pending'
	

2025/06/19 23:26:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.636ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:26:47.196'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:26:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.318ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:26:47.253' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:26:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.414ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:26:47.312'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:27:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.148ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:27:46.473'

2025/06/19 23:27:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.303ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:12:46.475' LIMIT 50

2025/06/19 23:27:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.014ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:12:46.485' LIMIT 50

2025/06/19 23:27:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.488ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:27:46.473'

2025/06/19 23:27:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.194ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:27:46.473'

2025/06/19 23:27:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.715ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:57:46.868'

2025/06/19 23:27:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.803ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:27:46.929' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:27:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.074ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:27:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.800ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:27:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.826ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:57:47.012'

2025/06/19 23:27:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.040ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:27:47.051' AND status != 'pending'
	

2025/06/19 23:27:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.748ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:27:47.077' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:27:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.989ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:27:47.112' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:27:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.999ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:27:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.777ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:27:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.574ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:27:47.172'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:27:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.225ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:27:47.206' AND status != 'pending'
	

2025/06/19 23:27:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.823ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:27:47.27' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:27:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.552ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:27:47.335'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:28:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.228ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:28:46.473'

2025/06/19 23:28:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.356ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:28:46.473'

2025/06/19 23:28:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.681ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:28:46.473'

2025/06/19 23:28:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.615ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:58:46.867'

2025/06/19 23:28:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.551ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:28:46.932' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:28:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.330ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:28:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.430ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:28:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.835ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:58:47.012'

2025/06/19 23:28:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.522ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:28:47.063' AND status != 'pending'
	

2025/06/19 23:28:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.424ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:28:47.074' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:28:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.970ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:28:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.494ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:28:47.127' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:28:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.735ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:28:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.087ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:28:47.192' AND status != 'pending'
	

2025/06/19 23:28:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.475ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:28:47.192'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:28:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.977ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:28:47.252' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:28:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.928ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:28:47.314'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:29:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:85
[60.027ms] [rows:1] SELECT * FROM `goods_list` WHERE id = 1 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/19 23:29:05 /Users/wensiyuan/go/go-admin-sass-github/controllers/admin/upload.go:40
[60.169ms] [rows:1] SELECT * FROM `config_setting` WHERE type = 'oss_code'

2025/06/19 23:29:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:75
[130.772ms] [rows:1] UPDATE `goods_list` SET `goods_name`='五月天周边海报',`price`=19.9,`content`='测试',`cover`='https://ark-auto-2102366935-cn-beijing-default.tos-cn-beijing.volces.com/uploads/20250619232905000.jpg',`status`='1',`stock`=3,`update_time`='2025-06-19 23:29:08.034' WHERE `id` = 1

2025/06/19 23:29:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[59.688ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1

2025/06/19 23:29:08 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[59.922ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 23:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[61.072ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/19 23:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[32.105ms] [rows:18] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/19 23:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[31.857ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 23:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.945ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 23:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.772ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 23:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.802ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 23:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.408ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 23:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.079ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 23:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.294ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 23:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.079ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 23:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.582ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 23:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[62.611ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 23:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.922ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 23:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.936ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 23:29:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[60.529ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 23:29:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[60.271ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1

2025/06/19 23:29:13 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[60.754ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 23:29:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:85
[59.861ms] [rows:1] SELECT * FROM `goods_list` WHERE id = 1 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/19 23:29:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:85
[60.983ms] [rows:1] SELECT * FROM `goods_list` WHERE id = 2 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/19 23:29:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.864ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:29:46.472'

2025/06/19 23:29:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.014ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:14:46.472' LIMIT 50

2025/06/19 23:29:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.744ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:14:46.484' LIMIT 50

2025/06/19 23:29:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.994ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:29:46.472'

2025/06/19 23:29:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.155ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:29:46.472'

2025/06/19 23:29:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.373ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:59:46.866'

2025/06/19 23:29:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.059ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:29:46.927' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:29:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.109ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:29:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.704ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:29:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.552ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 22:59:47.011'

2025/06/19 23:29:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.394ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:29:47.05' AND status != 'pending'
	

2025/06/19 23:29:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.967ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:29:47.076' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:29:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.389ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:29:47.11' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:29:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.407ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:29:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.138ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:29:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.939ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:29:47.172'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:29:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.353ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:29:47.208' AND status != 'pending'
	

2025/06/19 23:29:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.993ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:29:47.273' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:29:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[68.380ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:29:47.339'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:29:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[32.119ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 23:29:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.651ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 23:29:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.588ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 23:29:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.513ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 23:29:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.559ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 23:29:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.961ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 23:29:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.937ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 23:29:59 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.407ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 23:30:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.839ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 23:30:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.834ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 23:30:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.831ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 23:30:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.687ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 23:30:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.947ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 23:30:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[32.477ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 23:30:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.472ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 23:30:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[68.930ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 23:30:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.770ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 23:30:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.696ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 23:30:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.066ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 23:30:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.200ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 23:30:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[66.696ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 23:30:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.542ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 23:30:29 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.511ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 23:30:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.062ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 23:30:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[67.398ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 23:30:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.933ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 23:30:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[64.294ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1

2025/06/19 23:30:30 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[63.484ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 23:30:35 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:85
[64.174ms] [rows:1] SELECT * FROM `goods_list` WHERE id = 1 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/19 23:30:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.880ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:30:46.472'

2025/06/19 23:30:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.481ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:30:46.472'

2025/06/19 23:30:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.808ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:30:46.472'

2025/06/19 23:30:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.341ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:00:46.866'

2025/06/19 23:30:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.207ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:30:46.93' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:30:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.889ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:30:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.995ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:30:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.513ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:00:47.01'

2025/06/19 23:30:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.040ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:30:47.062' AND status != 'pending'
	

2025/06/19 23:30:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.142ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:30:47.07' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:30:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.006ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:30:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.440ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:30:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.281ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:30:47.127' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:30:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.158ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:30:47.193' AND status != 'pending'
	

2025/06/19 23:30:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.176ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:30:47.194'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:30:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.779ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:30:47.253' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:30:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.273ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:30:47.315'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:31:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:85
[61.123ms] [rows:1] SELECT * FROM `goods_list` WHERE id = 1 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/19 23:31:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:336
[31.359ms] [rows:1] SELECT count(*) FROM `sys_dict_type`

2025/06/19 23:31:12 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:336
[60.562ms] [rows:10] SELECT * FROM `sys_dict_type` ORDER BY create_time DESC LIMIT 10

2025/06/19 23:31:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:369
[62.328ms] [rows:1] SELECT count(*) FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 23:31:14 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:369
[58.925ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009 LIMIT 10

2025/06/19 23:31:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[65.190ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1

2025/06/19 23:31:43 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[60.804ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 23:31:44 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:85
[60.622ms] [rows:1] SELECT * FROM `goods_list` WHERE id = 1 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/19 23:31:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.423ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:31:46.471'

2025/06/19 23:31:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.759ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:16:46.471' LIMIT 50

2025/06/19 23:31:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.981ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:16:46.483' LIMIT 50

2025/06/19 23:31:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.087ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:31:46.471'

2025/06/19 23:31:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.442ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:31:46.471'

2025/06/19 23:31:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.662ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:01:46.866'

2025/06/19 23:31:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.894ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:31:46.927' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:31:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.117ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:31:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.407ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:31:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.782ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:01:47.01'

2025/06/19 23:31:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.825ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:31:47.049' AND status != 'pending'
	

2025/06/19 23:31:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.284ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:31:47.073' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:31:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.738ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:31:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.274ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:31:47.109' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:31:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.236ms] [rows:1] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:31:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.168ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:31:47.175'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:31:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.566ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:31:47.207' AND status != 'pending'
	

2025/06/19 23:31:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.292ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:31:47.27' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:31:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.673ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:31:47.333'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:31:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:75
[130.627ms] [rows:1] UPDATE `goods_list` SET `goods_name`='五月天周边海报',`price`=19.9,`content`='测试',`cover`='https://ark-auto-2102366935-cn-beijing-default.tos-cn-beijing.volces.com/uploads/20250619232905000.jpg',`status`='normal',`stock`=3,`update_time`='2025-06-19 23:31:57.257' WHERE `id` = 1

2025/06/19 23:31:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[65.287ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1

2025/06/19 23:31:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[64.829ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 23:32:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.811ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:32:46.471'

2025/06/19 23:32:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.210ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:32:46.471'

2025/06/19 23:32:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.245ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:32:46.471'

2025/06/19 23:32:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.100ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:02:46.865'

2025/06/19 23:32:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.216ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:32:46.93' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:32:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.720ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:32:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.441ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:32:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.034ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:02:47.009'

2025/06/19 23:32:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[70.959ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:32:47.058' AND status != 'pending'
	

2025/06/19 23:32:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.766ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:32:47.072' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:32:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[45.798ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:32:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.357ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:32:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[80.819ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:32:47.129' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:32:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.856ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:32:47.209' AND status != 'pending'
	

2025/06/19 23:32:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.406ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:32:47.21'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:32:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.310ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:32:47.271' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:32:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.512ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:32:47.331'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:33:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.007ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:33:46.469'

2025/06/19 23:33:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.435ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:18:46.47' LIMIT 50

2025/06/19 23:33:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.001ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:18:46.482' LIMIT 50

2025/06/19 23:33:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.430ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:33:46.469'

2025/06/19 23:33:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.825ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:33:46.469'

2025/06/19 23:33:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.353ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:03:46.864'

2025/06/19 23:33:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.962ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:33:46.926' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:33:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.863ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:33:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.033ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:33:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.502ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:03:47.008'

2025/06/19 23:33:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.987ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:33:47.05' AND status != 'pending'
	

2025/06/19 23:33:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.759ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:33:47.074' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:33:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.976ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:33:47.11' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:33:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.904ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:33:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.349ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:33:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.386ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:33:47.171'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:33:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.655ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:33:47.205' AND status != 'pending'
	

2025/06/19 23:33:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.278ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:33:47.268' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:33:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.486ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:33:47.333'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:34:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.589ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:34:46.469'

2025/06/19 23:34:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.956ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:34:46.469'

2025/06/19 23:34:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.789ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:34:46.469'

2025/06/19 23:34:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.150ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:04:46.864'

2025/06/19 23:34:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.949ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:34:46.93' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:34:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.502ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:34:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.351ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:34:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.570ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:04:47.008'

2025/06/19 23:34:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.625ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:34:47.059' AND status != 'pending'
	

2025/06/19 23:34:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.830ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:34:47.068' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:34:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.778ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:34:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.528ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:34:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.144ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:34:47.124' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:34:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.207ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:34:47.188' AND status != 'pending'
	

2025/06/19 23:34:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.636ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:34:47.188'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:34:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.897ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:34:47.247' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:34:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.866ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:34:47.307'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:35:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[71.771ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:35:46.469'

2025/06/19 23:35:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[73.509ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:20:46.469' LIMIT 50

2025/06/19 23:35:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.424ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:20:46.481' LIMIT 50

2025/06/19 23:35:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.875ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:35:46.469'

2025/06/19 23:35:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.444ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:35:46.469'

2025/06/19 23:35:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.399ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:05:46.863'

2025/06/19 23:35:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.359ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:35:46.923' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:35:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.176ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:35:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.499ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:35:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.632ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:05:47.008'

2025/06/19 23:35:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.328ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:35:47.042' AND status != 'pending'
	

2025/06/19 23:35:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.644ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:35:47.073' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:35:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.851ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:35:47.101' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:35:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.863ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:35:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.144ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:35:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.724ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:35:47.161'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:35:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.730ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:35:47.201' AND status != 'pending'
	

2025/06/19 23:35:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.599ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:35:47.265' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:35:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.329ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:35:47.331'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:36:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.247ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:36:46.469'

2025/06/19 23:36:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.912ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:36:46.469'

2025/06/19 23:36:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.600ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:36:46.469'

2025/06/19 23:36:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.156ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:06:46.863'

2025/06/19 23:36:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.728ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:36:46.928' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:36:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.152ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:36:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.286ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:36:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.516ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:06:47.007'

2025/06/19 23:36:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.824ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:36:47.058' AND status != 'pending'
	

2025/06/19 23:36:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.209ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:36:47.071' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:36:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.105ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:36:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.497ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:36:47.12' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:36:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.384ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:36:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.969ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:36:47.182'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:36:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.273ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:36:47.193' AND status != 'pending'
	

2025/06/19 23:36:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.727ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:36:47.252' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:36:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.023ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:36:47.313'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:37:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.856ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:37:46.468'

2025/06/19 23:37:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.582ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:22:46.468' LIMIT 50

2025/06/19 23:37:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.312ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:22:46.48' LIMIT 50

2025/06/19 23:37:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.592ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:37:46.468'

2025/06/19 23:37:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.841ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:37:46.468'

2025/06/19 23:37:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.404ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:07:46.862'

2025/06/19 23:37:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.940ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:37:46.925' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:37:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.562ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:37:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.741ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:37:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.453ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:07:47.006'

2025/06/19 23:37:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.633ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:37:47.049' AND status != 'pending'
	

2025/06/19 23:37:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.397ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:37:47.073' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:37:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.330ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:37:47.111' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:37:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.587ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:37:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.437ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:37:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.924ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:37:47.17'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:37:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.030ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:37:47.207' AND status != 'pending'
	

2025/06/19 23:37:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[68.234ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:37:47.272' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:37:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.501ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:37:47.34'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:38:19 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:85
[65.740ms] [rows:1] SELECT * FROM `goods_list` WHERE id = 2 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/19 23:38:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:75
[130.326ms] [rows:1] UPDATE `goods_list` SET `goods_name`='123456',`price`=100,`content`='测试',`status`='normal',`stock`=1000,`update_time`='2025-06-19 23:38:23.281' WHERE `id` = 2

2025/06/19 23:38:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[63.411ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1

2025/06/19 23:38:23 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[64.788ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 23:38:33 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:85
[65.487ms] [rows:1] SELECT * FROM `goods_list` WHERE id = 2 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/19 23:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:75
[132.306ms] [rows:1] UPDATE `goods_list` SET `goods_name`='123456',`price`=100,`content`='测试',`status`='removed',`stock`=1000,`update_time`='2025-06-19 23:38:37.164' WHERE `id` = 2

2025/06/19 23:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[64.237ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1

2025/06/19 23:38:37 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[64.981ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 23:38:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.859ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:38:46.467'

2025/06/19 23:38:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.025ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:38:46.467'

2025/06/19 23:38:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.328ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:38:46.467'

2025/06/19 23:38:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.599ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:08:46.862'

2025/06/19 23:38:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.025ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:38:46.929' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:38:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.106ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:38:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.679ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:38:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.369ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:08:47.006'

2025/06/19 23:38:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.021ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:38:47.059' AND status != 'pending'
	

2025/06/19 23:38:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.406ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:38:47.068' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:38:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.095ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:38:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.686ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:38:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.113ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:38:47.124' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:38:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.671ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:38:47.188' AND status != 'pending'
	

2025/06/19 23:38:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.019ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:38:47.189'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:38:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.995ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:38:47.25' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:38:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.173ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:38:47.31'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:38:50 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:85
[64.233ms] [rows:1] SELECT * FROM `goods_list` WHERE id = 1 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/19 23:38:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:75
[122.367ms] [rows:1] UPDATE `goods_list` SET `goods_name`='五月天周边海报',`price`=19.9,`content`='测试',`cover`='https://ark-auto-2102366935-cn-beijing-default.tos-cn-beijing.volces.com/uploads/20250619232905000.jpg',`status`='removed',`stock`=3,`update_time`='2025-06-19 23:38:54.985' WHERE `id` = 1

2025/06/19 23:38:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[59.917ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1

2025/06/19 23:38:55 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[60.713ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 23:39:17 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:85
[61.371ms] [rows:1] SELECT * FROM `goods_list` WHERE id = 1 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/19 23:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.512ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:24:46.467' LIMIT 50

2025/06/19 23:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.311ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:39:46.466'

2025/06/19 23:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.409ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:24:46.479' LIMIT 50

2025/06/19 23:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.592ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:39:46.466'

2025/06/19 23:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.825ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:39:46.466'

2025/06/19 23:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.208ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:09:46.861'

2025/06/19 23:39:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.820ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:39:46.928' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:39:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.151ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:39:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.259ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:39:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.521ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:09:47.006'

2025/06/19 23:39:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.394ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:39:47.057' AND status != 'pending'
	

2025/06/19 23:39:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.147ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:39:47.07' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:39:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.813ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:39:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.626ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:39:47.123' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:39:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.022ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:39:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.298ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:39:47.188'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:39:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.205ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:39:47.199' AND status != 'pending'
	

2025/06/19 23:39:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.926ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:39:47.262' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:39:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.657ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:39:47.326'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:39:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:75
[129.225ms] [rows:1] UPDATE `goods_list` SET `goods_name`='五月天周边海报',`price`=19.9,`content`='<p><br></p><p>刘强东与外卖小哥的合影 社交媒体图片</p><p>6月18日，京东面向全体酒店经营者发布公开信，正式宣布进军酒旅市场。而刘强东点外卖所在的四季酒店则是全球奢华酒店品牌之一。</p><p>送外卖的小哥身穿达达快送制服。今年，京东官宣外卖业务，该业务正是位于京东APP首页的京东秒送下的门类之一，其运力也主要来自达达秒送。</p><p>据最新披露的数据，京东外卖日订单量已突破2500万单，超过150万家餐厅入驻，京东外卖全职骑手已突破12万人。</p>',`cover`='https://ark-auto-2102366935-cn-beijing-default.tos-cn-beijing.volces.com/uploads/20250619232905000.jpg',`status`='removed',`stock`=3,`update_time`='2025-06-19 23:39:53.068' WHERE `id` = 1

2025/06/19 23:39:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[63.242ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1

2025/06/19 23:39:53 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[67.931ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 23:39:54 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:85
[64.272ms] [rows:1] SELECT * FROM `goods_list` WHERE id = 1 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/19 23:40:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:85
[68.432ms] [rows:1] SELECT * FROM `goods_list` WHERE id = 1 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/19 23:40:28 /Users/wensiyuan/go/go-admin-sass-github/controllers/admin/upload.go:40
[68.784ms] [rows:1] SELECT * FROM `config_setting` WHERE type = 'oss_code'

2025/06/19 23:40:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:24
[129.362ms] [rows:1] INSERT INTO `goods_list` (`user_id`,`goods_name`,`price`,`content`,`cover`,`status`,`category_id`,`tenants_id`,`stock`,`isdelete`,`create_time`,`update_time`) VALUES (1,'测是',100,'<p>刘强东与外卖小哥的合影 社交媒体图片</p><p>6月18日，京东面向全体酒店经营者发布公开信，正式宣布进军酒旅市场。而刘强东点外卖所在的四季酒店则是全球奢华酒店品牌之一。</p><p>送外卖的小哥身穿达达快送制服。今年，京东官宣外卖业务，该业务正是位于京东APP首页的京东秒送下的门类之一，其运力也主要来自达达秒送。</p><p>据最新披露的数据，京东外卖日订单量已突破2500万单，超过150万家餐厅入驻，京东外卖全职骑手已突破12万人。</p>','','lock',0,1,100,0,'2025-06-19 23:40:34.233','2025-06-19 23:40:34.233')

2025/06/19 23:40:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[63.607ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1

2025/06/19 23:40:34 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[75.084ms] [rows:3] SELECT * FROM `goods_list` WHERE isdelete != 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 23:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[64.885ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1

2025/06/19 23:40:38 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[63.889ms] [rows:3] SELECT * FROM `goods_list` WHERE isdelete != 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 23:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:85
[68.392ms] [rows:1] SELECT * FROM `goods_list` WHERE id = 3 ORDER BY `goods_list`.`id` LIMIT 1

2025/06/19 23:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.234ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:40:46.466'

2025/06/19 23:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.228ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:40:46.466'

2025/06/19 23:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.865ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:40:46.466'

2025/06/19 23:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.702ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:10:46.861'

2025/06/19 23:40:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.703ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:40:46.924' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:40:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.520ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:40:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.933ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:40:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.123ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:10:47.005'

2025/06/19 23:40:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.483ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:40:47.052' AND status != 'pending'
	

2025/06/19 23:40:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.548ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:40:47.069' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:40:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.435ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:40:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.587ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:40:47.116' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:40:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.629ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:40:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.436ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:40:47.18'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:40:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.748ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:40:47.2' AND status != 'pending'
	

2025/06/19 23:40:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.485ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:40:47.264' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:40:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.410ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:40:47.329'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:40:50 /Users/wensiyuan/go/go-admin-sass-github/controllers/admin/upload.go:40
[65.045ms] [rows:1] SELECT * FROM `config_setting` WHERE type = 'oss_code'

2025/06/19 23:40:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:75
[131.777ms] [rows:1] UPDATE `goods_list` SET `goods_name`='测是',`price`=100,`content`='<p>刘强东与外卖小哥的合影 社交媒体图片</p><p>6月18日，京东面向全体酒店经营者发布公开信，正式宣布进军酒旅市场。而刘强东点外卖所在的四季酒店则是全球奢华酒店品牌之一。</p><p>送外卖的小哥身穿达达快送制服。今年，京东官宣外卖业务，该业务正是位于京东APP首页的京东秒送下的门类之一，其运力也主要来自达达秒送。</p><p>据最新披露的数据，京东外卖日订单量已突破2500万单，超过150万家餐厅入驻，京东外卖全职骑手已突破12万人。</p>',`cover`='https://ark-auto-2102366935-cn-beijing-default.tos-cn-beijing.volces.com/uploads/20250619234050000.jpg',`status`='lock',`stock`=100,`update_time`='2025-06-19 23:40:52.416' WHERE `id` = 3

2025/06/19 23:40:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[64.275ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1

2025/06/19 23:40:52 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[65.195ms] [rows:3] SELECT * FROM `goods_list` WHERE isdelete != 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 23:41:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[65.780ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1

2025/06/19 23:41:00 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[64.107ms] [rows:3] SELECT * FROM `goods_list` WHERE isdelete != 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 23:41:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[64.078ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 8 ORDER BY `user`.`user_type` LIMIT 1

2025/06/19 23:41:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:88
[65.087ms] [rows:10] SELECT `permissionId` FROM `role_permissions_permission` WHERE roleId = 5

2025/06/19 23:41:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:104
[66.024ms] [rows:10] SELECT * FROM `permission_user` WHERE id IN (1,2,10,11,12,13,14,15,22,23) ORDER BY sort DESC

2025/06/19 23:41:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[31.676ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 23:41:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.205ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 23:41:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.497ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 23:41:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.806ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 23:41:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.220ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 23:41:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.779ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 23:41:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.248ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 23:41:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.022ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 23:41:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.046ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 23:41:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.628ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 23:41:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[64.181ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 23:41:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.803ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 23:41:01 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[65.324ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 23:41:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[65.025ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1

2025/06/19 23:41:02 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:52
[64.509ms] [rows:3] SELECT * FROM `goods_list` WHERE isdelete != 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 23:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[68.375ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:26:46.466' LIMIT 50

2025/06/19 23:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[69.772ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:41:46.466'

2025/06/19 23:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.241ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:26:46.477' LIMIT 50

2025/06/19 23:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.979ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:41:46.466'

2025/06/19 23:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.832ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:41:46.466'

2025/06/19 23:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.928ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:11:46.86'

2025/06/19 23:41:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.569ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:41:46.925' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:41:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.904ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:41:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.552ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:41:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.949ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:11:47.005'

2025/06/19 23:41:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.466ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:41:47.056' AND status != 'pending'
	

2025/06/19 23:41:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.363ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:41:47.065' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:41:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.126ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:41:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.375ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:41:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.714ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:41:47.121' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:41:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.557ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:41:47.186' AND status != 'pending'
	

2025/06/19 23:41:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.415ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:41:47.186'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:41:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.526ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:41:47.248' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:41:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.830ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:41:47.309'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:42:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.823ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:42:46.465'

2025/06/19 23:42:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.089ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:42:46.465'

2025/06/19 23:42:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.130ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:42:46.465'

2025/06/19 23:42:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.464ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:12:46.86'

2025/06/19 23:42:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.916ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:42:46.921' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:42:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.268ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:42:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.082ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:42:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.173ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:12:47.004'

2025/06/19 23:42:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.821ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:42:47.043' AND status != 'pending'
	

2025/06/19 23:42:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.003ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:42:47.069' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:42:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.192ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:42:47.104' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:42:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.539ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:42:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.516ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:42:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.643ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:42:47.165'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:42:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.426ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:42:47.199' AND status != 'pending'
	

2025/06/19 23:42:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.037ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:42:47.264' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:42:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.487ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:42:47.329'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:43:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.517ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:28:46.465' LIMIT 50

2025/06/19 23:43:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.326ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:43:46.465'

2025/06/19 23:43:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.566ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:28:46.477' LIMIT 50

2025/06/19 23:43:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.998ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:43:46.465'

2025/06/19 23:43:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.531ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:43:46.465'

2025/06/19 23:43:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.322ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:13:46.859'

2025/06/19 23:43:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.697ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:43:46.924' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:43:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.149ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:43:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.596ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:43:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.421ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:13:47.004'

2025/06/19 23:43:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.644ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:43:47.054' AND status != 'pending'
	

2025/06/19 23:43:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.706ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:43:47.07' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:43:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.880ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:43:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.741ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:43:47.119' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:43:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.772ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:43:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.598ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:43:47.184'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:43:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.825ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:43:47.198' AND status != 'pending'
	

2025/06/19 23:43:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.043ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:43:47.263' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:43:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.812ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:43:47.327'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:44:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[72.614ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:44:46.464'

2025/06/19 23:44:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.518ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:44:46.464'

2025/06/19 23:44:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.159ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:44:46.464'

2025/06/19 23:44:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.343ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:14:46.858'

2025/06/19 23:44:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.604ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:44:46.923' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:44:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.456ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:44:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.898ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:44:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.294ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:14:47.003'

2025/06/19 23:44:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.945ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:44:47.051' AND status != 'pending'
	

2025/06/19 23:44:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.810ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:44:47.068' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:44:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.272ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:44:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.446ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:44:47.115' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:44:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.419ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:44:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.764ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:44:47.178'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:44:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.143ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:44:47.198' AND status != 'pending'
	

2025/06/19 23:44:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.487ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:44:47.262' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:44:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.349ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:44:47.327'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:45:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.180ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:30:46.464' LIMIT 50

2025/06/19 23:45:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.137ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:45:46.464'

2025/06/19 23:45:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.756ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:30:46.476' LIMIT 50

2025/06/19 23:45:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.429ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:45:46.464'

2025/06/19 23:45:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.179ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:45:46.464'

2025/06/19 23:45:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.289ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:15:46.858'

2025/06/19 23:45:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.940ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:45:46.924' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:45:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.226ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:45:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.862ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:45:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.191ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:15:47.002'

2025/06/19 23:45:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.533ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:45:47.053' AND status != 'pending'
	

2025/06/19 23:45:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.828ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:45:47.06' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:45:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.501ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:45:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.027ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:45:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.372ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:45:47.116' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:45:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.550ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:45:47.181' AND status != 'pending'
	

2025/06/19 23:45:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.108ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:45:47.181'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:45:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.785ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:45:47.24' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:45:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.428ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:45:47.3'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.624ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:17:07.765'

2025/06/19 23:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.102ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:47:07.83' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.537ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.143ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:47:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[181.918ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:17:07.772'

2025/06/19 23:47:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.347ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:47:07.954' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:47:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.079ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:47:07.953' AND status != 'pending'
	

2025/06/19 23:47:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.977ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:47:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.833ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:47:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.865ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:47:08.013' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:47:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.243ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:47:08.072' AND status != 'pending'
	

2025/06/19 23:47:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.559ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:47:08.074'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:47:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.974ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:17:09.972'

2025/06/19 23:47:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.918ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:47:10.036' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:47:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.915ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:47:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.684ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:47:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[184.766ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:17:09.984'

2025/06/19 23:47:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.779ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:47:10.158' AND status != 'pending'
	

2025/06/19 23:47:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.340ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:47:10.169' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:47:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.761ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:47:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.441ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:47:10.219' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:47:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.512ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:47:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.278ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:47:10.28'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:47:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.000ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:47:10.288' AND status != 'pending'
	

2025/06/19 23:47:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.140ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:47:10.347' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:47:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.174ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:47:10.407'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:48:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.703ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:48:09.971'

2025/06/19 23:48:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.150ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:48:09.971'

2025/06/19 23:48:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.128ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:48:09.971'

2025/06/19 23:48:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.497ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:18:10.34'

2025/06/19 23:48:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.218ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:48:10.401' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:48:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.491ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:48:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.671ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:48:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.890ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:18:10.466'

2025/06/19 23:48:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.247ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:48:10.522' AND status != 'pending'
	

2025/06/19 23:48:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.909ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:48:10.525' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:48:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.920ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:48:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.672ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:48:10.581' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:48:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.079ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:48:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.974ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:48:10.641'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:48:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.619ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:48:10.646' AND status != 'pending'
	

2025/06/19 23:48:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.922ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:48:10.705' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:48:10 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.237ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:48:10.767'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:48:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[71.013ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:18:35.431'

2025/06/19 23:48:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.455ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:48:35.503' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:48:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.465ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:48:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[188.906ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:18:35.444'

2025/06/19 23:48:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.556ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:48:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.055ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:48:35.633' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:48:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.276ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:48:35.635' AND status != 'pending'
	

2025/06/19 23:48:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.629ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:48:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.905ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:48:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.128ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:48:35.701' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:48:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.861ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:48:35.756' AND status != 'pending'
	

2025/06/19 23:48:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.171ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:48:35.767'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:48:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.135ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:48:35.818' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:48:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.868ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:48:35.88'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:48:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.290ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:18:46.845'

2025/06/19 23:48:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.072ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:48:46.91' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:48:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.537ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:48:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.190ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:48:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[182.104ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:18:46.856'

2025/06/19 23:48:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.923ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:48:47.039' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:48:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.529ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:48:47.039' AND status != 'pending'
	

2025/06/19 23:48:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.064ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:48:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.702ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:48:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.901ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:48:47.102' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:48:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.592ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:48:47.158' AND status != 'pending'
	

2025/06/19 23:48:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.130ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:48:47.165'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:48:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.066ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:48:47.216' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:48:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.942ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:48:47.274'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[33.575ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.562ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.402ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.691ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.227ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.768ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.782ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.082ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.733ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 23:48:57 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.857ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 23:48:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.411ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 23:48:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.936ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 23:48:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.457ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 23:48:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:64
[57.493ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 8

2025/06/19 23:48:58 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:64
[57.737ms] [rows:2] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 8 ORDER BY create_time DESC LIMIT 10

2025/06/19 23:49:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:71
[59.277ms] [rows:1] SELECT user_type, role_id FROM `user` WHERE id = 1 ORDER BY `user`.`user_type` LIMIT 1

2025/06/19 23:49:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/permission_optimized.go:132
[29.833ms] [rows:18] SELECT * FROM `permission_user` ORDER BY sort DESC

2025/06/19 23:49:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:434
[33.927ms] [rows:12] SELECT * FROM `sys_dict_type`

2025/06/19 23:49:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.579ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1000

2025/06/19 23:49:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.460ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1001

2025/06/19 23:49:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.760ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1002

2025/06/19 23:49:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.068ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1003

2025/06/19 23:49:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.984ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1004

2025/06/19 23:49:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.722ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1005

2025/06/19 23:49:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.347ms] [rows:5] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1006

2025/06/19 23:49:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[63.191ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1007

2025/06/19 23:49:05 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.698ms] [rows:2] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1008

2025/06/19 23:49:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[59.275ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1009

2025/06/19 23:49:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.801ms] [rows:3] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1010

2025/06/19 23:49:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/system.go:447
[58.659ms] [rows:4] SELECT * FROM `sys_dict` WHERE sys_dict_type_id = 1011

2025/06/19 23:49:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:64
[59.252ms] [rows:1] SELECT count(*) FROM `goods_list` WHERE isdelete != 1 AND user_id = 1

2025/06/19 23:49:06 /Users/wensiyuan/go/go-admin-sass-github/services/admin_service/goods.go:64
[58.110ms] [rows:1] SELECT * FROM `goods_list` WHERE isdelete != 1 AND user_id = 1 ORDER BY create_time DESC LIMIT 10

2025/06/19 23:49:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.560ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:49:46.844'

2025/06/19 23:49:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.872ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:49:46.844'

2025/06/19 23:49:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.774ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:49:46.844'

2025/06/19 23:49:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.328ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:19:47.229'

2025/06/19 23:49:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.161ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:49:47.29' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:49:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.476ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:49:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.874ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:19:47.333'

2025/06/19 23:49:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.517ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:49:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.746ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:49:47.398' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:49:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.310ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:49:47.407' AND status != 'pending'
	

2025/06/19 23:49:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.406ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:49:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.234ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:49:47.465' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:49:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.102ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:49:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.398ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:49:47.525'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:49:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.928ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:49:47.528' AND status != 'pending'
	

2025/06/19 23:49:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.637ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:49:47.592' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:49:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.497ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:49:47.657'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:50:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[87.604ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:35:46.857' LIMIT 50

2025/06/19 23:50:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[90.197ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:50:46.851'

2025/06/19 23:50:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.398ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:50:46.851'

2025/06/19 23:50:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.319ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:50:46.851'

2025/06/19 23:50:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[210.987ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:35:46.855' LIMIT 50

2025/06/19 23:50:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[69.480ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:20:47.229'

2025/06/19 23:50:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.895ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:50:47.298' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:50:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.395ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:20:47.331'

2025/06/19 23:50:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.323ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:50:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.167ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:50:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.233ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:50:47.396' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:50:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.293ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:50:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.853ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:50:47.431' AND status != 'pending'
	

2025/06/19 23:50:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.903ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:50:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.388ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:50:47.498' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:50:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.361ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:50:47.526' AND status != 'pending'
	

2025/06/19 23:50:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.064ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:50:47.564'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:50:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.277ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:50:47.59' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:50:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.569ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:50:47.653'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:51:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.313ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:51:46.843'

2025/06/19 23:51:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.902ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:51:46.843'

2025/06/19 23:51:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.054ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:51:46.843'

2025/06/19 23:51:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.216ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:21:47.228'

2025/06/19 23:51:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.318ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:51:47.295' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:51:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.693ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:51:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.237ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:21:47.332'

2025/06/19 23:51:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.256ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:51:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.939ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:51:47.402' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:51:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.256ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:51:47.425' AND status != 'pending'
	

2025/06/19 23:51:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.276ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:51:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.915ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:51:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.303ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:51:47.492' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:51:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.627ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:51:47.535' AND status != 'pending'
	

2025/06/19 23:51:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.669ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:51:47.557'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:51:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.046ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:51:47.602' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:51:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.428ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:51:47.669'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:52:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.128ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:37:46.842' LIMIT 50

2025/06/19 23:52:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.321ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:52:46.842'

2025/06/19 23:52:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.568ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:37:46.854' LIMIT 50

2025/06/19 23:52:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.529ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:52:46.842'

2025/06/19 23:52:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.876ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:52:46.842'

2025/06/19 23:52:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.442ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:22:47.228'

2025/06/19 23:52:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.001ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:52:47.296' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:52:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.386ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:22:47.331'

2025/06/19 23:52:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.450ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:52:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.500ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:52:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.451ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:52:47.39' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:52:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.959ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:52:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.977ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:52:47.432' AND status != 'pending'
	

2025/06/19 23:52:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.131ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:52:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.773ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:52:47.501' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:52:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.598ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:52:47.509' AND status != 'pending'
	

2025/06/19 23:52:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.543ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:52:47.567' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:52:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.803ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:52:47.567'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:52:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.101ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:52:47.626'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:53:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.050ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:53:46.842'

2025/06/19 23:53:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.816ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:53:46.842'

2025/06/19 23:53:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.508ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:53:46.842'

2025/06/19 23:53:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.063ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:23:47.227'

2025/06/19 23:53:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.080ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:53:47.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:53:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.977ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:53:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.282ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:23:47.331'

2025/06/19 23:53:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.280ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:53:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.485ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:53:47.406' AND status != 'pending'
	

2025/06/19 23:53:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.469ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:53:47.399' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:53:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.841ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:53:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.222ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:53:47.465' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:53:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.711ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:53:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.434ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:53:47.523'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:53:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.022ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:53:47.532' AND status != 'pending'
	

2025/06/19 23:53:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[65.759ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:53:47.598' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:53:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.902ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:53:47.664'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:54:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.472ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:39:46.841' LIMIT 50

2025/06/19 23:54:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[70.476ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:54:46.843'

2025/06/19 23:54:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.855ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:39:46.853' LIMIT 50

2025/06/19 23:54:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.620ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:54:46.843'

2025/06/19 23:54:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.278ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:54:46.843'

2025/06/19 23:54:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[68.697ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:24:47.227'

2025/06/19 23:54:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.925ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:54:47.296' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:54:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.464ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:24:47.329'

2025/06/19 23:54:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.833ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:54:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.070ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:54:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.111ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:54:47.394' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:54:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.895ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:54:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.084ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:54:47.428' AND status != 'pending'
	

2025/06/19 23:54:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.915ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:54:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.168ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:54:47.494' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:54:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.814ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:54:47.522' AND status != 'pending'
	

2025/06/19 23:54:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.205ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:54:47.561'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:54:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.018ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:54:47.586' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:54:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.794ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:54:47.65'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:55:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[69.075ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:55:46.841'

2025/06/19 23:55:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.461ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:55:46.841'

2025/06/19 23:55:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.801ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:55:46.841'

2025/06/19 23:55:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.508ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:25:47.225'

2025/06/19 23:55:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.721ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:55:47.291' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:55:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.414ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:55:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.278ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:25:47.33'

2025/06/19 23:55:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.329ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:55:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.769ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:55:47.396' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:55:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.646ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:55:47.419' AND status != 'pending'
	

2025/06/19 23:55:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.227ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:55:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.289ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:55:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.133ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:55:47.483' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:55:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.998ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:55:47.53' AND status != 'pending'
	

2025/06/19 23:55:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.466ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:55:47.548'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:55:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.836ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:55:47.596' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:55:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.714ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:55:47.663'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:56:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.948ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:56:46.84'

2025/06/19 23:56:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.181ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:41:46.84' LIMIT 50

2025/06/19 23:56:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.997ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:41:46.852' LIMIT 50

2025/06/19 23:56:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.709ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:56:46.84'

2025/06/19 23:56:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.954ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:56:46.84'

2025/06/19 23:56:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.955ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:26:47.226'

2025/06/19 23:56:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.268ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:56:47.29' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:56:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.241ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:56:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.478ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:26:47.329'

2025/06/19 23:56:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.751ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:56:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.738ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:56:47.387' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:56:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.180ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:56:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.203ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:56:47.418' AND status != 'pending'
	

2025/06/19 23:56:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.380ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:56:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.876ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:56:47.482' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:56:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.530ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:56:47.503' AND status != 'pending'
	

2025/06/19 23:56:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.206ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:56:47.546'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:56:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.844ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:56:47.562' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:56:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.755ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:56:47.621'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:57:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.153ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:57:46.84'

2025/06/19 23:57:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.593ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:57:46.84'

2025/06/19 23:57:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.961ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:57:46.84'

2025/06/19 23:57:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.967ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:27:47.225'

2025/06/19 23:57:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.518ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:57:47.286' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:57:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.180ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:57:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.621ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:27:47.329'

2025/06/19 23:57:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.462ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:57:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.507ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:57:47.393' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:57:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.463ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:57:47.404' AND status != 'pending'
	

2025/06/19 23:57:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.915ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:57:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.003ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:57:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.228ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:57:47.462' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:57:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.506ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:57:47.523'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:57:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.257ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:57:47.521' AND status != 'pending'
	

2025/06/19 23:57:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.936ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:57:47.584' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:57:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.258ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:57:47.648'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:58:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.935ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:43:46.839' LIMIT 50

2025/06/19 23:58:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.797ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:58:46.839'

2025/06/19 23:58:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.212ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:43:46.851' LIMIT 50

2025/06/19 23:58:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.832ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:58:46.839'

2025/06/19 23:58:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.450ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:58:46.839'

2025/06/19 23:58:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.837ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:28:47.224'

2025/06/19 23:58:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.553ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:58:47.29' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:58:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.312ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:58:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.572ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:28:47.328'

2025/06/19 23:58:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.893ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:58:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.272ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:58:47.394' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:58:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.267ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:58:47.419' AND status != 'pending'
	

2025/06/19 23:58:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.287ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:58:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.048ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:58:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.814ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:58:47.484' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:58:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.797ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:58:47.527' AND status != 'pending'
	

2025/06/19 23:58:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.006ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:58:47.548'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:58:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.010ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:58:47.594' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:58:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.656ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:58:47.661'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:59:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[74.785ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-19 23:59:46.839'

2025/06/19 23:59:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.455ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-19 23:59:46.839'

2025/06/19 23:59:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[69.391ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-18 23:59:46.839'

2025/06/19 23:59:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.703ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:29:47.224'

2025/06/19 23:59:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.676ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:59:47.291' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:59:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.828ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:29:47.327'

2025/06/19 23:59:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.745ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:59:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.007ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:59:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.835ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 22:59:47.39' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/19 23:59:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.798ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/19 23:59:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.101ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:59:47.423' AND status != 'pending'
	

2025/06/19 23:59:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.845ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/19 23:59:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.013ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:59:47.487' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:59:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.044ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 22:59:47.518' AND status != 'pending'
	

2025/06/19 23:59:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.127ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:59:47.553'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/19 23:59:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.862ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 22:59:47.582' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/19 23:59:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.352ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 22:59:47.646'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 00:00:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.350ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:45:46.85' LIMIT 50

2025/06/20 00:00:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[71.412ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 00:00:46.838'

2025/06/20 00:00:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[69.713ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:45:46.838' LIMIT 50

2025/06/20 00:00:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.901ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 00:00:46.838'

2025/06/20 00:00:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.397ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 00:00:46.838'

2025/06/20 00:00:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.233ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:30:47.223'

2025/06/20 00:00:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.836ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 23:00:47.289' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 00:00:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.286ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 00:00:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.445ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:30:47.327'

2025/06/20 00:00:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.374ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 00:00:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.953ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 23:00:47.392' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 00:00:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.778ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 23:00:47.418' AND status != 'pending'
	

2025/06/20 00:00:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.808ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 00:00:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.989ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 00:00:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.942ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 23:00:47.482' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 00:00:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.306ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 23:00:47.525' AND status != 'pending'
	

2025/06/20 00:00:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.530ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 23:00:47.546'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 00:00:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.422ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 23:00:47.591' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 00:00:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.371ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 23:00:47.658'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 00:01:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.173ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 00:01:46.838'

2025/06/20 00:01:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.769ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 00:01:46.838'

2025/06/20 00:01:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[67.654ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 00:01:46.838'

2025/06/20 00:01:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.772ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:31:47.222'

2025/06/20 00:01:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.440ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 23:01:47.289' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 00:01:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.966ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 00:01:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.665ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:31:47.326'

2025/06/20 00:01:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.926ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 00:01:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.156ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 23:01:47.39' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 00:01:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.154ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 00:01:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.625ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 23:01:47.422' AND status != 'pending'
	

2025/06/20 00:01:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.762ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 00:01:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.404ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 23:01:47.488' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 00:01:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.744ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 23:01:47.518' AND status != 'pending'
	

2025/06/20 00:01:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.321ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 23:01:47.555'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 00:01:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.775ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 23:01:47.582' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 00:01:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.936ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 23:01:47.646'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 00:02:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.321ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:47:46.836' LIMIT 50

2025/06/20 00:02:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.935ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 00:02:46.837'

2025/06/20 00:02:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.075ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:47:46.848' LIMIT 50

2025/06/20 00:02:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[66.808ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 00:02:46.837'

2025/06/20 00:02:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.724ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 00:02:46.837'

2025/06/20 00:02:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.359ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:32:47.222'

2025/06/20 00:02:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.224ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 23:02:47.29' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 00:02:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.841ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:32:47.325'

2025/06/20 00:02:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.829ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 00:02:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.301ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 00:02:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.761ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 23:02:47.383' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 00:02:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.364ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 00:02:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.205ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 23:02:47.423' AND status != 'pending'
	

2025/06/20 00:02:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.178ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 00:02:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.424ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 23:02:47.489' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 00:02:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.045ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 23:02:47.501' AND status != 'pending'
	

2025/06/20 00:02:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.286ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 23:02:47.561' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 00:02:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.788ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 23:02:47.556'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 00:02:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.663ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 23:02:47.619'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 00:03:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.757ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 00:03:46.836'

2025/06/20 00:03:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.252ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 00:03:46.836'

2025/06/20 00:03:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.247ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 00:03:46.836'

2025/06/20 00:03:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.164ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:33:47.221'

2025/06/20 00:03:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.855ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 23:03:47.282' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 00:03:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.341ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 00:03:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.405ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:33:47.326'

2025/06/20 00:03:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.979ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 00:03:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.569ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 23:03:47.401' AND status != 'pending'
	

2025/06/20 00:03:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[67.053ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 23:03:47.393' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 00:03:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.118ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 00:03:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.691ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 23:03:47.46' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 00:03:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.901ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 00:03:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.959ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 23:03:47.52'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 00:03:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.747ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 23:03:47.528' AND status != 'pending'
	

2025/06/20 00:03:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.832ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 23:03:47.595' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 00:03:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[67.060ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 23:03:47.662'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 00:04:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.776ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 00:04:46.836'

2025/06/20 00:04:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[66.497ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:49:46.835' LIMIT 50

2025/06/20 00:04:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.897ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:49:46.848' LIMIT 50

2025/06/20 00:04:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.256ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 00:04:46.836'

2025/06/20 00:04:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.286ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 00:04:46.836'

2025/06/20 00:04:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.041ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:34:47.221'

2025/06/20 00:04:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.578ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 23:04:47.281' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 00:04:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.117ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 00:04:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.586ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:34:47.325'

2025/06/20 00:04:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.838ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 00:04:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.478ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 23:04:47.392' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 00:04:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.534ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 23:04:47.398' AND status != 'pending'
	

2025/06/20 00:04:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.126ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 00:04:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.951ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 23:04:47.458' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 00:04:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.852ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 00:04:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.218ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 23:04:47.516'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 00:04:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.719ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 23:04:47.521' AND status != 'pending'
	

2025/06/20 00:04:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.192ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 23:04:47.584' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 00:04:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.325ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 23:04:47.649'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 00:05:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[68.644ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 00:05:46.835'

2025/06/20 00:05:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.468ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 00:05:46.835'

2025/06/20 00:05:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.953ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 00:05:46.835'

2025/06/20 00:05:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[65.230ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:35:47.221'

2025/06/20 00:05:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.368ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 23:05:47.286' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 00:05:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.770ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:35:47.324'

2025/06/20 00:05:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.785ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 00:05:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.418ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 00:05:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.029ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 23:05:47.383' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 00:05:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.896ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 00:05:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[63.129ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 23:05:47.415' AND status != 'pending'
	

2025/06/20 00:05:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.262ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 00:05:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.040ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 23:05:47.478' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 00:05:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.333ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 23:05:47.502' AND status != 'pending'
	

2025/06/20 00:05:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.854ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 23:05:47.543'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 00:05:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.900ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 23:05:47.56' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 00:05:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.960ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 23:05:47.619'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 00:06:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.294ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-20 00:06:46.835'

2025/06/20 00:06:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.439ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:51:46.834' LIMIT 50

2025/06/20 00:06:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[65.236ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:51:46.847' LIMIT 50

2025/06/20 00:06:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.827ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-20 00:06:46.835'

2025/06/20 00:06:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.129ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-19 00:06:46.835'

2025/06/20 00:06:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.598ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:36:47.224'

2025/06/20 00:06:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.639ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 23:06:47.283' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 00:06:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.886ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 00:06:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.652ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-19 23:36:47.323'

2025/06/20 00:06:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.539ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 00:06:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[66.635ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-19 23:06:47.391' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/20 00:06:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.641ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 23:06:47.402' AND status != 'pending'
	

2025/06/20 00:06:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.143ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/20 00:06:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.885ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 23:06:47.459' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 00:06:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[33.161ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/20 00:06:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.667ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 23:06:47.517'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/20 00:06:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.439ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-19 23:06:47.524' AND status != 'pending'
	

2025/06/20 00:06:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[66.779ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-19 23:06:47.591' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/20 00:06:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.930ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-19 23:06:47.658'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	
