
2025/06/25 21:23:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.527ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 20:53:23.743'

2025/06/25 21:23:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.865ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:23:23.805' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:23:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.475ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:23:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.000ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:23:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[188.308ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 20:53:23.771'

2025/06/25 21:23:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[70.727ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:23:23.922' AND status != 'pending'
	

2025/06/25 21:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.646ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:23:23.96' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.621ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:23:23.993' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.239ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.997ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.761ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:23:24.05'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.049ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:23:24.082' AND status != 'pending'
	

2025/06/25 21:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[79.844ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:23:24.142' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.551ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:23:24.222'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:24:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[67.300ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:24:23.741'

2025/06/25 21:24:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.634ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:24:23.741'

2025/06/25 21:24:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.928ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:24:23.741'

2025/06/25 21:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.572ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 20:54:24.113'

2025/06/25 21:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.205ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:24:24.174' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.880ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.336ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.015ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 20:54:24.285'

2025/06/25 21:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.430ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:24:24.296' AND status != 'pending'
	

2025/06/25 21:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.835ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:24:24.343' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.868ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:24:24.356' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.656ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.145ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.318ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:24:24.416'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.394ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:24:24.459' AND status != 'pending'
	

2025/06/25 21:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.980ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:24:24.517' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.327ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:24:24.576'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:25:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.717ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:25:23.742'

2025/06/25 21:25:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.720ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:10:23.745' LIMIT 50

2025/06/25 21:25:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.672ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:25:23.742'

2025/06/25 21:25:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.860ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:25:23.742'

2025/06/25 21:25:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[185.725ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:10:23.773' LIMIT 50

2025/06/25 21:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.329ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 20:55:24.114'

2025/06/25 21:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.754ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:25:24.177' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.028ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.803ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.599ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 20:55:24.285'

2025/06/25 21:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.289ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:25:24.298' AND status != 'pending'
	

2025/06/25 21:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.619ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:25:24.345' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.083ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:25:24.358' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.276ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.787ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.295ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:25:24.42'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.321ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:25:24.461' AND status != 'pending'
	

2025/06/25 21:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.038ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:25:24.52' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.879ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:25:24.578'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:26:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[66.981ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:26:23.683'

2025/06/25 21:26:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.367ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:26:23.683'

2025/06/25 21:26:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.921ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:26:23.683'

2025/06/25 21:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.445ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 20:56:24.056'

2025/06/25 21:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.082ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:26:24.115' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.140ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.092ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.373ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 20:56:24.227'

2025/06/25 21:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.720ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:26:24.231' AND status != 'pending'
	

2025/06/25 21:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.398ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:26:24.288' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.031ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:26:24.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.383ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.093ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:26:24.348'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.713ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.708ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:26:24.41' AND status != 'pending'
	

2025/06/25 21:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.847ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:26:24.47' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.554ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:26:24.531'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:27:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.291ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:12:23.687' LIMIT 50

2025/06/25 21:27:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.012ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:27:23.683'

2025/06/25 21:27:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.145ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:12:23.714' LIMIT 50

2025/06/25 21:27:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.411ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:27:23.683'

2025/06/25 21:27:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[66.328ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:27:23.683'

2025/06/25 21:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.235ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 20:57:24.056'

2025/06/25 21:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.049ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:27:24.116' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.259ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.723ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.455ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 20:57:24.226'

2025/06/25 21:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.235ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:27:24.236' AND status != 'pending'
	

2025/06/25 21:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.716ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:27:24.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.641ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:27:24.297' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.624ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.422ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.999ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:27:24.356'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.252ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:27:24.41' AND status != 'pending'
	

2025/06/25 21:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.953ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:27:24.47' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.707ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:27:24.53'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:28:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.515ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:28:23.686'

2025/06/25 21:28:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.978ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:28:23.686'

2025/06/25 21:28:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.467ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:28:23.686'

2025/06/25 21:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.141ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 20:58:24.058'

2025/06/25 21:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[74.266ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:28:24.119' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[40.775ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.536ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.205ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 20:58:24.229'

2025/06/25 21:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.839ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:28:24.264' AND status != 'pending'
	

2025/06/25 21:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.815ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:28:24.293' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.073ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.444ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:28:24.325' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.369ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.172ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:28:24.385'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.953ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:28:24.415' AND status != 'pending'
	

2025/06/25 21:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.576ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:28:24.478' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.804ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:28:24.539'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:29:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.780ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:29:23.686'

2025/06/25 21:29:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.224ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:14:23.689' LIMIT 50

2025/06/25 21:29:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.194ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:14:23.717' LIMIT 50

2025/06/25 21:29:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.171ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:29:23.686'

2025/06/25 21:29:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.917ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:29:23.686'

2025/06/25 21:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.314ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 20:59:24.059'

2025/06/25 21:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.963ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:29:24.12' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.329ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.456ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.685ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 20:59:24.229'

2025/06/25 21:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.021ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:29:24.241' AND status != 'pending'
	

2025/06/25 21:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.903ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:29:24.289' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.044ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:29:24.301' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.790ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.925ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.695ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:29:24.362'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.377ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:29:24.405' AND status != 'pending'
	

2025/06/25 21:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.994ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:29:24.463' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.344ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:29:24.521'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:30:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.583ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:30:23.686'

2025/06/25 21:30:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.753ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:30:23.686'

2025/06/25 21:30:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.201ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:30:23.686'

2025/06/25 21:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.064ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:00:24.059'

2025/06/25 21:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.685ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:30:24.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.801ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.959ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.835ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:00:24.229'

2025/06/25 21:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.078ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:30:24.234' AND status != 'pending'
	

2025/06/25 21:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.967ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:30:24.294' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.112ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:30:24.291' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.024ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.178ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:30:24.351'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.607ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.045ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:30:24.412' AND status != 'pending'
	

2025/06/25 21:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.027ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:30:24.473' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.591ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:30:24.533'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:31:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.516ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:16:23.689' LIMIT 50

2025/06/25 21:31:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.087ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:31:23.686'

2025/06/25 21:31:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.286ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:16:23.716' LIMIT 50

2025/06/25 21:31:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.389ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:31:23.686'

2025/06/25 21:31:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.651ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:31:23.686'

2025/06/25 21:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.264ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:01:24.058'

2025/06/25 21:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.657ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:31:24.12' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.179ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.503ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.701ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:01:24.229'

2025/06/25 21:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[65.993ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:31:24.24' AND status != 'pending'
	

2025/06/25 21:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.786ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:31:24.297' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.876ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:31:24.306' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.635ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.190ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.439ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:31:24.369'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.150ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:31:24.417' AND status != 'pending'
	

2025/06/25 21:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.039ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:31:24.477' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.835ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:31:24.537'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:31:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.827ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:31:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[75.036ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 21:32:00 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.045ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:32:00 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.751ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:32:03 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.315ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:32:03 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.960ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:32:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.864ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:32:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.160ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:32:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.038ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:32:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.678ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:32:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.451ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:32:23.686'

2025/06/25 21:32:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.641ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:32:23.686'

2025/06/25 21:32:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.784ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:32:23.686'

2025/06/25 21:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.141ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:02:24.058'

2025/06/25 21:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.391ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:32:24.12' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.414ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.634ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.388ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:02:24.229'

2025/06/25 21:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.319ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:32:24.244' AND status != 'pending'
	

2025/06/25 21:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.701ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:32:24.29' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.935ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:32:24.303' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.120ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.200ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.368ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:32:24.363'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[67.540ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:32:24.41' AND status != 'pending'
	

2025/06/25 21:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.609ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:32:24.478' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.530ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:32:24.539'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:33:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.327ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:33:23.686'

2025/06/25 21:33:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.886ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:18:23.689' LIMIT 50

2025/06/25 21:33:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.215ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:18:23.716' LIMIT 50

2025/06/25 21:33:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.310ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:33:23.686'

2025/06/25 21:33:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.267ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:33:23.686'

2025/06/25 21:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[71.163ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:03:24.058'

2025/06/25 21:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[70.230ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:33:24.131' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.053ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.321ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.245ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:03:24.229'

2025/06/25 21:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.161ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:33:24.262' AND status != 'pending'
	

2025/06/25 21:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.250ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:33:24.286' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.983ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.013ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:33:24.322' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.852ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.295ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:33:24.382'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.530ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:33:24.403' AND status != 'pending'
	

2025/06/25 21:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.771ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:33:24.461' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.448ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:33:24.52'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:33:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.775ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:33:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.295ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:33:51 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[64.691ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 21:34:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.972ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:34:23.686'

2025/06/25 21:34:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.280ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:34:23.686'

2025/06/25 21:34:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.627ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:34:23.686'

2025/06/25 21:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.561ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:04:24.058'

2025/06/25 21:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.913ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:34:24.119' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.190ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.189ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.089ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:04:24.229'

2025/06/25 21:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.881ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:34:24.245' AND status != 'pending'
	

2025/06/25 21:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.060ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:34:24.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.087ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:34:24.305' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.667ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.014ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.836ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:34:24.365'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.265ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:34:24.404' AND status != 'pending'
	

2025/06/25 21:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.063ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:34:24.462' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.905ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:34:24.52'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:35:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.781ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:35:23.685'

2025/06/25 21:35:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.601ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:20:23.689' LIMIT 50

2025/06/25 21:35:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.465ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:20:23.716' LIMIT 50

2025/06/25 21:35:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.363ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:35:23.685'

2025/06/25 21:35:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.981ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:35:23.685'

2025/06/25 21:35:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.499ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:05:24.058'

2025/06/25 21:35:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.144ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:35:24.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:35:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.604ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:35:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.535ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:35:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.394ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:05:24.231'

2025/06/25 21:35:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.488ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:35:24.237' AND status != 'pending'
	

2025/06/25 21:35:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.213ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:35:24.292' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:35:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.969ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:35:24.298' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:35:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.814ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:35:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.764ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:35:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.725ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:35:24.356'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:35:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.916ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:35:24.413' AND status != 'pending'
	

2025/06/25 21:35:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.473ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:35:24.475' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:35:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.771ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:35:24.536'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:36:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.706ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:36:23.685'

2025/06/25 21:36:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.468ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:36:23.685'

2025/06/25 21:36:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.730ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:36:23.685'

2025/06/25 21:36:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.471ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:06:24.058'

2025/06/25 21:36:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.114ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:36:24.12' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:36:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.295ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:36:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.208ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:36:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.766ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:06:24.229'

2025/06/25 21:36:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.955ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:36:24.241' AND status != 'pending'
	

2025/06/25 21:36:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.146ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:36:24.29' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:36:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.603ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:36:24.302' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:36:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.878ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:36:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.846ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:36:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.975ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:36:24.366'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:36:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.665ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:36:24.405' AND status != 'pending'
	

2025/06/25 21:36:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.773ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:36:24.464' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:36:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.448ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:36:24.523'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:37:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.698ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:37:23.685'

2025/06/25 21:37:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.544ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:22:23.689' LIMIT 50

2025/06/25 21:37:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.007ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:22:23.716' LIMIT 50

2025/06/25 21:37:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.754ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:37:23.685'

2025/06/25 21:37:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.932ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:37:23.685'

2025/06/25 21:37:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.618ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:07:24.058'

2025/06/25 21:37:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.549ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:37:24.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:37:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.895ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:37:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.479ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:37:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.987ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:07:24.229'

2025/06/25 21:37:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.294ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:37:24.235' AND status != 'pending'
	

2025/06/25 21:37:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.114ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:37:24.289' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:37:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.899ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:37:24.292' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:37:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.176ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:37:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.069ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:37:24.35'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:37:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.809ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:37:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.214ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:37:24.41' AND status != 'pending'
	

2025/06/25 21:37:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.179ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:37:24.47' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:37:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.898ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:37:24.53'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:38:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.110ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:38:23.685'

2025/06/25 21:38:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.502ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:38:23.685'

2025/06/25 21:38:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.847ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:38:23.685'

2025/06/25 21:38:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.493ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:08:24.058'

2025/06/25 21:38:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.011ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:38:24.121' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:38:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.439ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:38:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.465ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:38:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.117ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:08:24.229'

2025/06/25 21:38:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.504ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:38:24.244' AND status != 'pending'
	

2025/06/25 21:38:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.893ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:38:24.289' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:38:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.107ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:38:24.305' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:38:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.835ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:38:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.049ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:38:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.864ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:38:24.365'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:38:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.949ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:38:24.406' AND status != 'pending'
	

2025/06/25 21:38:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.068ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:38:24.471' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:38:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.713ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:38:24.529'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:39:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.590ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:39:23.685'

2025/06/25 21:39:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.912ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:24:23.689' LIMIT 50

2025/06/25 21:39:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.181ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:24:23.716' LIMIT 50

2025/06/25 21:39:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.454ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:39:23.685'

2025/06/25 21:39:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.688ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:39:23.685'

2025/06/25 21:39:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.229ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:09:24.058'

2025/06/25 21:39:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.106ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:39:24.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:39:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.244ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:39:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.088ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:39:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.870ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:09:24.228'

2025/06/25 21:39:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.365ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:39:24.235' AND status != 'pending'
	

2025/06/25 21:39:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.257ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:39:24.289' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:39:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.087ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:39:24.293' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:39:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.104ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:39:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.815ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:39:24.35'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:39:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.722ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:39:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.136ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:39:24.41' AND status != 'pending'
	

2025/06/25 21:39:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.443ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:39:24.47' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:39:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.029ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:39:24.531'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:40:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.341ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:40:23.685'

2025/06/25 21:40:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.923ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:40:23.685'

2025/06/25 21:40:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.592ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:40:23.685'

2025/06/25 21:40:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.793ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:10:24.058'

2025/06/25 21:40:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.698ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:40:24.119' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:40:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.050ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:40:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.057ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:40:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.208ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:10:24.229'

2025/06/25 21:40:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.824ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:40:24.24' AND status != 'pending'
	

2025/06/25 21:40:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.078ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:40:24.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:40:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.388ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:40:24.3' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:40:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.790ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:40:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.877ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:40:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.188ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:40:24.361'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:40:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.143ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:40:24.404' AND status != 'pending'
	

2025/06/25 21:40:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.359ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:40:24.462' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:40:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.047ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:40:24.521'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:41:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.035ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:41:23.686'

2025/06/25 21:41:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.713ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:26:23.689' LIMIT 50

2025/06/25 21:41:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.994ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:26:23.716' LIMIT 50

2025/06/25 21:41:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.940ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:41:23.686'

2025/06/25 21:41:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.092ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:41:23.686'

2025/06/25 21:41:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.146ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:11:24.059'

2025/06/25 21:41:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.823ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:41:24.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:41:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.487ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:41:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.964ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:41:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.462ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:11:24.229'

2025/06/25 21:41:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.376ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:41:24.233' AND status != 'pending'
	

2025/06/25 21:41:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.149ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:41:24.292' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:41:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.017ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:41:24.29' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:41:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.781ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:41:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.690ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:41:24.349'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:41:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.896ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:41:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.679ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:41:24.41' AND status != 'pending'
	

2025/06/25 21:41:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.458ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:41:24.471' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:41:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.436ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:41:24.531'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:42:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.261ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:42:23.685'

2025/06/25 21:42:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.266ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:42:23.685'

2025/06/25 21:42:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.419ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:42:23.685'

2025/06/25 21:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.294ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:12:24.058'

2025/06/25 21:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.499ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:42:24.119' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.578ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.568ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.564ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:12:24.229'

2025/06/25 21:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.307ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:42:24.241' AND status != 'pending'
	

2025/06/25 21:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.913ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:42:24.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.222ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:42:24.301' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.203ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.428ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.925ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:42:24.362'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.536ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:42:24.405' AND status != 'pending'
	

2025/06/25 21:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.071ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:42:24.468' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:42:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.708ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:42:24.527'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:42:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[58.539ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 21:42:50 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.524ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:43:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[57.828ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 21:43:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.480ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:43:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[66.630ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:43:15 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[67.430ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:43:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.306ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:43:23.685'

2025/06/25 21:43:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.314ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:28:23.689' LIMIT 50

2025/06/25 21:43:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.765ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:28:23.716' LIMIT 50

2025/06/25 21:43:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.076ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:43:23.685'

2025/06/25 21:43:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.695ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:43:23.685'

2025/06/25 21:43:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.328ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:13:24.058'

2025/06/25 21:43:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.236ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:43:24.121' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:43:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.753ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:43:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[32.213ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:43:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.993ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:13:24.229'

2025/06/25 21:43:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.213ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:43:24.244' AND status != 'pending'
	

2025/06/25 21:43:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.149ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:43:24.29' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:43:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.923ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:43:24.306' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:43:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.426ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:43:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.412ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:43:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.551ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:43:24.367'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:43:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.258ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:43:24.412' AND status != 'pending'
	

2025/06/25 21:43:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.183ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:43:24.474' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:43:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.251ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:43:24.536'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:44:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.877ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:44:23.685'

2025/06/25 21:44:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.873ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:44:23.685'

2025/06/25 21:44:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.544ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:44:23.685'

2025/06/25 21:44:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.187ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:14:24.058'

2025/06/25 21:44:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.771ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:44:24.12' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:44:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.973ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:44:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.910ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:44:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.236ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:14:24.228'

2025/06/25 21:44:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.137ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:44:24.242' AND status != 'pending'
	

2025/06/25 21:44:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.141ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:44:24.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:44:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.784ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:44:24.302' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:44:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.763ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:44:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.879ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:44:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.125ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:44:24.364'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:44:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.902ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:44:24.407' AND status != 'pending'
	

2025/06/25 21:44:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.336ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:44:24.467' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:44:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.618ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:44:24.528'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:45:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.966ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:45:23.685'

2025/06/25 21:45:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.962ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:30:23.689' LIMIT 50

2025/06/25 21:45:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[67.842ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:30:23.717' LIMIT 50

2025/06/25 21:45:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.051ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:45:23.685'

2025/06/25 21:45:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.455ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:45:23.685'

2025/06/25 21:45:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.172ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:15:24.057'

2025/06/25 21:45:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.817ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:45:24.119' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:45:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.576ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:45:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.953ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:45:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.288ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:15:24.229'

2025/06/25 21:45:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.675ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:45:24.24' AND status != 'pending'
	

2025/06/25 21:45:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.674ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:45:24.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:45:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.888ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:45:24.3' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:45:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.875ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:45:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.280ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:45:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.922ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:45:24.362'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:45:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.236ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:45:24.407' AND status != 'pending'
	

2025/06/25 21:45:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.187ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:45:24.467' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:45:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.856ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:45:24.526'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:46:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.713ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:46:23.685'

2025/06/25 21:46:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.546ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:46:23.685'

2025/06/25 21:46:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.560ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:46:23.685'

2025/06/25 21:46:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.184ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:16:24.057'

2025/06/25 21:46:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.881ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:46:24.123' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:46:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.222ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:46:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.099ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:46:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.980ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:16:24.229'

2025/06/25 21:46:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.473ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:46:24.243' AND status != 'pending'
	

2025/06/25 21:46:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.146ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:46:24.289' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:46:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.560ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:46:24.302' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:46:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.886ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:46:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.226ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:46:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.794ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:46:24.364'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:46:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.387ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:46:24.41' AND status != 'pending'
	

2025/06/25 21:46:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.763ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:46:24.469' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:46:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.282ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:46:24.53'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:47:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.937ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:32:23.689' LIMIT 50

2025/06/25 21:47:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[64.546ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:47:23.685'

2025/06/25 21:47:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[63.409ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:32:23.717' LIMIT 50

2025/06/25 21:47:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.616ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:47:23.685'

2025/06/25 21:47:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.209ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:47:23.685'

2025/06/25 21:47:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.316ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:17:24.057'

2025/06/25 21:47:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.611ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:47:24.116' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:47:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.778ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:47:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.357ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:47:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.140ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:17:24.228'

2025/06/25 21:47:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.975ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:47:24.235' AND status != 'pending'
	

2025/06/25 21:47:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.047ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:47:24.293' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:47:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.586ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:47:24.291' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:47:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.135ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:47:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.105ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:47:24.351'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:47:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.849ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:47:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.358ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:47:24.411' AND status != 'pending'
	

2025/06/25 21:47:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.635ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:47:24.471' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:47:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.447ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:47:24.532'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:48:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.814ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:48:23.685'

2025/06/25 21:48:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.957ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:48:23.685'

2025/06/25 21:48:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.419ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:48:23.685'

2025/06/25 21:48:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[67.260ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:18:24.057'

2025/06/25 21:48:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[64.685ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:48:24.125' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:48:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.913ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:48:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.212ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:48:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.586ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:18:24.228'

2025/06/25 21:48:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.614ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:48:24.25' AND status != 'pending'
	

2025/06/25 21:48:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.314ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:48:24.286' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:48:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.257ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:48:24.311' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:48:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.844ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:48:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.454ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:48:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.941ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:48:24.371'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:48:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.840ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:48:24.401' AND status != 'pending'
	

2025/06/25 21:48:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.565ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:48:24.46' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:48:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[63.194ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:48:24.518'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:49:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.590ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:49:23.685'

2025/06/25 21:49:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.407ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:34:23.688' LIMIT 50

2025/06/25 21:49:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.681ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:34:23.716' LIMIT 50

2025/06/25 21:49:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.174ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:49:23.685'

2025/06/25 21:49:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.922ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:49:23.685'

2025/06/25 21:49:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.203ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:19:24.057'

2025/06/25 21:49:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.027ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:49:24.117' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:49:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.516ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:49:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.615ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:49:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.220ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:19:24.228'

2025/06/25 21:49:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.897ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:49:24.232' AND status != 'pending'
	

2025/06/25 21:49:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.585ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:49:24.299' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:49:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.697ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:49:24.29' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:49:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.087ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:49:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.390ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:49:24.359'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:49:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.412ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:49:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.450ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:49:24.418' AND status != 'pending'
	

2025/06/25 21:49:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.876ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:49:24.479' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:49:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.947ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:49:24.539'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:50:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.230ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:50:23.685'

2025/06/25 21:50:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.281ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:50:23.685'

2025/06/25 21:50:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.622ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:50:23.685'

2025/06/25 21:50:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.102ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:20:24.057'

2025/06/25 21:50:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.162ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:50:24.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:50:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.079ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:50:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.777ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:50:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.089ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:20:24.228'

2025/06/25 21:50:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.911ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:50:24.239' AND status != 'pending'
	

2025/06/25 21:50:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.425ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:50:24.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:50:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.402ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:50:24.299' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:50:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.179ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:50:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.742ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:50:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.114ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:50:24.359'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:50:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.897ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:50:24.404' AND status != 'pending'
	

2025/06/25 21:50:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.986ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:50:24.462' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:50:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.816ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:50:24.521'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:51:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.804ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:51:23.685'

2025/06/25 21:51:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.212ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:36:23.688' LIMIT 50

2025/06/25 21:51:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.521ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:36:23.716' LIMIT 50

2025/06/25 21:51:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.278ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:51:23.685'

2025/06/25 21:51:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.395ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:51:23.685'

2025/06/25 21:51:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.257ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:21:24.057'

2025/06/25 21:51:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.058ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:51:24.116' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:51:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.699ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:51:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.397ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:51:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.742ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:51:24.232' AND status != 'pending'
	

2025/06/25 21:51:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.740ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:21:24.228'

2025/06/25 21:51:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.914ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:51:24.29' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:51:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.224ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:51:24.29' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:51:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.106ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:51:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.418ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:51:24.348'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:51:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.249ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:51:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.827ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:51:24.41' AND status != 'pending'
	

2025/06/25 21:51:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.267ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:51:24.47' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:51:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.635ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:51:24.53'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:52:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.655ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:52:23.685'

2025/06/25 21:52:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.505ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:52:23.685'

2025/06/25 21:52:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.027ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:52:23.685'

2025/06/25 21:52:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.063ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:22:24.057'

2025/06/25 21:52:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.761ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:52:24.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:52:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.003ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:52:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.926ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:52:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.053ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:22:24.227'

2025/06/25 21:52:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.170ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:52:24.24' AND status != 'pending'
	

2025/06/25 21:52:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.827ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:52:24.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:52:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.385ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:52:24.3' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:52:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.533ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:52:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.241ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:52:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.283ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:52:24.36'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:52:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.700ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:52:24.405' AND status != 'pending'
	

2025/06/25 21:52:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.054ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:52:24.463' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:52:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.631ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:52:24.523'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:53:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.810ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:53:23.685'

2025/06/25 21:53:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.141ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:38:23.688' LIMIT 50

2025/06/25 21:53:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.257ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:38:23.715' LIMIT 50

2025/06/25 21:53:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.484ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:53:23.685'

2025/06/25 21:53:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[63.301ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:53:23.685'

2025/06/25 21:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.863ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:23:24.057'

2025/06/25 21:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.139ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:53:24.116' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[32.078ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.211ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.811ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:23:24.228'

2025/06/25 21:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.608ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:53:24.237' AND status != 'pending'
	

2025/06/25 21:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.826ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:53:24.291' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.200ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:53:24.295' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.593ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.215ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.845ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:53:24.351'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.768ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:53:24.409' AND status != 'pending'
	

2025/06/25 21:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.013ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:53:24.466' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:53:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.807ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:53:24.524'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:53:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[58.316ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 21:54:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[62.911ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:54:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.405ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:54:04 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.283ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:54:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.037ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:54:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.850ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:54:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.784ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:54:23.685'

2025/06/25 21:54:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.216ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:54:23.685'

2025/06/25 21:54:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.995ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:54:23.685'

2025/06/25 21:54:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.147ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:24:24.057'

2025/06/25 21:54:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.427ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:54:24.119' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:54:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.365ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:54:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.689ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:54:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.477ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:24:24.228'

2025/06/25 21:54:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.409ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:54:24.241' AND status != 'pending'
	

2025/06/25 21:54:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.160ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:54:24.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:54:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.156ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:54:24.301' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:54:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.180ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:54:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.336ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:54:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.633ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:54:24.361'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:54:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.784ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:54:24.403' AND status != 'pending'
	

2025/06/25 21:54:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.755ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:54:24.461' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:54:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.410ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:54:24.52'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:55:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.536ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:55:23.684'

2025/06/25 21:55:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.883ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:40:23.688' LIMIT 50

2025/06/25 21:55:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.958ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:40:23.715' LIMIT 50

2025/06/25 21:55:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.352ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:55:23.684'

2025/06/25 21:55:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.878ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:55:23.684'

2025/06/25 21:55:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.804ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:25:24.057'

2025/06/25 21:55:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.514ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:55:24.116' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:55:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.242ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:55:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.740ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:55:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.084ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:55:24.232' AND status != 'pending'
	

2025/06/25 21:55:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.723ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:25:24.228'

2025/06/25 21:55:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.329ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:55:24.289' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:55:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.196ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:55:24.29' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:55:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.719ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:55:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.138ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:55:24.348'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:55:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.878ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:55:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.479ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:55:24.41' AND status != 'pending'
	

2025/06/25 21:55:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.582ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:55:24.471' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:55:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[64.698ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:55:24.532'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:56:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.967ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:56:23.684'

2025/06/25 21:56:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.656ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:56:23.684'

2025/06/25 21:56:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.226ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:56:23.684'

2025/06/25 21:56:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.868ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:26:24.057'

2025/06/25 21:56:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.951ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:56:24.119' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:56:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.388ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:56:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.287ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:56:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.619ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:26:24.228'

2025/06/25 21:56:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.748ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:56:24.241' AND status != 'pending'
	

2025/06/25 21:56:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.606ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:56:24.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:56:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.350ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:56:24.301' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:56:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.997ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:56:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.974ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:56:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.474ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:56:24.363'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:56:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.985ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:56:24.405' AND status != 'pending'
	

2025/06/25 21:56:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.719ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:56:24.464' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:56:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.021ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:56:24.523'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:57:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.011ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:57:23.684'

2025/06/25 21:57:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.852ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:42:23.688' LIMIT 50

2025/06/25 21:57:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.503ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:42:23.715' LIMIT 50

2025/06/25 21:57:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.107ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:57:23.684'

2025/06/25 21:57:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.930ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:57:23.684'

2025/06/25 21:57:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.058ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:27:24.057'

2025/06/25 21:57:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.225ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:57:24.115' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:57:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.506ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:57:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.702ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:57:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.726ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:27:24.228'

2025/06/25 21:57:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.183ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:57:24.234' AND status != 'pending'
	

2025/06/25 21:57:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.644ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:57:24.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:57:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.753ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:57:24.293' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:57:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.156ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:57:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[56.544ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:57:24.35'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:57:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.248ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:57:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.765ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:57:24.408' AND status != 'pending'
	

2025/06/25 21:57:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.353ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:57:24.469' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:57:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.171ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:57:24.53'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:58:00 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.417ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:58:00 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.650ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:58:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.861ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:58:23.684'

2025/06/25 21:58:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.449ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:58:23.684'

2025/06/25 21:58:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.820ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:58:23.684'

2025/06/25 21:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.274ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:28:24.057'

2025/06/25 21:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.972ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:58:24.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[36.304ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.961ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.445ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:28:24.228'

2025/06/25 21:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.159ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:58:24.245' AND status != 'pending'
	

2025/06/25 21:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.488ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:58:24.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.347ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:58:24.305' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[27.993ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.901ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.175ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:58:24.365'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.174ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:58:24.403' AND status != 'pending'
	

2025/06/25 21:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.518ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:58:24.462' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:58:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.479ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:58:24.52'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:58:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.735ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:58:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.373ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 21:59:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.346ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:44:23.688' LIMIT 50

2025/06/25 21:59:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.808ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 21:59:23.684'

2025/06/25 21:59:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.493ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:44:23.716' LIMIT 50

2025/06/25 21:59:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.442ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 21:59:23.684'

2025/06/25 21:59:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.606ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 21:59:23.684'

2025/06/25 21:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.653ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:29:24.057'

2025/06/25 21:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.844ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:59:24.119' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.826ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.794ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.411ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:29:24.228'

2025/06/25 21:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.849ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:59:24.239' AND status != 'pending'
	

2025/06/25 21:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.242ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 20:59:24.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 21:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.006ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:59:24.299' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.059ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 21:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.963ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 21:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.158ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:59:24.359'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 21:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.064ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 20:59:24.408' AND status != 'pending'
	

2025/06/25 21:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.775ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 20:59:24.468' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 21:59:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.571ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 20:59:24.529'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.427ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:00:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.564ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:00:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.728ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:00:09 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.052ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:00:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.126ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:00:23.684'

2025/06/25 22:00:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.223ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:00:23.684'

2025/06/25 22:00:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.892ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:00:23.684'

2025/06/25 22:00:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.829ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:30:24.057'

2025/06/25 22:00:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.242ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:00:24.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:00:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.072ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:00:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.734ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:00:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.269ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:30:24.228'

2025/06/25 22:00:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.836ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:00:24.238' AND status != 'pending'
	

2025/06/25 22:00:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.004ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:00:24.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:00:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.076ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:00:24.298' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:00:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.129ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:00:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.124ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:00:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.768ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:00:24.358'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:00:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.061ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:00:24.409' AND status != 'pending'
	

2025/06/25 22:00:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.422ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:00:24.47' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:00:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.360ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:00:24.531'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.783ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:01:23.685'

2025/06/25 22:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.388ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:46:23.688' LIMIT 50

2025/06/25 22:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.718ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:46:23.716' LIMIT 50

2025/06/25 22:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.196ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:01:23.685'

2025/06/25 22:01:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.447ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:01:23.685'

2025/06/25 22:01:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.618ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:31:24.057'

2025/06/25 22:01:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.791ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:01:24.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:01:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.093ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:01:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.160ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:01:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.932ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:31:24.228'

2025/06/25 22:01:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.833ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:01:24.241' AND status != 'pending'
	

2025/06/25 22:01:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.081ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:01:24.286' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:01:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.125ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:01:24.302' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:01:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.625ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:01:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.185ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:01:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.808ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:01:24.365'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:01:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.767ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:01:24.402' AND status != 'pending'
	

2025/06/25 22:01:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.419ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:01:24.46' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:01:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.495ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:01:24.518'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:02:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.025ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:02:23.684'

2025/06/25 22:02:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.935ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:02:23.684'

2025/06/25 22:02:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.945ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:02:23.684'

2025/06/25 22:02:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.839ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:32:24.057'

2025/06/25 22:02:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.706ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:02:24.116' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:02:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.324ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:02:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.137ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:02:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.942ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:32:24.228'

2025/06/25 22:02:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.883ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:02:24.234' AND status != 'pending'
	

2025/06/25 22:02:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.433ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:02:24.289' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:02:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[56.909ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:02:24.294' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:02:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.823ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:02:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.741ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:02:24.351'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:02:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.761ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:02:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.383ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:02:24.41' AND status != 'pending'
	

2025/06/25 22:02:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.773ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:02:24.471' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:02:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.671ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:02:24.532'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:03:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.684ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:48:23.687' LIMIT 50

2025/06/25 22:03:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.135ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:03:23.684'

2025/06/25 22:03:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.223ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:48:23.715' LIMIT 50

2025/06/25 22:03:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.804ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:03:23.684'

2025/06/25 22:03:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.873ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:03:23.684'

2025/06/25 22:03:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.374ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:33:24.057'

2025/06/25 22:03:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.219ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:03:24.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:03:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.654ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:03:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.273ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:03:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.773ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:33:24.227'

2025/06/25 22:03:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.335ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:03:24.241' AND status != 'pending'
	

2025/06/25 22:03:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.845ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:03:24.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:03:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.710ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:03:24.302' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:03:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.206ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:03:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.972ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:03:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.135ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:03:24.362'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:03:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.791ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:03:24.408' AND status != 'pending'
	

2025/06/25 22:03:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.209ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:03:24.468' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:03:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.039ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:03:24.528'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:03:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[58.375ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:03:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.488ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:03:56 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[64.108ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:03:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.674ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:03:57 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.829ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:04:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.284ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:04:23.684'

2025/06/25 22:04:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.680ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:04:23.684'

2025/06/25 22:04:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.619ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:04:23.684'

2025/06/25 22:04:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.502ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:34:24.057'

2025/06/25 22:04:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.673ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:04:24.117' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:04:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.918ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:04:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.530ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:04:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.594ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:34:24.228'

2025/06/25 22:04:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.420ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:04:24.238' AND status != 'pending'
	

2025/06/25 22:04:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.404ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:04:24.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:04:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.545ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:04:24.298' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:04:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.696ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:04:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.858ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:04:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.765ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:04:24.358'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:04:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.437ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:04:24.409' AND status != 'pending'
	

2025/06/25 22:04:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.475ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:04:24.469' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:04:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.498ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:04:24.53'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:04:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.870ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:04:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.743ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:04:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.081ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:04:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.290ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:04:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.458ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:05:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.539ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:05:23.684'

2025/06/25 22:05:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.299ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:50:23.688' LIMIT 50

2025/06/25 22:05:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.773ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:50:23.715' LIMIT 50

2025/06/25 22:05:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[63.572ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:05:23.684'

2025/06/25 22:05:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.947ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:05:23.684'

2025/06/25 22:05:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.865ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:35:24.057'

2025/06/25 22:05:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.704ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:05:24.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:05:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.311ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:05:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.738ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:05:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.979ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:35:24.228'

2025/06/25 22:05:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.995ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:05:24.24' AND status != 'pending'
	

2025/06/25 22:05:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.349ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:05:24.289' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:05:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.706ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:05:24.301' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:05:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.938ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:05:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.575ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:05:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[72.031ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:05:24.361'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:05:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[66.811ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:05:24.407' AND status != 'pending'
	

2025/06/25 22:05:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[73.280ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:05:24.474' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:05:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.038ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:05:24.547'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:06:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.286ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:06:23.684'

2025/06/25 22:06:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[56.873ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:06:23.684'

2025/06/25 22:06:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.266ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:06:23.684'

2025/06/25 22:06:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.308ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:36:24.056'

2025/06/25 22:06:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.552ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:06:24.114' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:06:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.857ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:06:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.274ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:06:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.378ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:36:24.228'

2025/06/25 22:06:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[56.979ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:06:24.232' AND status != 'pending'
	

2025/06/25 22:06:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.157ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:06:24.289' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:06:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.251ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:06:24.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:06:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.255ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:06:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.610ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:06:24.348'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:06:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.551ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:06:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.293ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:06:24.409' AND status != 'pending'
	

2025/06/25 22:06:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.143ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:06:24.469' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:06:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.361ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:06:24.53'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:06:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[58.667ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:06:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.052ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:06:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.301ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:06:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.531ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:06:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.949ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:07:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.906ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:07:23.684'

2025/06/25 22:07:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.280ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:52:23.687' LIMIT 50

2025/06/25 22:07:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.594ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:52:23.714' LIMIT 50

2025/06/25 22:07:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.980ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:07:23.684'

2025/06/25 22:07:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.759ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:07:23.684'

2025/06/25 22:07:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.763ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:37:24.056'

2025/06/25 22:07:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.021ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:07:24.117' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:07:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.055ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:07:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.266ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:07:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.648ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:37:24.231'

2025/06/25 22:07:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.957ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:07:24.239' AND status != 'pending'
	

2025/06/25 22:07:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.170ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:07:24.289' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:07:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.340ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:07:24.299' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:07:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.811ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:07:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.695ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:07:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.737ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:07:24.359'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:07:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.167ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:07:24.406' AND status != 'pending'
	

2025/06/25 22:07:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.702ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:07:24.464' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:07:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[78.880ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:07:24.522'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:07:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.176ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:07:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.016ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:07:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.488ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:07:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.044ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:07:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.435ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:07:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.710ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:07:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.883ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:07:26 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.227ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:07:27 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.365ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:07:27 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.295ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:08:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[58.370ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:08:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.056ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:08:19 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.318ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:08:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.698ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:08:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.383ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:08:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.846ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:08:23.684'

2025/06/25 22:08:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.062ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:08:23.684'

2025/06/25 22:08:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[64.311ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:08:23.684'

2025/06/25 22:08:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.239ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:38:24.056'

2025/06/25 22:08:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.767ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:08:24.12' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:08:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[34.742ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:08:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.590ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:08:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[66.083ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:38:24.227'

2025/06/25 22:08:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[71.059ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:08:24.256' AND status != 'pending'
	

2025/06/25 22:08:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.542ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:08:24.293' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:08:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.164ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:08:24.327' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:08:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.544ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:08:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[35.412ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:08:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[70.338ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:08:24.389'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:08:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[68.462ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:08:24.425' AND status != 'pending'
	

2025/06/25 22:08:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[67.218ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:08:24.494' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:08:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.786ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:08:24.561'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:08:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.853ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:08:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.395ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:08:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.870ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:08:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[65.360ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:08:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[64.958ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:08:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.559ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:08:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.043ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:08:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.518ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:08:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.800ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:08:48 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.577ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:09:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.563ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:09:23.684'

2025/06/25 22:09:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.139ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:54:23.687' LIMIT 50

2025/06/25 22:09:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.836ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:54:23.714' LIMIT 50

2025/06/25 22:09:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.288ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:09:23.684'

2025/06/25 22:09:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.883ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:09:23.684'

2025/06/25 22:09:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.868ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:39:24.057'

2025/06/25 22:09:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.684ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:09:24.117' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:09:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.006ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:09:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.762ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:09:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.973ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:39:24.227'

2025/06/25 22:09:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.417ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:09:24.239' AND status != 'pending'
	

2025/06/25 22:09:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.770ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:09:24.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:09:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.008ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:09:24.3' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:09:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.625ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:09:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.542ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:09:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.152ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:09:24.36'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:09:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.720ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:09:24.405' AND status != 'pending'
	

2025/06/25 22:09:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[70.565ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:09:24.464' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:09:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.281ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:09:24.535'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:09:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.304ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:09:59 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.035ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:10:22 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.101ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:10:22 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.582ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:10:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.316ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:10:23.684'

2025/06/25 22:10:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.810ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:10:23.684'

2025/06/25 22:10:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.387ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:10:23.684'

2025/06/25 22:10:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.468ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:40:24.056'

2025/06/25 22:10:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.581ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:10:24.117' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:10:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.029ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:10:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.836ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:10:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.108ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:40:24.227'

2025/06/25 22:10:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.004ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:10:24.238' AND status != 'pending'
	

2025/06/25 22:10:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.626ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:10:24.284' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:10:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.805ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:10:24.299' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:10:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.692ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:10:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.975ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:10:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.919ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:10:24.359'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:10:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.938ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:10:24.4' AND status != 'pending'
	

2025/06/25 22:10:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.587ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:10:24.458' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:10:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.290ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:10:24.518'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:11:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.755ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:11:23.684'

2025/06/25 22:11:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.558ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:56:23.687' LIMIT 50

2025/06/25 22:11:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.366ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:56:23.714' LIMIT 50

2025/06/25 22:11:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.229ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:11:23.684'

2025/06/25 22:11:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[57.467ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:11:23.684'

2025/06/25 22:11:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.161ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:41:24.056'

2025/06/25 22:11:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.085ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:11:24.115' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:11:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.754ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:11:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.983ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:11:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.513ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:41:24.227'

2025/06/25 22:11:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.978ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:11:24.231' AND status != 'pending'
	

2025/06/25 22:11:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.733ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:11:24.289' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:11:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.955ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:11:24.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:11:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.397ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:11:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.187ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:11:24.348'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:11:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.186ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:11:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.532ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:11:24.408' AND status != 'pending'
	

2025/06/25 22:11:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.964ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:11:24.467' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:11:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.230ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:11:24.53'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:12:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.898ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:12:23.683'

2025/06/25 22:12:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.734ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:12:23.683'

2025/06/25 22:12:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.901ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:12:23.683'

2025/06/25 22:12:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.498ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:42:24.056'

2025/06/25 22:12:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.220ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:12:24.117' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:12:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.523ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:12:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.004ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:12:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.059ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:42:24.227'

2025/06/25 22:12:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.330ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:12:24.237' AND status != 'pending'
	

2025/06/25 22:12:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.943ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:12:24.284' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:12:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.176ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:12:24.297' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:12:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.566ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:12:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.868ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:12:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.744ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:12:24.359'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:12:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[58.169ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:12:24.405' AND status != 'pending'
	

2025/06/25 22:12:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.085ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:12:24.463' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:12:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.425ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:12:24.523'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:13:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.099ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:13:23.683'

2025/06/25 22:13:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.835ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:58:23.687' LIMIT 50

2025/06/25 22:13:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.959ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:58:23.714' LIMIT 50

2025/06/25 22:13:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.689ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:13:23.683'

2025/06/25 22:13:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.630ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:13:23.683'

2025/06/25 22:13:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.201ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:43:24.055'

2025/06/25 22:13:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.678ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:13:24.113' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:13:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.945ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:13:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.303ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:13:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.901ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:13:24.229' AND status != 'pending'
	

2025/06/25 22:13:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.513ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:43:24.227'

2025/06/25 22:13:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.945ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:13:24.287' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:13:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.543ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:13:24.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:13:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.740ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:13:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.425ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:13:24.346'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:13:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.978ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:13:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.906ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:13:24.407' AND status != 'pending'
	

2025/06/25 22:13:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.705ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:13:24.467' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:13:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.386ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:13:24.528'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:14:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.965ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:14:23.683'

2025/06/25 22:14:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.689ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:14:23.683'

2025/06/25 22:14:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[65.575ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:14:23.683'

2025/06/25 22:14:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.519ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:44:24.055'

2025/06/25 22:14:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.268ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:14:24.116' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:14:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.960ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:14:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.009ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:14:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.185ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:44:24.226'

2025/06/25 22:14:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.696ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:14:24.237' AND status != 'pending'
	

2025/06/25 22:14:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.487ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:14:24.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:14:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.301ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:14:24.298' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:14:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.464ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:14:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.788ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:14:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.620ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:14:24.358'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:14:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.556ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:14:24.406' AND status != 'pending'
	

2025/06/25 22:14:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.361ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:14:24.465' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:14:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.474ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:14:24.523'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:15:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.412ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:15:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.710ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:15:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.389ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:00:23.687' LIMIT 50

2025/06/25 22:15:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.240ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:15:23.683'

2025/06/25 22:15:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.304ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:00:23.714' LIMIT 50

2025/06/25 22:15:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.992ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:15:23.683'

2025/06/25 22:15:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.207ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:15:23.683'

2025/06/25 22:15:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.959ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:45:24.056'

2025/06/25 22:15:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.988ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:15:24.117' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:15:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.985ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:15:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.901ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:15:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.054ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:45:24.227'

2025/06/25 22:15:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.790ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:15:24.238' AND status != 'pending'
	

2025/06/25 22:15:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.760ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:15:24.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:15:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.906ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:15:24.299' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:15:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.754ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:15:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.444ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:15:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.693ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:15:24.359'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:15:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.781ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:15:24.409' AND status != 'pending'
	

2025/06/25 22:15:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.437ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:15:24.469' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:15:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.762ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:15:24.529'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:15:27 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.638ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:16:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.019ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:16:23.684'

2025/06/25 22:16:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.221ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:16:23.684'

2025/06/25 22:16:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.268ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:16:23.684'

2025/06/25 22:16:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.631ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:46:24.056'

2025/06/25 22:16:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.922ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:16:24.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:16:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[31.187ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:16:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.814ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:16:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[63.832ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:46:24.227'

2025/06/25 22:16:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.745ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:16:24.241' AND status != 'pending'
	

2025/06/25 22:16:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[73.637ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:16:24.291' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:16:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[64.639ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:16:24.3' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:16:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[33.583ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:16:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.156ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:16:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[65.036ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:16:24.365'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:16:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.799ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:16:24.43' AND status != 'pending'
	

2025/06/25 22:16:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.574ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:16:24.49' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:16:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[66.800ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:16:24.552'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:16:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.521ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:16:46 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.630ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:16:51 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.779ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:17:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.838ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:17:23.683'

2025/06/25 22:17:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.304ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:02:23.687' LIMIT 50

2025/06/25 22:17:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.974ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:02:23.714' LIMIT 50

2025/06/25 22:17:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[59.272ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:17:23.683'

2025/06/25 22:17:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.822ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:17:23.683'

2025/06/25 22:17:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.034ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:47:24.055'

2025/06/25 22:17:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.451ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:17:24.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:17:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.941ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:17:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.934ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:17:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.820ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:47:24.227'

2025/06/25 22:17:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.491ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:17:24.238' AND status != 'pending'
	

2025/06/25 22:17:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.439ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:17:24.285' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:17:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[69.235ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:17:24.3' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:17:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.924ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:17:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.490ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:17:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.667ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:17:24.369'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:17:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.674ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:17:24.405' AND status != 'pending'
	

2025/06/25 22:17:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.109ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:17:24.463' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:17:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.867ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:17:24.522'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:18:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.117ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:18:23.683'

2025/06/25 22:18:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.735ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:18:23.683'

2025/06/25 22:18:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.914ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:18:23.683'

2025/06/25 22:18:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.247ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:48:24.056'

2025/06/25 22:18:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.376ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:18:24.121' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:18:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.770ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:18:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.323ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:18:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.174ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:48:24.227'

2025/06/25 22:18:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.882ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:18:24.238' AND status != 'pending'
	

2025/06/25 22:18:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[59.339ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:18:24.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:18:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.309ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:18:24.296' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:18:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.179ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:18:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.877ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:18:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.369ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:18:24.355'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:18:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[64.995ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:18:24.407' AND status != 'pending'
	

2025/06/25 22:18:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.867ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:18:24.472' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:18:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.468ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:18:24.533'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:18:34 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[61.604ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:18:35 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.785ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:18:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[63.228ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:18:47 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.620ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:19:08 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.299ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:19:12 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.239ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:19:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.774ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:19:20 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.591ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:19:21 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[64.352ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:19:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.258ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:19:23.683'

2025/06/25 22:19:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.228ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:04:23.687' LIMIT 50

2025/06/25 22:19:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[62.424ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:04:23.714' LIMIT 50

2025/06/25 22:19:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.962ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:19:23.683'

2025/06/25 22:19:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[71.612ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:19:23.683'

2025/06/25 22:19:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.827ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:49:24.055'

2025/06/25 22:19:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.249ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:19:24.116' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:19:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.114ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:19:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.778ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:19:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.859ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:49:24.227'

2025/06/25 22:19:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.866ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:19:24.237' AND status != 'pending'
	

2025/06/25 22:19:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.316ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:19:24.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:19:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.424ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:19:24.297' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:19:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.782ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:19:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.712ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:19:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.687ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:19:24.357'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:19:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.895ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:19:24.41' AND status != 'pending'
	

2025/06/25 22:19:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.594ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:19:24.47' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:19:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.129ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:19:24.53'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:20:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[63.035ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:20:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.178ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:20:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[63.968ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:20:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[59.313ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:20:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[61.158ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:20:06 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.368ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[61.164ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:20:07 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.475ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:20:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.236ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:20:23.683'

2025/06/25 22:20:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.266ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:20:23.683'

2025/06/25 22:20:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.034ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:20:23.683'

2025/06/25 22:20:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.090ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:50:24.056'

2025/06/25 22:20:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.213ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:20:24.117' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:20:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.583ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:20:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.549ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:20:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.110ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:50:24.227'

2025/06/25 22:20:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.269ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:20:24.239' AND status != 'pending'
	

2025/06/25 22:20:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.462ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:20:24.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:20:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.707ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:20:24.3' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:20:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.810ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:20:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.522ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:20:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.265ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:20:24.359'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:20:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[59.967ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:20:24.408' AND status != 'pending'
	

2025/06/25 22:20:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.391ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:20:24.468' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:20:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.529ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:20:24.529'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:21:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[64.116ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:21:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[64.680ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:21:22 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[64.867ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:21:22 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[64.007ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:21:22 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[64.484ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:21:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.440ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:21:23.683'

2025/06/25 22:21:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.845ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:06:23.687' LIMIT 50

2025/06/25 22:21:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.143ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:06:23.714' LIMIT 50

2025/06/25 22:21:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.191ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:21:23.683'

2025/06/25 22:21:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[57.478ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:21:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.299ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:21:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[60.518ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:21:23.683'

2025/06/25 22:21:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.092ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:51:24.056'

2025/06/25 22:21:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.652ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:21:24.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:21:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.467ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:21:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.508ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:21:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.823ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:51:24.227'

2025/06/25 22:21:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.276ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:21:24.239' AND status != 'pending'
	

2025/06/25 22:21:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.087ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:21:24.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:21:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.837ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:21:24.299' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:21:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.909ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:21:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.498ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:21:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.841ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:21:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.613ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:21:24.359'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:21:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.074ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:21:24.408' AND status != 'pending'
	

2025/06/25 22:21:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[72.302ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:21:24.469' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:21:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[59.839ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:21:24.541'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:21:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:48
[61.053ms] [rows:1] SELECT * FROM `app_user` WHERE phone = '13113288579' ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:21:39 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.290ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:21:45 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[64.426ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:22:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.430ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:22:23.683'

2025/06/25 22:22:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[64.866ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:22:23.683'

2025/06/25 22:22:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.908ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:22:23.683'

2025/06/25 22:22:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.567ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:52:24.056'

2025/06/25 22:22:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.505ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:22:24.117' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:22:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.789ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:22:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.955ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:22:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.221ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:52:24.227'

2025/06/25 22:22:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.444ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:22:24.238' AND status != 'pending'
	

2025/06/25 22:22:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.347ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:22:24.289' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:22:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.283ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:22:24.299' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:22:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.182ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:22:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[34.557ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:22:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[68.884ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:22:24.36'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:22:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[76.823ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:22:24.415' AND status != 'pending'
	

2025/06/25 22:22:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.230ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:22:24.492' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:22:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.444ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:22:24.553'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:23:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.009ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:23:23.683'

2025/06/25 22:23:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.623ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:08:23.687' LIMIT 50

2025/06/25 22:23:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.472ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:23:23.683'

2025/06/25 22:23:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.978ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:23:23.683'

2025/06/25 22:23:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[178.215ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:23:23.687' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/25 22:23:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[28.590ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-18 22:23:23.866'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/25 22:23:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[189.396ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:08:23.714' LIMIT 50

2025/06/25 22:23:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:545
[189.433ms] [rows:0] 
		SELECT ar.user_id, ar.amount, ar.remark, ar.create_time, ar.order_no
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-24 22:23:23.714' 
		AND ar.status = 'completed'
		AND (
			-- 有订单号但找不到对应订单
			(ar.order_no IS NOT NULL AND ar.order_no != '' AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.no = ar.order_no
				AND ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
			))
			OR
			-- 没有订单号且找不到匹配的订单
			((ar.order_no IS NULL OR ar.order_no = '') AND NOT EXISTS (
				SELECT 1 FROM app_order ao 
				WHERE ao.user_id = ar.user_id 
				AND ABS(ao.amount - ar.amount) < 0.01
				AND ao.create_time BETWEEN ar.create_time - INTERVAL 10 MINUTE 
			                           AND ar.create_time + INTERVAL 10 MINUTE
			))
		)
		LIMIT 20
	

2025/06/25 22:23:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_security_fixes.go:604 Error 1054 (42S22): Unknown column 'ag.title' in 'field list'
[31.139ms] [rows:-] 
		SELECT ag.id as goods_id, ag.title, ag.stock, 
			   COUNT(ao.id) as order_count,
			   SUM(ao.num) as total_ordered
		FROM app_goods ag
		LEFT JOIN app_order ao ON ag.id = ao.goods_id 
			AND ao.status IN ('1', '2', '3') -- 已支付、处理中、已完成
			AND ao.create_time > '2025-06-18 22:23:23.903'
		WHERE ag.status = '1' AND ag.isdelete != 1
		GROUP BY ag.id, ag.title, ag.stock
		HAVING total_ordered > 0
		LIMIT 50
	

2025/06/25 22:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[70.284ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:53:24.056'

2025/06/25 22:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[63.899ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:23:24.126' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.088ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.069ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.516ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:53:24.226'

2025/06/25 22:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.251ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:23:24.251' AND status != 'pending'
	

2025/06/25 22:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.374ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:23:24.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.646ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:23:24.312' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.476ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.956ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.902ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:23:24.373'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.608ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:23:24.41' AND status != 'pending'
	

2025/06/25 22:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.869ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:23:24.472' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:23:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.933ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:23:24.535'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:23:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[60.729ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:23:28 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.910ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:24:01 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.967ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:24:01 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.030ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:24:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.435ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:24:23.683'

2025/06/25 22:24:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[65.881ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:24:23.683'

2025/06/25 22:24:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.771ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:24:23.683'

2025/06/25 22:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.508ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:54:24.056'

2025/06/25 22:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.471ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:24:24.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.797ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.426ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.505ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:54:24.226'

2025/06/25 22:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.293ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:24:24.241' AND status != 'pending'
	

2025/06/25 22:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.932ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:24:24.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.724ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:24:24.302' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.893ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.580ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.941ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:24:24.363'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.559ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:24:24.41' AND status != 'pending'
	

2025/06/25 22:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.748ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:24:24.471' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:24:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.805ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:24:24.533'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[67.040ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:24:42 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[67.785ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:25:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.026ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:25:23.683'

2025/06/25 22:25:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.715ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:10:23.687' LIMIT 50

2025/06/25 22:25:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.173ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:10:23.714' LIMIT 50

2025/06/25 22:25:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.878ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:25:23.683'

2025/06/25 22:25:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.192ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:25:23.683'

2025/06/25 22:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.744ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:55:24.055'

2025/06/25 22:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.972ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:25:24.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.344ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.668ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.622ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:55:24.227'

2025/06/25 22:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.056ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:25:24.241' AND status != 'pending'
	

2025/06/25 22:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.533ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:25:24.284' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.261ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:25:24.302' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.616ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.962ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.334ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:25:24.364'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.977ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:25:24.4' AND status != 'pending'
	

2025/06/25 22:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.350ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:25:24.458' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:25:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.162ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:25:24.517'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:25:33 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[58.418ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:26:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[59.224ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:26:23.683'

2025/06/25 22:26:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[57.962ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:26:23.683'

2025/06/25 22:26:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[58.440ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:26:23.683'

2025/06/25 22:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[59.092ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:56:24.055'

2025/06/25 22:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[57.635ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:26:24.114' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.712ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.759ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.428ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:56:24.226'

2025/06/25 22:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.728ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:26:24.23' AND status != 'pending'
	

2025/06/25 22:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[59.070ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:26:24.288' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.497ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:26:24.288' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.225ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[57.720ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:26:24.347'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.295ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.035ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:26:24.41' AND status != 'pending'
	

2025/06/25 22:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.905ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:26:24.471' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:26:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.547ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:26:24.532'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:27:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[58.305ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:12:23.687' LIMIT 50

2025/06/25 22:27:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[63.359ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:27:23.683'

2025/06/25 22:27:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.706ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:12:23.714' LIMIT 50

2025/06/25 22:27:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[60.686ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:27:23.683'

2025/06/25 22:27:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[67.684ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:27:23.683'

2025/06/25 22:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.687ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:57:24.056'

2025/06/25 22:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.461ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:27:24.119' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.660ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.504ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[64.303ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:57:24.227'

2025/06/25 22:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.289ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:27:24.241' AND status != 'pending'
	

2025/06/25 22:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.873ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:27:24.291' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.017ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:27:24.301' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.879ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.643ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.078ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:27:24.363'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.874ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:27:24.414' AND status != 'pending'
	

2025/06/25 22:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.590ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:27:24.475' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:27:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.827ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:27:24.537'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:28:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.127ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:28:23.683'

2025/06/25 22:28:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[62.328ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:28:23.683'

2025/06/25 22:28:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[70.350ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:28:23.683'

2025/06/25 22:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[71.610ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:58:24.055'

2025/06/25 22:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.552ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:28:24.127' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.282ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.843ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.254ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:58:24.226'

2025/06/25 22:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.727ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:28:24.25' AND status != 'pending'
	

2025/06/25 22:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.323ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:28:24.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.808ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:28:24.312' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.148ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.579ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.834ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:28:24.373'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.999ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:28:24.408' AND status != 'pending'
	

2025/06/25 22:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.688ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:28:24.469' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:28:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.875ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:28:24.53'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:29:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[68.058ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:29:17 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[68.344ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:29:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.317ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:29:23.683'

2025/06/25 22:29:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[60.044ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:14:23.686' LIMIT 50

2025/06/25 22:29:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[57.948ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:14:23.714' LIMIT 50

2025/06/25 22:29:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.175ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:29:23.683'

2025/06/25 22:29:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.682ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:29:23.683'

2025/06/25 22:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.188ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:59:24.055'

2025/06/25 22:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[65.816ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:29:24.117' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.810ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.237ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.623ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 21:59:24.226'

2025/06/25 22:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[62.246ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:29:24.244' AND status != 'pending'
	

2025/06/25 22:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.255ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:29:24.284' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.938ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:29:24.306' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.726ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.944ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.757ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:29:24.367'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.483ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:29:24.401' AND status != 'pending'
	

2025/06/25 22:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.700ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:29:24.458' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:29:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.054ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:29:24.517'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:30:03 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.054ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[59.172ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:30:16 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.578ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:30:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[62.311ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:30:23.683'

2025/06/25 22:30:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.224ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:30:23.683'

2025/06/25 22:30:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[62.646ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:30:23.683'

2025/06/25 22:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.517ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:00:24.055'

2025/06/25 22:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.761ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:30:24.117' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.027ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[31.158ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.864ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:00:24.226'

2025/06/25 22:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.223ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:30:24.241' AND status != 'pending'
	

2025/06/25 22:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.343ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:30:24.284' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.785ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:30:24.302' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[29.336ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.671ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.794ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:30:24.364'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.921ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:30:24.401' AND status != 'pending'
	

2025/06/25 22:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[57.701ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:30:24.459' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:30:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.187ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:30:24.517'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:31:05 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[58.290ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:31:22 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[58.013ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:31:22 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[60.426ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:31:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[59.948ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:16:23.686' LIMIT 50

2025/06/25 22:31:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[65.116ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:31:23.683'

2025/06/25 22:31:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[64.514ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:16:23.714' LIMIT 50

2025/06/25 22:31:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[68.380ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:31:23.683'

2025/06/25 22:31:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[70.687ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:31:23.683'

2025/06/25 22:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.990ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:01:24.055'

2025/06/25 22:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.744ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:31:24.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.162ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.358ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.156ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:01:24.226'

2025/06/25 22:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.845ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:31:24.241' AND status != 'pending'
	

2025/06/25 22:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[60.668ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:31:24.289' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.940ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:31:24.302' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.014ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.545ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.346ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:31:24.363'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.018ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:31:24.411' AND status != 'pending'
	

2025/06/25 22:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[62.418ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:31:24.472' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:31:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[62.388ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:31:24.534'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:32:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[61.841ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:32:23.683'

2025/06/25 22:32:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.779ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:32:23.683'

2025/06/25 22:32:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.202ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:32:23.683'

2025/06/25 22:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[62.159ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:02:24.055'

2025/06/25 22:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.292ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:32:24.118' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.457ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.118ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.625ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:02:24.226'

2025/06/25 22:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.925ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:32:24.24' AND status != 'pending'
	

2025/06/25 22:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.713ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:32:24.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.799ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:32:24.301' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.417ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.506ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.880ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:32:24.362'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.796ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:32:24.411' AND status != 'pending'
	

2025/06/25 22:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[61.517ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:32:24.472' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:32:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.235ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:32:24.534'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:32:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/banner.go:26
[62.114ms] [rows:2] SELECT * FROM `pet_banners` WHERE status = 1 ORDER BY sort DESC, id DESC

2025/06/25 22:32:53 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[63.006ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:33:13 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[61.798ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:33:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[60.798ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:33:23.683'

2025/06/25 22:33:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[61.161ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:18:23.686' LIMIT 50

2025/06/25 22:33:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_system_init.go:163
[56.497ms] [rows:0] SELECT `no` FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:18:23.713' LIMIT 50

2025/06/25 22:33:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[61.414ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:33:23.683'

2025/06/25 22:33:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[61.087ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:33:23.683'

2025/06/25 22:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[61.327ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:03:24.055'

2025/06/25 22:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[61.384ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:33:24.116' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.620ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.720ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[57.512ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:03:24.226'

2025/06/25 22:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.248ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:33:24.24' AND status != 'pending'
	

2025/06/25 22:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.392ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:33:24.286' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.746ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:33:24.301' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.605ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[29.652ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[61.403ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:33:24.362'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[60.884ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:33:24.403' AND status != 'pending'
	

2025/06/25 22:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[60.912ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:33:24.464' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:33:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.160ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:33:24.525'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:33:34 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.398ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:33:36 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/login.go:86
[62.727ms] [rows:1] SELECT * FROM `app_user` WHERE id = 6 ORDER BY `app_user`.`id` LIMIT 1

2025/06/25 22:34:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:67
[58.718ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 2 AND start_time <= '2025-06-25 22:34:23.682'

2025/06/25 22:34:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:121
[58.660ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 3 AND end_time <= '2025-06-25 22:34:23.682'

2025/06/25 22:34:23 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/booking_scheduler.go:194
[59.723ms] [rows:0] SELECT * FROM `room_bookings` WHERE status = 1 AND create_time <= '2025-06-24 22:34:23.682'

2025/06/25 22:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[58.701ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:04:24.055'

2025/06/25 22:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[58.641ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:34:24.114' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[28.665ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[28.980ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:129
[60.691ms] [rows:0] SELECT * FROM `order` WHERE status = 'pending' AND create_time < '2025-06-25 22:04:24.226'

2025/06/25 22:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[57.978ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:34:24.231' AND status != 'pending'
	

2025/06/25 22:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[58.516ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:34:24.289' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:177
[62.238ms] [rows:0] 
		SELECT user_id, COUNT(*) as payment_count, SUM(amount) as total_amount
		FROM app_recharge 
		WHERE create_time > '2025-06-25 21:34:24.287' AND transaction_type = 'order_payment'
		GROUP BY user_id
		HAVING COUNT(*) > 20 OR SUM(amount) > 5000
		ORDER BY payment_count DESC, total_amount DESC
		LIMIT 20
	

2025/06/25 22:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:201
[30.596ms] [rows:0] SELECT * FROM `goods_list` WHERE stock < 0 AND isdelete != 1

2025/06/25 22:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[58.222ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:34:24.348'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	

2025/06/25 22:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:217
[30.258ms] [rows:0] SELECT * FROM `goods_list` WHERE stock > 0 AND stock < 10 AND status = '1' AND isdelete != 1

2025/06/25 22:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:246
[61.155ms] [rows:1] 
		SELECT 
			COUNT(*) as total_orders,
			AVG(TIMESTAMPDIFF(SECOND, create_time, update_time)) as avg_duration
		FROM app_order 
		WHERE create_time > '2025-06-25 21:34:24.41' AND status != 'pending'
	

2025/06/25 22:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:305
[63.108ms] [rows:1] 
		SELECT 
			'orphaned_payments' as issue,
			COUNT(*) as count,
			'支付记录无对应订单' as description
		FROM app_recharge ar 
		WHERE ar.transaction_type = 'order_payment' 
		AND ar.create_time > '2025-06-25 21:34:24.472' 
		AND ar.order_no IS NOT NULL
		AND ar.order_no != ''
		AND NOT EXISTS (
			SELECT 1 FROM app_order ao 
			WHERE ao.no = ar.order_no
			AND ao.user_id = ar.user_id 
			AND ABS(ao.amount - ar.amount) < 0.01
		)
	

2025/06/25 22:34:24 /Users/wensiyuan/go/go-admin-sass-github/services/app_service/order_monitoring.go:343
[60.619ms] [rows:1] 
		SELECT 
			'status_mismatch' as issue,
			COUNT(*) as count,
			'订单状态异常' as description
		FROM app_order ao 
		WHERE ao.create_time > '2025-06-25 21:34:24.535'
		AND ao.status = 'paid'
		AND NOT EXISTS (
			SELECT 1 FROM app_recharge ar 
			WHERE (
				(ar.order_no = ao.no AND ar.user_id = ao.user_id) 
				OR 
				(ar.user_id = ao.user_id AND ABS(ar.amount - ao.amount) < 0.01
				 AND ar.create_time BETWEEN ao.create_time - INTERVAL 10 MINUTE 
			                           AND ao.create_time + INTERVAL 10 MINUTE)
			)
			AND ar.transaction_type = 'order_payment'
			AND ar.status = 'completed'
		)
	
